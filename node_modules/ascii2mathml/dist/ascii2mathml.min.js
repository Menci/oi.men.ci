!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).ascii2mathml=e()}}(function(){return function a(o,c,s){function l(t,e){if(!c[t]){if(!o[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(u)return u(t,!0);var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}var i=c[t]={exports:{}};o[t][0].call(i.exports,function(e){return l(o[t][1][e]||e)},i,i.exports,a,o,c,s)}return c[t].exports}for(var u="function"==typeof require&&require,e=0;e<s.length;e++)l(s[e]);return l}({1:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ascii2mathml=c,r.default=void 0;var n,o=(n=e("./lib/parser"))&&n.__esModule?n:{default:n};function c(r,t){if("object"==typeof r)return function(e,t){return c(e,Object.assign({},r,t))};if((t="object"==typeof t?t:{}).annotate=t.annotate||!1,t.bare=t.bare||!1,t.display=t.display||"inline",t.standalone=t.standalone||!1,t.dir=t.dir||"ltr",t.decimalMark=t.decimalMark||".",t.colSep=t.colSep||",",t.rowSep=t.rowSep||";",","===t.decimalMark&&","===t.colSep&&(t.colSep=";"),";"===t.colSep&&";"===t.rowSep&&(t.rowSep=";;"),t.bare){if(t.standalone)throw new Error("Can't output a valid HTML without a root <math> element");if(t.display&&"inline"!==t.display.toLowerCase())throw new Error("Can't display block without root element.");if(t.dir&&"ltr"!==t.dir.toLowerCase())throw new Error("Can't have right-to-left direction without root element.")}var e,n=(0,o.default)(t),i=t.bare?function(e){return e}:function(e){return"<math".concat("inline"!==t.display?' display="'.concat(t.display,'"'):"").concat("ltr"!==t.dir?' dir="'.concat(t.dir,'"'):"",">").concat(e,"</math>")};if(t.annotate){var a=n(r.trim(),"");e=i("<semantics>"+(a===o.default.getlastel(a)?a:"<mrow>".concat(a,"</mrow>"))+'<annotation encoding="application/AsciiMath">'+r+"</annotation></semantics>")}else e=i(n(r.trim(),""));return t.standalone&&(e="<!DOCTYPE html><html><head><title>"+r+"</title></head><body>"+e+"</body></html>"),e}var i=c;r.default=i},{"./lib/parser":3}],2:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.accents=r.fonts=r.groupings=r.operators=r.identifiers=r.numbers=void 0;var n={};r.numbers=n;var i="[0-9\xb2\xb3\xb9\xbc-\xbe\u0660-\u0669\u06f0-\u06f9\u07c0-\u07c9\u0966-\u096f\u09e6-\u09ef\u09f4-\u09f9\u0a66-\u0a6f\u0ae6-\u0aef\u0b66-\u0b6f\u0b72-\u0b77\u0be6-\u0bf2\u0c66-\u0c6f\u0c78-\u0c7e\u0ce6-\u0cef\u0d66-\u0d75\u0e50-\u0e59\u0ed0-\u0ed9\u0f20-\u0f33\u1040-\u1049\u1090-\u1099\u1369-\u137c\u16ee-\u16f0\u17e0-\u17e9\u17f0-\u17f9\u1810-\u1819\u1946-\u194f\u19d0-\u19da\u1a80-\u1a89\u1a90-\u1a99\u1b50-\u1b59\u1bb0-\u1bb9\u1c40-\u1c49\u1c50-\u1c59\u2070\u2074-\u2079\u2080-\u2089\u2150-\u2182\u2185-\u218b\u2460-\u249b\u24ea-\u24ff\u2776-\u2793\u2cfd\u3007\u3021-\u3029\u3038-\u303a\u3192-\u3195\u3220-\u3229\u3248-\u324f\u3251-\u325f\u3280-\u3289\u32b1-\u32bf\u96f6\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d\u5341\u767e\u5343\u4e07\u5104\u5146\u4eac\u5793\ud855\udf71\u79ed\u7a63\u6e9d\u6f97\u6b63\u8f09\u5272\u5206\u5398\u6bdb\u7cf8\u5ffd\u5fae\u7e4a\u6c99\u5875\u57c3\ua620-\ua629\ua6e6-\ua6ef\ua830-\ua835\ua8d0-\ua8d9\ua900-\ua909\ua9d0-\ua9d9\uaa50-\uaa59\uabf0-\uabf9\uff10-\uff19]",a=new RegExp(i);Object.defineProperties(n,{digitRange:{value:i},digitRE:{value:a},isdigit:{value:function(e){return e.match(a)}}});var o=["sin","cos","tan","csc","sec","cot","sinh","cosh","tanh","log","ln","det","dim","lim","mod","gcd","lcm","min","max"],c={Gamma:"\u0393",Delta:"\u0394",Theta:"\u0398",Lambda:"\u039b",Xi:"\u039e",Pi:"\u03a0",Sigma:"\u03a3",Phi:"\u03a6",Psi:"\u03a8",Omega:"\u03a9",alpha:"\u03b1",beta:"\u03b2",gamma:"\u03b3",delta:"\u03b4",epsilon:"\u025b",zeta:"\u03b6",eta:"\u03b7",theta:"\u03b8",iota:"\u03b9",kappa:"\u03ba",lambda:"\u03bb",mu:"\u03bc",nu:"\u03bd",xi:"\u03be",pi:"\u03c0",rho:"\u03c1",sigma:"\u03c3",tau:"\u03c4",upsilon:"\u03c5",phi:"\u03c6",chi:"\u03c7",psi:"\u03c8",omega:"\u03c9",oo:"\u221e","O/":"\u2205",CC:"\u2102",NN:"\u2115",QQ:"\u211a",RR:"\u211d",ZZ:"\u2124"};r.identifiers=c,o.forEach(function(e){c[e]=e}),Object.defineProperty(c,"contains",{value:function(e){return void 0!==c[e]}}),Object.defineProperty(c,"funs",{value:o}),Object.defineProperty(c,"isfun",{value:function(e){return 0<=o.indexOf(e)}});var s={"*":"\xb7","**":"\u2217","***":"\u22c6","//":"/","|":"|",":":":","'":"\u2032","''":"\u2033","'''":"\u2034","''''":"\u2057",xx:"\xd7","-:":"\xf7","|><":"\u22c9","><|":"\u22ca","|><|":"\u22c8","@":"\u2218","o+":"\u2295",ox:"\u2297","o.":"\u2299","!":"!",sum:"\u2211",prod:"\u220f","^^":"\u2227","^^^":"\u22c0",vv:"\u2228",vvv:"\u22c1",nn:"\u2229",nnn:"\u22c2",uu:"\u222a",uuu:"\u22c3",int:"\u222b",oint:"\u222e",dint:"\u222c","+-":"\xb1",del:"\u2202",grad:"\u2207",aleph:"\u2135","/_":"\u2220",diamond:"\u22c4",square:"\u25a1","|__":"\u230a","__|":"\u230b","|~":"\u2308","~|":"\u2309","=":"=","!=":"\u2260","<":"&lt;",">":"&gt;","<=":"\u2264",">=":"\u2265","-<":"\u227a","-<=":"\u2aaf",">-":"\u227b",">-=":"\u2ab0",in:"\u2208","!in":"\u2209",sub:"\u2282",sup:"\u2283",sube:"\u2286",supe:"\u2287","-=":"\u2261","==":"\u2261","~=":"\u2245","~~":"\u2248",prop:"\u221d","<-":"\u2190","->":"\u2192","=>":"\u21d2","<=>":"\u21d4","|->":"\u21a6",">->":"\u21a3","->>":"\u21a0",">->>":"\u2916",uarr:"\u2191",darr:"\u2193",larr:"\u2190",rarr:"\u2192",harr:"\u2194",lArr:"\u21d0",rArr:"\u21d2",hArr:"\u21d4",iff:"\u21d4",",":",",":.":"\u2234","...":"\u2026",cdots:"\u22ef",ddots:"\u22f1",vdots:"\u22ee",if:"if",otherwise:"otherwise",and:"and",or:"or",not:"\xac",AA:"\u2200",EE:"\u2203","_|_":"\u22a5",TT:"\u22a4","|--":"\u22a2","|==":"\u22a8"};r.operators=s,Object.defineProperty(s,"contains",{value:function(e){return void 0!==s[e]}}),Object.defineProperty(s,"get",{value:function(e){return s[e]||e}}),Object.defineProperty(s,"regexp",{value:new RegExp("("+Object.keys(s).sort(function(e,t){return t.length-e.length}).map(function(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}).join("|")+"|[+-<=>|~\xac\xb1\xd7\xf7\u03d0\u03d1\u03d2\u03d5\u03f0\u03f1\u03f4\u03f5\u03f6\u0606\u0607\u0608\u2016\u2032\u2033\u2034\u2040\u2044\u2052\u2061-\u2064\u207a-\u207e\u208a-\u208e\u2605\u2606\u2660\u2661\u2662\u2663\u266d\u266e\u266f\ufb29\uff61-\uff68\uff0b\uff1c\uff1d\uff1e\uff3c\uff3e\uff5c\uff5e\uffe2\uffe9\uffea\uffeb\uffec\u2200-\u22ff\u2a00-\u2aff\u27c0-\u27e5\u2980-\u2982\u2999-\u29ff\u2301-\u23ff\u25a0-\u25ff\u2b00-\u2bff\u2190-\u21ff\u27f0-\u27ff\u2900-\u297f\u20d0-\u20ef])")});var l={open:{"(:":"\u27e8","{:":""},close:{":)":"\u27e9",":}":""},complex:{abs:{open:"|",close:"|"},floor:{open:"\u230a",close:"\u230b"},ceil:{open:"\u2308",close:"\u2309"},norm:{open:"\u2225",close:"\u2225"}}};r.groupings=l,Object.defineProperty(l.open,"regexp",{value:/([[\u27e6\u27e8\u27ea\u27ec\u27ee\u2983\u2985\u2987\u2989\u298b\u298d\u298f\u2991\u2993\u2995\u2997]|[({]:?)/}),Object.defineProperty(l.close,"regexp",{value:/([\]\u27e7\u27e9\u27eb\u27ed\u27ef\u2984\u2986\u2988\u298a\u298c\u298e\u2990\u2992\u2994\u2996\u2998]|:?[)}])/}),Object.defineProperty(l.open,"get",{value:function(e){var t=l.open[e];return"string"==typeof t?t:e}}),Object.defineProperty(l.close,"get",{value:function(e){var t=l.close[e];return"string"==typeof t?t:e}}),Object.defineProperty(l.complex,"contains",{value:function(e){return 0<=Object.keys(l.complex).indexOf(e)}}),Object.defineProperty(l.complex,"get",{value:function(e){return l.complex[e]}}),Object.freeze(l.open),Object.freeze(l.close),Object.freeze(l.complex);var u={rm:"normal",bf:"bold",it:"italic",bb:"double-struck",cc:"script",tt:"monospace",fr:"fraktur",sf:"sans-serif"};r.fonts=u,Object.defineProperty(u,"get",{value:function(e){return u[e]}}),Object.defineProperty(u,"regexp",{value:new RegExp("("+Object.keys(u).join("|")+")")});var f={hat:{type:"over",accent:"^"},bar:{type:"over",accent:"\u203e"},ul:{type:"under",accent:"_"},vec:{type:"over",accent:"\u2192"},dot:{type:"over",accent:"\u22c5"},ddot:{type:"over",accent:"\u22c5\u22c5"},tilde:{type:"over",accent:"\u02dc"},cancel:{type:"enclose",attrs:{notation:"updiagonalstrike"}}};r.accents=f,Object.defineProperty(f,"contains",{value:function(e){return 0<=Object.keys(f).indexOf(e)}}),Object.defineProperty(f,"get",{value:function(e){return f[e]}}),Object.defineProperty(f,"regexp",{value:new RegExp("("+Object.keys(f).join("|")+")")})},{}],3:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n,le=(n=e("./syntax"))&&n.__esModule?n:{default:n},ue=e("./lexicon");function fe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,c=e[Symbol.iterator]();!(n=(o=c.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==c.return||c.return()}finally{if(i)throw a}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function me(i){return function t(r,n){if("object"==typeof r)return function(e){return t(e,r)};if("object"!=typeof n)return"<".concat(i,">").concat(r,"</").concat(i,">");var e=Object.keys(n).map(function(e){return"".concat(e,'="').concat(n[e],'"')}).join(" ");return"<".concat(i," ").concat(e,">").concat(r,"</").concat(i,">")}}var pe=me("mi"),de=me("mn"),he=me("mo"),ve=me("mfrac"),ge=me("msup"),be=me("msub"),xe=me("msubsup"),ye=me("munder"),Oe=me("mover"),we=me("munderover"),je=me("menclose"),_e=me("mrow"),Se=me("msqrt"),ke=me("mroot"),Ee=me("mfenced"),Pe=me("mtable"),We=me("mtr"),Re=me("mtd");function i(te){var e="."===te.decimalMark?"\\.":te.decimalMark,re=new RegExp("^".concat(ue.numbers.digitRange,"+(").concat(e).concat(ue.numbers.digitRange,"+)?")),ne=t(te.colSep),ie=t(te.rowSep),ae=t("\n");function t(c){return function(e){for(var t=[],r=0,n=0,i=0;i<e.length;i+=1){var a=e.slice(i),o=e[i];a.startsWith(c)&&!e.slice(0,i).match(/\\(\\{2})*$/)?0===r&&(t.push(e.slice(n,i)),n=i+c.length):o.match(ue.groupings.open.regexp)?r+=1:o.match(ue.groupings.close.regexp)&&(r-=1)}return t.push(e.slice(n)),t}}var r=function e(t,r,n,i){if(!t)return r;if(t.match(/^\s/)){if(t.match(/^\s+(\/[^\/]|^[^\^]|_[^_|])/))return e(t.trim(),r,!0);var a=t.match(/^ +/),o=a?a[0].length:0;if(1<o){var c='<mspace width="'.concat(o-1,'ex" />');return e(t.trim(),r+c,!0)}return e(t.trim(),r,!0)}var s=fe(ce(t,i),2),l=s[0],u=s[1];if((u&&u.trimLeft().startsWith("/")||u.trimLeft().startsWith("./"))&&!u.trimLeft().match(/^\.?\/\//)){var f=fe(function e(t,r){var n=r.trim().startsWith("./"),i=r.trim().slice(n?2:1);var a,o,c;if(i.startsWith(" ")){var s=i.trim().split(" ");a=oe(s[0]),c=i.trimLeft().slice(s[0].length+1)}else{var l=ce(i),u=fe(l,2);a=u[0],c=u[1]}a=a||_e("");o=ve(Le(t)+Le(a),n&&{bevelled:!0});if(c&&c.trim().startsWith("/")||c.trim().startsWith("./"))return e(o,c);return[o,c]}(l,u),2);l=f[0],u=f[1]}return e(u,r+l,!1)};function oe(e){if(0===e.trim().length)return"";var t=r(e,"",!1,!0);return t===a(t)?t:_e(t)}function ce(e,t,r){if(!e)return["",""];var n,i,a,o,c,s,l,u,f=e[0],m=e.slice(1),p=f+(m.match(/^[A-Za-z]+/)||"");if(e.startsWith("sqrt")){var d=ce(e.slice(4).trim(),t);n=Se(d[0]?Le(d[0]):_e("")),i=d[1]}else if(e.startsWith("root")){var h=ce(e.slice(4).trimLeft(),t),v=h[0]?Le(h[0]):_e(""),g=ce(h[1].trimLeft(),t),b=g[0]?Le(g[0]):_e("");n=ke(b+v),i=g[1]}else if("\\"===f&&1<e.length)if(e[1].match(/[(\[]/)){var x=function(e){for(var t=e[0],r="("===t?")":"["===t?"]":e[0],n=0,i=0,a=0;a<e.length;a+=1){var o=e[a];if(i+=1,o===r){if(0===(n-=1))break}else o===t&&(n+=1)}return i}(m);n=he(e.slice(2,x)),i=e.slice(x+1)}else n=he(e[1]),i=e.slice(2);else if(ue.accents.contains(p)){var y=ue.accents.get(p),O=e.slice(p.length).trimLeft(),w=O.match(/^\s*\(?([ij])\)?/),j=ce(O);switch(y.type){case"over":i=w?(n=Oe(pe("i"===w[1]?"\u0131":"\u0237")+he(y.accent,{accent:!0})),O.slice(w[0].length)):(n=Oe(Le(j[0])+he(y.accent,{accent:!0})),j[1]);break;case"under":n=ye(Le(j[0])+he(y.accent)),i=j[1];break;case"enclose":n=je(Le(j[0]),y.attrs),i=j[1];break;default:throw new Error("Invalid config for accent "+p)}}else if(le.default.isfontCommand(e)){var _=le.default.splitfont(e);n=me(_.tagname)(_.text,_.font&&{mathvariant:_.font}),i=_.rest}else if(ue.groupings.complex.contains(p)){var S=ue.groupings.complex.get(p),k=ce(e.slice(p.length).trimLeft());n=Ee(Le(k[0]),S),i=k[1]}else if(le.default.isgroupStart(e)||le.default.isvertGroupStart(e)){var E=fe(le.default.isgroupStart(e)?le.default.splitNextGroup(e):le.default.splitNextVert(e),5),P=E[1],W=E[2],R=E[3],L=E[4];i=ue.groupings.open.get(L);var M=1<(u=ae(W)).length?u:ie(W);if(le.default.ismatrixInterior(W.trim(),te.colSep,te.rowSep)){W.trim().endsWith(te.colSep)&&(W=W.trimRight().slice(0,-1));var A=(c="{"===P&&""===R&&{columnalign:"center left"},s=(l=ne(o=W),1<l.length?l:ae(o)).map(function(e){return e.trim().slice(1,-1)}),Pe(s.map(se).join(""),c));n=Ee(A,{open:P,close:R})}else if(1<M.length)if(2===M.length&&"("===P&&")"===R){var C=ve(M.map(oe).join(""),{linethickness:0});n=Ee(C,{open:P,close:R})}else{var G=M.map(ne);1===Ae(G).length&&Ae(G)[0].match(/^\s*$/)&&(G=G.slice(0,-1));var N=G.map(function(e){return We(e.map((t=Re,r=oe,function(e){return t(r(e))})).join(""));var t,r}).join("");n=Ee(Pe(N),{open:P,close:R})}else{var z=ne(W).map(oe).join(""),$={open:P,close:R};","!==te.colSep&&($.separators=te.colSep),n=Ee(z,$)}}else if(!t&&le.default.isgroupable(e,te)){var q=function e(t){var r=new RegExp("(\\s|".concat(te.colSep,"|").concat(te.rowSep,"|$)"));var n=t.match(r),i=t.slice(0,n.index),a=n[0],o=t.slice(n.index+1);var c=i,s=a+o;if(!le.default.isgroupStart(o.trim())&&le.default.endsInFunc(i)){var l=e(o);c+=a+l[0],s=l[1]}else if(i.match(/root$/)){var u=e(o),f=e(u[1].trimLeft());c+=a+u[0]+" "+f[0],s=a+f[1]}return[c,s]}(e);n=oe(q[0]),i=q[1]}else if(ue.numbers.isdigit(f)){var I=e.match(re)[0];n=de(I),i=m.slice(I.length-1)}else if(e.match(/^#`[^`]+`/)){var T=e.match(/^#`([^`]+)`/)[1];n=de(T),i=e.slice(T.length+3)}else if(e.match(new RegExp("^"+ue.operators.regexp.source))&&!ue.identifiers.contains(p)){var U=fe(le.default.splitNextOperator(e),2),F=U[0],D=U[1],Z=e.startsWith("'"),Q=Me(["\u2202","\u2207"],F),V=Me(["|"],F),H=e.startsWith("| "),X={};Z&&(X.lspace=0,X.rspace=0),Q&&(X.rspace=0),V&&(X.stretchy=!0),H&&(X.lspace="veryverythickmathspace",X.rspace="veryverythickmathspace"),n=he(F,(a=X,!(0===Object.keys(a).length)&&X)),i=D}else if(ue.identifiers.contains(p)){var Y=ue.identifiers[p];n=Y.match(/[\u0391-\u03A9\u2100-\u214F\u2200-\u22FF]/)?pe(Y,{mathvariant:"normal"}):pe(Y),i=m.slice(p.length-1)}else i="O"===f&&"/"===m[0]?(n=pe(ue.identifiers["O/"],{mathvariant:"normal"}),m.slice(1)):(n=pe(f),m);if(i&&i.trimLeft().match(/\.?[\^_]/))if(r&&r.match(/m(sup|over)/)||!i.trim().startsWith("_")||!(i.trim().length<=1)&&i.trim()[1].match(/[|_]/))if("mover"!==r&&i.trim().startsWith("._")&&(i.trim().length<=2||!i.trim()[2].match(/[|_]/))){var B=fe(function(e,t){var r,n=ce(t.trim().slice(2).trim(),!0,"munder"),i=n[0]?Le(n[0]):_e(""),a=n[1],o=a.match(/^(\.?\^)[^\^]/);if(o){var c=ce(a.trim().slice(o[1].length).trim(),!0),s=c[0]?Le(c[0]):_e("");r=we(e+i+s),a=c[1]}else r=ye(e+i);return[r,a]}(n,i),2);n=B[0],i=B[1]}else if(r&&r.match(/m(sub|under)/)||!i.trim().startsWith("^")||!(i.trim().length<=1||"^"!==i.trim()[1])){if("munder"!==r&&i.trim().startsWith(".^")&&(i.trim().length<=2||"^"!==i.trim()[2])){var J=fe(function(e,t){var r,n=ce(t.trim().slice(2).trim(),!0,"mover"),i=n[0]?Le(n[0]):_e(""),a=n[1],o=a.match(/^(\.?_)[^_|]/);if(o){var c=ce(a.trim().slice(o[1].length).trim(),!0),s=c[0]?Le(c[0]):_e("");r=we(e+s+i),a=c[1]}else r=Oe(e+i);return[r,a]}(n,i),2);n=J[0],i=J[1]}}else{var K=fe(function(e,t){var r,n=ce(t.trim().slice(1).trim(),!0,"msup"),i=n[0]?Le(n[0]):_e(""),a=n[1];if(a.trim().startsWith("_")&&(a.trim().length<=1||!a.trim()[1].match(/[|_]/))){var o=ce(a.trim().slice(1).trim(),!0),c=o[0]?Le(o[0]):_e(""),s=le.default.shouldGoUnder(e)?we:xe;r=s(e+c+i),a=o[1]}else{var l=le.default.shouldGoUnder(e)?Oe:ge;r=l(e+i)}return[r,a]}(n,i),2);n=K[0],i=K[1]}else{var ee=fe(function(e,t){var r,n=ce(t.trim().slice(1).trim(),!0,"msub"),i=n[0]?Le(n[0]):_e(""),a=n[1];if(a&&a.trim().startsWith("^")&&(a.trim().length<=1||"^"!==!a.trim()[1])){var o=ce(a.trim().slice(1).trim(),!0),c=o[0]?Le(o[0]):_e(""),s=le.default.shouldGoUnder(e)?we:xe;r=s(e+i+c),a=o[1]}else{var l=le.default.shouldGoUnder(e)?ye:be;r=l(e+i)}return[r,a]}(n,i),2);n=ee[0],i=ee[1]}return[n,i]}function se(e,t){if(t="string"==typeof t?t:"",!e||0===e.length)return We(t);var r=fe(function e(t,r){if(!t||0===t.length)return[Re(r),""];if(t[0]===te.colSep)return[Re(r),t.slice(1).trim()];var n=ce(t),i=fe(n,2),a=i[0],o=i[1];return e(o.trim(),r+a)}(e.trim(),""),2),n=r[0];return se(r[1].trim(),t+n)}return r}function Le(e){var t,r,n=e.replace(/^<mfenced[^>]*>/,"").replace(/<\/mfenced>$/,"");return(t=n,r=a(t),[t.slice(0,t.lastIndexOf(r)),r])[1]===n?n:_e(n)}function a(e){var t=e.match(/<\/(m[a-z]+)>$/);if(!t){var r=e.match(/<mspace\s*([a-z]+="[a-z]")*\s*\?>/);if(r){var n=r.match[0].length;return e.slice(n)}return""}for(var i=t[1],a=e.length-(i.length+3),o=0;0<=a;a-=1){if(e.slice(a).startsWith("<".concat(i))){if(0===o)break;o-=1}e.slice(a-2).startsWith("</".concat(i))&&(o+=1)}return e.slice(a)}function Me(e,t){return 0<=e.indexOf(t)}function Ae(e){return e.slice(-1)[0]}i.getlastel=a;var o=i;r.default=o},{"./lexicon":2,"./syntax":4}],4:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var m=e("./lexicon");function i(e){var t=new RegExp("^"+m.groupings.open.regexp.source);return e.match(t)}var n=new RegExp("("+m.identifiers.funs.concat(Object.keys(m.accents)).concat(["sqrt"]).sort(function(e,t){return e.length-t.length}).join("|")+")$");function p(e){for(var t,r,n,i,a=new RegExp("^"+m.groupings.open.regexp.source),o=new RegExp("^"+m.groupings.close.regexp.source),c=0,s=0;s<e.length;){var l=e.slice(s),u=l.match(a),f=l.match(o);if(u)"number"!=typeof t&&(t=s,n=u[0]),c+=1,s+=u[0].length;else if(f){if(0===(c-=1)){r=s+((i=f[0]).length-1);break}s+=f[0].length}else s+=1}return n?[0===t?"":e.slice(0,t),m.groupings.open.get(n),e.slice(t+n.length,i?r-(i.length-1):e.length),i?m.groupings.close.get(i):"",r?e.slice(r+1):""]:null}function a(e){var t,r,n,i=e.indexOf("|"),a=i+1,o=e.slice(i+1),c=o.startsWith("|"),s=c?/\|\|/:/\|/;if(c&&(o=o.slice(1),a+=1),-1===o.indexOf("|"))return null;if(o.match(/^\.?[_\^]/))return null;for(;0<o.length;){var l=p(o),u=l?l[0]:o,f=l?l[4]:"",m=s.exec(u);if(m)return t=i,r=a+m.index,n=c,[0===t?"":e.slice(0,t),n?"\u2016":"|",e.slice(t+(n?2:1),r),n?"\u2016":"|",e.slice(r+(n?2:1))];a+=l.slice(0,-1).map(d("length")).reduce(h),""===l[1]?a+=2:"\u2329"===l[1]&&(a+=1),""===l[3]?a+=2:"\u232a"===l[3]&&(a+=1),o=f}return null}function d(t){return function(e){return e[t]}}function h(e,t){return e+t}function o(e){var t=new RegExp("^("+m.fonts.regexp.source+" ?)?"+e);return function(e){return t.exec(e)}}var s=o("(`)\\w+`"),l=o('(")');var c=["<mi>lim</mi>","<mo>\u2211</mo>","<mo>\u220f</mo>"];var u={endsInFunc:function(e){return e.match(n)},isgroupStart:i,isgroupable:function(e,t){var r=new RegExp("^[0-9A-Za-z+\\-!]{2,}(\\s|".concat(t.colSep,"|").concat(t.rowSep,")"));return e.match(r)},isvertGroupStart:function(e){if(!e.startsWith("|"))return!1;var t=a(e);return t&&""===t[0]},splitNextGroup:p,splitNextVert:a,splitNextOperator:function(e){var t=new RegExp("^"+m.operators.regexp.source).exec(e)[0];return[m.operators.get(t),e.slice(t.length)]},ismatrixInterior:function(e,t,r){if(!i(e))return!1;var n=p(e)[4];if(!(n.trim().startsWith(t)||n.match(/^\s*\n/)&&i(n.trim())))return!1;for(;n&&n.trim();)if((n=(p(n)||[])[4])&&(n.startsWith(r)||n.match(/^\s*\n/)))return!1;return!0},isfontCommand:function(e){return s(e)||l(e)},splitfont:function(e){var t=s(e)||l(e),r=t&&t[2],n=t&&t[3],i='"'===n?"mtext":"`"===n?"mi":"",a=e.indexOf(n),o=a+1+e.slice(a+1).indexOf(n),c=0<a?m.fonts.get(r):"";return{tagname:i,text:e.slice(a+1,o),font:c,rest:e.slice(o+1)}},shouldGoUnder:function(e){return 0<=c.indexOf(e)}};r.default=u},{"./lexicon":2}]},{},[1])(1)});
