title: 组合数学学习笔记
categories:
  - OI
tags:
  - 学习笔记
  - 数学
  - 算法模板
  - 组合数学
permalink: combinatorics-notes
date: '2016-03-15 17:16:12'
---

计数原理、排列、组合、递推关系、等差数列求和公式、自然数平方和公式、二项式定理。

<!-- more -->

### 计数原理

#### 加法原理

做一件事有 $ n $ 种途径，每种途径有 $ p_i $ 个不同的方案，则做这件事的方案数为

$$ \sum\limits_{i = i}^{n}p_i $$

#### 乘法原理

做一件事有 $ n $ 个步骤，每个步骤有 $ p_i $ 个不同的方案，则做这件事的方案数为

$$ \prod\limits_{i = i}^{n}p_i $$

#### 容斥原理

统计多个集合的并的元素数量：先加上所有集合的元素的元素数量，再减去『多加的』每两个集合相交的元素数量，再加上『多减的』每三个集合相交的元素数量 ……

即等式左边是多个集合的并的元素数量，等式右边每一项是几个几何的交的元素数量，每一项的符号取决于元素数量的奇偶。

### 排列

#### 全排列

把 $ n $ 个元素按照不同顺序排列，设总方案数为 $ f(n) $（定义 $ f(0) = 1 $），考虑第一个元素摆放的位置，得出公式

$$ f(n) = f(n - 1) * n $$

即 $ f(n) = n! $。

#### 普通排列

从 $ n $ 个元素中取 $ k $ 个，按照不同顺序排列，设总方案数为 $ P(n, k) $，每次选一个数，第一次有 $ n $ 种选择，第二次有 $ n - 1 $ 种选择，直到第 $ k $ 次有 $ n - k + 1 $ 种选择，即

$$ P(n, k) = \prod\limits_{i = 0}^{k - 1}(n - i) $$

将上式与 $ n! $ 对比，缺少 $ n - k $ 及之后的项，即

$$ P(n, k) = \frac{n!}{(n - k)!} $$

#### 有重复元素的全排列

从 $ k $ 种元素，第 $ i $ 种有 $ n_i $ 个，设 $ n = \sum\limits_{i = 1}^{k}n_i $，为了保证答案不重复，可以先求出 $ n! $，再除去每种元素重复的情况，即

$$ \frac{n!}{\prod\limits_{i = 1}^{k}n_i!} $$

### 组合

#### 组合数

从 n 个元素中选择 k 个，顺序无关，设总方案数为 $ C(n, k) $。把排列数 $ P(n, k) $ 看做先从 n 各种选择 k 个元素，再对 k 个元素做全排列，即

$$ P(n, k) = C(n, k) * k! $$

移项得

$$ \begin{align*} C(n, k) & = \frac{P(n, k)}{k!} \\ & = \frac{n!}{(n - k)!k!} \\ \end{align*} $$

#### 组合数的性质

$ C(n, 0) = C(n, n) = 1 $ 全选或全不选只有一种方案。

$ C(n, k) = C(n, n - k) $ 选择 $ k $ 个拿走相当于选择 $ n - k $ 个留下。

$ C(n, k) = C(n - 1, k) + C(n - 1, k - 1) $ 考虑最后一个选还是不选（Pascal 公式，常用来递推计算组合数表）。

#### 可重复选择的组合

从 n 种无限多的元素中选择 k 个，共有 $ C(n + k - 1, k) $ 种方案。

#### 组合数的计算

##### 组合数表

用 Pascal 公式递推，组合数太大要开高精度或者取模。

```cpp
BigInt combo[MAXN + 1][MAXN + 1];

inline void makeComboTable() {
    for (int i = 1; i <= MAXN; i++) {
        combo[i][0] = combo[i][i] = 1;
        for (int j = 1; j < i; j++){
            combo[i][j] = combo[i - 1][j] + combo[i - 1][j - 1];
        }
    }
}

inline BigInt &C(int n, int k) {
    return combo[n][k];
}
```

##### 单个计算

书上有用 `double` 来算的，因为中间乘法 `long long` 可能会溢出，不知道那样会不会损失精度。

```cpp
long long C(long long n, long long k) {
    long long result = 1;
    for (int i = 1; i <= k; i++) {
        result = result * (n - i + 1) / i;
    }
    return result;
}
```

### 递推关系

#### Fibonacci 数列

楼梯上共有 $ n $ 个台阶，一次可以走一个或两个，总方案数为

$$ F_n = F_{n - 1} + F_{n - 2} $$

边界为

$$ F_1 = F_2 = 1 $$

#### Catalan 数

给定一个凸 $ n $ 边形，用 $ n - 3 $ 条不相交的直线将它剖分成 $ n - 2 $ 个三角形，设方案总数为 $ f(n) $。

对每个顶点编号，第 $ i $ 个顶点编号为 $ V_i $。作三角形 $ {V_1}{V_k}{V_n} $（$ 1 \lt k \lt n $），该三角形左边是一个 $ k $ 边形，右边是一个 $ n - k + 1 $ 边形，即

$$ f(n) = \sum\limits_{k = 2}^{n - 1}f(k)f(n - k + 1) $$

### 公式

#### 等差数列

设数列 $ \{ a_1, a_2, \cdots, a_n \} $ 对于任意的 $ 1 \lt i \leq n $ 满足 $ a_t - a_{i - 1} = d $，则有

$$ a_i = a_i + (i - 1)d $$

求和公式为

$$ \begin{align*} \sum\limits_{i = i}^{n}a_i & = \frac{(a_1 + a_n)n}{2} \\ & = \frac{[2a_1 + (n - 1)d]n}{2} \\ \end{align*} $$

#### 自然数平方和

$$ \sum\limits_{i = 1}^{n}i^2 = \frac{n(n + 1)(2n + 1)}{6} $$

不会证。

#### 二项式定理

$$ (a + b) ^ n = \sum\limits_{k = 0}^{n}\binom{n}{k}a^{k}b^{n - k} $$