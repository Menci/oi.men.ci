<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Menci</title>
  <subtitle>眉眼如初，岁月如故</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://blog.menci.moe/"/>
  <updated>2016-05-19T03:58:54.586Z</updated>
  <id>https://blog.menci.moe/</id>
  
  <author>
    <name>Menci</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>「BZOJ 3156」防御准备 - 斜率优化DP</title>
    <link href="https://blog.menci.moe/bzoj-3156/"/>
    <id>https://blog.menci.moe/bzoj-3156/</id>
    <published>2016-05-19T03:58:00.000Z</published>
    <updated>2016-05-19T03:58:54.586Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x6211;&amp;#x4EEC;&amp;#x5B9A;&amp;#x4E49;&amp;#x6218;&amp;#x7EBF;&amp;#x4E3A;&amp;#x4E00;&amp;#x6761;&amp;#x957F;&amp;#x5EA6;&amp;#x4E3A; $ n $ &amp;#x7684;&amp;#x5E8F;&amp;#x5217;&amp;#xFF0C;&amp;#x5728;&amp;#x8FD9;&amp;#x6761;&amp;#x6218;&amp;#x7EBF;&amp;#x4E0A;&amp;#x5171;&amp;#x8BBE;&amp;#x6709; $ n $ &amp;#x4E2A;&amp;#x68C0;&amp;#x67E5;&amp;#x70B9;&amp;#xFF0C;&amp;#x4ECE;&amp;#x5DE6;&amp;#x5230;&amp;#x53F3;&amp;#x4F9D;&amp;#x6B21;&amp;#x6807;&amp;#x53F7;&amp;#x4E3A; $ 1 $ &amp;#x5230; $ n $&amp;#x3002;&amp;#x4E00;&amp;#x4E2A;&amp;#x6218;&amp;#x7EBF;&amp;#x4E3A;&amp;#x5408;&amp;#x6CD5;&amp;#x6218;&amp;#x7EBF;&amp;#x5F53;&amp;#x4E14;&amp;#x4EC5;&amp;#x5F53;&amp;#x4EFB;&amp;#x610F;&amp;#x4E00;&amp;#x4E2A;&amp;#x68C0;&amp;#x67E5;&amp;#x70B9;&amp;#x53EF;&amp;#x4EE5;&amp;#x901A;&amp;#x8FC7;&amp;#x5B89;&amp;#x5168;&amp;#x68C0;&amp;#x67E5;&amp;#x3002;&amp;#x5BF9;&amp;#x4E8E;&amp;#x7B2C; $ i $ &amp;#x4E2A;&amp;#x70B9;&amp;#xFF0C;&amp;#x901A;&amp;#x8FC7;&amp;#x5B89;&amp;#x5168;&amp;#x68C0;&amp;#x67E5;&amp;#x7684;&amp;#x65B9;&amp;#x6CD5;&amp;#x6709;&amp;#x4E24;&amp;#x79CD;&amp;#xFF0C;&amp;#x7B2C;&amp;#x4E00;&amp;#x79CD;&amp;#x662F;&amp;#x653E;&amp;#x7F6E;&amp;#x4E00;&amp;#x4E2A;&amp;#x5B88;&amp;#x536B;&amp;#x5854;&amp;#xFF0C;&amp;#x8FD9;&amp;#x5C06;&amp;#x82B1;&amp;#x8D39; $ c(i) $ &amp;#x7684;&amp;#x8D39;&amp;#x7528;&amp;#xFF0C;&amp;#x7B2C;&amp;#x4E8C;&amp;#x79CD;&amp;#x65B9;&amp;#x5F0F;&amp;#x662F;&amp;#x653E;&amp;#x7F6E;&amp;#x4E00;&amp;#x4E2A;&amp;#x6728;&amp;#x5076;&amp;#xFF0C;&amp;#x653E;&amp;#x7F6E;&amp;#x6728;&amp;#x5076;&amp;#x7684;&amp;#x82B1;&amp;#x8D39;&amp;#x7B49;&amp;#x4E8E;&amp;#x8FD9;&amp;#x4E2A;&amp;#x68C0;&amp;#x67E5;&amp;#x70B9;&amp;#x53F3;&amp;#x4FA7;&amp;#x7684;&amp;#x7B2C;&amp;#x4E00;&amp;#x4E2A;&amp;#x5B88;&amp;#x536B;&amp;#x5854;&amp;#x5230;&amp;#x5B83;&amp;#x7684;&amp;#x8DDD;&amp;#x79BB;&amp;#x3002;&amp;#x7B2C; $ n $ &amp;#x4E2A;&amp;#x70B9;&amp;#x53EA;&amp;#x80FD;&amp;#x653E;&amp;#x7F6E;&amp;#x5B88;&amp;#x536B;&amp;#x5854;&amp;#x3002;&amp;#x6C42;&amp;#x6700;&amp;#x5C0F;&amp;#x7684;&amp;#x6218;&amp;#x7EBF;&amp;#x82B1;&amp;#x8D39;&amp;#x503C;&amp;#x3002;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;&amp;#x94FE;&amp;#x63A5;&quot;&gt;&amp;#x94FE;&amp;#x63A5;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://www.lydsy.com/JudgeOnline/problem.php?id=3156&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;BZOJ 3156&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x9898;&amp;#x89E3;&quot;&gt;&amp;#x9898;&amp;#x89E3;&lt;/h3&gt;
&lt;p&gt;&amp;#x5C06;&amp;#x6574;&amp;#x4E2A;&amp;#x5E8F;&amp;#x5217;&amp;#x53CD;&amp;#x8F6C;&amp;#xFF0C;&amp;#x653E;&amp;#x7F6E;&amp;#x6728;&amp;#x5076;&amp;#x7684;&amp;#x82B1;&amp;#x8D39;&amp;#x7B49;&amp;#x4E8E;&amp;#x8FD9;&amp;#x4E2A;&amp;#x68C0;&amp;#x67E5;&amp;#x70B9;&lt;strong&gt;&amp;#x5DE6;&amp;#x4FA7;&lt;/strong&gt;&amp;#x7684;&amp;#x7B2C;&amp;#x4E00;&amp;#x4E2A;&amp;#x5B88;&amp;#x536B;&amp;#x5854;&amp;#x5230;&amp;#x5B83;&amp;#x7684;&amp;#x8DDD;&amp;#x79BB;&amp;#xFF0C;&amp;#x4E00;&amp;#x53F7;&amp;#x68C0;&amp;#x67E5;&amp;#x70B9;&amp;#x5FC5;&amp;#x987B;&amp;#x653E;&amp;#x7F6E;&amp;#x5B88;&amp;#x536B;&amp;#x5854;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x8BBE; $ f(i) $ &amp;#x8868;&amp;#x793A;&amp;#x524D; $ i $ &amp;#x4E2A;&amp;#x68C0;&amp;#x67E5;&amp;#x70B9;&amp;#x901A;&amp;#x8FC7;&amp;#x68C0;&amp;#x67E5;&amp;#x7684;&amp;#x6700;&amp;#x5C0F;&amp;#x4EE3;&amp;#x4EF7;&amp;#xFF0C;&amp;#x679A;&amp;#x4E3E; $ j $&amp;#xFF0C;&amp;#x5728; $ j + 1 $ &amp;#x4F4D;&amp;#x7F6E;&amp;#x653E;&amp;#x7F6E;&amp;#x4E00;&amp;#x4E2A;&amp;#x5B88;&amp;#x536B;&amp;#x5854;&amp;#xFF0C;&amp;#x4E4B;&amp;#x540E;&amp;#x4E00;&amp;#x76F4;&amp;#x5230; $ i $ &amp;#x7684;&amp;#x4F4D;&amp;#x7F6E;&amp;#x5168;&amp;#x90E8;&amp;#x653E;&amp;#x7F6E;&amp;#x6728;&amp;#x5076;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;$$ f(i) = \min\limits_{j = 0} ^ {i - 1} \{ f(j) + c(j + 1) + \frac{(i - j - 1)(i - j)}{2} \} $$&lt;/p&gt;
&lt;p&gt;&amp;#x659C;&amp;#x7387;&amp;#x4F18;&amp;#x5316;&amp;#xFF0C;&amp;#x8003;&amp;#x8651;&amp;#x4E24;&amp;#x4E2A;&amp;#x51B3;&amp;#x7B56; $ a $&amp;#x3001;$ b $&amp;#xFF08;$ a &amp;gt; b $&amp;#xFF09;&amp;#xFF0C;&amp;#x82E5; $ a $ &amp;#x6BD4; $ b $ &amp;#x4F18;&amp;#xFF0C;&amp;#x5219;&amp;#x6709;&lt;/p&gt;
&lt;p&gt;$$ \begin{align*} f(a) + c(a + 1) + \frac{(i - a - 1)(i - a)}{2} &amp;amp;&amp;lt; f(b) + c(b + 1) + \frac{(i - b - 1)(i - b)}{2} \\ f(a) + c(a + 1) + \frac{i ^ 2}{2} + \frac{a ^ 2}{2} - ia - \frac{i}{2} + \frac{a}{2} &amp;amp;&amp;lt; f(b) + c(b + 1) + \frac{i ^ 2}{2} + \frac{b ^ 2}{2} - ib - \frac{i}{2} + \frac{b}{2} \\ { (f(a) + c(a + 1) + \frac{a ^ 2}{2} + \frac{a}{2}) - (f(b) + c(b + 1) + \frac{b ^ 2}{2} + \frac{b}{2}) \over a - b } &amp;amp;&amp;lt; i \\ \end{align*} $$&lt;/p&gt;
&lt;p&gt;&amp;#x7EF4;&amp;#x62A4;&amp;#x51B3;&amp;#x7B56;&amp;#x70B9;&amp;#xFF0C;&amp;#x4F7F;&amp;#x659C;&amp;#x7387;&amp;#x9012;&amp;#x589E;&amp;#xFF0C;&amp;#x6700;&amp;#x4F18;&amp;#x51B3;&amp;#x7B56;&amp;#x53D6;&amp;#x961F;&amp;#x9996;&amp;#x3002;&amp;#x65F6;&amp;#x95F4;&amp;#x590D;&amp;#x6742;&amp;#x5EA6;&amp;#x4E3A; $ O(n) $&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x4EE3;&amp;#x7801;&quot;&gt;&amp;#x4EE3;&amp;#x7801;&lt;/h3&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;climits&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;algorithm&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXN = &lt;span class=&quot;number&quot;&gt;1000000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; c[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;], f[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;prepare&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::reverse(c + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, c + n + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;/*&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;inline void force() {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    std::fill(f, f + n + 1, LLONG_MAX);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    f[0] = 0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    for (int i = 1; i &amp;lt;= n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        int _j = -1;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        for (int j = 0; j &amp;lt; i; j++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            if (f[i] &amp;gt; f[j] + c[j + 1] + (i - j - 1) * (i - j) / 2) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                f[i] = f[j] + c[j + 1] + (i - j - 1) * (i - j) / 2;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                _j = j;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        printf(&amp;quot;%d --&amp;gt; %d\n&amp;quot;, i, _j);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;*/&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;template&lt;/span&gt; &amp;lt;&lt;span class=&quot;keyword&quot;&gt;typename&lt;/span&gt; T&amp;gt; &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; T &lt;span class=&quot;title&quot;&gt;sqr&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; T &amp;amp;x)&lt;/span&gt; &lt;/span&gt;{ &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; x * x; }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i)&lt;/span&gt; &lt;/span&gt;{ &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; f[i] + c[i + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;] + sqr(&lt;span class=&quot;keyword&quot;&gt;static_cast&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt;&amp;gt;(i)) * &lt;span class=&quot;number&quot;&gt;0.5&lt;/span&gt; + i * &lt;span class=&quot;number&quot;&gt;0.5&lt;/span&gt;; }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;slope&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; a, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; b)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt;(x(a) - x(b))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;         / &lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt;(a - b);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;dp&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::fill(f, f + n + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, LLONG_MAX);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    f[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;] = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; q[MAXN];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; *l = q, *r = q;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    *r = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (l &amp;lt; &lt;span class=&quot;function&quot;&gt;r &amp;amp;&amp;amp; &lt;span class=&quot;title&quot;&gt;slope&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(*(l + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&lt;/span&gt;, *l) &amp;lt; i) l++&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &amp;amp;j = *l;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        f[i] = f[j] + c[j + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;] + (i - j - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) * (i - j) / &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// printf(&amp;quot;%d --&amp;gt; %d\n&amp;quot;, i, j);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (i &amp;lt; n) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (l &amp;lt; &lt;span class=&quot;function&quot;&gt;r &amp;amp;&amp;amp; &lt;span class=&quot;title&quot;&gt;slope&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(*r, *(r - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&lt;/span&gt;) &amp;gt; &lt;span class=&quot;title&quot;&gt;slope&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(i, *r)&lt;/span&gt;) r--&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            *++r = i;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;n);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= n; i++) &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%lld&amp;quot;&lt;/span&gt;, &amp;amp;c[i]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    prepare();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// force();&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    dp();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%lld\n&amp;quot;&lt;/span&gt;, f[n]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x6211;&amp;#x4EEC;&amp;#x5B9A;&amp;#x4E49;&amp;#x6218;&amp;#x7EBF;&amp;#x4E3A;&amp;#x4E00;&amp;#x6761;&amp;#x957F;&amp;#x5EA6;&amp;#x4E3A; $ n $ &amp;#x7684;&amp;#x5E8F;&amp;#x5217;&amp;#xFF0C;&amp;#x5728;&amp;#x8FD9;&amp;#x6761;&amp;#x6218;&amp;#x7EBF;&amp;#x4E0A;&amp;#x5171;&amp;#x8BBE;&amp;#x6709; $ n $ &amp;#x4E2A;&amp;#x68C0;&amp;#x67E5;&amp;#x70B9;&amp;#xFF0C;&amp;#x4ECE;&amp;#x5DE6;&amp;#x5230;&amp;#x53F3;&amp;#x4F9D;&amp;#x6B21;&amp;#x6807;&amp;#x53F7;&amp;#x4E3A; $ 1 $ &amp;#x5230; $ n $&amp;#x3002;&amp;#x4E00;&amp;#x4E2A;&amp;#x6218;&amp;#x7EBF;&amp;#x4E3A;&amp;#x5408;&amp;#x6CD5;&amp;#x6218;&amp;#x7EBF;&amp;#x5F53;&amp;#x4E14;&amp;#x4EC5;&amp;#x5F53;&amp;#x4EFB;&amp;#x610F;&amp;#x4E00;&amp;#x4E2A;&amp;#x68C0;&amp;#x67E5;&amp;#x70B9;&amp;#x53EF;&amp;#x4EE5;&amp;#x901A;&amp;#x8FC7;&amp;#x5B89;&amp;#x5168;&amp;#x68C0;&amp;#x67E5;&amp;#x3002;&amp;#x5BF9;&amp;#x4E8E;&amp;#x7B2C; $ i $ &amp;#x4E2A;&amp;#x70B9;&amp;#xFF0C;&amp;#x901A;&amp;#x8FC7;&amp;#x5B89;&amp;#x5168;&amp;#x68C0;&amp;#x67E5;&amp;#x7684;&amp;#x65B9;&amp;#x6CD5;&amp;#x6709;&amp;#x4E24;&amp;#x79CD;&amp;#xFF0C;&amp;#x7B2C;&amp;#x4E00;&amp;#x79CD;&amp;#x662F;&amp;#x653E;&amp;#x7F6E;&amp;#x4E00;&amp;#x4E2A;&amp;#x5B88;&amp;#x536B;&amp;#x5854;&amp;#xFF0C;&amp;#x8FD9;&amp;#x5C06;&amp;#x82B1;&amp;#x8D39; $ c(i) $ &amp;#x7684;&amp;#x8D39;&amp;#x7528;&amp;#xFF0C;&amp;#x7B2C;&amp;#x4E8C;&amp;#x79CD;&amp;#x65B9;&amp;#x5F0F;&amp;#x662F;&amp;#x653E;&amp;#x7F6E;&amp;#x4E00;&amp;#x4E2A;&amp;#x6728;&amp;#x5076;&amp;#xFF0C;&amp;#x653E;&amp;#x7F6E;&amp;#x6728;&amp;#x5076;&amp;#x7684;&amp;#x82B1;&amp;#x8D39;&amp;#x7B49;&amp;#x4E8E;&amp;#x8FD9;&amp;#x4E2A;&amp;#x68C0;&amp;#x67E5;&amp;#x70B9;&amp;#x53F3;&amp;#x4FA7;&amp;#x7684;&amp;#x7B2C;&amp;#x4E00;&amp;#x4E2A;&amp;#x5B88;&amp;#x536B;&amp;#x5854;&amp;#x5230;&amp;#x5B83;&amp;#x7684;&amp;#x8DDD;&amp;#x79BB;&amp;#x3002;&amp;#x7B2C; $ n $ &amp;#x4E2A;&amp;#x70B9;&amp;#x53EA;&amp;#x80FD;&amp;#x653E;&amp;#x7F6E;&amp;#x5B88;&amp;#x536B;&amp;#x5854;&amp;#x3002;&amp;#x6C42;&amp;#x6700;&amp;#x5C0F;&amp;#x7684;&amp;#x6218;&amp;#x7EBF;&amp;#x82B1;&amp;#x8D39;&amp;#x503C;&amp;#x3002;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="BZOJ" scheme="https://blog.menci.moe/tag/bzoj/"/>
    
      <category term="DP" scheme="https://blog.menci.moe/tag/dp/"/>
    
      <category term="单调队列" scheme="https://blog.menci.moe/tag/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97/"/>
    
      <category term="斜率优化" scheme="https://blog.menci.moe/tag/%E6%96%9C%E7%8E%87%E4%BC%98%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>「CEOI2004」锯木厂选址 - 斜率优化DP</title>
    <link href="https://blog.menci.moe/ceoi2004-two/"/>
    <id>https://blog.menci.moe/ceoi2004-two/</id>
    <published>2016-05-18T10:03:00.000Z</published>
    <updated>2016-05-18T10:04:30.736Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x4ECE;&amp;#x5C71;&amp;#x9876;&amp;#x4E0A;&amp;#x5230;&amp;#x5C71;&amp;#x5E95;&amp;#x4E0B;&amp;#x6CBF;&amp;#x7740;&amp;#x4E00;&amp;#x6761;&amp;#x76F4;&amp;#x7EBF;&amp;#x79CD;&amp;#x690D;&amp;#x4E86; $ n $ &amp;#x68F5;&amp;#x8001;&amp;#x6811;&amp;#x3002;&amp;#x5F53;&amp;#x5730;&amp;#x7684;&amp;#x653F;&amp;#x5E9C;&amp;#x51B3;&amp;#x5B9A;&amp;#x628A;&amp;#x4ED6;&amp;#x4EEC;&amp;#x780D;&amp;#x4E0B;&amp;#x6765;&amp;#x3002;&amp;#x4E3A;&amp;#x4E86;&amp;#x4E0D;&amp;#x6D6A;&amp;#x8D39;&amp;#x4EFB;&amp;#x4F55;&amp;#x4E00;&amp;#x68F5;&amp;#x6728;&amp;#x6750;&amp;#xFF0C;&amp;#x6811;&amp;#x88AB;&amp;#x780D;&amp;#x5012;&amp;#x540E;&amp;#x8981;&amp;#x8FD0;&amp;#x9001;&amp;#x5230;&amp;#x952F;&amp;#x6728;&amp;#x5382;&amp;#x3002; &amp;#x6728;&amp;#x6750;&amp;#x53EA;&amp;#x80FD;&amp;#x6309;&amp;#x7167;&amp;#x4E00;&amp;#x4E2A;&amp;#x65B9;&amp;#x5411;&amp;#x8FD0;&amp;#x8F93;&amp;#xFF1A;&amp;#x671D;&amp;#x5C71;&amp;#x4E0B;&amp;#x8FD0;&amp;#x3002;&amp;#x5C71;&amp;#x811A;&amp;#x4E0B;&amp;#x6709;&amp;#x4E00;&amp;#x4E2A;&amp;#x952F;&amp;#x6728;&amp;#x5382;&amp;#x3002;&amp;#x53E6;&amp;#x5916;&amp;#x4E24;&amp;#x4E2A;&amp;#x952F;&amp;#x6728;&amp;#x5382;&amp;#x5C06;&amp;#x65B0;&amp;#x4FEE;&amp;#x5EFA;&amp;#x5728;&amp;#x5C71;&amp;#x8DEF;&amp;#x4E0A;&amp;#x3002;&amp;#x4F60;&amp;#x5FC5;&amp;#x987B;&amp;#x51B3;&amp;#x5B9A;&amp;#x5728;&amp;#x54EA;&amp;#x91CC;&amp;#x4FEE;&amp;#x5EFA;&amp;#x4E24;&amp;#x4E2A;&amp;#x952F;&amp;#x6728;&amp;#x5382;&amp;#xFF0C;&amp;#x4F7F;&amp;#x5F97;&amp;#x4F20;&amp;#x8F93;&amp;#x7684;&amp;#x8D39;&amp;#x7528;&amp;#x603B;&amp;#x548C;&amp;#x6700;&amp;#x5C0F;&amp;#x3002;&amp;#x5047;&amp;#x5B9A;&amp;#x8FD0;&amp;#x8F93;&amp;#x6BCF;&amp;#x516C;&amp;#x65A4;&amp;#x6728;&amp;#x6750;&amp;#x6BCF;&amp;#x7C73;&amp;#x9700;&amp;#x8981;&amp;#x4E00;&amp;#x5206;&amp;#x94B1;&amp;#x3002;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;&amp;#x94FE;&amp;#x63A5;&quot;&gt;&amp;#x94FE;&amp;#x63A5;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://cogs.top/cogs/problem/problem.php?pid=362&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;COGS 362&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x9898;&amp;#x89E3;&quot;&gt;&amp;#x9898;&amp;#x89E3;&lt;/h3&gt;
&lt;p&gt;&amp;#x5C06;&amp;#x6574;&amp;#x4E2A;&amp;#x5E8F;&amp;#x5217;&amp;#x53CD;&amp;#x8F6C;&amp;#xFF0C;&amp;#x76EE;&amp;#x6807;&amp;#x53D8;&amp;#x4E3A;&amp;#x5C06;&amp;#x6240;&amp;#x6709;&amp;#x6811;&amp;#x8FD0;&amp;#x5230; $ 0 $ &amp;#x53F7;&amp;#x70B9;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x8BBE; $ f[i][j] $ &amp;#x8868;&amp;#x793A;&amp;#x524D; $ i $ &amp;#x68F5;&amp;#x6811;&amp;#xFF0C;&amp;#x4FEE;&amp;#x5EFA; $ j $ &amp;#x4E2A;&amp;#x952F;&amp;#x6728;&amp;#x5382;&amp;#x7684;&amp;#x6700;&amp;#x5C0F;&amp;#x82B1;&amp;#x8D39;&amp;#x3002;&amp;#x4F7F;&amp;#x7528;&amp;#x6EDA;&amp;#x52A8;&amp;#x6570;&amp;#x7EC4;&amp;#x53BB;&amp;#x6389;&amp;#x7B2C;&amp;#x4E8C;&amp;#x7EF4;&amp;#xFF0C;&amp;#x8BBE; $ f(i) $ &amp;#x4E3A;&amp;#x539F;&amp;#x6709;&amp;#x7684; $ f[i][j] $&amp;#xFF0C;$ g(i) $ &amp;#x4E3A;&amp;#x539F;&amp;#x6709;&amp;#x7684; $ f[i][j - 1] $&amp;#x3002;$ S(i) $ &amp;#x8868;&amp;#x793A;&amp;#x524D; $ i $ &amp;#x68F5;&amp;#x6811;&amp;#x5168;&amp;#x90E8;&amp;#x8FD0;&amp;#x5230; $ 0 $ &amp;#x53F7;&amp;#x70B9;&amp;#x7684;&amp;#x82B1;&amp;#x8D39;&amp;#xFF0C;$ s(i) $ &amp;#x8868;&amp;#x793A;&amp;#x524D; $ i $ &amp;#x68F5;&amp;#x6811;&amp;#x7684;&amp;#x603B;&amp;#x8D28;&amp;#x91CF;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;$$ f(i) = \min\limits_{j = 0} ^ {i} \{ g(j) + S(i) - S(j) - (s(i) - s(j)) \times d(j + 1) \} $$&lt;/p&gt;
&lt;p&gt;&amp;#x659C;&amp;#x7387;&amp;#x4F18;&amp;#x5316;&amp;#xFF0C;&amp;#x8003;&amp;#x8651;&amp;#x4E24;&amp;#x4E2A;&amp;#x51B3;&amp;#x7B56;&amp;#x70B9; $ a $&amp;#x3001;$ b $&amp;#xFF0C;&amp;#x82E5; $ a $ &amp;#x6BD4; $ b $ &amp;#x4F18;&amp;#xFF0C;&amp;#x5219;&amp;#x6709;&lt;/p&gt;
&lt;p&gt;$$ {(g(a) - S(a) + s(a) \times d(a + 1)) - (g(b) - S(b) + s(b) \times d(b + 1)) \over d(a + 1) - d(b + 1)} &amp;lt; s(i) $$&lt;/p&gt;
&lt;p&gt;&amp;#x7EF4;&amp;#x62A4;&amp;#x51B3;&amp;#x7B56;&amp;#x70B9;&amp;#xFF0C;&amp;#x4F7F;&amp;#x659C;&amp;#x7387;&amp;#x9012;&amp;#x589E;&amp;#xFF0C;&amp;#x6700;&amp;#x4F18;&amp;#x51B3;&amp;#x7B56;&amp;#x53D6;&amp;#x961F;&amp;#x9996;&amp;#x3002;&amp;#x65F6;&amp;#x95F4;&amp;#x590D;&amp;#x6742;&amp;#x5EA6;&amp;#x4E3A; $ O(n) $&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x4EE3;&amp;#x7801;&quot;&gt;&amp;#x4EE3;&amp;#x7801;&lt;/h3&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;93&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;94&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;95&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;96&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;97&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;climits&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;algorithm&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXN = &lt;span class=&quot;number&quot;&gt;20000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXM = &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; w[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;], d[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;], s[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;], S[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; g[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;], f[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;prepare&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::reverse(w + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, w + n + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::reverse(d + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, d + n + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        d[i] += d[i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        s[i] = s[i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;] + w[i];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        S[i] = S[i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;] + w[i] * d[i];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;/*&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;inline void force() {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    std::copy(S, S + n + 1, f);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    for (int k = 1; k &amp;lt; MAXM; k++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        std::copy(f, f + n + 1, g);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        std::fill(f, f + n + 1, LLONG_MAX);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        f[0] = 0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        for (int i = 1; i &amp;lt;= n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            int _j = -1;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            for (int j = 0; j &amp;lt; i; j++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                if (f[i] &amp;gt; g[j] + S[i] - S[j] - (s[i] - s[j]) * d[j + 1]) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    f[i] = g[j] + S[i] - S[j] - (s[i] - s[j]) * d[j + 1];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    _j = j;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            printf(&amp;quot;%d --&amp;gt; %d\n&amp;quot;, i, _j);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;*/&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i)&lt;/span&gt; &lt;/span&gt;{ &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; g[i] - S[i] + s[i] * d[i + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]; }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;slope&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; a, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; b)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt;(x(a) - x(b))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;         / &lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt;(d[a + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;] - d[b + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;dp&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::copy(S, S + n + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, f);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; k = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; k &amp;lt; MAXM; k++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::copy(f, f + n + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, g);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::fill(f, f + n + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, LLONG_MAX);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        f[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;] = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; q[MAXN];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; *l = q, *r = q;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        *r = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (l &amp;lt; &lt;span class=&quot;function&quot;&gt;r &amp;amp;&amp;amp; &lt;span class=&quot;title&quot;&gt;slope&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(*(l + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&lt;/span&gt;, *l) &amp;lt; s[i]) l++&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &amp;amp;j = *l;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            f[i] = g[j] + S[i] - S[j] - (s[i] - s[j]) * d[j + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;// printf(&amp;quot;%d --&amp;gt; %d\n&amp;quot;, i, j);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (i &amp;lt; n) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (l &amp;lt; &lt;span class=&quot;function&quot;&gt;r &amp;amp;&amp;amp; &lt;span class=&quot;title&quot;&gt;slope&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(*r, *(r - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&lt;/span&gt;) &amp;gt; &lt;span class=&quot;title&quot;&gt;slope&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(i, *r)&lt;/span&gt;) r--&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                *++r = i;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    freopen(&lt;span class=&quot;string&quot;&gt;&amp;quot;two.in&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;r&amp;quot;&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;stdin&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    freopen(&lt;span class=&quot;string&quot;&gt;&amp;quot;two.out&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;w&amp;quot;&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;stdout&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;n);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%lld %lld&amp;quot;&lt;/span&gt;, &amp;amp;w[i], &amp;amp;d[i]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    prepare();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// force();&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    dp();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%lld\n&amp;quot;&lt;/span&gt;, f[n]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    fclose(&lt;span class=&quot;built_in&quot;&gt;stdin&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    fclose(&lt;span class=&quot;built_in&quot;&gt;stdout&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x4ECE;&amp;#x5C71;&amp;#x9876;&amp;#x4E0A;&amp;#x5230;&amp;#x5C71;&amp;#x5E95;&amp;#x4E0B;&amp;#x6CBF;&amp;#x7740;&amp;#x4E00;&amp;#x6761;&amp;#x76F4;&amp;#x7EBF;&amp;#x79CD;&amp;#x690D;&amp;#x4E86; $ n $ &amp;#x68F5;&amp;#x8001;&amp;#x6811;&amp;#x3002;&amp;#x5F53;&amp;#x5730;&amp;#x7684;&amp;#x653F;&amp;#x5E9C;&amp;#x51B3;&amp;#x5B9A;&amp;#x628A;&amp;#x4ED6;&amp;#x4EEC;&amp;#x780D;&amp;#x4E0B;&amp;#x6765;&amp;#x3002;&amp;#x4E3A;&amp;#x4E86;&amp;#x4E0D;&amp;#x6D6A;&amp;#x8D39;&amp;#x4EFB;&amp;#x4F55;&amp;#x4E00;&amp;#x68F5;&amp;#x6728;&amp;#x6750;&amp;#xFF0C;&amp;#x6811;&amp;#x88AB;&amp;#x780D;&amp;#x5012;&amp;#x540E;&amp;#x8981;&amp;#x8FD0;&amp;#x9001;&amp;#x5230;&amp;#x952F;&amp;#x6728;&amp;#x5382;&amp;#x3002; &amp;#x6728;&amp;#x6750;&amp;#x53EA;&amp;#x80FD;&amp;#x6309;&amp;#x7167;&amp;#x4E00;&amp;#x4E2A;&amp;#x65B9;&amp;#x5411;&amp;#x8FD0;&amp;#x8F93;&amp;#xFF1A;&amp;#x671D;&amp;#x5C71;&amp;#x4E0B;&amp;#x8FD0;&amp;#x3002;&amp;#x5C71;&amp;#x811A;&amp;#x4E0B;&amp;#x6709;&amp;#x4E00;&amp;#x4E2A;&amp;#x952F;&amp;#x6728;&amp;#x5382;&amp;#x3002;&amp;#x53E6;&amp;#x5916;&amp;#x4E24;&amp;#x4E2A;&amp;#x952F;&amp;#x6728;&amp;#x5382;&amp;#x5C06;&amp;#x65B0;&amp;#x4FEE;&amp;#x5EFA;&amp;#x5728;&amp;#x5C71;&amp;#x8DEF;&amp;#x4E0A;&amp;#x3002;&amp;#x4F60;&amp;#x5FC5;&amp;#x987B;&amp;#x51B3;&amp;#x5B9A;&amp;#x5728;&amp;#x54EA;&amp;#x91CC;&amp;#x4FEE;&amp;#x5EFA;&amp;#x4E24;&amp;#x4E2A;&amp;#x952F;&amp;#x6728;&amp;#x5382;&amp;#xFF0C;&amp;#x4F7F;&amp;#x5F97;&amp;#x4F20;&amp;#x8F93;&amp;#x7684;&amp;#x8D39;&amp;#x7528;&amp;#x603B;&amp;#x548C;&amp;#x6700;&amp;#x5C0F;&amp;#x3002;&amp;#x5047;&amp;#x5B9A;&amp;#x8FD0;&amp;#x8F93;&amp;#x6BCF;&amp;#x516C;&amp;#x65A4;&amp;#x6728;&amp;#x6750;&amp;#x6BCF;&amp;#x7C73;&amp;#x9700;&amp;#x8981;&amp;#x4E00;&amp;#x5206;&amp;#x94B1;&amp;#x3002;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="CEOI" scheme="https://blog.menci.moe/tag/ceoi/"/>
    
      <category term="COGS" scheme="https://blog.menci.moe/tag/cogs/"/>
    
      <category term="DP" scheme="https://blog.menci.moe/tag/dp/"/>
    
      <category term="单调队列" scheme="https://blog.menci.moe/tag/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97/"/>
    
      <category term="斜率优化" scheme="https://blog.menci.moe/tag/%E6%96%9C%E7%8E%87%E4%BC%98%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>「BZOJ 1597」土地购买 - 斜率优化DP</title>
    <link href="https://blog.menci.moe/bzoj-1597/"/>
    <id>https://blog.menci.moe/bzoj-1597/</id>
    <published>2016-05-18T09:04:00.000Z</published>
    <updated>2016-05-18T09:17:49.426Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x519C;&amp;#x592B; John &amp;#x51C6;&amp;#x5907;&amp;#x6269;&amp;#x5927;&amp;#x4ED6;&amp;#x7684;&amp;#x519C;&amp;#x573A;&amp;#xFF0C;&amp;#x4ED6;&amp;#x6B63;&amp;#x5728;&amp;#x8003;&amp;#x8651; $ N $&amp;#xFF08;$ 1 \leq N \leq 50000 $&amp;#xFF09;&amp;#x5757;&amp;#x957F;&amp;#x65B9;&amp;#x5F62;&amp;#x7684;&amp;#x571F;&amp;#x5730;&amp;#x3002;&amp;#x6BCF;&amp;#x5757;&amp;#x571F;&amp;#x5730;&amp;#x7684;&amp;#x957F;&amp;#x5BBD;&amp;#x6EE1;&amp;#x8DB3;&amp;#xFF08;$ 1 \leq $ &amp;#x957F;&amp;#x3001;&amp;#x5BBD; $ \leq 1000000 $&amp;#xFF09;&amp;#x3002;&amp;#x6BCF;&amp;#x5757;&amp;#x571F;&amp;#x5730;&amp;#x7684;&amp;#x4EF7;&amp;#x683C;&amp;#x662F;&amp;#x5B83;&amp;#x7684;&amp;#x9762;&amp;#x79EF;&amp;#xFF0C;&amp;#x4F46; FJ &amp;#x53EF;&amp;#x4EE5;&amp;#x540C;&amp;#x65F6;&amp;#x8D2D;&amp;#x4E70;&amp;#x591A;&amp;#x5FEB;&amp;#x571F;&amp;#x5730;&amp;#x3002;&amp;#x8FD9;&amp;#x4E9B;&amp;#x571F;&amp;#x5730;&amp;#x7684;&amp;#x4EF7;&amp;#x683C;&amp;#x662F;&amp;#x5B83;&amp;#x4EEC;&amp;#x6700;&amp;#x5927;&amp;#x7684;&amp;#x957F;&amp;#x4E58;&amp;#x4EE5;&amp;#x5B83;&amp;#x4EEC;&amp;#x6700;&amp;#x5927;&amp;#x7684;&amp;#x5BBD;&amp;#xFF0C;&amp;#x4F46;&amp;#x662F;&amp;#x571F;&amp;#x5730;&amp;#x7684;&amp;#x957F;&amp;#x5BBD;&amp;#x4E0D;&amp;#x80FD;&amp;#x4EA4;&amp;#x6362;&amp;#x3002;&amp;#x5982;&amp;#x679C; FJ &amp;#x4E70;&amp;#x4E00;&amp;#x5757; $ 3 \times 5 $ &amp;#x7684;&amp;#x5730;&amp;#x548C;&amp;#x4E00;&amp;#x5757; $ 5 \times 3 $ &amp;#x7684;&amp;#x5730;&amp;#xFF0C;&amp;#x5219;&amp;#x4ED6;&amp;#x9700;&amp;#x8981;&amp;#x4ED8; $ 5 \times 5 = 25 $&amp;#x3002;FJ &amp;#x5E0C;&amp;#x671B;&amp;#x4E70;&amp;#x4E0B;&amp;#x6240;&amp;#x6709;&amp;#x7684;&amp;#x571F;&amp;#x5730;&amp;#xFF0C;&amp;#x4F46;&amp;#x662F;&amp;#x4ED6;&amp;#x53D1;&amp;#x73B0;&amp;#x5206;&amp;#x7EC4;&amp;#x6765;&amp;#x4E70;&amp;#x8FD9;&amp;#x4E9B;&amp;#x571F;&amp;#x5730;&amp;#x53EF;&amp;#x4EE5;&amp;#x8282;&amp;#x7701;&amp;#x7ECF;&amp;#x8D39;&amp;#xFF0C;&amp;#x4ED6;&amp;#x9700;&amp;#x8981;&amp;#x4F60;&amp;#x5E2E;&amp;#x52A9;&amp;#x4ED6;&amp;#x627E;&amp;#x5230;&amp;#x6700;&amp;#x5C0F;&amp;#x7684;&amp;#x7ECF;&amp;#x8D39;&amp;#x3002;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;&amp;#x94FE;&amp;#x63A5;&quot;&gt;&amp;#x94FE;&amp;#x63A5;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://www.lydsy.com/JudgeOnline/problem.php?id=1597&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;BZOJ 1597&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x9898;&amp;#x89E3;&quot;&gt;&amp;#x9898;&amp;#x89E3;&lt;/h3&gt;
&lt;p&gt;&amp;#x8003;&amp;#x8651;&amp;#x4E24;&amp;#x5757;&amp;#x571F;&amp;#x5730;&amp;#xFF0C;&amp;#x82E5;&amp;#x5176;&amp;#x4E2D;&amp;#x4E00;&amp;#x5757;&amp;#x53EF;&amp;#x5C06;&amp;#x53E6;&amp;#x4E00;&amp;#x5757;&amp;#x5B8C;&amp;#x5168;&amp;#x5305;&amp;#x542B;&amp;#xFF0C;&amp;#x5219;&amp;#x53EF;&amp;#x4EE5;&amp;#x5C06;&amp;#x8F83;&amp;#x5C0F;&amp;#x7684;&amp;#x4E00;&amp;#x5757;&amp;#x5FFD;&amp;#x7565;&amp;#xFF0C;&amp;#x56E0;&amp;#x4E3A;&amp;#x5B83;&amp;#x603B;&amp;#x662F;&amp;#x53EF;&amp;#x4EE5;&amp;#x88AB;&amp;#x548C;&amp;#x53E6;&amp;#x4E00;&amp;#x5757;&amp;#x540C;&amp;#x65F6;&amp;#x8D2D;&amp;#x4E70;&amp;#xFF0C;&amp;#x800C;&amp;#x4E0D;&amp;#x589E;&amp;#x52A0;&amp;#x82B1;&amp;#x8D39;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x6392;&amp;#x5E8F;&amp;#x5C06;&amp;#x4E0A;&amp;#x8FF0;&amp;#x60C5;&amp;#x51B5;&amp;#x7B5B;&amp;#x9664;&amp;#x540E;&amp;#xFF0C;&amp;#x6574;&amp;#x4E2A;&amp;#x5E8F;&amp;#x5217;&amp;#x4EE5;&amp;#x4E00;&amp;#x4E2A;&amp;#x5173;&amp;#x952E;&amp;#x5B57;&amp;#x5347;&amp;#x5E8F;&amp;#xFF0C;&amp;#x53E6;&amp;#x4E00;&amp;#x4E2A;&amp;#x5173;&amp;#x952E;&amp;#x5B57;&amp;#x964D;&amp;#x5E8F;&amp;#x3002;&amp;#x5047;&amp;#x8BBE;&amp;#x5BBD;&amp;#x5EA6; $ w(i) $ &amp;#x964D;&amp;#x5E8F;&amp;#xFF0C;&amp;#x9AD8;&amp;#x5EA6; $ h(i) $ &amp;#x5347;&amp;#x5E8F;&amp;#x3002;&amp;#x8BBE; $ f(i) $ &amp;#x8868;&amp;#x793A;&amp;#x8D2D;&amp;#x4E70;&amp;#x524D; $ i $ &amp;#x5757;&amp;#x571F;&amp;#x5730;&amp;#x7684;&amp;#x6700;&amp;#x5C0F;&amp;#x82B1;&amp;#x8D39;&amp;#xFF0C;&amp;#x8003;&amp;#x8651;&amp;#x54EA;&amp;#x4E9B;&amp;#x4E0D;&amp;#x548C; $ i $ &amp;#x5728;&amp;#x4E00;&amp;#x8D77;&amp;#x8D2D;&amp;#x4E70;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;$$ f(i) = \min\limits_{j = 0} ^ {i - 1} \{ f(j) + w(j + 1) \times h(i) \} $$&lt;/p&gt;
&lt;p&gt;&amp;#x659C;&amp;#x7387;&amp;#x4F18;&amp;#x5316;&amp;#xFF0C;&amp;#x8003;&amp;#x8651;&amp;#x4E24;&amp;#x4E2A;&amp;#x51B3;&amp;#x7B56; $ a $&amp;#x3001;$ b $&amp;#xFF0C;&amp;#x82E5; $ a $ &amp;#x6BD4; $ b $ &amp;#x4F18;&amp;#xFF0C;&amp;#x5219;&amp;#x6709;&lt;/p&gt;
&lt;p&gt;$$ \begin{align*} f(a) + w(a + 1) \times h(i) &amp;amp; &amp;lt; f(b) + w(b + 1) \times h(i) \\ f(a) + f(b) &amp;amp; &amp;lt; (w(b + 1) - w(a + 1)) \times h(i) \\ f(a) + f(b) \over w(b + 1) - w(a + 1) &amp;amp; &amp;lt; h(i) \\ \end{align*} $$&lt;/p&gt;
&lt;p&gt;&amp;#x7EF4;&amp;#x62A4;&amp;#x51B3;&amp;#x7B56;&amp;#x70B9;&amp;#xFF0C;&amp;#x4F7F;&amp;#x659C;&amp;#x7387;&amp;#x9012;&amp;#x589E;&amp;#xFF0C;&amp;#x6700;&amp;#x4F18;&amp;#x51B3;&amp;#x7B56;&amp;#x53D6;&amp;#x961F;&amp;#x9996;&amp;#x3002;&amp;#x65F6;&amp;#x95F4;&amp;#x590D;&amp;#x6742;&amp;#x5EA6;&amp;#x4E3A; $ O(n) $&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x4EE3;&amp;#x7801;&quot;&gt;&amp;#x4EE3;&amp;#x7801;&lt;/h3&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;87&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;climits&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;utility&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;functional&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;algorithm&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;vector&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXN = &lt;span class=&quot;number&quot;&gt;50000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::pair&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;&amp;gt; A[MAXN];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;vector&lt;/span&gt;&amp;lt; &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::pair&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;&amp;gt;* &amp;gt; vec;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; f[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;prepare&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::sort(A, A + n, &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::greater&amp;lt; &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::pair&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;&amp;gt; &amp;gt;());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::pair&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;&amp;gt; *last = &lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!last || A[i].second &amp;gt; last-&amp;gt;second) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            vec.push_back(&amp;amp;A[i]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            last = &amp;amp;A[i];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    n = vec.size();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i)&lt;/span&gt; &lt;/span&gt;{ &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static_cast&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt;&amp;gt;(vec[i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]-&amp;gt;first); }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;h&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i)&lt;/span&gt; &lt;/span&gt;{ &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static_cast&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt;&amp;gt;(vec[i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]-&amp;gt;second); }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;force&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    f[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;] = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::fill(f + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, f + n + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, LLONG_MAX);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; _j = -&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; j = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; j &amp;lt; i; j++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (f[i] &amp;gt; f[j] + w(j + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) * h(i)) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                f[i] = f[j] + w(j + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) * h(i);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                _j = j;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// printf(&amp;quot;%d --&amp;gt; %d\n&amp;quot;, i, _j);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;slope&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; a, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; b)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt;(f[a] - f[b])&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;         / &lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt;(w(b + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) - w(a + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;dp&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    f[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;] = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::fill(f + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, f + n + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, LLONG_MAX);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; q[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; *l = &amp;amp;q[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;], *r = &amp;amp;q[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    *r = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (l &amp;lt; &lt;span class=&quot;function&quot;&gt;r &amp;amp;&amp;amp; &lt;span class=&quot;title&quot;&gt;slope&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(*(l + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&lt;/span&gt;, *l) &amp;lt; &lt;span class=&quot;title&quot;&gt;h&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(i)&lt;/span&gt;) l++&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; tmp = *l;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        f[i] = f[tmp] + w(tmp + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) * h(i);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// printf(&amp;quot;%d --&amp;gt; %d\n&amp;quot;, i, tmp);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (i != n) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (l &amp;lt; &lt;span class=&quot;function&quot;&gt;r &amp;amp;&amp;amp; &lt;span class=&quot;title&quot;&gt;slope&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(*r, *(r - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&lt;/span&gt;) &amp;gt; &lt;span class=&quot;title&quot;&gt;slope&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(*r, i)&lt;/span&gt;) r--&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            *++r = i;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;n);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d&amp;quot;&lt;/span&gt;, &amp;amp;A[i].first, &amp;amp;A[i].second);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    prepare();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// for (int i = 0; i &amp;lt; n; i++) printf(&amp;quot;%d %d\n&amp;quot;, vec[i]-&amp;gt;first, vec[i]-&amp;gt;second);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// force();&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    dp();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%lld\n&amp;quot;&lt;/span&gt;, f[n]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x519C;&amp;#x592B; John &amp;#x51C6;&amp;#x5907;&amp;#x6269;&amp;#x5927;&amp;#x4ED6;&amp;#x7684;&amp;#x519C;&amp;#x573A;&amp;#xFF0C;&amp;#x4ED6;&amp;#x6B63;&amp;#x5728;&amp;#x8003;&amp;#x8651; $ N $&amp;#xFF08;$ 1 \leq N \leq 50000 $&amp;#xFF09;&amp;#x5757;&amp;#x957F;&amp;#x65B9;&amp;#x5F62;&amp;#x7684;&amp;#x571F;&amp;#x5730;&amp;#x3002;&amp;#x6BCF;&amp;#x5757;&amp;#x571F;&amp;#x5730;&amp;#x7684;&amp;#x957F;&amp;#x5BBD;&amp;#x6EE1;&amp;#x8DB3;&amp;#xFF08;$ 1 \leq $ &amp;#x957F;&amp;#x3001;&amp;#x5BBD; $ \leq 1000000 $&amp;#xFF09;&amp;#x3002;&amp;#x6BCF;&amp;#x5757;&amp;#x571F;&amp;#x5730;&amp;#x7684;&amp;#x4EF7;&amp;#x683C;&amp;#x662F;&amp;#x5B83;&amp;#x7684;&amp;#x9762;&amp;#x79EF;&amp;#xFF0C;&amp;#x4F46; FJ &amp;#x53EF;&amp;#x4EE5;&amp;#x540C;&amp;#x65F6;&amp;#x8D2D;&amp;#x4E70;&amp;#x591A;&amp;#x5FEB;&amp;#x571F;&amp;#x5730;&amp;#x3002;&amp;#x8FD9;&amp;#x4E9B;&amp;#x571F;&amp;#x5730;&amp;#x7684;&amp;#x4EF7;&amp;#x683C;&amp;#x662F;&amp;#x5B83;&amp;#x4EEC;&amp;#x6700;&amp;#x5927;&amp;#x7684;&amp;#x957F;&amp;#x4E58;&amp;#x4EE5;&amp;#x5B83;&amp;#x4EEC;&amp;#x6700;&amp;#x5927;&amp;#x7684;&amp;#x5BBD;&amp;#xFF0C;&amp;#x4F46;&amp;#x662F;&amp;#x571F;&amp;#x5730;&amp;#x7684;&amp;#x957F;&amp;#x5BBD;&amp;#x4E0D;&amp;#x80FD;&amp;#x4EA4;&amp;#x6362;&amp;#x3002;&amp;#x5982;&amp;#x679C; FJ &amp;#x4E70;&amp;#x4E00;&amp;#x5757; $ 3 \times 5 $ &amp;#x7684;&amp;#x5730;&amp;#x548C;&amp;#x4E00;&amp;#x5757; $ 5 \times 3 $ &amp;#x7684;&amp;#x5730;&amp;#xFF0C;&amp;#x5219;&amp;#x4ED6;&amp;#x9700;&amp;#x8981;&amp;#x4ED8; $ 5 \times 5 = 25 $&amp;#x3002;FJ &amp;#x5E0C;&amp;#x671B;&amp;#x4E70;&amp;#x4E0B;&amp;#x6240;&amp;#x6709;&amp;#x7684;&amp;#x571F;&amp;#x5730;&amp;#xFF0C;&amp;#x4F46;&amp;#x662F;&amp;#x4ED6;&amp;#x53D1;&amp;#x73B0;&amp;#x5206;&amp;#x7EC4;&amp;#x6765;&amp;#x4E70;&amp;#x8FD9;&amp;#x4E9B;&amp;#x571F;&amp;#x5730;&amp;#x53EF;&amp;#x4EE5;&amp;#x8282;&amp;#x7701;&amp;#x7ECF;&amp;#x8D39;&amp;#xFF0C;&amp;#x4ED6;&amp;#x9700;&amp;#x8981;&amp;#x4F60;&amp;#x5E2E;&amp;#x52A9;&amp;#x4ED6;&amp;#x627E;&amp;#x5230;&amp;#x6700;&amp;#x5C0F;&amp;#x7684;&amp;#x7ECF;&amp;#x8D39;&amp;#x3002;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="BZOJ" scheme="https://blog.menci.moe/tag/bzoj/"/>
    
      <category term="DP" scheme="https://blog.menci.moe/tag/dp/"/>
    
      <category term="单调队列" scheme="https://blog.menci.moe/tag/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97/"/>
    
      <category term="斜率优化" scheme="https://blog.menci.moe/tag/%E6%96%9C%E7%8E%87%E4%BC%98%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>「ZJOI2007」仓库建设 - 斜率优化DP</title>
    <link href="https://blog.menci.moe/zjoi2007-storage/"/>
    <id>https://blog.menci.moe/zjoi2007-storage/</id>
    <published>2016-05-18T03:58:00.000Z</published>
    <updated>2016-05-18T09:10:44.666Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x7B2C; $ i $ &amp;#x4E2A;&amp;#x5DE5;&amp;#x5382;&amp;#x76EE;&amp;#x524D;&amp;#x5DF2;&amp;#x6709;&amp;#x6210;&amp;#x54C1; $ P_i $ &amp;#x4EF6;&amp;#xFF0C;&amp;#x5728;&amp;#x7B2C; $ i $ &amp;#x4E2A;&amp;#x4F4D;&amp;#x7F6E;&amp;#x5EFA;&amp;#x7ACB;&amp;#x4ED3;&amp;#x5E93;&amp;#x7684;&amp;#x8D39;&amp;#x7528;&amp;#x662F; $ C_i $&amp;#x3002;&amp;#x5BF9;&amp;#x4E8E;&amp;#x6CA1;&amp;#x6709;&amp;#x5EFA;&amp;#x7ACB;&amp;#x4ED3;&amp;#x5E93;&amp;#x7684;&amp;#x5DE5;&amp;#x5382;&amp;#xFF0C;&amp;#x5176;&amp;#x4EA7;&amp;#x54C1;&amp;#x5E94;&amp;#x88AB;&amp;#x8FD0;&amp;#x5F80;&amp;#x5176;&amp;#x4ED6;&amp;#x7684;&amp;#x4ED3;&amp;#x5E93;&amp;#x8FDB;&amp;#x884C;&amp;#x50A8;&amp;#x85CF;&amp;#xFF0C;&amp;#x800C;&amp;#x7531;&amp;#x4E8E;&amp;#x516C;&amp;#x53F8;&amp;#x4EA7;&amp;#x54C1;&amp;#x7684;&amp;#x5BF9;&amp;#x5916;&amp;#x9500;&amp;#x552E;&amp;#x5904;&amp;#x8BBE;&amp;#x7F6E;&amp;#x5728;&amp;#x5C71;&amp;#x811A;&amp;#x7684;&amp;#x5DE5;&amp;#x5382; $ N $&amp;#xFF0C;&amp;#x6545;&amp;#x4EA7;&amp;#x54C1;&amp;#x53EA;&amp;#x80FD;&amp;#x5F80;&amp;#x5C71;&amp;#x4E0B;&amp;#x8FD0;&amp;#xFF08;&amp;#x5373;&amp;#x53EA;&amp;#x80FD;&amp;#x8FD0;&amp;#x5F80;&amp;#x7F16;&amp;#x53F7;&amp;#x66F4;&amp;#x5927;&amp;#x7684;&amp;#x5DE5;&amp;#x5382;&amp;#x7684;&amp;#x4ED3;&amp;#x5E93;&amp;#xFF09;&amp;#xFF0C;&amp;#x5F53;&amp;#x7136;&amp;#x8FD0;&amp;#x9001;&amp;#x4EA7;&amp;#x54C1;&amp;#x4E5F;&amp;#x662F;&amp;#x9700;&amp;#x8981;&amp;#x8D39;&amp;#x7528;&amp;#x7684;&amp;#xFF0C;&amp;#x5047;&amp;#x8BBE;&amp;#x4E00;&amp;#x4EF6;&amp;#x4EA7;&amp;#x54C1;&amp;#x8FD0;&amp;#x9001; $ 1 $ &amp;#x4E2A;&amp;#x5355;&amp;#x4F4D;&amp;#x8DDD;&amp;#x79BB;&amp;#x7684;&amp;#x8D39;&amp;#x7528;&amp;#x662F; $ 1 $&amp;#x3002;&amp;#x5047;&amp;#x8BBE;&amp;#x5EFA;&amp;#x7ACB;&amp;#x7684;&amp;#x4ED3;&amp;#x5E93;&amp;#x5BB9;&amp;#x91CF;&amp;#x90FD;&amp;#x90FD;&amp;#x662F;&amp;#x8DB3;&amp;#x591F;&amp;#x5927;&amp;#x7684;&amp;#xFF0C;&amp;#x53EF;&amp;#x4EE5;&amp;#x5BB9;&amp;#x4E0B;&amp;#x6240;&amp;#x6709;&amp;#x7684;&amp;#x4EA7;&amp;#x54C1;&amp;#x3002;&amp;#x4F60;&amp;#x5C06;&amp;#x5F97;&amp;#x5230;&amp;#x4EE5;&amp;#x4E0B;&amp;#x6570;&amp;#x636E;&amp;#xFF1A;&lt;/p&gt;
&lt;ol style=&quot;list-style-type: decimal&quot;&gt;
&lt;li&gt;&amp;#x5DE5;&amp;#x5382; $ i $ &amp;#x8DDD;&amp;#x79BB;&amp;#x5DE5;&amp;#x5382; $ 1 $ &amp;#x7684;&amp;#x8DDD;&amp;#x79BB; $ x_i $&amp;#xFF08;&amp;#x5176;&amp;#x4E2D; $ x_1 = 0 $&amp;#xFF09;&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x5DE5;&amp;#x5382; $ i $ &amp;#x76EE;&amp;#x524D;&amp;#x5DF2;&amp;#x6709;&amp;#x6210;&amp;#x54C1;&amp;#x6570;&amp;#x91CF; $ p_i $&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x5728;&amp;#x5DE5;&amp;#x5382; $ i $ &amp;#x5EFA;&amp;#x7ACB;&amp;#x4ED3;&amp;#x5E93;&amp;#x7684;&amp;#x8D39;&amp;#x7528; $ c_i $&amp;#x3002;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&amp;#x8BF7;&amp;#x4F60;&amp;#x5E2E;&amp;#x52A9;&amp;#x516C;&amp;#x53F8;&amp;#x5BFB;&amp;#x627E;&amp;#x4E00;&amp;#x4E2A;&amp;#x4ED3;&amp;#x5E93;&amp;#x5EFA;&amp;#x8BBE;&amp;#x7684;&amp;#x65B9;&amp;#x6848;&amp;#xFF0C;&amp;#x4F7F;&amp;#x5F97;&amp;#x603B;&amp;#x7684;&amp;#x8D39;&amp;#x7528;&amp;#xFF08;&amp;#x5EFA;&amp;#x9020;&amp;#x8D39;&amp;#x7528; + &amp;#x8FD0;&amp;#x8F93;&amp;#x8D39;&amp;#x7528;&amp;#xFF09;&amp;#x6700;&amp;#x5C0F;&amp;#x3002;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;&amp;#x94FE;&amp;#x63A5;&quot;&gt;&amp;#x94FE;&amp;#x63A5;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://www.lydsy.com/JudgeOnline/problem.php?id=1096&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;BZOJ 1096&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://cogs.top/cogs/problem/problem.php?pid=367&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;COGS 367&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x9898;&amp;#x89E3;&quot;&gt;&amp;#x9898;&amp;#x89E3;&lt;/h3&gt;
&lt;p&gt;&amp;#x5C06;&amp;#x6574;&amp;#x4E2A;&amp;#x5E8F;&amp;#x5217;&amp;#x7FFB;&amp;#x8F6C;&amp;#xFF0C;&amp;#x53D8;&amp;#x4E3A;&amp;#x4ECE;&amp;#x7F16;&amp;#x53F7;&amp;#x5927;&amp;#x7684;&amp;#x8FD0;&amp;#x5F80;&amp;#x7F16;&amp;#x53F7;&amp;#x5C0F;&amp;#x7684;&amp;#xFF0C;&amp;#x8BBE; $ S(i) $ &amp;#x8868;&amp;#x793A;&amp;#x524D; $ i $ &amp;#x4E2A;&amp;#x5DE5;&amp;#x5382;&amp;#x5168;&amp;#x90E8;&amp;#x8FD0;&amp;#x5230; $ 1 $ &amp;#x53F7;&amp;#x5DE5;&amp;#x5382;&amp;#x7684;&amp;#x8D39;&amp;#x7528;&amp;#xFF0C;$ s(i) $ &amp;#x8868;&amp;#x793A;&amp;#x524D; $ i $ &amp;#x4E2A;&amp;#x5DE5;&amp;#x5382;&amp;#x7684;&amp;#x6210;&amp;#x54C1;&amp;#x603B;&amp;#x6570;&amp;#x91CF;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x8BBE; $ f(i) $ &amp;#x8868;&amp;#x793A;&amp;#x524D; i &amp;#x4E2A;&amp;#x5DE5;&amp;#x5382;&amp;#x5904;&amp;#x7406;&amp;#x5B8C;&amp;#x6210;&amp;#x7684;&amp;#x6700;&amp;#x5C0F;&amp;#x82B1;&amp;#x8D39;&amp;#xFF0C;&amp;#x5219;&lt;/p&gt;
&lt;p&gt;$$ f(i) = \min\limits_{j = 0} ^ {i - 1} \{ f(j) + c(j + 1) + S(i) - S(j) - (s(i) - s(j)) \times d(j + 1) \} $$&lt;/p&gt;
&lt;p&gt;&amp;#x659C;&amp;#x7387;&amp;#x4F18;&amp;#x5316;&amp;#xFF0C;&amp;#x8003;&amp;#x8651;&amp;#x4E24;&amp;#x4E2A;&amp;#x51B3;&amp;#x7B56; $ a $&amp;#x3001;$ b $&amp;#xFF08;$ a &amp;gt; b $&amp;#xFF09;&amp;#xFF0C;&amp;#x82E5; $ a $ &amp;#x6BD4; $ b $ &amp;#x4F18;&amp;#xFF0C;&amp;#x5219;&amp;#x6709;&lt;/p&gt;
&lt;p&gt;$$ \begin{align*} f(a) + c(a + 1) + S(i) - S(a) - (s(i) - s(a)) \times d(a + 1) &amp;amp; &amp;lt; f(b) + c(b + 1) + S(i) - S(b) - (s(i) - s(b)) \times d(b + 1) \\ f(a) + c(a + 1) - S(a) - (s(i) - s(a)) \times d(a + 1) &amp;amp; &amp;lt; f(b) + c(b + 1) - S(b) - (s(i) - s(b)) \times d(b + 1) \\ f(a) + c(a + 1) - S(a) - s(i) \times d(a + 1) - s(a) \times d(a + 1) &amp;amp; &amp;lt; f(b) + c(b + 1) - S(b) - s(i) \times d(b + 1) - s(b) \times d(b + 1) \\ (f(a) + c(a + 1) - S(a) - s(a) \times d(a + 1)) - (f(b) + c(b + 1) - S(b) - s(b) \times d(b + 1)) &amp;amp; &amp;lt; s(i) \times d(a + 1) - s(i) \times d(b + 1) \\ (f(a) + c(a + 1) - S(a) - s(a) \times d(a + 1)) - (f(b) + c(b + 1) - S(b) - s(b) \times d(b + 1)) \over d(a + 1) - d(b + 1) &amp;amp; &amp;lt; s(i) \\ \end{align*} $$&lt;/p&gt;
&lt;p&gt;&amp;#x7EF4;&amp;#x62A4;&amp;#x51B3;&amp;#x7B56;&amp;#x70B9;&amp;#xFF0C;&amp;#x4F7F;&amp;#x659C;&amp;#x7387;&amp;#x9012;&amp;#x589E;&amp;#xFF0C;&amp;#x6700;&amp;#x4F18;&amp;#x51B3;&amp;#x7B56;&amp;#x53D6;&amp;#x961F;&amp;#x9996;&amp;#x3002;&amp;#x65F6;&amp;#x95F4;&amp;#x590D;&amp;#x6742;&amp;#x5EA6;&amp;#x4E3A; $ O(n) $&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x4EE3;&amp;#x7801;&quot;&gt;&amp;#x4EE3;&amp;#x7801;&lt;/h3&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;90&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;climits&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;algorithm&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXN = &lt;span class=&quot;number&quot;&gt;1000000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; d[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;], p[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;], c[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; s[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;], S[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; f[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;prepare&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::reverse(p + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, p + n + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::reverse(c + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, c + n + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = n; i &amp;gt;= &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i--) d[i] -= d[i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::reverse(d + &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, d + n + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= n; i++) d[i] += d[i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        s[i] = s[i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;] + p[i];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        S[i] = S[i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;] + p[i] * d[i];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;/*&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;inline void force() {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    std::fill(f, f + n + 1, LLONG_MAX);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    f[0] = 0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    for (int i = 1; i &amp;lt;= n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        int _j = -1;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        for (int j = 0; j &amp;lt; i; j++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            if (f[i] &amp;gt; f[j] + c[j + 1] + S[i] - S[j] - (s[i] - s[j]) * d[j + 1]) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                f[i] = f[j] + c[j + 1] + S[i] - S[j] - (s[i] - s[j]) * d[j + 1];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                _j = j;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        // printf(&amp;quot;%d --&amp;gt; %d\n&amp;quot;, i, _j);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;*/&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i)&lt;/span&gt; &lt;/span&gt;{ &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; f[i] + c[i + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;] - S[i] + s[i] * d[i + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]; }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;slope&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; a, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; b)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// printf(&amp;quot;slope(%d, %d) = %.4lf\n&amp;quot;, a, b, double(x(a) - x(b)) / double(d[a + 1] - d[b + 1]));&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt;(x(a) - x(b))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;         / &lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt;(d[a + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;] - d[b + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;dp&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::fill(f, f + n + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, LLONG_MAX);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    f[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;] = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; q[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; *l = q, *r = q;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    *r = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (l &amp;lt; &lt;span class=&quot;function&quot;&gt;r &amp;amp;&amp;amp; &lt;span class=&quot;title&quot;&gt;slope&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(*(l + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&lt;/span&gt;, *l) &amp;lt; s[i]) l++&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// if (l &amp;lt; r) {&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;//     printf(&amp;quot;%lld %lld\n&amp;quot;, f[*l] + c[*l + 1] + S[i] - S[*l] - (s[i] - s[*l]) * d[*l + 1], f[*(l + 1)] + c[*(l + 1) + 1] + S[i] - S[*(l + 1)] - (s[i] - s[*(l + 1)]) * d[*(l + 1) + 1]);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// }&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &amp;amp;j = *l;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        f[i] = f[j] + c[j + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;] + S[i] - S[j] - (s[i] - s[j]) * d[j + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// printf(&amp;quot;%d --&amp;gt; %d\n&amp;quot;, i, j);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (i &amp;lt; n) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (l &amp;lt; &lt;span class=&quot;function&quot;&gt;r &amp;amp;&amp;amp; &lt;span class=&quot;title&quot;&gt;slope&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(*r, *(r - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&lt;/span&gt;) &amp;gt; &lt;span class=&quot;title&quot;&gt;slope&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(i, *r)&lt;/span&gt;) r--&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            *++r = i;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;n);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%lld %lld %lld&amp;quot;&lt;/span&gt;, &amp;amp;d[i], &amp;amp;p[i], &amp;amp;c[i]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    prepare();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// force();&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    dp();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%lld\n&amp;quot;&lt;/span&gt;, f[n]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x7B2C; $ i $ &amp;#x4E2A;&amp;#x5DE5;&amp;#x5382;&amp;#x76EE;&amp;#x524D;&amp;#x5DF2;&amp;#x6709;&amp;#x6210;&amp;#x54C1; $ P_i $ &amp;#x4EF6;&amp;#xFF0C;&amp;#x5728;&amp;#x7B2C; $ i $ &amp;#x4E2A;&amp;#x4F4D;&amp;#x7F6E;&amp;#x5EFA;&amp;#x7ACB;&amp;#x4ED3;&amp;#x5E93;&amp;#x7684;&amp;#x8D39;&amp;#x7528;&amp;#x662F; $ C_i $&amp;#x3002;&amp;#x5BF9;&amp;#x4E8E;&amp;#x6CA1;&amp;#x6709;&amp;#x5EFA;&amp;#x7ACB;&amp;#x4ED3;&amp;#x5E93;&amp;#x7684;&amp;#x5DE5;&amp;#x5382;&amp;#xFF0C;&amp;#x5176;&amp;#x4EA7;&amp;#x54C1;&amp;#x5E94;&amp;#x88AB;&amp;#x8FD0;&amp;#x5F80;&amp;#x5176;&amp;#x4ED6;&amp;#x7684;&amp;#x4ED3;&amp;#x5E93;&amp;#x8FDB;&amp;#x884C;&amp;#x50A8;&amp;#x85CF;&amp;#xFF0C;&amp;#x800C;&amp;#x7531;&amp;#x4E8E;&amp;#x516C;&amp;#x53F8;&amp;#x4EA7;&amp;#x54C1;&amp;#x7684;&amp;#x5BF9;&amp;#x5916;&amp;#x9500;&amp;#x552E;&amp;#x5904;&amp;#x8BBE;&amp;#x7F6E;&amp;#x5728;&amp;#x5C71;&amp;#x811A;&amp;#x7684;&amp;#x5DE5;&amp;#x5382; $ N $&amp;#xFF0C;&amp;#x6545;&amp;#x4EA7;&amp;#x54C1;&amp;#x53EA;&amp;#x80FD;&amp;#x5F80;&amp;#x5C71;&amp;#x4E0B;&amp;#x8FD0;&amp;#xFF08;&amp;#x5373;&amp;#x53EA;&amp;#x80FD;&amp;#x8FD0;&amp;#x5F80;&amp;#x7F16;&amp;#x53F7;&amp;#x66F4;&amp;#x5927;&amp;#x7684;&amp;#x5DE5;&amp;#x5382;&amp;#x7684;&amp;#x4ED3;&amp;#x5E93;&amp;#xFF09;&amp;#xFF0C;&amp;#x5F53;&amp;#x7136;&amp;#x8FD0;&amp;#x9001;&amp;#x4EA7;&amp;#x54C1;&amp;#x4E5F;&amp;#x662F;&amp;#x9700;&amp;#x8981;&amp;#x8D39;&amp;#x7528;&amp;#x7684;&amp;#xFF0C;&amp;#x5047;&amp;#x8BBE;&amp;#x4E00;&amp;#x4EF6;&amp;#x4EA7;&amp;#x54C1;&amp;#x8FD0;&amp;#x9001; $ 1 $ &amp;#x4E2A;&amp;#x5355;&amp;#x4F4D;&amp;#x8DDD;&amp;#x79BB;&amp;#x7684;&amp;#x8D39;&amp;#x7528;&amp;#x662F; $ 1 $&amp;#x3002;&amp;#x5047;&amp;#x8BBE;&amp;#x5EFA;&amp;#x7ACB;&amp;#x7684;&amp;#x4ED3;&amp;#x5E93;&amp;#x5BB9;&amp;#x91CF;&amp;#x90FD;&amp;#x90FD;&amp;#x662F;&amp;#x8DB3;&amp;#x591F;&amp;#x5927;&amp;#x7684;&amp;#xFF0C;&amp;#x53EF;&amp;#x4EE5;&amp;#x5BB9;&amp;#x4E0B;&amp;#x6240;&amp;#x6709;&amp;#x7684;&amp;#x4EA7;&amp;#x54C1;&amp;#x3002;&amp;#x4F60;&amp;#x5C06;&amp;#x5F97;&amp;#x5230;&amp;#x4EE5;&amp;#x4E0B;&amp;#x6570;&amp;#x636E;&amp;#xFF1A;&lt;/p&gt;
&lt;ol style=&quot;list-style-type: decimal&quot;&gt;
&lt;li&gt;&amp;#x5DE5;&amp;#x5382; $ i $ &amp;#x8DDD;&amp;#x79BB;&amp;#x5DE5;&amp;#x5382; $ 1 $ &amp;#x7684;&amp;#x8DDD;&amp;#x79BB; $ x_i $&amp;#xFF08;&amp;#x5176;&amp;#x4E2D; $ x_1 = 0 $&amp;#xFF09;&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x5DE5;&amp;#x5382; $ i $ &amp;#x76EE;&amp;#x524D;&amp;#x5DF2;&amp;#x6709;&amp;#x6210;&amp;#x54C1;&amp;#x6570;&amp;#x91CF; $ p_i $&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x5728;&amp;#x5DE5;&amp;#x5382; $ i $ &amp;#x5EFA;&amp;#x7ACB;&amp;#x4ED3;&amp;#x5E93;&amp;#x7684;&amp;#x8D39;&amp;#x7528; $ c_i $&amp;#x3002;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&amp;#x8BF7;&amp;#x4F60;&amp;#x5E2E;&amp;#x52A9;&amp;#x516C;&amp;#x53F8;&amp;#x5BFB;&amp;#x627E;&amp;#x4E00;&amp;#x4E2A;&amp;#x4ED3;&amp;#x5E93;&amp;#x5EFA;&amp;#x8BBE;&amp;#x7684;&amp;#x65B9;&amp;#x6848;&amp;#xFF0C;&amp;#x4F7F;&amp;#x5F97;&amp;#x603B;&amp;#x7684;&amp;#x8D39;&amp;#x7528;&amp;#xFF08;&amp;#x5EFA;&amp;#x9020;&amp;#x8D39;&amp;#x7528; + &amp;#x8FD0;&amp;#x8F93;&amp;#x8D39;&amp;#x7528;&amp;#xFF09;&amp;#x6700;&amp;#x5C0F;&amp;#x3002;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="BZOJ" scheme="https://blog.menci.moe/tag/bzoj/"/>
    
      <category term="COGS" scheme="https://blog.menci.moe/tag/cogs/"/>
    
      <category term="DP" scheme="https://blog.menci.moe/tag/dp/"/>
    
      <category term="ZJOI" scheme="https://blog.menci.moe/tag/zjoi/"/>
    
      <category term="单调队列" scheme="https://blog.menci.moe/tag/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97/"/>
    
      <category term="斜率优化" scheme="https://blog.menci.moe/tag/%E6%96%9C%E7%8E%87%E4%BC%98%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>「APIO2010」特别行动队 - 斜率优化DP</title>
    <link href="https://blog.menci.moe/apio2010-commando/"/>
    <id>https://blog.menci.moe/apio2010-commando/</id>
    <published>2016-05-13T12:16:00.000Z</published>
    <updated>2016-05-18T09:05:47.346Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x4E00;&amp;#x652F;&amp;#x90E8;&amp;#x961F;&amp;#x7531; $ n $ &amp;#x540D;&amp;#x9884;&amp;#x5907;&amp;#x5F79;&amp;#x58EB;&amp;#x5175;&amp;#x7EC4;&amp;#x6210;&amp;#xFF0C;&amp;#x58EB;&amp;#x5175;&amp;#x4ECE; $ 1 $ &amp;#x5230; $ n $ &amp;#x7F16;&amp;#x53F7;&amp;#xFF0C;&amp;#x8981;&amp;#x5C06;&amp;#x4ED6;&amp;#x4EEC;&amp;#x62C6;&amp;#x5206;&amp;#x6210;&amp;#x82E5;&amp;#x5E72;&amp;#x7279;&amp;#x522B;&amp;#x884C;&amp;#x52A8;&amp;#x961F;&amp;#xFF0C;&amp;#x540C;&amp;#x4E00;&amp;#x961F;&amp;#x4E2D;&amp;#x961F;&amp;#x5458;&amp;#x7684;&amp;#x7F16;&amp;#x53F7;&amp;#x5E94;&amp;#x8BE5;&amp;#x8FDE;&amp;#x7EED;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x58EB;&amp;#x5175; $ i $ &amp;#x7684;&amp;#x521D;&amp;#x59CB;&amp;#x6218;&amp;#x6597;&amp;#x529B;&amp;#x4E3A; $ x_i $ &amp;#x4E00;&amp;#x652F;&amp;#x7279;&amp;#x522B;&amp;#x884C;&amp;#x52A8;&amp;#x961F;&amp;#x7684;&amp;#x521D;&amp;#x59CB;&amp;#x6218;&amp;#x6597;&amp;#x529B; $ x $ &amp;#x4E3A;&amp;#x5404;&amp;#x58EB;&amp;#x5175;&amp;#x521D;&amp;#x59CB;&amp;#x6218;&amp;#x6597;&amp;#x529B;&amp;#x4E4B;&amp;#x548C;&amp;#x3002;&amp;#x4E00;&amp;#x652F;&amp;#x7279;&amp;#x522B;&amp;#x884C;&amp;#x52A8;&amp;#x961F;&amp;#x7684;&amp;#x6218;&amp;#x6597;&amp;#x529B;&amp;#x4F1A;&amp;#x88AB;&amp;#x4FEE;&amp;#x6B63;&amp;#x4E3A; $ x&amp;#x2019; = Ax ^ 2 + Bx + C $&amp;#xFF0C;&amp;#x5176;&amp;#x4E2D; $ A $&amp;#x3001;$ B $&amp;#x3001;$ C $ &amp;#x5DF2;&amp;#x77E5;&amp;#xFF0C;$ A &amp;lt; 0 $&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x6C42;&amp;#x51FA;&amp;#x5C06;&amp;#x6240;&amp;#x6709;&amp;#x58EB;&amp;#x5175;&amp;#x7EC4;&amp;#x6210;&amp;#x82E5;&amp;#x5E72;&amp;#x7279;&amp;#x522B;&amp;#x884C;&amp;#x52A8;&amp;#x961F;&amp;#x7684;&amp;#x6700;&amp;#x5927;&amp;#x603B;&amp;#x6218;&amp;#x6597;&amp;#x529B;&amp;#x3002;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;&amp;#x94FE;&amp;#x63A5;&quot;&gt;&amp;#x94FE;&amp;#x63A5;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://www.lydsy.com/JudgeOnline/problem.php?id=1911&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;BZOJ 1911&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x9898;&amp;#x89E3;&quot;&gt;&amp;#x9898;&amp;#x89E3;&lt;/h3&gt;
&lt;p&gt;&amp;#x8BBE; $ f[i] $ &amp;#x8868;&amp;#x793A;&amp;#x524D; $ i $ &amp;#x540D;&amp;#x58EB;&amp;#x5175;&amp;#x5206;&amp;#x6210;&amp;#x82E5;&amp;#x5E72;&amp;#x7279;&amp;#x522B;&amp;#x884C;&amp;#x52A8;&amp;#x961F;&amp;#x7684;&amp;#x6700;&amp;#x5927;&amp;#x6218;&amp;#x6597;&amp;#x529B;&amp;#xFF0C;$ s_i $ &amp;#x8868;&amp;#x793A;&amp;#x524D;&amp;#x7F00;&amp;#x548C;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x679A;&amp;#x4E3E; $ j $&amp;#xFF0C;&amp;#x5C06;&amp;#x7B2C; $ j + 1 $ &amp;#x5230; $ i $ &amp;#x4E2A;&amp;#x5206;&amp;#x5728;&amp;#x540C;&amp;#x4E00;&amp;#x961F;&amp;#x91CC;&amp;#xFF0C;&amp;#x72B6;&amp;#x6001;&amp;#x8F6C;&amp;#x79FB;&amp;#x65B9;&amp;#x7A0B;&amp;#x4E3A;&lt;/p&gt;
&lt;p&gt;$$ f[i] = \max\limits_{j = 0} ^ {i - 1} \{ f[j] + A(s_i - s_j) ^ 2 + B(s_i - s_j) + C \} $$&lt;/p&gt;
&lt;p&gt;&amp;#x65F6;&amp;#x95F4;&amp;#x590D;&amp;#x6742;&amp;#x5EA6;&amp;#x4E3A; $ O(n ^ 2) $&amp;#xFF0C;&amp;#x8D85;&amp;#x65F6;&amp;#xFF0C;&amp;#x9700;&amp;#x8981;&amp;#x4F18;&amp;#x5316;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x8003;&amp;#x8651;&amp;#x4E24;&amp;#x4E2A;&amp;#x51B3;&amp;#x7B56;&amp;#x70B9; $ j = a $&amp;#x3001;$ j = b $&amp;#xFF08;$ a &amp;gt; b $&amp;#xFF09;&amp;#xFF0C;&amp;#x82E5; $ a $ &amp;#x6BD4; $ b $ &amp;#x4F18;&amp;#xFF0C;&amp;#x5219;&amp;#x6709;&lt;/p&gt;
&lt;p&gt;$$ f[a] + A(s_i - s_a) ^ 2 + B(s_i - s_a) + C &amp;gt; f[b] + A(s_i - s_b) ^ 2 + B(s_i - s_b) + C \\ f[a] + A(s_i ^ 2 + s_a ^ 2 - 2 s_i s_a) + B(s_i - s_a) + C &amp;gt; f[b] + A(s_i ^ 2 + s_b ^ 2 - 2 s_i s_b) + B(s_i - s_b) + C \\ f[a] + A s_i ^ 2 + A s_a ^ 2 - 2 A s_i s_a + B s_i - B s_a + C &amp;gt; f[b] + A s_i ^ 2 + A s_b ^ 2 - 2 A s_i s_b + B s_i - B s_b + C \\ f[a] + A s_a ^ 2 - 2 A s_i s_a - B s_a &amp;gt; f[b] + A s_b ^ 2 - 2 A s_i s_b - B s_b \\ f[a] - f[b] + A s_a ^ 2 - A s_b ^ 2 - B s_a + B s_b &amp;gt; 2 A s_a s_i + 2 A s_b s_i \\ (f[a] + A s_a ^ 2 - B s_a) - (f[b] + A s_b ^ 2 - B s_b) &amp;gt; 2 A s_i(s_a - s_b) \\ { {(f[a] + A s_a ^ 2 - B s_a) - (f[b] + A s_b ^ 2 - B s_b)} \over {s_a - s_b} } &amp;gt; 2 A s_i \\ $$&lt;/p&gt;
&lt;p&gt;&amp;#x4E0D;&amp;#x7B49;&amp;#x5F0F;&amp;#x53F3;&amp;#x8FB9;&amp;#x5355;&amp;#x8C03;&amp;#x9012;&amp;#x51CF;&amp;#xFF0C;&amp;#x5DE6;&amp;#x8FB9;&amp;#x5206;&amp;#x6BCD;&amp;#x4E0A;&amp;#x7684;&amp;#x524D;&amp;#x7F00;&amp;#x548C;&amp;#x5355;&amp;#x8C03;&amp;#x9012;&amp;#x589E;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x7528;&amp;#x5355;&amp;#x8C03;&amp;#x961F;&amp;#x5217;&amp;#x5B58;&amp;#x50A8;&amp;#x6240;&amp;#x6709;&amp;#x51B3;&amp;#x7B56;&amp;#x70B9;&amp;#xFF0C;&amp;#x7EF4;&amp;#x62A4;&amp;#x4E00;&amp;#x4E2A;&amp;#x4E0A;&amp;#x51F8;&amp;#x58F3;&amp;#xFF0C;&amp;#x4ECE;&amp;#x5DE6;&amp;#x5230;&amp;#x540E;&amp;#x4E24;&amp;#x4E24;&amp;#x4E4B;&amp;#x95F4;&amp;#x7684;&amp;#x659C;&amp;#x7387;&amp;#x9012;&amp;#x51CF;&amp;#xFF0C;&amp;#x4E14;&amp;#x5747;&amp;#x5C0F;&amp;#x4E8E;&amp;#x5F53;&amp;#x524D;&amp;#x7684; $ 2 A s_i $&amp;#xFF0C;&amp;#x6BCF;&amp;#x6B21;&amp;#x6700;&amp;#x4F18;&amp;#x51B3;&amp;#x7B56;&amp;#x4ECE;&amp;#x6700;&amp;#x5DE6;&amp;#x8FB9;&amp;#x53D6;&amp;#x5F97;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x65F6;&amp;#x95F4;&amp;#x590D;&amp;#x6742;&amp;#x5EA6;&amp;#x4E3A; $ O(n) $&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x4EE3;&amp;#x7801;&quot;&gt;&amp;#x4EE3;&amp;#x7801;&lt;/h3&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXN = &lt;span class=&quot;number&quot;&gt;1000000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; a[MAXN], A, B, C;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; s[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;], f[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;template&lt;/span&gt; &amp;lt;&lt;span class=&quot;keyword&quot;&gt;typename&lt;/span&gt; T&amp;gt; &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; T &lt;span class=&quot;title&quot;&gt;sqr&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; T &amp;amp;x)&lt;/span&gt; &lt;/span&gt;{ &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; x * x; }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; a)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; f[a] + &lt;span class=&quot;function&quot;&gt;A * &lt;span class=&quot;title&quot;&gt;sqr&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(s[a])&lt;/span&gt; - B * s[a]&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; a)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; s[a];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; * A * s[i];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;slope&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; a, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; b)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static_cast&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt;&amp;gt;(y(a) - y(b))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;         / &lt;span class=&quot;keyword&quot;&gt;static_cast&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt;&amp;gt;(x(a) - x(b));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;n);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%lld %lld %lld&amp;quot;&lt;/span&gt;, &amp;amp;A, &amp;amp;B, &amp;amp;C);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%lld&amp;quot;&lt;/span&gt;, &amp;amp;a[i]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= n; i++) s[i] = s[i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;] + a[i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; q[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; *l = q, *r = q;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    *r = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (l &amp;lt; &lt;span class=&quot;function&quot;&gt;r &amp;amp;&amp;amp; &lt;span class=&quot;title&quot;&gt;slope&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(*(l + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&lt;/span&gt;, *l) &amp;gt; &lt;span class=&quot;title&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(i)&lt;/span&gt;) l++&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; j = *l;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// int _j = -1;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// for (int j = 0; j &amp;lt; i; j++) {&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;//     if (_j == -1 || f[j] + A * sqr(s[i] - s[j]) + B * (s[i] - s[j]) + C &amp;gt; f[_j] + A * sqr(s[i] - s[_j]) + B * (s[i] - s[_j]) + C) _j = j;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// }&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// j = _j;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// printf(&amp;quot;i = %d, j = %d\n&amp;quot;, i, j);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        f[i] = f[j] + &lt;span class=&quot;function&quot;&gt;A * &lt;span class=&quot;title&quot;&gt;sqr&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(s[i] - s[j])&lt;/span&gt; + B * &lt;span class=&quot;params&quot;&gt;(s[i] - s[j])&lt;/span&gt; + C&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// printf(&amp;quot;i = %d, _j = %d\n&amp;quot;, i, _j);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (l &amp;lt; &lt;span class=&quot;function&quot;&gt;r &amp;amp;&amp;amp; &lt;span class=&quot;title&quot;&gt;slope&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(*r, *(r - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&lt;/span&gt;) &amp;lt; &lt;span class=&quot;title&quot;&gt;slope&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(i, *r)&lt;/span&gt;) r--&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        *++r = i;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%lld\n&amp;quot;&lt;/span&gt;, f[n]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x4E00;&amp;#x652F;&amp;#x90E8;&amp;#x961F;&amp;#x7531; $ n $ &amp;#x540D;&amp;#x9884;&amp;#x5907;&amp;#x5F79;&amp;#x58EB;&amp;#x5175;&amp;#x7EC4;&amp;#x6210;&amp;#xFF0C;&amp;#x58EB;&amp;#x5175;&amp;#x4ECE; $ 1 $ &amp;#x5230; $ n $ &amp;#x7F16;&amp;#x53F7;&amp;#xFF0C;&amp;#x8981;&amp;#x5C06;&amp;#x4ED6;&amp;#x4EEC;&amp;#x62C6;&amp;#x5206;&amp;#x6210;&amp;#x82E5;&amp;#x5E72;&amp;#x7279;&amp;#x522B;&amp;#x884C;&amp;#x52A8;&amp;#x961F;&amp;#xFF0C;&amp;#x540C;&amp;#x4E00;&amp;#x961F;&amp;#x4E2D;&amp;#x961F;&amp;#x5458;&amp;#x7684;&amp;#x7F16;&amp;#x53F7;&amp;#x5E94;&amp;#x8BE5;&amp;#x8FDE;&amp;#x7EED;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x58EB;&amp;#x5175; $ i $ &amp;#x7684;&amp;#x521D;&amp;#x59CB;&amp;#x6218;&amp;#x6597;&amp;#x529B;&amp;#x4E3A; $ x_i $ &amp;#x4E00;&amp;#x652F;&amp;#x7279;&amp;#x522B;&amp;#x884C;&amp;#x52A8;&amp;#x961F;&amp;#x7684;&amp;#x521D;&amp;#x59CB;&amp;#x6218;&amp;#x6597;&amp;#x529B; $ x $ &amp;#x4E3A;&amp;#x5404;&amp;#x58EB;&amp;#x5175;&amp;#x521D;&amp;#x59CB;&amp;#x6218;&amp;#x6597;&amp;#x529B;&amp;#x4E4B;&amp;#x548C;&amp;#x3002;&amp;#x4E00;&amp;#x652F;&amp;#x7279;&amp;#x522B;&amp;#x884C;&amp;#x52A8;&amp;#x961F;&amp;#x7684;&amp;#x6218;&amp;#x6597;&amp;#x529B;&amp;#x4F1A;&amp;#x88AB;&amp;#x4FEE;&amp;#x6B63;&amp;#x4E3A; $ x&amp;#x2019; = Ax ^ 2 + Bx + C $&amp;#xFF0C;&amp;#x5176;&amp;#x4E2D; $ A $&amp;#x3001;$ B $&amp;#x3001;$ C $ &amp;#x5DF2;&amp;#x77E5;&amp;#xFF0C;$ A &amp;lt; 0 $&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x6C42;&amp;#x51FA;&amp;#x5C06;&amp;#x6240;&amp;#x6709;&amp;#x58EB;&amp;#x5175;&amp;#x7EC4;&amp;#x6210;&amp;#x82E5;&amp;#x5E72;&amp;#x7279;&amp;#x522B;&amp;#x884C;&amp;#x52A8;&amp;#x961F;&amp;#x7684;&amp;#x6700;&amp;#x5927;&amp;#x603B;&amp;#x6218;&amp;#x6597;&amp;#x529B;&amp;#x3002;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="APIO" scheme="https://blog.menci.moe/tag/apio/"/>
    
      <category term="BZOJ" scheme="https://blog.menci.moe/tag/bzoj/"/>
    
      <category term="DP" scheme="https://blog.menci.moe/tag/dp/"/>
    
      <category term="单调队列" scheme="https://blog.menci.moe/tag/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97/"/>
    
      <category term="斜率优化" scheme="https://blog.menci.moe/tag/%E6%96%9C%E7%8E%87%E4%BC%98%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>「HDU 632」Rikka with Array - 数位DP</title>
    <link href="https://blog.menci.moe/hdu-5632/"/>
    <id>https://blog.menci.moe/hdu-5632/</id>
    <published>2016-05-12T14:11:00.000Z</published>
    <updated>2016-05-12T14:11:54.189Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x8BBE; $ A(x) $ &amp;#x8868;&amp;#x793A; $ x $ &amp;#x7684;&amp;#x4E8C;&amp;#x8FDB;&amp;#x5236;&amp;#x8868;&amp;#x793A;&amp;#x4E2D; $ 1 $ &amp;#x7684;&amp;#x6570;&amp;#x91CF;&amp;#xFF0C;&amp;#x6C42;&amp;#x6EE1;&amp;#x8DB3; $ 1 \leq i \lt j \leq n,\ A(i) \gt A(j) $ &amp;#x7684;&amp;#x6570;&amp;#x5BF9; $ [i, j] $ &amp;#x7684;&amp;#x6570;&amp;#x91CF;&amp;#x3002;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;&amp;#x94FE;&amp;#x63A5;&quot;&gt;&amp;#x94FE;&amp;#x63A5;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://acm.hdu.edu.cn/showproblem.php?pid=5632&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;HDU 5632&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x9898;&amp;#x89E3;&quot;&gt;&amp;#x9898;&amp;#x89E3;&lt;/h3&gt;
&lt;p&gt;&amp;#x6570;&amp;#x4F4D; DP&amp;#xFF0C;&amp;#x8BBE;&lt;/p&gt;
&lt;p&gt;$$ f[n][gap][iLessThanJ][lim1][lim2] $$&lt;/p&gt;
&lt;p&gt;&amp;#x8868;&amp;#x793A;&amp;#x4E8C;&amp;#x8FDB;&amp;#x5236;&amp;#x8868;&amp;#x793A;&amp;#x7684;&amp;#x6700;&amp;#x540E; $ n $ &amp;#x4F4D;&amp;#xFF0C;&amp;#x4E4B;&amp;#x524D;&amp;#x5404;&amp;#x4F4D;&amp;#x7EC4;&amp;#x6210;&amp;#x7684;&amp;#x6570;&amp;#x7684;&amp;#x5DEE;&amp;#xFF08;$ j - i $&amp;#xFF09;&amp;#x4E3A; $ gap $&amp;#xFF0C;&amp;#x662F;&amp;#x5426; $ i \lt j $ &amp;#x6216; $ i = j $&amp;#xFF0C;$ i $&amp;#x3001;$ j $ &amp;#x7684;&amp;#x4E4B;&amp;#x524D;&amp;#x6240;&amp;#x6709;&amp;#x4F4D;&amp;#x662F;&amp;#x5426;&amp;#x5747;&amp;#x8FBE;&amp;#x5230;&amp;#x4E0A;&amp;#x754C;&amp;#x7684;&amp;#x5408;&amp;#x6CD5;&amp;#x6570;&amp;#x5BF9;&amp;#x6570;&amp;#x91CF;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x8F6C;&amp;#x79FB;&amp;#x65F6;&amp;#x679A;&amp;#x4E3E; $ i $&amp;#x3001;$ j $ &amp;#x7684;&amp;#x4E0B;&amp;#x4E00;&amp;#x4F4D;&amp;#x5206;&amp;#x522B;&amp;#x662F; $ 0 $ &amp;#x6216;&amp;#x8005; $ 1 $ &amp;#x5373;&amp;#x53EF;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x6CE8;&amp;#x610F;&amp;#xFF0C;&amp;#x4E0D;&amp;#x9700;&amp;#x8981;&amp;#x8003;&amp;#x8651; $ i \gt j $ &amp;#x7684;&amp;#x60C5;&amp;#x51B5;&amp;#xFF0C;&amp;#x56E0;&amp;#x4E3A;&amp;#x786E;&amp;#x5B9A;&amp;#x4E86;&amp;#x4E8C;&amp;#x8FDB;&amp;#x5236;&amp;#x8F83;&amp;#x9AD8;&amp;#x4F4D;&amp;#x6EE1;&amp;#x8DB3;&amp;#x4E00;&amp;#x5927;&amp;#x4E00;&amp;#x5C0F;&amp;#x540E;&amp;#xFF0C;&amp;#x8F83;&amp;#x4F4E;&amp;#x4F4D;&amp;#x4E0D;&amp;#x4F1A;&amp;#x4F7F;&amp;#x5176;&amp;#x5927;&amp;#x5C0F;&amp;#x5173;&amp;#x7CFB;&amp;#x66F4;&amp;#x6539;&amp;#xFF0C;&amp;#x5373;&amp;#x8FD9;&amp;#x79CD;&amp;#x72B6;&amp;#x6001;&amp;#x4E0D;&amp;#x53EF;&amp;#x80FD;&amp;#x5408;&amp;#x6CD5;&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x4EE3;&amp;#x7801;&quot;&gt;&amp;#x4EE3;&amp;#x7801;&lt;/h3&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;93&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;94&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;95&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;96&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;97&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;98&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;99&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;100&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;101&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;102&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;103&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;104&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;105&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;106&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;107&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;108&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;109&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;110&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;111&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;112&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;113&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;114&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;115&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;116&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;117&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;118&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;119&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;120&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;121&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;122&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;123&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;124&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;125&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;126&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;127&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;128&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;129&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;130&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;131&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;132&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;133&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;134&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;135&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;136&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;137&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;138&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;139&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;140&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;141&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;142&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;143&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;144&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;145&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;146&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;147&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;148&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;149&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;150&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;151&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;152&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;153&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;154&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;155&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;156&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;157&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;158&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;159&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;160&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;161&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;162&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;163&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;164&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;165&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;166&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;167&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;168&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;169&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;170&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;171&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;172&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;173&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;174&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;175&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;176&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;177&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;178&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;179&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;180&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;181&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;182&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;183&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;184&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;185&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;186&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;187&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;188&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;189&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstring&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;algorithm&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXT = &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXN = &lt;span class=&quot;number&quot;&gt;300&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXN_BIT = &lt;span class=&quot;number&quot;&gt;997&lt;/span&gt;; &lt;span class=&quot;comment&quot;&gt;// 996.5784284662087&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MOD = &lt;span class=&quot;number&quot;&gt;998244353&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; FLAG = &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; a[MAXN_BIT];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; mem[MAXN_BIT][(MAXN_BIT + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) * &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;][FLAG][FLAG][FLAG];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// bool calced[MAXN_BIT][(MAXN_BIT + 1) * 2][FLAG][FLAG][FLAG];&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; i[MAXN_BIT], j[MAXN_BIT];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;/*&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;inline void _set(const int n, const bool i, const bool j) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    ::i[::n - n] = i;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    ::j[::n - n] = j;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;inline void _print() {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    for (int i = 0; i &amp;lt; n; i++) putchar(::i[i] ? &amp;apos;1&amp;apos; : &amp;apos;0&amp;apos;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    putchar(&amp;apos;\n&amp;apos;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    for (int i = 0; i &amp;lt; n; i++) putchar(::j[i] ? &amp;apos;1&amp;apos; : &amp;apos;0&amp;apos;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    putchar(&amp;apos;\n&amp;apos;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    putchar(&amp;apos;\n&amp;apos;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;*/&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;dp&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; gap, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; iLessThanJ, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; limited1, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; limited2)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// gap : (A[i] - A[j])&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &amp;amp;ans = mem[n][gap + MAXN_BIT][iLessThanJ][limited1][limited2];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (ans != -&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; ans;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (n == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (iLessThanJ &amp;amp;&amp;amp; gap &amp;gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) ans = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; &lt;span class=&quot;comment&quot;&gt;// , _print();&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; ans = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    } &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ans = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; limit1, limit2;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; &amp;amp;next = a[::n - n];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (limited1) limit1 = next;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; limit1 = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (limited2) limit2 = next;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; limit2 = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// printf(&amp;quot;next = %d\n&amp;quot;, next);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// 0 0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// _set(n, 0, 0);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ans += dp(n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                  gap,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                  iLessThanJ,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                  limited1 &amp;amp;&amp;amp; next == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                  limited2 &amp;amp;&amp;amp; next == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ans %= MOD;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// 0 1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (limit2 == &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;// _set(n, 0, 1);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            ans += dp(n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                      gap - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                      &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                      limited1 &amp;amp;&amp;amp; next == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                      limited2 &amp;amp;&amp;amp; next == &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            ans %= MOD;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// 1 0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (limit1 == &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &amp;amp;&amp;amp; iLessThanJ) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;// _set(n, 1, 0);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            ans += dp(n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                      gap + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                      &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                      limited1 &amp;amp;&amp;amp; next == &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                      limited2 &amp;amp;&amp;amp; next == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            ans %= MOD;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// 1 1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (limit1 == &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &amp;amp;&amp;amp; limit2 == &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;// _set(n, 1, 1);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            ans += dp(n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                      gap,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                      iLessThanJ,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                      limited1 &amp;amp;&amp;amp; next == &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                      limited2 &amp;amp;&amp;amp; next == &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            ans %= MOD;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// if (n == ::n - 1) printf(&amp;quot;f[%d][%d][%s][%s][%s] = %d\n&amp;quot;, n, gap, iLessThanJ ? &amp;quot;&amp;lt;&amp;quot; : &amp;quot;=&amp;quot;, limited1 ? &amp;quot;*&amp;quot; : &amp;quot; &amp;quot;, limited2 ? &amp;quot;*&amp;quot; : &amp;quot; &amp;quot;, ans);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; ans;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;solve&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt; *s)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;memset&lt;/span&gt;(mem, &lt;span class=&quot;number&quot;&gt;0xff&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;sizeof&lt;/span&gt;(mem));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// memset(calced, 0, sizeof(calced));&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    n = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; len = &lt;span class=&quot;built_in&quot;&gt;strlen&lt;/span&gt;(s);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; num[MAXN];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; len; i++) num[i] = s[i] - &lt;span class=&quot;string&quot;&gt;&amp;apos;0&amp;apos;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; r = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; allZero = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; len; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (num[i] != &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) allZero = &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            r = r * &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt; + num[i];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            num[i] = r / &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            r %= &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (allZero) &lt;span class=&quot;keyword&quot;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        a[n++] = r;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::reverse(a, a + n);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (n == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; ans = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 0 0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// _set(n, 0, 0);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    ans += dp(&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    ans %= MOD;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 0 1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// _set(n, 0, 1);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    ans += dp(&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        -&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    ans %= MOD;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 1 1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// _set(n, 1, 1);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    ans += dp(&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    ans %= MOD;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; ans;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; t;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;t);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (t--) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt; s[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%s&amp;quot;&lt;/span&gt;, s);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d\n&amp;quot;&lt;/span&gt;, solve(s));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x8BBE; $ A(x) $ &amp;#x8868;&amp;#x793A; $ x $ &amp;#x7684;&amp;#x4E8C;&amp;#x8FDB;&amp;#x5236;&amp;#x8868;&amp;#x793A;&amp;#x4E2D; $ 1 $ &amp;#x7684;&amp;#x6570;&amp;#x91CF;&amp;#xFF0C;&amp;#x6C42;&amp;#x6EE1;&amp;#x8DB3; $ 1 \leq i \lt j \leq n,\ A(i) \gt A(j) $ &amp;#x7684;&amp;#x6570;&amp;#x5BF9; $ [i, j] $ &amp;#x7684;&amp;#x6570;&amp;#x91CF;&amp;#x3002;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="DP" scheme="https://blog.menci.moe/tag/dp/"/>
    
      <category term="HDU" scheme="https://blog.menci.moe/tag/hdu/"/>
    
      <category term="数位DP" scheme="https://blog.menci.moe/tag/%E6%95%B0%E4%BD%8Ddp/"/>
    
  </entry>
  
  <entry>
    <title>「SCOI2009」windy 数 - 数位DP</title>
    <link href="https://blog.menci.moe/scoi2009-windy/"/>
    <id>https://blog.menci.moe/scoi2009-windy/</id>
    <published>2016-05-12T09:25:00.000Z</published>
    <updated>2016-05-12T09:29:36.189Z</updated>
    
    <content type="html">&lt;p&gt;windy &amp;#x5B9A;&amp;#x4E49;&amp;#x4E86;&amp;#x4E00;&amp;#x79CD; windy &amp;#x6570;&amp;#x3002;&amp;#x4E0D;&amp;#x542B;&amp;#x524D;&amp;#x5BFC;&amp;#x96F6;&amp;#x4E14;&amp;#x76F8;&amp;#x90BB;&amp;#x4E24;&amp;#x4E2A;&amp;#x6570;&amp;#x5B57;&amp;#x4E4B;&amp;#x5DEE;&amp;#x81F3;&amp;#x5C11;&amp;#x4E3A; $ 2 $ &amp;#x7684;&amp;#x6B63;&amp;#x6574;&amp;#x6570;&amp;#x88AB;&amp;#x79F0;&amp;#x4E3A; windy &amp;#x6570;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;windy &amp;#x60F3;&amp;#x77E5;&amp;#x9053;&amp;#xFF0C;&amp;#x5728; $ A $ &amp;#x548C; $ B $ &amp;#x4E4B;&amp;#x95F4;&amp;#xFF0C;&amp;#x5305;&amp;#x62EC; $ A $ &amp;#x548C; $ B $&amp;#xFF0C;&amp;#x603B;&amp;#x5171;&amp;#x6709;&amp;#x591A;&amp;#x5C11;&amp;#x4E2A; windy &amp;#x6570;&amp;#xFF1F;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;&amp;#x94FE;&amp;#x63A5;&quot;&gt;&amp;#x94FE;&amp;#x63A5;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://www.lydsy.com/JudgeOnline/problem.php?id=1026&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;BZOJ 1026&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x9898;&amp;#x89E3;&quot;&gt;&amp;#x9898;&amp;#x89E3;&lt;/h3&gt;
&lt;p&gt;&amp;#x6570;&amp;#x4F4D; DP&amp;#xFF0C;&amp;#x8BBE;&lt;/p&gt;
&lt;p&gt;$$ f[n][last][notZero][limited] $$&lt;/p&gt;
&lt;p&gt;&amp;#x8868;&amp;#x793A;&amp;#x6700;&amp;#x540E; $ n $ &amp;#x4F4D;&amp;#x6570;&amp;#xFF0C;&amp;#x8FD9; $ n $ &amp;#x4F4D;&amp;#x6570;&amp;#x7684;&amp;#x524D;&amp;#x4E00;&amp;#x4F4D;&amp;#x6570;&amp;#x662F; $ last $&amp;#xFF0C;&amp;#x4E4B;&amp;#x524D;&amp;#x662F;&amp;#x5426;&amp;#x6709;&amp;#x975E;&amp;#x96F6;&amp;#x6570;&amp;#xFF08;&amp;#x5982;&amp;#x679C;&amp;#x524D;&amp;#x9762;&amp;#x5168;&amp;#x662F;&amp;#x96F6;&amp;#x5219;&amp;#x4E0D;&amp;#x8003;&amp;#x8651;&amp;#x5DEE;&amp;#x5206;&amp;#x9650;&amp;#x5236;&amp;#xFF09;&amp;#xFF0C;&amp;#x662F;&amp;#x5426;&amp;#x8FBE;&amp;#x5230;&amp;#x4E0A;&amp;#x754C;&amp;#xFF0C;&amp;#x7684;&amp;#x603B;&amp;#x6570;&amp;#x91CF;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;PS&amp;#xFF1A;&amp;#x4E0D;&amp;#x5141;&amp;#x8BB8;&amp;#x6709;&amp;#x524D;&amp;#x5BFC;&amp;#x96F6;&amp;#x7684;&amp;#x5B9E;&amp;#x73B0;&amp;#x65B9;&amp;#x5F0F;&amp;#x662F;&amp;#xFF0C;&amp;#x5141;&amp;#x8BB8;&amp;#x524D;&amp;#x5BFC;&amp;#x96F6;&amp;#xFF0C;&amp;#x4F46;&amp;#x4E0D;&amp;#x5BF9;&amp;#x524D;&amp;#x5BFC;&amp;#x96F6;&amp;#x8BBE;&amp;#x7F6E;&amp;#x9650;&amp;#x5236;&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x4EE3;&amp;#x7801;&quot;&gt;&amp;#x4EE3;&amp;#x7801;&lt;/h3&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cmath&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstring&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;algorithm&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXX = &lt;span class=&quot;number&quot;&gt;2000000000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXN = &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MINGAP = &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; CHARSET_SIZE = &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; FLAG = &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; a[MAXN], n;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; mem[MAXN][CHARSET_SIZE][FLAG][FLAG];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; calced[MAXN][CHARSET_SIZE][FLAG][FLAG];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;dp&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; last, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; notZero, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; limited)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &amp;amp;ans = mem[n][last][notZero][limited];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (calced[n][last][notZero][limited]) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; ans;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    calced[n][last][notZero][limited] = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (n == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ans = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    } &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; limit;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (limited) limit = a[::n - n];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; limit = CHARSET_SIZE - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt;= limit; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;function&quot;&gt;notZero &amp;amp;&amp;amp; &lt;span class=&quot;title&quot;&gt;abs&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(i - last)&lt;/span&gt; &amp;lt; MINGAP) &lt;span class=&quot;keyword&quot;&gt;continue&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            ans += dp(n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, i, notZero || i != &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, limited &amp;amp;&amp;amp; i == limit);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; ans;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;solve&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt; *s)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::fill(a, a + n, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; len = &lt;span class=&quot;built_in&quot;&gt;strlen&lt;/span&gt;(s);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; len; i++) a[i] = s[len - i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;] - &lt;span class=&quot;string&quot;&gt;&amp;apos;0&amp;apos;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::reverse(a, a + n);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// for (int i = 0; i &amp;lt; n; i++) putchar(&amp;apos;0&amp;apos; + a[i]);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// putchar(&amp;apos;\n&amp;apos;);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;memset&lt;/span&gt;(mem, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;sizeof&lt;/span&gt;(mem));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;memset&lt;/span&gt;(calced, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;sizeof&lt;/span&gt;(calced));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; ans = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt;= a[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;]; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ans += dp(n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, i, i != &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, i == a[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; ans;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; l, r;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d&amp;quot;&lt;/span&gt;, &amp;amp;l, &amp;amp;r);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt; s1[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;], s2[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;sprintf&lt;/span&gt;(s1, &lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, l - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;sprintf&lt;/span&gt;(s2, &lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, r);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    n = &lt;span class=&quot;built_in&quot;&gt;strlen&lt;/span&gt;(s2);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d\n&amp;quot;&lt;/span&gt;, solve(s2) - solve(s1));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;windy &amp;#x5B9A;&amp;#x4E49;&amp;#x4E86;&amp;#x4E00;&amp;#x79CD; windy &amp;#x6570;&amp;#x3002;&amp;#x4E0D;&amp;#x542B;&amp;#x524D;&amp;#x5BFC;&amp;#x96F6;&amp;#x4E14;&amp;#x76F8;&amp;#x90BB;&amp;#x4E24;&amp;#x4E2A;&amp;#x6570;&amp;#x5B57;&amp;#x4E4B;&amp;#x5DEE;&amp;#x81F3;&amp;#x5C11;&amp;#x4E3A; $ 2 $ &amp;#x7684;&amp;#x6B63;&amp;#x6574;&amp;#x6570;&amp;#x88AB;&amp;#x79F0;&amp;#x4E3A; windy &amp;#x6570;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;windy &amp;#x60F3;&amp;#x77E5;&amp;#x9053;&amp;#xFF0C;&amp;#x5728; $ A $ &amp;#x548C; $ B $ &amp;#x4E4B;&amp;#x95F4;&amp;#xFF0C;&amp;#x5305;&amp;#x62EC; $ A $ &amp;#x548C; $ B $&amp;#xFF0C;&amp;#x603B;&amp;#x5171;&amp;#x6709;&amp;#x591A;&amp;#x5C11;&amp;#x4E2A; windy &amp;#x6570;&amp;#xFF1F;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="BZOJ" scheme="https://blog.menci.moe/tag/bzoj/"/>
    
      <category term="DP" scheme="https://blog.menci.moe/tag/dp/"/>
    
      <category term="SCOI" scheme="https://blog.menci.moe/tag/scoi/"/>
    
      <category term="数位DP" scheme="https://blog.menci.moe/tag/%E6%95%B0%E4%BD%8Ddp/"/>
    
  </entry>
  
  <entry>
    <title>「Codeforces 628D」Magic Numbers - 数位DP</title>
    <link href="https://blog.menci.moe/cf-628d/"/>
    <id>https://blog.menci.moe/cf-628d/</id>
    <published>2016-05-12T07:47:00.000Z</published>
    <updated>2016-05-12T07:47:46.849Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x6211;&amp;#x4EEC;&amp;#x8BA4;&amp;#x4E3A;&amp;#x4E00;&amp;#x4E2A;&amp;#x6570;&amp;#x662F; &lt;code&gt;d-magic&lt;/code&gt; &amp;#x7684;&amp;#xFF0C;&amp;#x5F53;&amp;#x4E14;&amp;#x4EC5;&amp;#x5F53;&amp;#x6570;&amp;#x5B57; $ d $ &amp;#x51FA;&amp;#x73B0;&amp;#x5728;&amp;#x8FD9;&amp;#x4E2A;&amp;#x6570;&amp;#x5B57;&amp;#x7684;&amp;#x5341;&amp;#x8FDB;&amp;#x5236;&amp;#x8868;&amp;#x793A;&amp;#x7684;&amp;#x6240;&amp;#x6709;&amp;#x5076;&amp;#x6570;&amp;#x4F4D;&amp;#x4E0A;&amp;#xFF0C;&amp;#x800C;&amp;#x4E0D;&amp;#x4F1A;&amp;#x51FA;&amp;#x73B0;&amp;#x5728;&amp;#x5176;&amp;#x5B83;&amp;#x4F4D;&amp;#x4E0A;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x4F8B;&amp;#x5982;&amp;#xFF0C;$ 1727374,\ 17,\ 1 $ &amp;#x662F; &lt;code&gt;7-magic&lt;/code&gt; &amp;#x7684;&amp;#xFF0C;&amp;#x4F46; $ 77,\ 7,\ 123,\ 34,\ 71 $ &amp;#x4E0D;&amp;#x662F; &lt;code&gt;7-magic&lt;/code&gt; &amp;#x7684;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x627E;&amp;#x51FA;&amp;#x80FD;&amp;#x88AB; &lt;code&gt;m&lt;/code&gt; &amp;#x6574;&amp;#x9664;&amp;#x7684; &lt;code&gt;d-magic&lt;/code&gt; &amp;#x7684;&amp;#x6570;&amp;#x5B57;&amp;#x5728;&amp;#x533A;&amp;#x95F4; $ [a, b] $ &amp;#x5185;&amp;#x7684;&amp;#x6570;&amp;#x91CF;&amp;#x3002;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;&amp;#x94FE;&amp;#x63A5;&quot;&gt;&amp;#x94FE;&amp;#x63A5;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://codeforces.com/contest/628/problem/D&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Codeforces 628D&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x9898;&amp;#x89E3;&quot;&gt;&amp;#x9898;&amp;#x89E3;&lt;/h3&gt;
&lt;p&gt;&amp;#x6570;&amp;#x4F4D; DP&amp;#xFF0C;&amp;#x8BBE;&lt;/p&gt;
&lt;p&gt;$$ f[n][limit][r] $$&lt;/p&gt;
&lt;p&gt;&amp;#x8868;&amp;#x793A;&amp;#x6570;&amp;#x5B57;&amp;#x7684;&amp;#x6700;&amp;#x540E; $ n $ &amp;#x4F4D;&amp;#xFF0C;&amp;#x6700;&amp;#x9AD8;&amp;#x4F4D;&amp;#x6700;&amp;#x5927;&amp;#x4E3A; $ limit $&amp;#xFF0C;&amp;#x6A21; $ m $ &amp;#x7684;&amp;#x4F59;&amp;#x6570;&amp;#x4E3A; $ r $ &amp;#x7684;&amp;#x6570;&amp;#x91CF;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x5BF9;&amp;#x4E8E; $ [a, b] $ &amp;#x7684;&amp;#x9650;&amp;#x5236;&amp;#xFF0C;&amp;#x6211;&amp;#x4EEC;&amp;#x901A;&amp;#x5E38;&amp;#x5B9A;&amp;#x4E49;&amp;#x51FD;&amp;#x6570; $ g(x) $ &amp;#x8868;&amp;#x793A; $ [0, x] $ &amp;#x4E2D;&amp;#x7684;&amp;#x6570;&amp;#x91CF;&amp;#xFF0C;&amp;#x6C42;&amp;#x51FA; $ g(b) - g(a - 1) $&amp;#xFF0C;&amp;#x4F46;&amp;#x8FD9;&amp;#x9053;&amp;#x9898;&amp;#x76EE;&amp;#x4E2D; $ a $ &amp;#x662F;&amp;#x9AD8;&amp;#x7CBE;&amp;#x5EA6;&amp;#x6570;&amp;#xFF0C;&amp;#x4E0D;&amp;#x65B9;&amp;#x4FBF;&amp;#x505A;&amp;#x51CF;&amp;#x6CD5;&amp;#xFF0C;&amp;#x53EF;&amp;#x4EE5;&amp;#x5148;&amp;#x6C42;&amp;#x51FA; $ g(b) - g(a) $&amp;#xFF0C;&amp;#x7136;&amp;#x540E;&amp;#x7279;&amp;#x5224; $ a $ &amp;#x662F;&amp;#x5426;&amp;#x6709;&amp;#x6548;&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x4EE3;&amp;#x7801;&quot;&gt;&amp;#x4EE3;&amp;#x7801;&lt;/h3&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;93&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;94&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;95&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;96&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;97&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;98&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;99&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;100&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;101&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;102&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;103&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;104&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;105&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;106&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;107&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;108&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;109&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;110&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;111&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;112&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;113&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;114&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;115&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;116&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;117&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;118&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;119&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;120&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;121&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;122&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;123&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;124&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;125&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;126&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;127&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;128&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;129&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;130&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;131&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;132&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;133&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;134&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;135&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;136&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;137&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;138&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;139&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;140&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;141&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;142&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;143&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;144&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;145&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// #pragma comment(linker, &amp;quot;/STACK:102400000,102400000&amp;quot;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstring&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;algorithm&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXN = &lt;span class=&quot;number&quot;&gt;2000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXM = &lt;span class=&quot;number&quot;&gt;2000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXD = &lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MOD = &lt;span class=&quot;number&quot;&gt;1e9&lt;/span&gt; + &lt;span class=&quot;number&quot;&gt;7&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; LIMIT_UNLIMITED = &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; a[MAXN];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; mem[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;][&lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;][MAXM + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; calced[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;][&lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;][MAXM + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; pow10[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, d, m;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; isEven[MAXN];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;prepare&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    pow10[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;] = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= MAXN; i++)  {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        pow10[i] = &lt;span class=&quot;keyword&quot;&gt;static_cast&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt;&amp;gt;(pow10[i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]) * &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt; % m;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;modm&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; r)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; ((r % m) + m) % m;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;mul&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; x, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static_cast&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt;&amp;gt;(pow10[n]) * x % m;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;dec&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; r, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; x)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; modm(r - x);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// int A[MAXN];&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;dp&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; limit, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; r)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &amp;amp;ans = mem[n][limit][r];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (calced[n][limit][r]) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; ans;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    calced[n][limit][r] = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (n == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (r == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) ans = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; ans = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// if (ans == 1) {&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;//     for (int i = 0; i &amp;lt; ::n; i++) putchar(&amp;apos;0&amp;apos; + A[i]);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;//     putchar(&amp;apos;\n&amp;apos;);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// }&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    } &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; next;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (n != &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) next = a[::n - n + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; next = LIMIT_UNLIMITED;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; _l, _r;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (isEven[n]) _l = d, _r = &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::min(limit, d);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; _l = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, _r = &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::min(limit, &lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = _l; i &amp;lt;= _r; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;// A[::n - n] = i;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!isEven[n] &amp;amp;&amp;amp; i == d) &lt;span class=&quot;keyword&quot;&gt;continue&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;// if (isEven[n] &amp;amp;&amp;amp; i != d) continue;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; t;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (i &amp;lt; limit || limit == LIMIT_UNLIMITED) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                t = LIMIT_UNLIMITED;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            } &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                t = next;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            ans = (ans + dp(&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    t,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    dec(r, mul(i, n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            )) % MOD;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// if (r == 178) printf(&amp;quot;f[%d][%d][%s][%d] = %d\n&amp;quot;, n, limit, isEven ? &amp;quot;true&amp;quot; : &amp;quot;false&amp;quot;, r, ans);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; ans;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;solve&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt; *s)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;memset&lt;/span&gt;(mem, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;sizeof&lt;/span&gt;(mem));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;memset&lt;/span&gt;(calced, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;sizeof&lt;/span&gt;(calced));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) a[i] = s[i] - &lt;span class=&quot;string&quot;&gt;&amp;apos;0&amp;apos;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; ans = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &amp;amp;limit = a[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::min(limit, &lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;); i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (i == d) &lt;span class=&quot;keyword&quot;&gt;continue&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; t;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (i &amp;lt; limit || n == &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            t = LIMIT_UNLIMITED;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        } &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            t = a[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// A[0] = i;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ans = (ans + dp(n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, t, dec(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, mul(i, n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)))) % MOD;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// printf(&amp;quot;solve(%s) = %d\n&amp;quot;, s, ans);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; ans;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;judge&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt; *s)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; r = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; isEven = &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!isEven &amp;amp;&amp;amp; s[i] - &lt;span class=&quot;string&quot;&gt;&amp;apos;0&amp;apos;&lt;/span&gt; == d) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (isEven &amp;amp;&amp;amp; s[i] - &lt;span class=&quot;string&quot;&gt;&amp;apos;0&amp;apos;&lt;/span&gt; != d) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        r = modm(r - mul(s[i] - &lt;span class=&quot;string&quot;&gt;&amp;apos;0&amp;apos;&lt;/span&gt;, n - i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        isEven ^= &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; r == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; ? &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; : &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// int size = 16 &amp;lt;&amp;lt; 20;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// char *p = (char *)malloc(size) + size;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// __asm__(&amp;quot;movq %0, %%rsp\n&amp;quot; :: &amp;quot;r&amp;quot;(p));&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// __asm__(&amp;quot;movl %0, %%esp\n&amp;quot; :: &amp;quot;r&amp;quot;(p));&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt; s1[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;], s2[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d\n%s\n%s&amp;quot;&lt;/span&gt;, &amp;amp;m, &amp;amp;d, s1, s2);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    prepare();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    n = &lt;span class=&quot;built_in&quot;&gt;strlen&lt;/span&gt;(s1);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    isEven[n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;] = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = n - &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;; i &amp;gt;= &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i--) isEven[i] = !isEven[i + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; ans = (solve(s2) - solve(s1) + judge(s1)) % MOD;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d\n&amp;quot;&lt;/span&gt;, (ans + MOD) % MOD);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// exit(0);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x6211;&amp;#x4EEC;&amp;#x8BA4;&amp;#x4E3A;&amp;#x4E00;&amp;#x4E2A;&amp;#x6570;&amp;#x662F; &lt;code&gt;d-magic&lt;/code&gt; &amp;#x7684;&amp;#xFF0C;&amp;#x5F53;&amp;#x4E14;&amp;#x4EC5;&amp;#x5F53;&amp;#x6570;&amp;#x5B57; $ d $ &amp;#x51FA;&amp;#x73B0;&amp;#x5728;&amp;#x8FD9;&amp;#x4E2A;&amp;#x6570;&amp;#x5B57;&amp;#x7684;&amp;#x5341;&amp;#x8FDB;&amp;#x5236;&amp;#x8868;&amp;#x793A;&amp;#x7684;&amp;#x6240;&amp;#x6709;&amp;#x5076;&amp;#x6570;&amp;#x4F4D;&amp;#x4E0A;&amp;#xFF0C;&amp;#x800C;&amp;#x4E0D;&amp;#x4F1A;&amp;#x51FA;&amp;#x73B0;&amp;#x5728;&amp;#x5176;&amp;#x5B83;&amp;#x4F4D;&amp;#x4E0A;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x4F8B;&amp;#x5982;&amp;#xFF0C;$ 1727374,\ 17,\ 1 $ &amp;#x662F; &lt;code&gt;7-magic&lt;/code&gt; &amp;#x7684;&amp;#xFF0C;&amp;#x4F46; $ 77,\ 7,\ 123,\ 34,\ 71 $ &amp;#x4E0D;&amp;#x662F; &lt;code&gt;7-magic&lt;/code&gt; &amp;#x7684;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x627E;&amp;#x51FA;&amp;#x80FD;&amp;#x88AB; &lt;code&gt;m&lt;/code&gt; &amp;#x6574;&amp;#x9664;&amp;#x7684; &lt;code&gt;d-magic&lt;/code&gt; &amp;#x7684;&amp;#x6570;&amp;#x5B57;&amp;#x5728;&amp;#x533A;&amp;#x95F4; $ [a, b] $ &amp;#x5185;&amp;#x7684;&amp;#x6570;&amp;#x91CF;&amp;#x3002;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="Codeforces" scheme="https://blog.menci.moe/tag/codeforces/"/>
    
      <category term="DP" scheme="https://blog.menci.moe/tag/dp/"/>
    
      <category term="数位DP" scheme="https://blog.menci.moe/tag/%E6%95%B0%E4%BD%8Ddp/"/>
    
  </entry>
  
  <entry>
    <title>「HDU 2089」不要 62 - 数位DP</title>
    <link href="https://blog.menci.moe/hdu-2089/"/>
    <id>https://blog.menci.moe/hdu-2089/</id>
    <published>2016-05-12T03:56:00.000Z</published>
    <updated>2016-05-12T07:48:11.559Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x4E0D;&amp;#x5409;&amp;#x5229;&amp;#x7684;&amp;#x6570;&amp;#x5B57;&amp;#x4E3A;&amp;#x6240;&amp;#x6709;&amp;#x542B;&amp;#x6709; $ 4 $ &amp;#x6216; $ 62 $ &amp;#x7684;&amp;#x53F7;&amp;#x7801;&amp;#x3002;&amp;#x4F8B;&amp;#x5982;&amp;#xFF1A;$ 62315,\ 73418,\ 88914 $ &amp;#x90FD;&amp;#x5C5E;&amp;#x4E8E;&amp;#x4E0D;&amp;#x5409;&amp;#x5229;&amp;#x53F7;&amp;#x7801;&amp;#x3002;&amp;#x4F46;&amp;#x662F;&amp;#xFF0C;$ 61152 $ &amp;#x867D;&amp;#x7136;&amp;#x542B;&amp;#x6709; $ 6 $ &amp;#x548C; $ 2 $&amp;#xFF0C;&amp;#x4F46;&amp;#x4E0D;&amp;#x662F; $ 62 $ &amp;#x8FDE;&amp;#x53F7;&amp;#xFF0C;&amp;#x6240;&amp;#x4EE5;&amp;#x4E0D;&amp;#x5C5E;&amp;#x4E8E;&amp;#x4E0D;&amp;#x5409;&amp;#x5229;&amp;#x6570;&amp;#x5B57;&amp;#x4E4B;&amp;#x5217;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x4F60;&amp;#x7684;&amp;#x4EFB;&amp;#x52A1;&amp;#x662F;&amp;#xFF0C;&amp;#x5BF9;&amp;#x4E8E;&amp;#x6BCF;&amp;#x6B21;&amp;#x7ED9;&amp;#x51FA;&amp;#x7684;&amp;#x4E00;&amp;#x4E2A;&amp;#x724C;&amp;#x7167;&amp;#x533A;&amp;#x95F4;&amp;#x53F7;&amp;#xFF0C;&amp;#x63A8;&amp;#x65AD;&amp;#x51FA;&amp;#x4EA4;&amp;#x7BA1;&amp;#x5C40;&amp;#x4ECA;&amp;#x6B21;&amp;#x53C8;&amp;#x8981;&amp;#x5B9E;&amp;#x9645;&amp;#x4E0A;&amp;#x7ED9;&amp;#x591A;&amp;#x5C11;&amp;#x8F86;&amp;#x65B0;&amp;#x7684;&amp;#x58EB;&amp;#x8F66;&amp;#x4E0A;&amp;#x724C;&amp;#x7167;&amp;#x4E86;&amp;#x3002;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;&amp;#x94FE;&amp;#x63A5;&quot;&gt;&amp;#x94FE;&amp;#x63A5;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://acm.hdu.edu.cn/showproblem.php?pid=2089&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;HDU 2089&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x9898;&amp;#x89E3;&quot;&gt;&amp;#x9898;&amp;#x89E3;&lt;/h3&gt;
&lt;p&gt;&amp;#x6570;&amp;#x4F4D; DP&amp;#xFF0C;&amp;#x8BBE;&lt;/p&gt;
&lt;p&gt;$$ f[n][last][flag] $$&lt;/p&gt;
&lt;p&gt;&amp;#x8868;&amp;#x793A;&amp;#x53F7;&amp;#x7801;&amp;#x7684;&amp;#x6700;&amp;#x540E; $ n $ &amp;#x4F4D;&amp;#xFF0C;&amp;#x8FD9; $ n $ &amp;#x4F4D;&amp;#x7684;&amp;#x4E0A;&amp;#x4E00;&amp;#x4E2A;&amp;#x5B57;&amp;#x7B26;&amp;#x662F; $ last $&amp;#xFF0C;&amp;#x4E4B;&amp;#x524D;&amp;#x7684;&amp;#x5B57;&amp;#x7B26;&amp;#x662F;&amp;#x5426;&amp;#x5168;&amp;#x90E8;&amp;#x7D27;&amp;#x8D34;&amp;#x4E0A;&amp;#x754C;&amp;#xFF0C;&amp;#x7684;&amp;#x603B;&amp;#x6570;&amp;#x91CF;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x6BCF;&amp;#x6B21;&amp;#x679A;&amp;#x4E3E;&amp;#x8FD9; $ n $ &amp;#x4F4D;&amp;#x7684;&amp;#x6700;&amp;#x9AD8;&amp;#x4F4D;&amp;#xFF0C;&amp;#x7279;&amp;#x5224; $ 4 $&amp;#xFF0C;&amp;#x7279;&amp;#x5224;&amp;#x8FDE;&amp;#x7EED;&amp;#x7684; $ 62 $ &amp;#x5373;&amp;#x53EF;&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x4EE3;&amp;#x7801;&quot;&gt;&amp;#x4EE3;&amp;#x7801;&lt;/h3&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstring&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXX = &lt;span class=&quot;number&quot;&gt;1000000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXN = &lt;span class=&quot;number&quot;&gt;7&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; CHARSET_SIZE = &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; FLAG = &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; a[MAXN], n;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; mem[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;][CHARSET_SIZE][FLAG];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; calced[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;][CHARSET_SIZE][FLAG];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;dp&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; last, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; flag)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &amp;amp;ans = mem[n][last][flag];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (calced[n][last][flag]) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; ans;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    calced[n][last][flag] = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (n == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ans = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    } &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; limit;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (flag) limit = a[::n - n];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; limit = CHARSET_SIZE - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt;= limit; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (last == &lt;span class=&quot;number&quot;&gt;6&lt;/span&gt; &amp;amp;&amp;amp; i == &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; || i == &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;) &lt;span class=&quot;keyword&quot;&gt;continue&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            ans += dp(n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, i, flag &amp;amp;&amp;amp; i == limit);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// printf(&amp;quot;dp(%d, %d) = %d\n&amp;quot;, n, last, ans);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; ans;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;solve&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; x)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt; s[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;sprintf&lt;/span&gt;(s, &lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, x);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    n = &lt;span class=&quot;built_in&quot;&gt;strlen&lt;/span&gt;(s);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) a[i] = s[i] - &lt;span class=&quot;string&quot;&gt;&amp;apos;0&amp;apos;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;memset&lt;/span&gt;(mem, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;sizeof&lt;/span&gt;(mem));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;memset&lt;/span&gt;(calced, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;sizeof&lt;/span&gt;(calced));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; ans = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt;= a[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;]; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (i == &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;) &lt;span class=&quot;keyword&quot;&gt;continue&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ans += dp(n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, i, i == a[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// printf(&amp;quot;[%d, %d] -&amp;gt; %d\n&amp;quot;, n - 1, i, dp(n - 1, i, i == a[0]));&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; ans;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; l, r;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (&lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d&amp;quot;&lt;/span&gt;, &amp;amp;l, &amp;amp;r), !(l == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &amp;amp;&amp;amp; r == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;)) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d\n&amp;quot;&lt;/span&gt;, solve(r) - solve(l - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x4E0D;&amp;#x5409;&amp;#x5229;&amp;#x7684;&amp;#x6570;&amp;#x5B57;&amp;#x4E3A;&amp;#x6240;&amp;#x6709;&amp;#x542B;&amp;#x6709; $ 4 $ &amp;#x6216; $ 62 $ &amp;#x7684;&amp;#x53F7;&amp;#x7801;&amp;#x3002;&amp;#x4F8B;&amp;#x5982;&amp;#xFF1A;$ 62315,\ 73418,\ 88914 $ &amp;#x90FD;&amp;#x5C5E;&amp;#x4E8E;&amp;#x4E0D;&amp;#x5409;&amp;#x5229;&amp;#x53F7;&amp;#x7801;&amp;#x3002;&amp;#x4F46;&amp;#x662F;&amp;#xFF0C;$ 61152 $ &amp;#x867D;&amp;#x7136;&amp;#x542B;&amp;#x6709; $ 6 $ &amp;#x548C; $ 2 $&amp;#xFF0C;&amp;#x4F46;&amp;#x4E0D;&amp;#x662F; $ 62 $ &amp;#x8FDE;&amp;#x53F7;&amp;#xFF0C;&amp;#x6240;&amp;#x4EE5;&amp;#x4E0D;&amp;#x5C5E;&amp;#x4E8E;&amp;#x4E0D;&amp;#x5409;&amp;#x5229;&amp;#x6570;&amp;#x5B57;&amp;#x4E4B;&amp;#x5217;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x4F60;&amp;#x7684;&amp;#x4EFB;&amp;#x52A1;&amp;#x662F;&amp;#xFF0C;&amp;#x5BF9;&amp;#x4E8E;&amp;#x6BCF;&amp;#x6B21;&amp;#x7ED9;&amp;#x51FA;&amp;#x7684;&amp;#x4E00;&amp;#x4E2A;&amp;#x724C;&amp;#x7167;&amp;#x533A;&amp;#x95F4;&amp;#x53F7;&amp;#xFF0C;&amp;#x63A8;&amp;#x65AD;&amp;#x51FA;&amp;#x4EA4;&amp;#x7BA1;&amp;#x5C40;&amp;#x4ECA;&amp;#x6B21;&amp;#x53C8;&amp;#x8981;&amp;#x5B9E;&amp;#x9645;&amp;#x4E0A;&amp;#x7ED9;&amp;#x591A;&amp;#x5C11;&amp;#x8F86;&amp;#x65B0;&amp;#x7684;&amp;#x58EB;&amp;#x8F66;&amp;#x4E0A;&amp;#x724C;&amp;#x7167;&amp;#x4E86;&amp;#x3002;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="DP" scheme="https://blog.menci.moe/tag/dp/"/>
    
      <category term="HDU" scheme="https://blog.menci.moe/tag/hdu/"/>
    
      <category term="数位DP" scheme="https://blog.menci.moe/tag/%E6%95%B0%E4%BD%8Ddp/"/>
    
  </entry>
  
  <entry>
    <title>「HDU 5462」King&#39;s Order - 数位DP</title>
    <link href="https://blog.menci.moe/hdu-5642/"/>
    <id>https://blog.menci.moe/hdu-5642/</id>
    <published>2016-05-11T23:47:00.000Z</published>
    <updated>2016-05-11T23:47:37.829Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x7531;&amp;#x4E8E;&amp;#x56FD;&amp;#x738B;&amp;#x7684;&amp;#x53E3;&amp;#x5403;&amp;#x5E76;&amp;#x6CA1;&amp;#x6709;&amp;#x6CBB;&amp;#x6108;&amp;#xFF0C;&amp;#x6240;&amp;#x4EE5;&amp;#x4F20;&amp;#x4EE4;&amp;#x4E2D;&amp;#x53EF;&amp;#x80FD;&amp;#x51FA;&amp;#x73B0;&amp;#xFF1A;&amp;#x201C;&amp;#x8BA9;&amp;#x7B2C;&amp;#x4E09;&amp;#x519B;-&amp;#x519B;-&amp;#x519B;&amp;#xFF0C;&amp;#x5230;&amp;#x524D;&amp;#x7EBF;&amp;#x53BB;&amp;#x201D;&amp;#x8FD9;&amp;#x6837;&amp;#x7684;&amp;#x547D;&amp;#x4EE4;&amp;#x3002;&amp;#x7531;&amp;#x4E8E;&amp;#x5927;&amp;#x6D0B;&amp;#x56FD;&amp;#x5728;&amp;#x519B;&amp;#x961F;&amp;#x4E2D;&amp;#x5B89;&amp;#x63D2;&amp;#x4E86;&amp;#x95F4;&amp;#x8C0D;&amp;#xFF0C;&amp;#x6218;&amp;#x4E8B;&amp;#x7D27;&amp;#x6025;&amp;#xFF0C;&amp;#x5F88;&amp;#x591A;&amp;#x65F6;&amp;#x5019;&amp;#x524D;&amp;#x7EBF;&amp;#x7684;&amp;#x6307;&amp;#x6325;&amp;#x5B98;&amp;#x4E0D;&amp;#x80FD;&amp;#x5206;&amp;#x6E05;&amp;#x54EA;&amp;#x4E9B;&amp;#x547D;&amp;#x4EE4;&amp;#x771F;&amp;#x6B63;&amp;#x6765;&amp;#x81EA;&amp;#x56FD;&amp;#x738B;&amp;#x3002;&amp;#x4F46;&amp;#x56FD;&amp;#x738B;&amp;#x7684;&amp;#x547D;&amp;#x4EE4;&amp;#x6709;&amp;#x4E00;&amp;#x4E2A;&amp;#x7279;&amp;#x70B9;&amp;#xFF0C;&amp;#x4ED6;&amp;#x6BCF;&amp;#x6B21;&amp;#x8FDE;&amp;#x7EED;&amp;#x91CD;&amp;#x590D;&amp;#x7684;&amp;#x5B57;&amp;#x7B26;&amp;#x6700;&amp;#x591A; $ 3 $ &amp;#x6B21;. &amp;#x6240;&amp;#x4EE5;&amp;#x8BF4;&amp;#x4ED6;&amp;#x7684;&amp;#x547D;&amp;#x4EE4;&amp;#x4E2D;&amp;#x6CA1;&amp;#x6709;&amp;#xFF1A;&amp;#x201C;&amp;#x8BA9;&amp;#x7B2C;&amp;#x4E09;&amp;#x519B;-&amp;#x519B;-&amp;#x519B;-&amp;#x519B;&amp;#xFF0C;&amp;#x5230;&amp;#x524D;&amp;#x7EBF;&amp;#x53BB;&amp;#x201D;&amp;#xFF0C;&amp;#x4F46;&amp;#x662F;&amp;#x53EF;&amp;#x4EE5;&amp;#x6709;&amp;#xFF1A;&amp;#x201C;&amp;#x8BA9;&amp;#x7B2C;&amp;#x4E09;&amp;#x519B;-&amp;#x519B; &amp;#xFF0C;&amp;#x5230;&amp;#x524D;&amp;#x7EBF;&amp;#x53BB;&amp;#x201D;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x6B64;&amp;#x65F6;&amp;#x5C06;&amp;#x519B;&amp;#x627E;&amp;#x5230;&amp;#x4E86;&amp;#x4F60;&amp;#xFF0C;&amp;#x4F60;&amp;#x9700;&amp;#x8981;&amp;#x544A;&amp;#x8BC9;&amp;#x4ED6;&amp;#xFF0C;&amp;#x7ED9;&amp;#x5B9A;&amp;#x547D;&amp;#x4EE4;&amp;#x7684;&amp;#x957F;&amp;#x5EA6;&amp;#x957F;&amp;#x5EA6;&amp;#x4E3A; $ n $&amp;#xFF0C;&amp;#x6709;&amp;#x591A;&amp;#x5C11;&amp;#x79CD;&amp;#x4E0D;&amp;#x540C;&amp;#x7684;&amp;#x547D;&amp;#x4EE4;&amp;#x53EF;&amp;#x4EE5;&amp;#x662F;&amp;#x56FD;&amp;#x738B;&amp;#x53D1;&amp;#x51FA;&amp;#x7684;&amp;#x3002;&amp;#xFF08;&amp;#x4E5F;&amp;#x5C31;&amp;#x662F;&amp;#x6C42;&amp;#x957F;&amp;#x5EA6;&amp;#x4E3A; $ n $ &amp;#x7684;&amp;#x5408;&amp;#x683C;&amp;#x5B57;&amp;#x7B26;&amp;#x4E32;&amp;#x7684;&amp;#x4E2A;&amp;#x6570;&amp;#xFF09;&amp;#x5F53;&amp;#x7136;&amp;#xFF0C;&amp;#x56FD;&amp;#x738B;&amp;#x53EF;&amp;#x80FD;&amp;#x8BF4;&amp;#x51FA;&amp;#x4E00;&amp;#x53E5;&amp;#x8BDD;&amp;#x6CA1;&amp;#x6709;&amp;#x72AF;&amp;#x4EFB;&amp;#x4F55;&amp;#x53E3;&amp;#x5403;&amp;#xFF0C;&amp;#x5C31;&amp;#x50CF;&amp;#x4ED6;&amp;#x90A3;&amp;#x6B21;&amp;#x6F14;&amp;#x8BB2;&amp;#x4E00;&amp;#x6837;&amp;#x3002;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;&amp;#x94FE;&amp;#x63A5;&quot;&gt;&amp;#x94FE;&amp;#x63A5;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://acm.hdu.edu.cn/showproblem.php?pid=5642&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;HDU 5642&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x9898;&amp;#x89E3;&quot;&gt;&amp;#x9898;&amp;#x89E3;&lt;/h3&gt;
&lt;p&gt;&amp;#x6570;&amp;#x4F4D; DP&amp;#xFF0C;&amp;#x8BBE;&lt;/p&gt;
&lt;p&gt;$$ f[n][f1][f2][f3][lastChar] $$&lt;/p&gt;
&lt;p&gt;&amp;#x8868;&amp;#x793A;&amp;#x957F;&amp;#x5EA6;&amp;#x4E3A; $ n $ &amp;#x7684;&amp;#x5B57;&amp;#x7B26;&amp;#x4E32;&amp;#xFF0C;&amp;#x6700;&amp;#x540E;&amp;#x56DB;&amp;#x4E2A;&amp;#x5B57;&amp;#x7B26;&amp;#x4E2D;&amp;#x4E24;&amp;#x4E24;&amp;#x662F;&amp;#x5426;&amp;#x76F8;&amp;#x7B49;&amp;#xFF0C;&amp;#x6700;&amp;#x540E;&amp;#x4E00;&amp;#x4E2A;&amp;#x5B57;&amp;#x7B26;&amp;#x662F; $ lastChar $&amp;#xFF0C;&amp;#x72B6;&amp;#x6001;&amp;#x8F6C;&amp;#x79FB;&amp;#x65F6;&amp;#xFF0C;&amp;#x679A;&amp;#x4E3E;&amp;#x6700;&amp;#x540E;&amp;#x4E00;&amp;#x4E2A;&amp;#x5B57;&amp;#x7B26;&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x4E09;&amp;#x4E2A;&amp;#x6807;&amp;#x5FD7;&amp;#x4F4D;&amp;#x5747;&amp;#x4E3A;&amp;#x771F;&amp;#xFF0C;&amp;#x5219;&amp;#x72B6;&amp;#x6001;&amp;#x975E;&amp;#x6CD5;&amp;#xFF0C;&amp;#x7B54;&amp;#x6848;&amp;#x4E3A;&amp;#x96F6;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x6BCF;&amp;#x6B21;&amp;#x4E0D;&amp;#x9700;&amp;#x8981;&amp;#x91CD;&amp;#x65B0;&amp;#x8BA1;&amp;#x7B97;&amp;#xFF0C;&amp;#x5229;&amp;#x7528;&amp;#x4E4B;&amp;#x524D;&amp;#x8BA1;&amp;#x7B97;&amp;#x8FC7;&amp;#x7684;&amp;#x503C;&amp;#x5373;&amp;#x53EF;&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x4EE3;&amp;#x7801;&quot;&gt;&amp;#x4EE3;&amp;#x7801;&lt;/h3&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstring&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXT = &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXN = &lt;span class=&quot;number&quot;&gt;2000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MOD = &lt;span class=&quot;number&quot;&gt;1000000007&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; CHARSET_SIZE = &lt;span class=&quot;number&quot;&gt;26&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; mem[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;][&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;][&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;][&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;][CHARSET_SIZE + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; calced[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;][&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;][&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;][&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;][CHARSET_SIZE + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;dp&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; c2EqualToC1, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; c3EqualToC2, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; c4EqualToC3, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; c4)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &amp;amp;ans = mem[n][c2EqualToC1][c3EqualToC2][c4EqualToC3][c4];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (calced[n][c2EqualToC1][c3EqualToC2][c4EqualToC3][c4]) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; ans;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    calced[n][c2EqualToC1][c3EqualToC2][c4EqualToC3][c4] = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (c2EqualToC1 &amp;amp;&amp;amp; c3EqualToC2 &amp;amp;&amp;amp; c4EqualToC3) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ans = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    } &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (n == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ans = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    } &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ans = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; CHARSET_SIZE; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            ans += dp(n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, c3EqualToC2, c4EqualToC3, i == c4, i);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            ans %= MOD;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; ans;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// inline void cleanUp() {&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//     memset(mem, 0, sizeof(mem));&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//     memset(calced, 0, sizeof(calced));&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// }&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; t;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;t);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (t--) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;n);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d\n&amp;quot;&lt;/span&gt;, dp(n, &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;, &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;, &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;, CHARSET_SIZE));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// cleanUp();&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x7531;&amp;#x4E8E;&amp;#x56FD;&amp;#x738B;&amp;#x7684;&amp;#x53E3;&amp;#x5403;&amp;#x5E76;&amp;#x6CA1;&amp;#x6709;&amp;#x6CBB;&amp;#x6108;&amp;#xFF0C;&amp;#x6240;&amp;#x4EE5;&amp;#x4F20;&amp;#x4EE4;&amp;#x4E2D;&amp;#x53EF;&amp;#x80FD;&amp;#x51FA;&amp;#x73B0;&amp;#xFF1A;&amp;#x201C;&amp;#x8BA9;&amp;#x7B2C;&amp;#x4E09;&amp;#x519B;-&amp;#x519B;-&amp;#x519B;&amp;#xFF0C;&amp;#x5230;&amp;#x524D;&amp;#x7EBF;&amp;#x53BB;&amp;#x201D;&amp;#x8FD9;&amp;#x6837;&amp;#x7684;&amp;#x547D;&amp;#x4EE4;&amp;#x3002;&amp;#x7531;&amp;#x4E8E;&amp;#x5927;&amp;#x6D0B;&amp;#x56FD;&amp;#x5728;&amp;#x519B;&amp;#x961F;&amp;#x4E2D;&amp;#x5B89;&amp;#x63D2;&amp;#x4E86;&amp;#x95F4;&amp;#x8C0D;&amp;#xFF0C;&amp;#x6218;&amp;#x4E8B;&amp;#x7D27;&amp;#x6025;&amp;#xFF0C;&amp;#x5F88;&amp;#x591A;&amp;#x65F6;&amp;#x5019;&amp;#x524D;&amp;#x7EBF;&amp;#x7684;&amp;#x6307;&amp;#x6325;&amp;#x5B98;&amp;#x4E0D;&amp;#x80FD;&amp;#x5206;&amp;#x6E05;&amp;#x54EA;&amp;#x4E9B;&amp;#x547D;&amp;#x4EE4;&amp;#x771F;&amp;#x6B63;&amp;#x6765;&amp;#x81EA;&amp;#x56FD;&amp;#x738B;&amp;#x3002;&amp;#x4F46;&amp;#x56FD;&amp;#x738B;&amp;#x7684;&amp;#x547D;&amp;#x4EE4;&amp;#x6709;&amp;#x4E00;&amp;#x4E2A;&amp;#x7279;&amp;#x70B9;&amp;#xFF0C;&amp;#x4ED6;&amp;#x6BCF;&amp;#x6B21;&amp;#x8FDE;&amp;#x7EED;&amp;#x91CD;&amp;#x590D;&amp;#x7684;&amp;#x5B57;&amp;#x7B26;&amp;#x6700;&amp;#x591A; $ 3 $ &amp;#x6B21;. &amp;#x6240;&amp;#x4EE5;&amp;#x8BF4;&amp;#x4ED6;&amp;#x7684;&amp;#x547D;&amp;#x4EE4;&amp;#x4E2D;&amp;#x6CA1;&amp;#x6709;&amp;#xFF1A;&amp;#x201C;&amp;#x8BA9;&amp;#x7B2C;&amp;#x4E09;&amp;#x519B;-&amp;#x519B;-&amp;#x519B;-&amp;#x519B;&amp;#xFF0C;&amp;#x5230;&amp;#x524D;&amp;#x7EBF;&amp;#x53BB;&amp;#x201D;&amp;#xFF0C;&amp;#x4F46;&amp;#x662F;&amp;#x53EF;&amp;#x4EE5;&amp;#x6709;&amp;#xFF1A;&amp;#x201C;&amp;#x8BA9;&amp;#x7B2C;&amp;#x4E09;&amp;#x519B;-&amp;#x519B; &amp;#xFF0C;&amp;#x5230;&amp;#x524D;&amp;#x7EBF;&amp;#x53BB;&amp;#x201D;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x6B64;&amp;#x65F6;&amp;#x5C06;&amp;#x519B;&amp;#x627E;&amp;#x5230;&amp;#x4E86;&amp;#x4F60;&amp;#xFF0C;&amp;#x4F60;&amp;#x9700;&amp;#x8981;&amp;#x544A;&amp;#x8BC9;&amp;#x4ED6;&amp;#xFF0C;&amp;#x7ED9;&amp;#x5B9A;&amp;#x547D;&amp;#x4EE4;&amp;#x7684;&amp;#x957F;&amp;#x5EA6;&amp;#x957F;&amp;#x5EA6;&amp;#x4E3A; $ n $&amp;#xFF0C;&amp;#x6709;&amp;#x591A;&amp;#x5C11;&amp;#x79CD;&amp;#x4E0D;&amp;#x540C;&amp;#x7684;&amp;#x547D;&amp;#x4EE4;&amp;#x53EF;&amp;#x4EE5;&amp;#x662F;&amp;#x56FD;&amp;#x738B;&amp;#x53D1;&amp;#x51FA;&amp;#x7684;&amp;#x3002;&amp;#xFF08;&amp;#x4E5F;&amp;#x5C31;&amp;#x662F;&amp;#x6C42;&amp;#x957F;&amp;#x5EA6;&amp;#x4E3A; $ n $ &amp;#x7684;&amp;#x5408;&amp;#x683C;&amp;#x5B57;&amp;#x7B26;&amp;#x4E32;&amp;#x7684;&amp;#x4E2A;&amp;#x6570;&amp;#xFF09;&amp;#x5F53;&amp;#x7136;&amp;#xFF0C;&amp;#x56FD;&amp;#x738B;&amp;#x53EF;&amp;#x80FD;&amp;#x8BF4;&amp;#x51FA;&amp;#x4E00;&amp;#x53E5;&amp;#x8BDD;&amp;#x6CA1;&amp;#x6709;&amp;#x72AF;&amp;#x4EFB;&amp;#x4F55;&amp;#x53E3;&amp;#x5403;&amp;#xFF0C;&amp;#x5C31;&amp;#x50CF;&amp;#x4ED6;&amp;#x90A3;&amp;#x6B21;&amp;#x6F14;&amp;#x8BB2;&amp;#x4E00;&amp;#x6837;&amp;#x3002;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="BestCoder" scheme="https://blog.menci.moe/tag/bestcoder/"/>
    
      <category term="DP" scheme="https://blog.menci.moe/tag/dp/"/>
    
      <category term="HDU" scheme="https://blog.menci.moe/tag/hdu/"/>
    
      <category term="数位DP" scheme="https://blog.menci.moe/tag/%E6%95%B0%E4%BD%8Ddp/"/>
    
  </entry>
  
  <entry>
    <title>主席树学习笔记</title>
    <link href="https://blog.menci.moe/chairman-tree-notes/"/>
    <id>https://blog.menci.moe/chairman-tree-notes/</id>
    <published>2016-05-11T13:06:00.000Z</published>
    <updated>2016-05-11T13:06:44.900Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x4E3B;&amp;#x5E2D;&amp;#x6811;&amp;#x662F;&amp;#x4E00;&amp;#x79CD;&amp;#x6570;&amp;#x636E;&amp;#x7ED3;&amp;#x6784;&amp;#xFF0C;&amp;#x5176;&amp;#x4E3B;&amp;#x8981;&amp;#x5E94;&amp;#x7528;&amp;#x662F;&amp;#x533A;&amp;#x95F4;&amp;#x7B2C; $ k $ &amp;#x5927;&amp;#x95EE;&amp;#x9898;&amp;#x3002;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;&amp;#x6743;&amp;#x503C;&amp;#x7EBF;&amp;#x6BB5;&amp;#x6811;&quot;&gt;&amp;#x6743;&amp;#x503C;&amp;#x7EBF;&amp;#x6BB5;&amp;#x6811;&lt;/h3&gt;
&lt;p&gt;&amp;#x4F20;&amp;#x7EDF;&amp;#x7684;&amp;#x7EBF;&amp;#x6BB5;&amp;#x6811;&amp;#x7528;&amp;#x4E8E;&amp;#x7EF4;&amp;#x62A4;&amp;#x4E00;&amp;#x6761;&amp;#x7EBF;&amp;#x6BB5;&amp;#x4E0A;&amp;#x7684;&amp;#x533A;&amp;#x95F4;&amp;#xFF0C;&amp;#x53EF;&amp;#x4EE5;&amp;#x65B9;&amp;#x4FBF;&amp;#x5730;&amp;#x67E5;&amp;#x8BE2;&amp;#x533A;&amp;#x95F4;&amp;#x4FE1;&amp;#x606F;&amp;#x3002;&amp;#x800C;&amp;#x5982;&amp;#x679C;&amp;#x5C06;&amp;#x7EBF;&amp;#x6BB5;&amp;#x6811;&amp;#x8F6C;&amp;#x5316;&amp;#x4E3A;&amp;#x300E;&amp;#x6743;&amp;#x503C;&amp;#x7EBF;&amp;#x6BB5;&amp;#x6811;&amp;#x300F;&amp;#xFF0C;&amp;#x6BCF;&amp;#x4E2A;&amp;#x53F6;&amp;#x5B50;&amp;#x8282;&amp;#x70B9;&amp;#x5B58;&amp;#x50A8;&amp;#x67D0;&amp;#x4E2A;&amp;#x5143;&amp;#x7D20;&amp;#x51FA;&amp;#x73B0;&amp;#x6B21;&amp;#x6570;&amp;#xFF0C;&amp;#x4E00;&amp;#x6761;&amp;#x7EBF;&amp;#x6BB5;&amp;#x7684;&amp;#x603B;&amp;#x548C;&amp;#x8868;&amp;#x793A;&amp;#x533A;&amp;#x95F4;&amp;#x5185;&amp;#x6240;&amp;#x6709;&amp;#x6570;&amp;#x51FA;&amp;#x73B0;&amp;#x6B21;&amp;#x6570;&amp;#x7684;&amp;#x603B;&amp;#x548C;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x5229;&amp;#x7528;&amp;#x6743;&amp;#x503C;&amp;#x7EBF;&amp;#x6BB5;&amp;#x6811;&amp;#x53EF;&amp;#x4EE5;&amp;#x65B9;&amp;#x4FBF;&amp;#x5730;&amp;#x6C42;&amp;#x51FA;&amp;#x6574;&amp;#x4F53;&amp;#x7B2C; $ k $ &amp;#x5927; &amp;#x2014;&amp;#x2014; &amp;#x4ECE;&amp;#x6839;&amp;#x8282;&amp;#x70B9;&amp;#x5411;&amp;#x4E0B;&amp;#x8D70;&amp;#xFF0C;&amp;#x5982;&amp;#x679C; $ k $ &amp;#x5C0F;&amp;#x4E8E;&amp;#x7B49;&amp;#x4E8E;&amp;#x5DE6;&amp;#x5B50;&amp;#x6811;&amp;#x5927;&amp;#x5C0F;&amp;#xFF0C;&amp;#x8BF4;&amp;#x660E;&amp;#x7B2C; $ k $ &amp;#x5927;&amp;#x5728;&amp;#x5DE6;&amp;#x5B50;&amp;#x6811;&amp;#x7684;&amp;#x533A;&amp;#x95F4;&amp;#x4E2D;&amp;#xFF0C;&amp;#x5728;&amp;#x5DE6;&amp;#x5B50;&amp;#x6811;&amp;#x4E2D;&amp;#x7EE7;&amp;#x7EED;&amp;#x67E5;&amp;#x627E;&amp;#x5373;&amp;#x53EF;&amp;#xFF1B;&amp;#x5426;&amp;#x5219;&amp;#xFF0C;&amp;#x8BF4;&amp;#x660E;&amp;#x7B2C; $ k $ &amp;#x5927;&amp;#x5728;&amp;#x53F3;&amp;#x5B50;&amp;#x6811;&amp;#x7684;&amp;#x533A;&amp;#x95F4;&amp;#x4E2D;&amp;#xFF0C;&amp;#x6B64;&amp;#x65F6;&amp;#x5C06; $ k $ &amp;#x51CF;&amp;#x53BB;&amp;#x5DE6;&amp;#x5B50;&amp;#x6811;&amp;#x5927;&amp;#x5C0F;&amp;#xFF0C;&amp;#x5E76;&amp;#x5728;&amp;#x53F3;&amp;#x5B50;&amp;#x6811;&amp;#x4E2D;&amp;#x7EE7;&amp;#x7EED;&amp;#x67E5;&amp;#x627E;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x67E5;&amp;#x627E;&amp;#x8FC7;&amp;#x7A0B;&amp;#x7C7B;&amp;#x4F3C;&amp;#x5E73;&amp;#x8861;&amp;#x6811;&amp;#xFF0C;&amp;#x65F6;&amp;#x95F4;&amp;#x590D;&amp;#x6742;&amp;#x5EA6;&amp;#x4E3A; $ O(\log n) $&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x524D;&amp;#x7F00;&amp;#x548C;&quot;&gt;&amp;#x524D;&amp;#x7F00;&amp;#x548C;&lt;/h3&gt;
&lt;p&gt;&amp;#x4E0A;&amp;#x8FF0;&amp;#x7B97;&amp;#x6CD5;&amp;#x53EF;&amp;#x4EE5;&amp;#x7528;&amp;#x6765;&amp;#x5904;&amp;#x7406;&amp;#x6574;&amp;#x4E2A;&amp;#x5E8F;&amp;#x5217;&amp;#x4E0A;&amp;#x7684;&amp;#x7B2C; $ k $ &amp;#x5927;&amp;#xFF0C;&amp;#x800C;&amp;#x6211;&amp;#x4EEC;&amp;#x53EF;&amp;#x4EE5;&amp;#x5BF9;&amp;#x4E8E;&amp;#x4E00;&amp;#x4E2A;&amp;#x957F;&amp;#x5EA6;&amp;#x4E3A; $ n $ &amp;#x7684;&amp;#x5E8F;&amp;#x5217; $ a $ &amp;#x5EFA;&amp;#x7ACB; $ n $ &amp;#x68F5;&amp;#x4E0A;&amp;#x8FF0;&amp;#x7684;&amp;#x6743;&amp;#x503C;&amp;#x7EBF;&amp;#x6BB5;&amp;#x6811;&amp;#xFF0C;&amp;#x7B2C; $ i $ &amp;#x68F5;&amp;#x8868;&amp;#x793A;&amp;#x300E;$ a_1 $ ~ $ a_i $ &amp;#x7684;&amp;#x6240;&amp;#x6709;&amp;#x6570;&amp;#x300F;&amp;#x7EC4;&amp;#x6210;&amp;#x7684;&amp;#x6743;&amp;#x503C;&amp;#x7EBF;&amp;#x6BB5;&amp;#x6811;&amp;#x3002;&amp;#x5982;&amp;#x679C;&amp;#x8981;&amp;#x67E5;&amp;#x8BE2; $ [l, r] $ &amp;#x4E2D;&amp;#x7684;&amp;#x7B2C; $ k $ &amp;#x5927;&amp;#xFF0C;&amp;#x53EF;&amp;#x4EE5;&amp;#x4F7F;&amp;#x7528;&amp;#x7B2C; $ r $ &amp;#x68F5;&amp;#x7EBF;&amp;#x6BB5;&amp;#x6811;&amp;#x51CF;&amp;#x53BB;&amp;#x7B2C; $ l - 1 $ &amp;#x68F5;&amp;#x7EBF;&amp;#x6BB5;&amp;#x6811;&amp;#xFF0C;&amp;#x5F97;&amp;#x5230;&amp;#x6574;&amp;#x4E2A;&amp;#x533A;&amp;#x95F4;&amp;#x7EC4;&amp;#x6210;&amp;#x7684;&amp;#x6743;&amp;#x503C;&amp;#x7EBF;&amp;#x6BB5;&amp;#x6811;&amp;#xFF0C;&amp;#x5E76;&amp;#x8FDB;&amp;#x884C;&amp;#x4E0A;&amp;#x8FF0;&amp;#x7B97;&amp;#x6CD5;&amp;#x5F97;&amp;#x5230;&amp;#x533A;&amp;#x95F4;&amp;#x4E2D;&amp;#x7684;&amp;#x7B2C; $ k $ &amp;#x5927;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x8FD9;&amp;#x4E2A;&amp;#x7B97;&amp;#x6CD5;&amp;#x5B58;&amp;#x5728;&amp;#x4E24;&amp;#x4E2A;&amp;#x95EE;&amp;#x9898;&amp;#xFF1A;&lt;/p&gt;
&lt;ol style=&quot;list-style-type: decimal&quot;&gt;
&lt;li&gt;&amp;#x6BCF;&amp;#x4E2A;&amp;#x7EBF;&amp;#x6BB5;&amp;#x6811;&amp;#x8981;&amp;#x5360;&amp;#x7528; $ O(n \log n) $ &amp;#x7684;&amp;#x7A7A;&amp;#x95F4;&amp;#xFF0C;&amp;#x7B97;&amp;#x6CD5;&amp;#x7684;&amp;#x7A7A;&amp;#x95F4;&amp;#x590D;&amp;#x6742;&amp;#x5EA6;&amp;#x4E3A; $ O(n ^ 2 \log n) $&amp;#xFF0C;&amp;#x5360;&amp;#x7528;&amp;#x7A7A;&amp;#x95F4;&amp;#x8FC7;&amp;#x591A;&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x5EFA;&amp;#x7ACB;&amp;#x6BCF;&amp;#x68F5;&amp;#x7EBF;&amp;#x6BB5;&amp;#x6811;&amp;#x81F3;&amp;#x5C11;&amp;#x8981;&amp;#x7528; $ O(n \log n) $ &amp;#x7684;&amp;#x65F6;&amp;#x95F4;&amp;#xFF0C;&amp;#x6BCF;&amp;#x6B21;&amp;#x67E5;&amp;#x8BE2;&amp;#x53C8;&amp;#x8981;&amp;#x7528; $ O(n \log n) $ &amp;#x7684;&amp;#x65F6;&amp;#x95F4;&amp;#x6784;&amp;#x5EFA;&amp;#x533A;&amp;#x95F4;&amp;#x7684;&amp;#x6743;&amp;#x503C;&amp;#x7EBF;&amp;#x6BB5;&amp;#x6811;&amp;#xFF0C;&amp;#x603B;&amp;#x65F6;&amp;#x95F4;&amp;#x590D;&amp;#x6742;&amp;#x5EA6; $ O((n + m) n \log n) $&amp;#x3002;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&amp;#x770B;&amp;#x4E0A;&amp;#x53BB;&amp;#x8FD8;&amp;#x4E0D;&amp;#x5982;&lt;strong&gt;&amp;#x6BCF;&amp;#x6B21;&amp;#x76F4;&amp;#x63A5;&amp;#x63D0;&amp;#x53D6;&amp;#x51FA;&amp;#x533A;&amp;#x95F4;&amp;#xFF0C;&amp;#x5E76;&amp;#x4F7F;&amp;#x7528;&amp;#x540E;&amp;#x7EBF;&amp;#x6027;&amp;#x9009;&amp;#x62E9;&amp;#x5F97;&amp;#x5230;&amp;#x7B54;&amp;#x6848;&lt;/strong&gt;&amp;#x7684; $ O(n ^ 2) $ &amp;#x7684;&amp;#x6734;&amp;#x7D20;&amp;#x7B97;&amp;#x6CD5;&amp;#x4F18;&amp;#x79C0;&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x4E3B;&amp;#x5E2D;&amp;#x6811;&quot;&gt;&amp;#x4E3B;&amp;#x5E2D;&amp;#x6811;&lt;/h3&gt;
&lt;p&gt;&amp;#x4ED4;&amp;#x7EC6;&amp;#x601D;&amp;#x8003;&amp;#xFF0C;&amp;#x53D1;&amp;#x73B0;&amp;#x4E0A;&amp;#x8FF0;&amp;#x7B97;&amp;#x6CD5;&amp;#x7684; $ n $ &amp;#x68F5;&amp;#x7EBF;&amp;#x6BB5;&amp;#x6811;&amp;#x4E2D;&amp;#xFF0C;&amp;#x76F8;&amp;#x90BB;&amp;#x7684;&amp;#x4E24;&amp;#x68F5;&amp;#x7EBF;&amp;#x6BB5;&amp;#x6811;&amp;#x4EC5;&amp;#x6709; $ O(\log n) $ &amp;#x4E2A;&amp;#x8282;&amp;#x70B9;&amp;#x4E0D;&amp;#x540C;&amp;#xFF0C;&amp;#x56E0;&amp;#x6B64;&amp;#x672C;&amp;#x8D28;&amp;#x4E0D;&amp;#x540C;&amp;#x7684;&amp;#x8282;&amp;#x70B9;&amp;#x53EA;&amp;#x6709; $ O(n \log n) $ &amp;#x4E2A;&amp;#x3002;&amp;#x6211;&amp;#x4EEC;&amp;#x53EF;&amp;#x4EE5;&amp;#x5145;&amp;#x5206;&amp;#x5229;&amp;#x7528;&amp;#x8FD9;&amp;#x4E00;&amp;#x7279;&amp;#x70B9;&amp;#xFF0C;&amp;#x6BCF;&amp;#x6B21;&amp;#x53EA;&amp;#x91CD;&amp;#x65B0;&amp;#x521B;&amp;#x5EFA;&amp;#x4E0E;&amp;#x4E0A;&amp;#x6B21;&amp;#x6240;&amp;#x4E0D;&amp;#x540C;&amp;#x7684;&amp;#x8282;&amp;#x70B9;&amp;#xFF0C;&amp;#x76F8;&amp;#x540C;&amp;#x7684;&amp;#x8282;&amp;#x70B9;&amp;#x76F4;&amp;#x63A5;&amp;#x4F7F;&amp;#x7528;&amp;#x524D;&amp;#x4E00;&amp;#x68F5;&amp;#x7684;&amp;#x5373;&amp;#x53EF;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x4E3A;&amp;#x4E86;&amp;#x8282;&amp;#x7701;&amp;#x7A7A;&amp;#x95F4;&amp;#xFF0C;&amp;#x53EF;&amp;#x4EE5;&amp;#x5C06;&amp;#x7B2C; $ 0 $ &amp;#x68F5;&amp;#x7EBF;&amp;#x6BB5;&amp;#x6811;&amp;#x7F6E;&amp;#x4E3A;&amp;#x7A7A;&amp;#xFF0C;&amp;#x6BCF;&amp;#x6B21;&amp;#x63D2;&amp;#x5165;&amp;#x4E00;&amp;#x4E2A;&amp;#x65B0;&amp;#x53F6;&amp;#x5B50;&amp;#x8282;&amp;#x70B9;&amp;#x65F6;&amp;#x63A5;&amp;#x5165;&amp;#x4E00;&amp;#x6761;&amp;#x957F;&amp;#x5EA6;&amp;#x4E3A; $ O(\log n) $ &amp;#x7684;&amp;#x94FE;&amp;#x3002;&amp;#x603B;&amp;#x7A7A;&amp;#x95F4;&amp;#x3001;&amp;#x65F6;&amp;#x95F4;&amp;#x590D;&amp;#x6742;&amp;#x5EA6;&amp;#x4ECD;&amp;#x4E3A; $ O(n \log n) $&lt;/p&gt;
&lt;p&gt;&amp;#x67E5;&amp;#x8BE2;&amp;#x65F6;&amp;#x6784;&amp;#x9020;&amp;#x6574;&amp;#x68F5;&amp;#x7EBF;&amp;#x6BB5;&amp;#x6811;&amp;#xFF0C;&amp;#x9700;&amp;#x8981;&amp;#x6784;&amp;#x9020; $ O(n \log n) $ &amp;#x4E2A;&amp;#x8282;&amp;#x70B9;&amp;#xFF0C;&amp;#x4F46;&amp;#x6BCF;&amp;#x6B21;&amp;#x67E5;&amp;#x8BE2;&amp;#x53EA;&amp;#x4F1A;&amp;#x7528;&amp;#x5230; $ O(\log n) $ &amp;#x4E2A;&amp;#x8282;&amp;#x70B9;&amp;#xFF0C;&amp;#x76F4;&amp;#x63A5;&amp;#x52A8;&amp;#x6001;&amp;#x6784;&amp;#x9020;&amp;#x8FD9;&amp;#x4E9B;&amp;#x8282;&amp;#x70B9;&amp;#x5373;&amp;#x53EF;&amp;#x3002;&amp;#x4E3A;&amp;#x4E86;&amp;#x65B9;&amp;#x4FBF;&amp;#xFF0C;&amp;#x53EF;&amp;#x4EE5;&amp;#x4E0D;&amp;#x663E;&amp;#x5F0F;&amp;#x6784;&amp;#x9020;&amp;#x8FD9;&amp;#x4E9B;&amp;#x8282;&amp;#x70B9;&amp;#xFF0C;&amp;#x800C;&amp;#x662F;&amp;#x76F4;&amp;#x63A5;&amp;#x7528;&amp;#x4E24;&amp;#x68F5;&amp;#x7EBF;&amp;#x6BB5;&amp;#x6811;&amp;#x4E0A;&amp;#x7684;&amp;#x503C;&amp;#x76F8;&amp;#x51CF;&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x6A21;&amp;#x677F;&quot;&gt;&amp;#x6A21;&amp;#x677F;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://poj.org/problem?id=2104&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;POJ 2104&lt;/a&gt;&lt;br&gt;
&amp;#x52A8;&amp;#x6001;&amp;#x5206;&amp;#x914D;&amp;#x5185;&amp;#x5B58;&amp;#x4F1A;&amp;#x8D85;&amp;#x65F6;&amp;#xFF0C;&amp;#x9700;&amp;#x8981;&amp;#x9759;&amp;#x6001;&amp;#x5206;&amp;#x914D;&amp;#x5185;&amp;#x5B58;&amp;#x3002;&lt;/p&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;93&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;94&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;95&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;96&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;97&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;98&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;99&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;100&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;101&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;102&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;climits&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;algorithm&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;new&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXN = &lt;span class=&quot;number&quot;&gt;100000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXM = &lt;span class=&quot;number&quot;&gt;5000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;template&lt;/span&gt; &amp;lt;&lt;span class=&quot;keyword&quot;&gt;size_t&lt;/span&gt; SIZE&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; MemoryPool {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt; buf[SIZE], *cur;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    MemoryPool() : cur(buf) {}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; *&lt;span class=&quot;title&quot;&gt;alloc&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; size)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (cur == buf + SIZE) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;malloc&lt;/span&gt;(size);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt; *p = cur;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            cur += size;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; p;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;};&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;MemoryPool&amp;lt;(&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt; + &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt; + &lt;span class=&quot;number&quot;&gt;8&lt;/span&gt; + &lt;span class=&quot;number&quot;&gt;8&lt;/span&gt; + &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;) * MAXN * &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;&amp;gt; pool;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; ChairmanTree {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Node {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; l, r;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Node *lc, *rc;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; cnt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Node(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; l, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; r, Node *lc = &lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;, Node *rc = &lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;) : l(l), r(r), lc(lc), rc(rc), cnt((lc ? lc-&amp;gt;cnt : &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) + (rc ? rc-&amp;gt;cnt : &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;)) {}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Node(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; l, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; r, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; cnt) : l(l), r(r), lc(&lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;), rc(&lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;), cnt(cnt) {}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;pushDown&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (lc &amp;amp;&amp;amp; rc) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; mid = l + ((r - l) &amp;gt;&amp;gt; &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!lc) lc = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; (pool.alloc(&lt;span class=&quot;keyword&quot;&gt;sizeof&lt;/span&gt;(Node))) Node(l, mid);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!rc) rc = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; (pool.alloc(&lt;span class=&quot;keyword&quot;&gt;sizeof&lt;/span&gt;(Node))) Node(mid + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, r);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;function&quot;&gt;Node *&lt;span class=&quot;title&quot;&gt;insert&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; num)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (num &amp;lt; l || num &amp;gt; r) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (num == l &amp;amp;&amp;amp; num == r) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; (pool.alloc(&lt;span class=&quot;keyword&quot;&gt;sizeof&lt;/span&gt;(Node))) Node(l, r, &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;cnt + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; mid = l + ((r - l) &amp;gt;&amp;gt; &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                pushDown();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (num &amp;lt;= mid) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; (pool.alloc(&lt;span class=&quot;keyword&quot;&gt;sizeof&lt;/span&gt;(Node))) Node(l, r, lc-&amp;gt;insert(num), rc);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; (pool.alloc(&lt;span class=&quot;keyword&quot;&gt;sizeof&lt;/span&gt;(Node))) Node(l, r, lc, rc-&amp;gt;insert(num));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;rank&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; lc ? lc-&amp;gt;cnt : &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    } *root[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; a[], &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;n = n;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        root[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;] = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; (pool.alloc(&lt;span class=&quot;keyword&quot;&gt;sizeof&lt;/span&gt;(Node))) Node(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            root[i] = root[i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]-&amp;gt;insert(a[i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; l, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; r, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; k)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Node *L = root[l - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;], *R = root[r];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; min = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, max = n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (min != max) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            L-&amp;gt;pushDown(), R-&amp;gt;pushDown();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; mid = min + ((max - min) &amp;gt;&amp;gt; &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;), t = R-&amp;gt;rank() - L-&amp;gt;rank();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (k &amp;lt;= t) L = L-&amp;gt;lc, R = R-&amp;gt;lc, max = mid;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; k -= t, L = L-&amp;gt;rc, R = R-&amp;gt;rc, min = mid + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; min;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} t;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, m, a[MAXN];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d&amp;quot;&lt;/span&gt;, &amp;amp;n, &amp;amp;m);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;a[i]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt;[MAXN];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::copy(a, a + n, &lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::sort(&lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt; + n);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; *end = &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::unique(&lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt; + n);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) a[i] = &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::lower_bound(&lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt;, end, a[i]) - &lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    t.build(a, n);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; m; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; l, r, k;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d %d&amp;quot;&lt;/span&gt;, &amp;amp;l, &amp;amp;r, &amp;amp;k);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; ans = t.query(l, r, k);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d\n&amp;quot;&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt;[ans]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x4E3B;&amp;#x5E2D;&amp;#x6811;&amp;#x662F;&amp;#x4E00;&amp;#x79CD;&amp;#x6570;&amp;#x636E;&amp;#x7ED3;&amp;#x6784;&amp;#xFF0C;&amp;#x5176;&amp;#x4E3B;&amp;#x8981;&amp;#x5E94;&amp;#x7528;&amp;#x662F;&amp;#x533A;&amp;#x95F4;&amp;#x7B2C; $ k $ &amp;#x5927;&amp;#x95EE;&amp;#x9898;&amp;#x3002;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="主席树" scheme="https://blog.menci.moe/tag/%E4%B8%BB%E5%B8%AD%E6%A0%91/"/>
    
      <category term="学习笔记" scheme="https://blog.menci.moe/tag/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
      <category term="数据结构" scheme="https://blog.menci.moe/tag/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
      <category term="算法模板" scheme="https://blog.menci.moe/tag/%E7%AE%97%E6%B3%95%E6%A8%A1%E6%9D%BF/"/>
    
  </entry>
  
  <entry>
    <title>「HNOI2016」树 - 最近公共祖先 + 主席树</title>
    <link href="https://blog.menci.moe/hnoi2016-tree/"/>
    <id>https://blog.menci.moe/hnoi2016-tree/</id>
    <published>2016-05-11T09:28:00.000Z</published>
    <updated>2016-05-11T09:39:38.920Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x5C0F; A &amp;#x60F3;&amp;#x505A;&amp;#x4E00;&amp;#x68F5;&amp;#x5F88;&amp;#x5927;&amp;#x7684;&amp;#x6811;&amp;#xFF0C;&amp;#x4F46;&amp;#x662F;&amp;#x4ED6;&amp;#x624B;&amp;#x4E0A;&amp;#x7684;&amp;#x6750;&amp;#x6599;&amp;#x6709;&amp;#x9650;&amp;#xFF0C;&amp;#x53EA;&amp;#x597D;&amp;#x7528;&amp;#x70B9;&amp;#x5C0F;&amp;#x6280;&amp;#x5DE7;&amp;#x4E86;&amp;#x3002;&amp;#x5F00;&amp;#x59CB;&amp;#xFF0C;&amp;#x5C0F; A &amp;#x53EA;&amp;#x6709;&amp;#x4E00;&amp;#x68F5;&amp;#x7ED3;&amp;#x70B9;&amp;#x6570;&amp;#x4E3A; $ N $ &amp;#x7684;&amp;#x6811;&amp;#xFF0C;&amp;#x7ED3;&amp;#x70B9;&amp;#x7684;&amp;#x7F16;&amp;#x53F7;&amp;#x4E3A; $ 1,\ 2,\ \dots,\ N $&amp;#xFF0C;&amp;#x5176;&amp;#x4E2D;&amp;#x7ED3;&amp;#x70B9; $ 1 $ &amp;#x4E3A;&amp;#x6839;&amp;#xFF1B;&amp;#x6211;&amp;#x4EEC;&amp;#x79F0;&amp;#x8FD9;&amp;#x9897;&amp;#x6811;&amp;#x4E3A;&amp;#x6A21;&amp;#x677F;&amp;#x6811;&amp;#x3002;&amp;#x5C0F; A &amp;#x51B3;&amp;#x5B9A;&amp;#x901A;&amp;#x8FC7;&amp;#x8FD9;&amp;#x68F5;&amp;#x6A21;&amp;#x677F;&amp;#x6811;&amp;#x6765;&amp;#x6784;&amp;#x5EFA;&amp;#x4E00;&amp;#x9897;&amp;#x5927;&amp;#x6811;&amp;#x3002;&amp;#x6784;&amp;#x5EFA;&amp;#x8FC7;&amp;#x7A0B;&amp;#x5982;&amp;#x4E0B;&amp;#xFF1A;&lt;/p&gt;
&lt;ol style=&quot;list-style-type: decimal&quot;&gt;
&lt;li&gt;&amp;#x5C06;&amp;#x6A21;&amp;#x677F;&amp;#x6811;&amp;#x590D;&amp;#x5236;&amp;#x4E3A;&amp;#x521D;&amp;#x59CB;&amp;#x7684;&amp;#x5927;&amp;#x6811;&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x4EE5;&amp;#x4E0B; 3&amp;#xFF0C;4&amp;#xFF0C;5 &amp;#x6B65;&amp;#x5FAA;&amp;#x73AF;&amp;#x6267;&amp;#x884C; $ M $ &amp;#x6B21;&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x9009;&amp;#x62E9;&amp;#x4E24;&amp;#x4E2A;&amp;#x6570;&amp;#x5B57; $ a,\ b $&amp;#xFF0C;&amp;#x5176;&amp;#x4E2D; $ 1 \leq a \leq N $&amp;#xFF0C;$ 1 \leq b \leq &amp;#x5F53;&amp;#x524D;&amp;#x5927;&amp;#x6811;&amp;#x7684;&amp;#x7ED3;&amp;#x70B9;&amp;#x6570; $&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x5C06;&amp;#x6A21;&amp;#x677F;&amp;#x6811;&amp;#x4E2D;&amp;#x4EE5;&amp;#x7ED3;&amp;#x70B9; $ a $ &amp;#x4E3A;&amp;#x6839;&amp;#x7684;&amp;#x5B50;&amp;#x6811;&amp;#x590D;&amp;#x5236;&amp;#x4E00;&amp;#x904D;&amp;#xFF0C;&amp;#x6302;&amp;#x5230;&amp;#x5927;&amp;#x6811;&amp;#x4E2D;&amp;#x7ED3;&amp;#x70B9; $ b $ &amp;#x7684;&amp;#x4E0B;&amp;#x65B9;&amp;#xFF08;&amp;#x4E5F;&amp;#x5C31;&amp;#x662F;&amp;#x8BF4;&amp;#xFF0C;&amp;#x6A21;&amp;#x677F;&amp;#x6811;&amp;#x4E2D;&amp;#x7684;&amp;#x7ED3;&amp;#x70B9; $ a $ &amp;#x4E3A;&amp;#x6839;&amp;#x7684;&amp;#x5B50;&amp;#x6811;&amp;#x590D;&amp;#x5236;&amp;#x5230;&amp;#x5927;&amp;#x6811;&amp;#x4E2D;&amp;#x540E;&amp;#xFF0C;&amp;#x5C06;&amp;#x6210;&amp;#x4E3A;&amp;#x5927;&amp;#x6811;&amp;#x4E2D;&amp;#x7ED3;&amp;#x70B9; $ b $ &amp;#x7684;&amp;#x5B50;&amp;#x6811;)&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x5C06;&amp;#x65B0;&amp;#x52A0;&amp;#x5165;&amp;#x5927;&amp;#x6811;&amp;#x7684;&amp;#x7ED3;&amp;#x70B9;&amp;#x6309;&amp;#x7167;&amp;#x5728;&amp;#x6A21;&amp;#x677F;&amp;#x6811;&amp;#x4E2D;&amp;#x7F16;&amp;#x53F7;&amp;#x7684;&amp;#x987A;&amp;#x5E8F;&amp;#x91CD;&amp;#x65B0;&amp;#x7F16;&amp;#x53F7;&amp;#x3002;&amp;#x4F8B;&amp;#x5982;&amp;#xFF0C;&amp;#x5047;&amp;#x8BBE;&amp;#x5728;&amp;#x8FDB;&amp;#x884C; 4 &amp;#x6B65;&amp;#x4E4B;&amp;#x524D;&amp;#x5927;&amp;#x6811;&amp;#x6709; $ L $ &amp;#x4E2A;&amp;#x7ED3;&amp;#x70B9;&amp;#xFF0C;&amp;#x6A21;&amp;#x677F;&amp;#x6811;&amp;#x4E2D;&amp;#x4EE5; $ a $ &amp;#x4E3A;&amp;#x6839;&amp;#x7684;&amp;#x5B50;&amp;#x6811;&amp;#x5171;&amp;#x6709; $ C $ &amp;#x4E2A;&amp;#x7ED3;&amp;#x70B9;&amp;#xFF0C;&amp;#x90A3;&amp;#x4E48;&amp;#x65B0;&amp;#x52A0;&amp;#x5165;&amp;#x6A21;&amp;#x677F;&amp;#x6811;&amp;#x7684; $ C $ &amp;#x4E2A;&amp;#x7ED3;&amp;#x70B9;&amp;#x5728;&amp;#x5927;&amp;#x6811;&amp;#x4E2D;&amp;#x7684;&amp;#x7F16;&amp;#x53F7;&amp;#x5C06;&amp;#x662F; $ L + 1,\ L + 2,\ \dots,\ L + C $&amp;#xFF1B;&amp;#x5927;&amp;#x6811;&amp;#x4E2D;&amp;#x8FD9; $ C $ &amp;#x4E2A;&amp;#x7ED3;&amp;#x70B9;&amp;#x7F16;&amp;#x53F7;&amp;#x7684;&amp;#x5927;&amp;#x5C0F;&amp;#x987A;&amp;#x5E8F;&amp;#x548C;&amp;#x6A21;&amp;#x677F;&amp;#x6811;&amp;#x4E2D;&amp;#x5BF9;&amp;#x5E94;&amp;#x7684; $ C $ &amp;#x4E2A;&amp;#x7ED3;&amp;#x70B9;&amp;#x7684;&amp;#x5927;&amp;#x5C0F;&amp;#x987A;&amp;#x5E8F;&amp;#x662F;&amp;#x4E00;&amp;#x81F4;&amp;#x7684;&amp;#x3002;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&amp;#x73B0;&amp;#x5728;&amp;#x4ED6;&amp;#x60F3;&amp;#x95EE;&amp;#x4F60;&amp;#xFF0C;&amp;#x6811;&amp;#x4E2D;&amp;#x4E00;&amp;#x4E9B;&amp;#x7ED3;&amp;#x70B9;&amp;#x5BF9;&amp;#x7684;&amp;#x8DDD;&amp;#x79BB;&amp;#x662F;&amp;#x591A;&amp;#x5C11;&amp;#x3002;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;&amp;#x94FE;&amp;#x63A5;&quot;&gt;&amp;#x94FE;&amp;#x63A5;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://www.lydsy.com/JudgeOnline/problem.php?id=4539&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;BZOJ 4539&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://cogs.top/cogs/problem/problem.php?pid=2052&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;COGS 2052&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x9898;&amp;#x89E3;&quot;&gt;&amp;#x9898;&amp;#x89E3;&lt;/h3&gt;
&lt;p&gt;&amp;#x5728;&amp;#x65B0;&amp;#x6811;&amp;#x4E2D;&amp;#x7528;&amp;#x4E00;&amp;#x4E2A;&amp;#x8282;&amp;#x70B9;&amp;#x4EE3;&amp;#x8868;&amp;#x6A21;&amp;#x677F;&amp;#x6811;&amp;#x4E2D;&amp;#x7684;&amp;#x4E00;&amp;#x68F5;&amp;#x5B50;&amp;#x6811;&amp;#xFF0C;&amp;#x5B58;&amp;#x50A8;&amp;#x6BCF;&amp;#x4E2A;&amp;#x8282;&amp;#x70B9;&amp;#x5728;&amp;#x6A21;&amp;#x677F;&amp;#x6811;&amp;#x4E2D;&amp;#x7684;&amp;#x6839;&amp;#xFF0C;&amp;#x5176;&amp;#x771F;&amp;#x5B9E;&amp;#x7236;&amp;#x8282;&amp;#x70B9;&amp;#x5728;&amp;#x6A21;&amp;#x677F;&amp;#x6811;&amp;#x4E2D;&amp;#x7684;&amp;#x8282;&amp;#x70B9;&amp;#xFF0C;&amp;#x8FB9;&amp;#x8BBE;&amp;#x7F6E;&amp;#x4E3A;&amp;#x65B0;&amp;#x8282;&amp;#x70B9;&amp;#x5230;&amp;#x5176;&amp;#x65B0;&amp;#x6811;&amp;#x4E2D;&amp;#x7236;&amp;#x8282;&amp;#x70B9;&amp;#x7684;&amp;#x6839;&amp;#x8282;&amp;#x70B9;&amp;#x7684;&amp;#x8DDD;&amp;#x79BB;&amp;#x3002;&amp;#x5BF9;&amp;#x65B0;&amp;#x6811;&amp;#x548C;&amp;#x6A21;&amp;#x677F;&amp;#x6811;&amp;#x5206;&amp;#x522B;&amp;#x8FDB;&amp;#x884C;&amp;#x6811;&amp;#x94FE;&amp;#x5256;&amp;#x5206;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x9700;&amp;#x8981;&amp;#x4ECE;&amp;#x7F16;&amp;#x53F7;&amp;#x6C42;&amp;#x51FA;&amp;#x5728;&amp;#x65B0;&amp;#x6811;&amp;#x4E2D;&amp;#x7684;&amp;#x8282;&amp;#x70B9;&amp;#x65F6;&amp;#xFF0C;&amp;#x8BB0;&amp;#x5F55;&amp;#x65B0;&amp;#x6811;&amp;#x4E2D;&amp;#x6BCF;&amp;#x4E2A;&amp;#x8282;&amp;#x70B9;&amp;#x4EE3;&amp;#x8868;&amp;#x7684;&amp;#x533A;&amp;#x95F4;&amp;#xFF0C;&amp;#x8FDB;&amp;#x884C;&amp;#x4E8C;&amp;#x5206;&amp;#x67E5;&amp;#x627E;&amp;#x3002;&amp;#x9700;&amp;#x8981;&amp;#x6C42;&amp;#x51FA;&amp;#x6A21;&amp;#x677F;&amp;#x6811;&amp;#x4E2D;&amp;#x7684;&amp;#x8282;&amp;#x70B9;&amp;#x65F6;&amp;#xFF0C;&amp;#x5148;&amp;#x6C42;&amp;#x51FA;&amp;#x5728;&amp;#x533A;&amp;#x95F4;&amp;#x5185;&amp;#x7684;&amp;#x7F16;&amp;#x53F7;&amp;#xFF0C;&amp;#x518D;&amp;#x505A;&amp;#x533A;&amp;#x95F4;&amp;#x7B2C; $ k $ &amp;#x5927;&amp;#x67E5;&amp;#x8BE2;&amp;#xFF0C;&amp;#x4F7F;&amp;#x7528;&amp;#x4E3B;&amp;#x5E2D;&amp;#x6811;&amp;#x5373;&amp;#x53EF;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x6C42;&amp;#x8DDD;&amp;#x79BB;&amp;#x65F6;&amp;#xFF0C;&amp;#x5206;&amp;#x4E09;&amp;#x79CD;&amp;#x60C5;&amp;#x51B5;&amp;#x8BA8;&amp;#x8BBA;&amp;#xFF1A;&lt;/p&gt;
&lt;ol style=&quot;list-style-type: decimal&quot;&gt;
&lt;li&gt;&amp;#x4E24;&amp;#x4E2A;&amp;#x70B9;&amp;#x5728;&amp;#x65B0;&amp;#x6811;&amp;#x4E2D;&amp;#x7684;&amp;#x7EDF;&amp;#x4E00;&amp;#x8282;&amp;#x70B9;&amp;#x5185;&amp;#xFF0C;&amp;#x76F4;&amp;#x63A5;&amp;#x5728;&amp;#x6A21;&amp;#x677F;&amp;#x6811;&amp;#x4E2D;&amp;#x627E;&amp;#x6700;&amp;#x8FD1;&amp;#x516C;&amp;#x5171;&amp;#x79DF;&amp;#x5148;&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x4E24;&amp;#x4E2A;&amp;#x70B9;&amp;#x5728;&amp;#x65B0;&amp;#x6811;&amp;#x4E2D;&amp;#x7684;&amp;#x8282;&amp;#x70B9;&amp;#x7684;&amp;#x7684;&amp;#x6700;&amp;#x8FD1;&amp;#x516C;&amp;#x5171;&amp;#x79DF;&amp;#x5148;&amp;#x4E3A;&amp;#x5176;&amp;#x4E2D;&amp;#x4E00;&amp;#x4E2A;&amp;#x8282;&amp;#x70B9;&amp;#xFF0C;&amp;#x5206;&amp;#x522B;&amp;#x6C42;&amp;#x51FA;&amp;#x591A;&amp;#x6BB5;&amp;#x8DDD;&amp;#x79BB;&amp;#x76F8;&amp;#x52A0;&amp;#x51CF;&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x5176;&amp;#x4ED6;&amp;#x60C5;&amp;#x51B5;&amp;#xFF0C;&amp;#x6BD4;&amp;#x60C5;&amp;#x51B5; 2 &amp;#x590D;&amp;#x6742;&amp;#x4E00;&amp;#x4E9B;&amp;#xFF0C;&amp;#x65B9;&amp;#x6CD5;&amp;#x7C7B;&amp;#x4F3C;&amp;#x3002;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&amp;#x603B;&amp;#x65F6;&amp;#x95F4;&amp;#x590D;&amp;#x6742;&amp;#x5EA6;&amp;#x4E3A; $ O((m + q) \log n) $&amp;#xFF0C;&amp;#x5177;&amp;#x4F53;&amp;#x5B9E;&amp;#x73B0;&amp;#x7EC6;&amp;#x8282;&amp;#x89C1;&amp;#x4EE3;&amp;#x7801;&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x4EE3;&amp;#x7801;&quot;&gt;&amp;#x4EE3;&amp;#x7801;&lt;/h3&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;93&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;94&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;95&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;96&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;97&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;98&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;99&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;100&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;101&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;102&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;103&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;104&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;105&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;106&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;107&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;108&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;109&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;110&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;111&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;112&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;113&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;114&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;115&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;116&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;117&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;118&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;119&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;120&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;121&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;122&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;123&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;124&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;125&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;126&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;127&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;128&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;129&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;130&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;131&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;132&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;133&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;134&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;135&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;136&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;137&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;138&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;139&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;140&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;141&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;142&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;143&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;144&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;145&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;146&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;147&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;148&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;149&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;150&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;151&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;152&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;153&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;154&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;155&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;156&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;157&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;158&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;159&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;160&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;161&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;162&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;163&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;164&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;165&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;166&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;167&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;168&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;169&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;170&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;171&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;172&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;173&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;174&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;175&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;176&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;177&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;178&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;179&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;180&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;181&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;182&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;183&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;184&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;185&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;186&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;187&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;188&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;189&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;190&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;191&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;192&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;193&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;194&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;195&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;196&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;197&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;198&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;199&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;200&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;201&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;202&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;203&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;204&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;205&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;206&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;207&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;208&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;209&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;210&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;211&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;212&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;213&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;214&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;215&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;216&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;217&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;218&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;219&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;220&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;221&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;222&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;223&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;224&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;225&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;226&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;227&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;228&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;229&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;230&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;231&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;232&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;233&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;234&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;235&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;236&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;237&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;238&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;239&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;240&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;241&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;242&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;243&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;244&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;245&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;246&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;247&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;248&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;249&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;250&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;251&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;252&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;253&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;254&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;255&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;256&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;257&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;258&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;259&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;260&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;261&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;262&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;263&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;264&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;265&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;266&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;267&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;268&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;269&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;270&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;271&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;272&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;273&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;274&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;275&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;276&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;277&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;278&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;279&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;280&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;281&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;282&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;283&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;284&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;285&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;286&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;287&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;288&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;289&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;290&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;291&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;292&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;293&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;294&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;295&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;296&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;297&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;298&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;299&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;300&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;301&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;302&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;303&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;304&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;305&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;306&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;307&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;308&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;309&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;310&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;311&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;312&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;313&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;314&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;315&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;316&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;317&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;318&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;319&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;320&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;321&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;322&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;323&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;climits&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;stack&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;algorithm&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXN = &lt;span class=&quot;number&quot;&gt;100000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXM = &lt;span class=&quot;number&quot;&gt;100000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXQ = &lt;span class=&quot;number&quot;&gt;100000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Range {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; l, r;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Range(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; l = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; r = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) : l(l), r(r) {}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;};&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Node;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; TemplateTreeNode;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; TargetTreeNode;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Node {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; id, depth, size, pos, posEnd;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; dist;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Node *parent, *child, *top;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; visited;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;};&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;template&lt;/span&gt; &amp;lt;&lt;span class=&quot;keyword&quot;&gt;typename&lt;/span&gt; T&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Edge {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    T *s, *t;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; w;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Edge&amp;lt;T&amp;gt; *next;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Edge(T *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; s, T *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; t, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; w) : s(s), t(t), w(w), next(s-&amp;gt;e) {}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;};&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; TemplateTreeNode : &lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; Node {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Edge&amp;lt;TemplateTreeNode&amp;gt; *e;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} templateTree[MAXN];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; TargetTreeNode : &lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; Node {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Edge&amp;lt;TargetTreeNode&amp;gt; *e;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    TemplateTreeNode *rootInTemplateTree, *parentInTemplateTree;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Range idRange;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;friend&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;operator&lt;/span&gt;&amp;lt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; TargetTreeNode &amp;amp;v, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; x) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; v.idRange.r &amp;lt; x;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} targetTree[MAXM + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; ChairmanTree {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; SegmentTree {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; l, r, mid;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        SegmentTree *lc, *rc;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; cnt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        SegmentTree(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; l, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; r, SegmentTree *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; lc = &lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;, SegmentTree *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; rc = &lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;) : l(l), r(r), mid(l + ((r - l) &amp;gt;&amp;gt; &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)), lc(lc), rc(rc), cnt((lc ? lc-&amp;gt;cnt : &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) + (rc ? rc-&amp;gt;cnt : &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;)) {}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        SegmentTree(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; l, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; r, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; cnt) : l(l), r(r), lc(&lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;), rc(&lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;), cnt(cnt) {}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;pushDown&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!lc) lc = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; SegmentTree(l, mid);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!rc) rc = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; SegmentTree(mid + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, r);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;function&quot;&gt;SegmentTree *&lt;span class=&quot;title&quot;&gt;insert&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; num)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (num &amp;lt; l || num &amp;gt; r) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (num == l &amp;amp;&amp;amp; num == r) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; SegmentTree(l, r, cnt + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                pushDown();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (num &amp;lt;= mid) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; SegmentTree(l, r, lc-&amp;gt;insert(num), rc);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; SegmentTree(l, r, lc, rc-&amp;gt;insert(num));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;rank&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; lc ? lc-&amp;gt;cnt : &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    } *root[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; *a, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;n = n;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        root[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;] = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; SegmentTree(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= n; i++) root[i] = root[i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]-&amp;gt;insert(a[i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; l, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; r, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; k)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        SegmentTree *L = root[l - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;], *R = root[r];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; min = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, max = n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (min != max) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            L-&amp;gt;pushDown(), R-&amp;gt;pushDown();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; mid = min + ((max - min) &amp;gt;&amp;gt; &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;), t = R-&amp;gt;rank() - L-&amp;gt;rank();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (k &amp;lt;= t) L = L-&amp;gt;lc, R = R-&amp;gt;lc, max = mid;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; k -= t, L = L-&amp;gt;rc, R = R-&amp;gt;rc, min = mid + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; min;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} chairmanTree;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, m, q, dfsSequence[MAXN];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; cnt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;template&lt;/span&gt; &amp;lt;&lt;span class=&quot;keyword&quot;&gt;typename&lt;/span&gt; T&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;addEdge&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(T *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; N, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; u, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; v, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; w)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    N[u].e = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Edge&amp;lt;T&amp;gt;(&amp;amp;N[u], &amp;amp;N[v], w);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    N[v].e = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Edge&amp;lt;T&amp;gt;(&amp;amp;N[v], &amp;amp;N[u], w);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;template&lt;/span&gt; &amp;lt;&lt;span class=&quot;keyword&quot;&gt;typename&lt;/span&gt; T&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;cut&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(T *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; N, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;stack&lt;/span&gt;&amp;lt;T *&amp;gt; s;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    s.push(&amp;amp;N[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    N[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;].depth = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    N[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;].dist = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (!s.empty()) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        T *v = s.top();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!v-&amp;gt;visited) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            v-&amp;gt;visited = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (Edge&amp;lt;T&amp;gt; *e = v-&amp;gt;e; e; e = e-&amp;gt;next) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!e-&amp;gt;t-&amp;gt;depth) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    e-&amp;gt;t-&amp;gt;depth = v-&amp;gt;depth + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    e-&amp;gt;t-&amp;gt;dist = v-&amp;gt;dist + e-&amp;gt;w;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    e-&amp;gt;t-&amp;gt;parent = v;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    s.push(e-&amp;gt;t);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        } &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            v-&amp;gt;size = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (Edge&amp;lt;T&amp;gt; *e = v-&amp;gt;e; e; e = e-&amp;gt;next) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;static_cast&lt;/span&gt;&amp;lt;T *&amp;gt;(e-&amp;gt;t-&amp;gt;parent) == v) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    v-&amp;gt;size += e-&amp;gt;t-&amp;gt;size;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!v-&amp;gt;child || v-&amp;gt;child-&amp;gt;size &amp;lt; e-&amp;gt;t-&amp;gt;size) v-&amp;gt;child = e-&amp;gt;t;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            s.pop();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) N[i].visited = &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; time = -&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    s.push(&amp;amp;N[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    N[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;].depth = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (!s.empty()) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        T *v = s.top();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!v-&amp;gt;visited) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            v-&amp;gt;visited = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (v-&amp;gt;parent == &lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt; || v != &lt;span class=&quot;keyword&quot;&gt;static_cast&lt;/span&gt;&amp;lt;T *&amp;gt;(v-&amp;gt;parent-&amp;gt;child)) v-&amp;gt;top = v;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; v-&amp;gt;top = v-&amp;gt;parent-&amp;gt;top;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            v-&amp;gt;pos = ++time;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (Edge&amp;lt;T&amp;gt; *e = v-&amp;gt;e; e; e = e-&amp;gt;next) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;static_cast&lt;/span&gt;&amp;lt;T *&amp;gt;(e-&amp;gt;t-&amp;gt;parent) == v) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (e-&amp;gt;t != v-&amp;gt;child) s.push(e-&amp;gt;t);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (v-&amp;gt;child) s.push(&lt;span class=&quot;keyword&quot;&gt;static_cast&lt;/span&gt;&amp;lt;T *&amp;gt;(v-&amp;gt;child));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        } &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            v-&amp;gt;posEnd = time;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            s.pop();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;template&lt;/span&gt; &amp;lt;&lt;span class=&quot;keyword&quot;&gt;typename&lt;/span&gt; T&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; T *&lt;span class=&quot;title&quot;&gt;lca&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(T *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; u, T *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; v)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Node *a = u, *b = v;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (a-&amp;gt;top != b-&amp;gt;top) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (a-&amp;gt;top-&amp;gt;depth &amp;lt; b-&amp;gt;top-&amp;gt;depth) &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::swap(a, b);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        a = a-&amp;gt;top-&amp;gt;parent;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (a-&amp;gt;depth &amp;gt; b-&amp;gt;depth) &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::swap(a, b);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static_cast&lt;/span&gt;&amp;lt;T *&amp;gt;(a);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;template&lt;/span&gt; &amp;lt;&lt;span class=&quot;keyword&quot;&gt;typename&lt;/span&gt; T&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; T *&lt;span class=&quot;title&quot;&gt;lcaDown&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(T *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; u, T *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; v, T *&amp;amp;uDown, T *&amp;amp;vDown)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    T *p = lca(u, v);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;function&quot;&gt;T *&lt;span class=&quot;title&quot;&gt;operator&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Node *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; p, Node *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; v)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Node *tmp = v;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (tmp-&amp;gt;top-&amp;gt;parent != p) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (p-&amp;gt;top == tmp-&amp;gt;top) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static_cast&lt;/span&gt;&amp;lt;T *&amp;gt;(p-&amp;gt;child);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                tmp = tmp-&amp;gt;top-&amp;gt;parent;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static_cast&lt;/span&gt;&amp;lt;T *&amp;gt;(tmp-&amp;gt;top);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    } down;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    uDown = down(p, u), vDown = down(p, v);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; p;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;template&lt;/span&gt; &amp;lt;&lt;span class=&quot;keyword&quot;&gt;typename&lt;/span&gt; T&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;calcDist&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(T *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; u, T *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; v)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; T *p = lca(u, v);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; (u-&amp;gt;dist - p-&amp;gt;dist) + (v-&amp;gt;dist - p-&amp;gt;dist);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;template&lt;/span&gt; &amp;lt;&lt;span class=&quot;keyword&quot;&gt;typename&lt;/span&gt; T&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;getDist&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(T *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; u, T *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; v)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; llabs(u-&amp;gt;dist - v-&amp;gt;dist);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;getNode&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; id, TargetTreeNode *&amp;amp;targetTreeNode, TemplateTreeNode *&amp;amp;templateTreeNode)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    targetTreeNode = &lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    templateTreeNode = &lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    targetTreeNode = &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::lower_bound(targetTree, targetTree + cnt, id);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;/*for (int i = 0; i &amp;lt;= cnt; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        if (id &amp;gt;= targetTree[i].idRange.l &amp;amp;&amp;amp; id &amp;lt;= targetTree[i].idRange.r) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            targetTreeNode = &amp;amp;targetTree[i];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            break;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }*/&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// printf(&amp;quot;%ld\n&amp;quot;, targetTreeNode - targetTree);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (targetTreeNode == &lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;) &lt;span class=&quot;keyword&quot;&gt;throw&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (targetTreeNode == &amp;amp;targetTree[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;]) templateTreeNode = &amp;amp;templateTree[id];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; k = id - targetTreeNode-&amp;gt;idRange.l;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        TemplateTreeNode *root = targetTreeNode-&amp;gt;rootInTemplateTree;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; x = chairmanTree.query(root-&amp;gt;pos + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, root-&amp;gt;posEnd + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, k + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        templateTreeNode = &amp;amp;templateTree[x];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// static int tmp[MAXN];&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// std::copy(dfsSequence + root-&amp;gt;pos, dfsSequence + root-&amp;gt;pos + root-&amp;gt;size, tmp);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// // std::nth_element(tmp, tmp + root-&amp;gt;size, tmp + k);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// std::sort(tmp, tmp + root-&amp;gt;size);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// templateTreeNode = &amp;amp;templateTree[tmp[k]];&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; u, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; v)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    TargetTreeNode *aTarget, *bTarget;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    TemplateTreeNode *aTemplate, *bTemplate;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    getNode(u, aTarget, aTemplate), getNode(v, bTarget, bTemplate);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (aTarget == bTarget) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; calcDist(aTemplate, bTemplate);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    } &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        TargetTreeNode *aDown, *bDown;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        TemplateTreeNode *aUp, *bUp;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        TargetTreeNode *pTarget = lcaDown(aTarget, bTarget, aDown, bDown);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (aTarget-&amp;gt;depth &amp;gt; bTarget-&amp;gt;depth) &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::swap(aTarget, bTarget), &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::swap(aTemplate, bTemplate), &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::swap(aDown, bDown);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        aUp = &lt;span class=&quot;keyword&quot;&gt;static_cast&lt;/span&gt;&amp;lt;TemplateTreeNode *&amp;gt;(aDown-&amp;gt;parentInTemplateTree);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        bUp = &lt;span class=&quot;keyword&quot;&gt;static_cast&lt;/span&gt;&amp;lt;TemplateTreeNode *&amp;gt;(bDown-&amp;gt;parentInTemplateTree);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; d = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (aTarget == pTarget) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            d += getDist(bTarget, pTarget);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            d -= getDist(bUp, pTarget-&amp;gt;rootInTemplateTree);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            d += calcDist(bUp, aTemplate);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            d += getDist(bTemplate, bTarget-&amp;gt;rootInTemplateTree);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        } &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            d += getDist(aTarget, pTarget) + getDist(bTarget, pTarget);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            d -= getDist(bUp, pTarget-&amp;gt;rootInTemplateTree);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            d -= getDist(aUp, pTarget-&amp;gt;rootInTemplateTree);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            d += calcDist(aUp, bUp);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            d += getDist(bTemplate, bTarget-&amp;gt;rootInTemplateTree);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            d += getDist(aTemplate, aTarget-&amp;gt;rootInTemplateTree);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; d;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// freopen(&amp;quot;tree_tenderRun.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// freopen(&amp;quot;tree_tenderRun.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d %d&amp;quot;&lt;/span&gt;, &amp;amp;n, &amp;amp;m, &amp;amp;q);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        templateTree[i].id = i;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; u, v;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d&amp;quot;&lt;/span&gt;, &amp;amp;u, &amp;amp;v), u--, v--;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        addEdge(templateTree, u, v, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    cut&amp;lt;TemplateTreeNode&amp;gt;(templateTree, n);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) dfsSequence[templateTree[i].pos] = i;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    chairmanTree.build(dfsSequence, n);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    targetTree[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;].id = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    targetTree[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;].rootInTemplateTree = &amp;amp;templateTree[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    targetTree[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;].idRange = Range(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; lastEnd = n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= m; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        cnt = i;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        targetTree[i].id = i;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; a, b;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%lld %lld&amp;quot;&lt;/span&gt;, &amp;amp;a, &amp;amp;b), a--, b--;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        targetTree[i].idRange = Range(lastEnd + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, lastEnd + templateTree[a].size);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        lastEnd = targetTree[i].idRange.r;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        TargetTreeNode *V;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        TemplateTreeNode *v;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        getNode(b, V, v);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        addEdge(targetTree, V-&amp;gt;id, i, getDist(v, V-&amp;gt;rootInTemplateTree) + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        targetTree[i].rootInTemplateTree = &amp;amp;templateTree[a];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        targetTree[i].parentInTemplateTree = v;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    cut&amp;lt;TargetTreeNode&amp;gt;(targetTree, m + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; q; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; u, v;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%lld %lld&amp;quot;&lt;/span&gt;, &amp;amp;u, &amp;amp;v), u--, v--;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%lld\n&amp;quot;&lt;/span&gt;, query(u, v));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// fclose(stdin);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// fclose(stdout);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x5C0F; A &amp;#x60F3;&amp;#x505A;&amp;#x4E00;&amp;#x68F5;&amp;#x5F88;&amp;#x5927;&amp;#x7684;&amp;#x6811;&amp;#xFF0C;&amp;#x4F46;&amp;#x662F;&amp;#x4ED6;&amp;#x624B;&amp;#x4E0A;&amp;#x7684;&amp;#x6750;&amp;#x6599;&amp;#x6709;&amp;#x9650;&amp;#xFF0C;&amp;#x53EA;&amp;#x597D;&amp;#x7528;&amp;#x70B9;&amp;#x5C0F;&amp;#x6280;&amp;#x5DE7;&amp;#x4E86;&amp;#x3002;&amp;#x5F00;&amp;#x59CB;&amp;#xFF0C;&amp;#x5C0F; A &amp;#x53EA;&amp;#x6709;&amp;#x4E00;&amp;#x68F5;&amp;#x7ED3;&amp;#x70B9;&amp;#x6570;&amp;#x4E3A; $ N $ &amp;#x7684;&amp;#x6811;&amp;#xFF0C;&amp;#x7ED3;&amp;#x70B9;&amp;#x7684;&amp;#x7F16;&amp;#x53F7;&amp;#x4E3A; $ 1,\ 2,\ \dots,\ N $&amp;#xFF0C;&amp;#x5176;&amp;#x4E2D;&amp;#x7ED3;&amp;#x70B9; $ 1 $ &amp;#x4E3A;&amp;#x6839;&amp;#xFF1B;&amp;#x6211;&amp;#x4EEC;&amp;#x79F0;&amp;#x8FD9;&amp;#x9897;&amp;#x6811;&amp;#x4E3A;&amp;#x6A21;&amp;#x677F;&amp;#x6811;&amp;#x3002;&amp;#x5C0F; A &amp;#x51B3;&amp;#x5B9A;&amp;#x901A;&amp;#x8FC7;&amp;#x8FD9;&amp;#x68F5;&amp;#x6A21;&amp;#x677F;&amp;#x6811;&amp;#x6765;&amp;#x6784;&amp;#x5EFA;&amp;#x4E00;&amp;#x9897;&amp;#x5927;&amp;#x6811;&amp;#x3002;&amp;#x6784;&amp;#x5EFA;&amp;#x8FC7;&amp;#x7A0B;&amp;#x5982;&amp;#x4E0B;&amp;#xFF1A;&lt;/p&gt;
&lt;ol style=&quot;list-style-type: decimal&quot;&gt;
&lt;li&gt;&amp;#x5C06;&amp;#x6A21;&amp;#x677F;&amp;#x6811;&amp;#x590D;&amp;#x5236;&amp;#x4E3A;&amp;#x521D;&amp;#x59CB;&amp;#x7684;&amp;#x5927;&amp;#x6811;&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x4EE5;&amp;#x4E0B; 3&amp;#xFF0C;4&amp;#xFF0C;5 &amp;#x6B65;&amp;#x5FAA;&amp;#x73AF;&amp;#x6267;&amp;#x884C; $ M $ &amp;#x6B21;&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x9009;&amp;#x62E9;&amp;#x4E24;&amp;#x4E2A;&amp;#x6570;&amp;#x5B57; $ a,\ b $&amp;#xFF0C;&amp;#x5176;&amp;#x4E2D; $ 1 \leq a \leq N $&amp;#xFF0C;$ 1 \leq b \leq &amp;#x5F53;&amp;#x524D;&amp;#x5927;&amp;#x6811;&amp;#x7684;&amp;#x7ED3;&amp;#x70B9;&amp;#x6570; $&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x5C06;&amp;#x6A21;&amp;#x677F;&amp;#x6811;&amp;#x4E2D;&amp;#x4EE5;&amp;#x7ED3;&amp;#x70B9; $ a $ &amp;#x4E3A;&amp;#x6839;&amp;#x7684;&amp;#x5B50;&amp;#x6811;&amp;#x590D;&amp;#x5236;&amp;#x4E00;&amp;#x904D;&amp;#xFF0C;&amp;#x6302;&amp;#x5230;&amp;#x5927;&amp;#x6811;&amp;#x4E2D;&amp;#x7ED3;&amp;#x70B9; $ b $ &amp;#x7684;&amp;#x4E0B;&amp;#x65B9;&amp;#xFF08;&amp;#x4E5F;&amp;#x5C31;&amp;#x662F;&amp;#x8BF4;&amp;#xFF0C;&amp;#x6A21;&amp;#x677F;&amp;#x6811;&amp;#x4E2D;&amp;#x7684;&amp;#x7ED3;&amp;#x70B9; $ a $ &amp;#x4E3A;&amp;#x6839;&amp;#x7684;&amp;#x5B50;&amp;#x6811;&amp;#x590D;&amp;#x5236;&amp;#x5230;&amp;#x5927;&amp;#x6811;&amp;#x4E2D;&amp;#x540E;&amp;#xFF0C;&amp;#x5C06;&amp;#x6210;&amp;#x4E3A;&amp;#x5927;&amp;#x6811;&amp;#x4E2D;&amp;#x7ED3;&amp;#x70B9; $ b $ &amp;#x7684;&amp;#x5B50;&amp;#x6811;)&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x5C06;&amp;#x65B0;&amp;#x52A0;&amp;#x5165;&amp;#x5927;&amp;#x6811;&amp;#x7684;&amp;#x7ED3;&amp;#x70B9;&amp;#x6309;&amp;#x7167;&amp;#x5728;&amp;#x6A21;&amp;#x677F;&amp;#x6811;&amp;#x4E2D;&amp;#x7F16;&amp;#x53F7;&amp;#x7684;&amp;#x987A;&amp;#x5E8F;&amp;#x91CD;&amp;#x65B0;&amp;#x7F16;&amp;#x53F7;&amp;#x3002;&amp;#x4F8B;&amp;#x5982;&amp;#xFF0C;&amp;#x5047;&amp;#x8BBE;&amp;#x5728;&amp;#x8FDB;&amp;#x884C; 4 &amp;#x6B65;&amp;#x4E4B;&amp;#x524D;&amp;#x5927;&amp;#x6811;&amp;#x6709; $ L $ &amp;#x4E2A;&amp;#x7ED3;&amp;#x70B9;&amp;#xFF0C;&amp;#x6A21;&amp;#x677F;&amp;#x6811;&amp;#x4E2D;&amp;#x4EE5; $ a $ &amp;#x4E3A;&amp;#x6839;&amp;#x7684;&amp;#x5B50;&amp;#x6811;&amp;#x5171;&amp;#x6709; $ C $ &amp;#x4E2A;&amp;#x7ED3;&amp;#x70B9;&amp;#xFF0C;&amp;#x90A3;&amp;#x4E48;&amp;#x65B0;&amp;#x52A0;&amp;#x5165;&amp;#x6A21;&amp;#x677F;&amp;#x6811;&amp;#x7684; $ C $ &amp;#x4E2A;&amp;#x7ED3;&amp;#x70B9;&amp;#x5728;&amp;#x5927;&amp;#x6811;&amp;#x4E2D;&amp;#x7684;&amp;#x7F16;&amp;#x53F7;&amp;#x5C06;&amp;#x662F; $ L + 1,\ L + 2,\ \dots,\ L + C $&amp;#xFF1B;&amp;#x5927;&amp;#x6811;&amp;#x4E2D;&amp;#x8FD9; $ C $ &amp;#x4E2A;&amp;#x7ED3;&amp;#x70B9;&amp;#x7F16;&amp;#x53F7;&amp;#x7684;&amp;#x5927;&amp;#x5C0F;&amp;#x987A;&amp;#x5E8F;&amp;#x548C;&amp;#x6A21;&amp;#x677F;&amp;#x6811;&amp;#x4E2D;&amp;#x5BF9;&amp;#x5E94;&amp;#x7684; $ C $ &amp;#x4E2A;&amp;#x7ED3;&amp;#x70B9;&amp;#x7684;&amp;#x5927;&amp;#x5C0F;&amp;#x987A;&amp;#x5E8F;&amp;#x662F;&amp;#x4E00;&amp;#x81F4;&amp;#x7684;&amp;#x3002;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&amp;#x73B0;&amp;#x5728;&amp;#x4ED6;&amp;#x60F3;&amp;#x95EE;&amp;#x4F60;&amp;#xFF0C;&amp;#x6811;&amp;#x4E2D;&amp;#x4E00;&amp;#x4E9B;&amp;#x7ED3;&amp;#x70B9;&amp;#x5BF9;&amp;#x7684;&amp;#x8DDD;&amp;#x79BB;&amp;#x662F;&amp;#x591A;&amp;#x5C11;&amp;#x3002;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="BZOJ" scheme="https://blog.menci.moe/tag/bzoj/"/>
    
      <category term="COGS" scheme="https://blog.menci.moe/tag/cogs/"/>
    
      <category term="HNOI" scheme="https://blog.menci.moe/tag/hnoi/"/>
    
      <category term="主席树" scheme="https://blog.menci.moe/tag/%E4%B8%BB%E5%B8%AD%E6%A0%91/"/>
    
      <category term="最近公共祖先" scheme="https://blog.menci.moe/tag/%E6%9C%80%E8%BF%91%E5%85%AC%E5%85%B1%E7%A5%96%E5%85%88/"/>
    
      <category term="树链剖分" scheme="https://blog.menci.moe/tag/%E6%A0%91%E9%93%BE%E5%89%96%E5%88%86/"/>
    
  </entry>
  
  <entry>
    <title>「HNOI2016」网络 - 树链剖分 + DFS 序</title>
    <link href="https://blog.menci.moe/hnoi2016-network/"/>
    <id>https://blog.menci.moe/hnoi2016-network/</id>
    <published>2016-05-11T09:08:00.000Z</published>
    <updated>2016-05-11T09:39:49.490Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x4E00;&amp;#x4E2A;&amp;#x7B80;&amp;#x5355;&amp;#x7684;&amp;#x7F51;&amp;#x7EDC;&amp;#x7CFB;&amp;#x7EDF;&amp;#x53EF;&amp;#x4EE5;&amp;#x88AB;&amp;#x63CF;&amp;#x8FF0;&amp;#x6210;&amp;#x4E00;&amp;#x68F5;&amp;#x65E0;&amp;#x6839;&amp;#x6811;&amp;#x3002;&amp;#x4E24;&amp;#x4E2A;&amp;#x670D;&amp;#x52A1;&amp;#x5668;&amp;#x8FDB;&amp;#x884C;&amp;#x6570;&amp;#x636E;&amp;#x7684;&amp;#x4EA4;&amp;#x4E92;&amp;#x65F6;&amp;#xFF0C;&amp;#x6570;&amp;#x636E;&amp;#x4F1A;&amp;#x7ECF;&amp;#x8FC7;&amp;#x8FDE;&amp;#x63A5;&amp;#x8FD9;&amp;#x4E24;&amp;#x4E2A;&amp;#x670D;&amp;#x52A1;&amp;#x5668;&amp;#x7684;&amp;#x8DEF;&amp;#x5F84;&amp;#x4E0A;&amp;#x7684;&amp;#x6240;&amp;#x6709;&amp;#x670D;&amp;#x52A1;&amp;#x5668;&amp;#xFF08;&amp;#x5305;&amp;#x62EC;&amp;#x8FD9;&amp;#x4E24;&amp;#x4E2A;&amp;#x670D;&amp;#x52A1;&amp;#x5668;&amp;#x81EA;&amp;#x8EAB;&amp;#xFF09;&amp;#x3002;&amp;#x5F53;&amp;#x8DEF;&amp;#x5F84;&amp;#x4E0A;&amp;#x7684;&amp;#x67D0;&amp;#x4E2A;&amp;#x670D;&amp;#x52A1;&amp;#x5668;&amp;#x51FA;&amp;#x73B0;&amp;#x6545;&amp;#x969C;&amp;#xFF0C;&amp;#x65E0;&amp;#x6CD5;&amp;#x6B63;&amp;#x5E38;&amp;#x8FD0;&amp;#x884C;&amp;#x65F6;&amp;#xFF0C;&amp;#x6570;&amp;#x636E;&amp;#x4FBF;&amp;#x65E0;&amp;#x6CD5;&amp;#x4EA4;&amp;#x4E92;&amp;#x3002;&amp;#x6B64;&amp;#x5916;&amp;#xFF0C;&amp;#x6BCF;&amp;#x4E2A;&amp;#x6570;&amp;#x636E;&amp;#x4EA4;&amp;#x4E92;&amp;#x8BF7;&amp;#x6C42;&amp;#x90FD;&amp;#x6709;&amp;#x4E00;&amp;#x4E2A;&amp;#x91CD;&amp;#x8981;&amp;#x5EA6;&amp;#x3002;&amp;#x5728;&amp;#x6BCF;&amp;#x4E00;&amp;#x4E2A;&amp;#x65F6;&amp;#x523B;&amp;#xFF0C;&amp;#x53EA;&amp;#x6709;&amp;#x53EF;&amp;#x80FD;&amp;#x51FA;&amp;#x73B0;&amp;#x4E0B;&amp;#x5217;&amp;#x4E09;&amp;#x79CD;&amp;#x4E8B;&amp;#x4EF6;&amp;#x4E2D;&amp;#x7684;&amp;#x4E00;&amp;#x79CD;&amp;#xFF1A;&lt;/p&gt;
&lt;ol style=&quot;list-style-type: decimal&quot;&gt;
&lt;li&gt;&amp;#x5728;&amp;#x67D0;&amp;#x4E24;&amp;#x4E2A;&amp;#x670D;&amp;#x52A1;&amp;#x5668;&amp;#x4E4B;&amp;#x95F4;&amp;#x51FA;&amp;#x73B0;&amp;#x4E00;&amp;#x6761;&amp;#x65B0;&amp;#x7684;&amp;#x6570;&amp;#x636E;&amp;#x4EA4;&amp;#x4E92;&amp;#x8BF7;&amp;#x6C42;&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x67D0;&amp;#x4E2A;&amp;#x6570;&amp;#x636E;&amp;#x4EA4;&amp;#x4E92;&amp;#x7ED3;&amp;#x675F;&amp;#x8BF7;&amp;#x6C42;&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x67D0;&amp;#x4E2A;&amp;#x670D;&amp;#x52A1;&amp;#x5668;&amp;#x51FA;&amp;#x73B0;&amp;#x6545;&amp;#x969C;&amp;#x3002;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&amp;#x7CFB;&amp;#x7EDF;&amp;#x4F1A;&amp;#x5728;&amp;#x4EFB;&amp;#x4F55;&amp;#x6545;&amp;#x969C;&amp;#x53D1;&amp;#x751F;&amp;#x540E;&amp;#x7ACB;&amp;#x5373;&amp;#x4FEE;&amp;#x590D;&amp;#x3002;&amp;#x4E5F;&amp;#x5C31;&amp;#x662F;&amp;#x5728;&amp;#x51FA;&amp;#x73B0;&amp;#x6545;&amp;#x969C;&amp;#x7684;&amp;#x65F6;&amp;#x523B;&amp;#x4E4B;&amp;#x540E;&amp;#xFF0C;&amp;#x8FD9;&amp;#x4E2A;&amp;#x670D;&amp;#x52A1;&amp;#x5668;&amp;#x4F9D;&amp;#x7136;&amp;#x662F;&amp;#x6B63;&amp;#x5E38;&amp;#x7684;&amp;#x3002;&amp;#x4F46;&amp;#x5728;&amp;#x670D;&amp;#x52A1;&amp;#x5668;&amp;#x4EA7;&amp;#x751F;&amp;#x6545;&amp;#x969C;&amp;#x65F6;&amp;#x4F9D;&amp;#x7136;&amp;#x4F1A;&amp;#x5BF9;&amp;#x9700;&amp;#x8981;&amp;#x7ECF;&amp;#x8FC7;&amp;#x8BE5;&amp;#x670D;&amp;#x52A1;&amp;#x5668;&amp;#x7684;&amp;#x6570;&amp;#x636E;&amp;#x4EA4;&amp;#x4E92;&amp;#x8BF7;&amp;#x6C42;&amp;#x9020;&amp;#x6210;&amp;#x5F71;&amp;#x54CD;&amp;#x3002;&amp;#x4F60;&amp;#x7684;&amp;#x4EFB;&amp;#x52A1;&amp;#x662F;&amp;#x5728;&amp;#x6BCF;&amp;#x6B21;&amp;#x51FA;&amp;#x73B0;&amp;#x6545;&amp;#x969C;&amp;#x65F6;&amp;#xFF0C;&amp;#x7EF4;&amp;#x62A4;&amp;#x672A;&amp;#x88AB;&amp;#x5F71;&amp;#x54CD;&amp;#x7684;&amp;#x8BF7;&amp;#x6C42;&amp;#x4E2D;&amp;#x91CD;&amp;#x8981;&amp;#x5EA6;&amp;#x7684;&amp;#x6700;&amp;#x5927;&amp;#x503C;&amp;#x3002;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;&amp;#x94FE;&amp;#x63A5;&quot;&gt;&amp;#x94FE;&amp;#x63A5;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://www.lydsy.com/JudgeOnline/problem.php?id=4538&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;BZOJ 4538&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://cogs.top/cogs/problem/problem.php?pid=2215&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;COGS 2215&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x9898;&amp;#x89E3;&quot;&gt;&amp;#x9898;&amp;#x89E3;&lt;/h3&gt;
&lt;p&gt;&amp;#x5BF9;&amp;#x6811;&amp;#x8FDB;&amp;#x884C;&amp;#x6811;&amp;#x94FE;&amp;#x5256;&amp;#x5206;&amp;#xFF0C;&amp;#x5E76;&amp;#x5F97;&amp;#x5230;&amp;#x5176; DFS &amp;#x5E8F;&amp;#x3002;&amp;#x6811;&amp;#x4E0A;&amp;#x7684;&amp;#x4E00;&amp;#x6761;&amp;#x8DEF;&amp;#x7ECF;&amp;#x8F6C;&amp;#x5316;&amp;#x4E3A; DFS &amp;#x5E8F;&amp;#x4E0A;&amp;#x7684; $ O(\log n) $ &amp;#x4E2A;&amp;#x533A;&amp;#x95F4;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x8003;&amp;#x8651;&amp;#x4E00;&amp;#x6761;&amp;#x672A;&amp;#x5B8C;&amp;#x6210;&amp;#x7684;&amp;#x4EA4;&amp;#x4E92;&amp;#x8BF7;&amp;#x6C42;&lt;strong&gt;&amp;#x4E0D;&lt;/strong&gt;&amp;#x4F1A;&amp;#x53D7;&amp;#x5230;&amp;#x67D0;&amp;#x670D;&amp;#x52A1;&amp;#x5668;&amp;#x6545;&amp;#x969C;&amp;#x7684;&amp;#x5F71;&amp;#x54CD;&amp;#xFF0C;&amp;#x5F53;&amp;#x4E14;&amp;#x4EC5;&amp;#x5F53;&amp;#x8FD9;&amp;#x6761;&amp;#x4EA4;&amp;#x4E92;&amp;#x8BF7;&amp;#x6C42;&lt;strong&gt;&amp;#x4E0D;&lt;/strong&gt;&amp;#x7ECF;&amp;#x8FC7;&amp;#x8FD9;&amp;#x53F0;&amp;#x670D;&amp;#x52A1;&amp;#x5668;&amp;#x3002;&amp;#x6240;&amp;#x4EE5;&amp;#x53EA;&amp;#x9700;&amp;#x8981;&amp;#x7EF4;&amp;#x62A4;&amp;#x4E0D;&amp;#x7ECF;&amp;#x8FC7;&amp;#x67D0;&amp;#x53F0;&amp;#x670D;&amp;#x52A1;&amp;#x5668;&amp;#x7684;&amp;#x8BF7;&amp;#x6C42;&amp;#x5373;&amp;#x53EF;&amp;#x3002;&amp;#x4E00;&amp;#x6761;&amp;#x8BF7;&amp;#x6C42;&amp;#x4F1A;&amp;#x5F71;&amp;#x54CD;&amp;#x6811;&amp;#x7684; DFS &amp;#x5E8F;&amp;#x4E0A; $ O(\log n) $ &amp;#x4E2A;&amp;#x533A;&amp;#x95F4;&amp;#xFF0C;&amp;#x5176;&amp;#x8865;&amp;#x96C6;&amp;#x5373;&amp;#x4E3A;&amp;#x4E0D;&amp;#x7ECF;&amp;#x8FC7;&amp;#x7684;&amp;#x670D;&amp;#x52A1;&amp;#x5668;&amp;#xFF0C;&amp;#x4ECD;&amp;#x7136;&amp;#x662F; $ O(\log n) $ &amp;#x4E2A;&amp;#x533A;&amp;#x95F4;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x518D;&amp;#x5C31;&amp;#x662F;&amp;#x7EF4;&amp;#x62A4;&amp;#x91CD;&amp;#x8981;&amp;#x5EA6;&amp;#x6700;&amp;#x5927;&amp;#x7684;&amp;#x8BF7;&amp;#x6C42;&amp;#xFF0C;&amp;#x53EF;&amp;#x4EE5;&amp;#x5728;&amp;#x7EBF;&amp;#x6BB5;&amp;#x6811;&amp;#x7684;&amp;#x6BCF;&amp;#x4E2A;&amp;#x8282;&amp;#x70B9;&amp;#x4E0A;&amp;#x7EF4;&amp;#x62A4;&amp;#x4E00;&amp;#x4E2A;&amp;#x5806;&amp;#xFF0C;&amp;#x5E76;&amp;#x5C06;&amp;#x6807;&amp;#x8BB0;&amp;#x6C38;&amp;#x4E45;&amp;#x5316;&amp;#xFF08;&amp;#x4E0D;&amp;#x4E0B;&amp;#x4F20;&amp;#x6807;&amp;#x8BB0;&amp;#xFF0C;&amp;#x7528;&amp;#x4ECE;&amp;#x6839;&amp;#x5230;&amp;#x53F6;&amp;#x5B50;&amp;#x7684;&amp;#x4E00;&amp;#x6761;&amp;#x94FE;&amp;#x4E0A;&amp;#x7684;&amp;#x503C;&amp;#x66F4;&amp;#x65B0;&amp;#x7B54;&amp;#x6848;&amp;#xFF09;&amp;#xFF0C;&amp;#x540C;&amp;#x65F6;&amp;#x5B58;&amp;#x50A8;&amp;#x6BCF;&amp;#x6761;&amp;#x8BF7;&amp;#x6C42;&amp;#x662F;&amp;#x5426;&amp;#x5DF2;&amp;#x7ED3;&amp;#x675F;&amp;#xFF0C;&amp;#x5E76;&amp;#x53CA;&amp;#x65F6;&amp;#x5C06;&amp;#x5806;&amp;#x9876;&amp;#x5DF2;&amp;#x7ED3;&amp;#x675F;&amp;#x7684;&amp;#x8BF7;&amp;#x6C42;&amp;#x5220;&amp;#x9664;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x603B;&amp;#x65F6;&amp;#x95F4;&amp;#x590D;&amp;#x6742;&amp;#x5EA6;&amp;#x4E3A; $ O(n \log ^ 3 n) $&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x4EE3;&amp;#x7801;&quot;&gt;&amp;#x4EE3;&amp;#x7801;&lt;/h3&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;93&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;94&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;95&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;96&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;97&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;98&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;99&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;100&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;101&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;102&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;103&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;104&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;105&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;106&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;107&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;108&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;109&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;110&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;111&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;112&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;113&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;114&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;115&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;116&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;117&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;118&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;119&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;120&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;121&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;122&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;123&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;124&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;125&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;126&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;127&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;128&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;129&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;130&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;131&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;132&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;133&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;134&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;135&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;136&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;137&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;138&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;139&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;140&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;141&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;142&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;143&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;144&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;145&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;146&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;147&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;148&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;149&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;150&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;151&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;152&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;153&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;154&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;155&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;156&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;157&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;158&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;159&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;160&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;161&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;162&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;163&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;164&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;165&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;166&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;167&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;168&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;169&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;170&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;171&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;172&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;173&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;174&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;175&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;176&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;177&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;178&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;179&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;180&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;181&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;182&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;183&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;stack&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;queue&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;algorithm&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;utility&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXN = &lt;span class=&quot;number&quot;&gt;100000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXM = &lt;span class=&quot;number&quot;&gt;200000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Node;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Edge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Node {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Edge *e;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Node *p, *c, *t;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; d, i, s;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; v;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} N[MAXN];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Edge {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Node *s, *t;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Edge *next;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Edge(Node *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; s, Node *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; t) : s(s), t(t), next(s-&amp;gt;e) {}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;};&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; SegmentTree {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; l, r;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    SegmentTree *lc, *rc;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::priority_queue&amp;lt; &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::pair&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; *&amp;gt; &amp;gt; q;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    SegmentTree(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; l, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; r, SegmentTree *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; lc, SegmentTree *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; rc) : l(l), r(r), lc(lc), rc(rc) {}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    ~SegmentTree() {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (lc) &lt;span class=&quot;keyword&quot;&gt;delete&lt;/span&gt; lc;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (rc) &lt;span class=&quot;keyword&quot;&gt;delete&lt;/span&gt; rc;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; l, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; r, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::pair&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; *&amp;gt; &amp;amp;p)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (l &amp;gt; &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;r || r &amp;lt; &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;l) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (l &amp;lt;= &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;l &amp;amp;&amp;amp; r &amp;gt;= &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;r) &lt;span class=&quot;comment&quot;&gt;/* printf(&amp;quot;&amp;gt; [%d, %d]\n&amp;quot;, this-&amp;gt;l, this-&amp;gt;r), */&lt;/span&gt; q.push(p);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; lc-&amp;gt;update(l, r, p), rc-&amp;gt;update(l, r, p);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (i &amp;lt; &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;l || i &amp;gt; &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;r) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; -&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; ans = -&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (i &amp;gt;= &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;l &amp;amp;&amp;amp; i &amp;lt;= &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;r) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (!q.empty() &amp;amp;&amp;amp; *q.top().second) q.pop();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!q.empty()) ans = &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::max(ans, q.top().first);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (lc) ans = &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::max(ans, lc-&amp;gt;query(i));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (rc) ans = &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::max(ans, rc-&amp;gt;query(i));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; ans;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} *seg;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;addEdge&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; u, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; v)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    N[u].e = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Edge(&amp;amp;N[u], &amp;amp;N[v]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    N[v].e = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Edge(&amp;amp;N[v], &amp;amp;N[u]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, m;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; del[MAXM];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; SegmentTree *&lt;span class=&quot;title&quot;&gt;buildSegment&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; l, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; r)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (l &amp;gt; r) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (l == r) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; SegmentTree(l, r, &lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;, &lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; SegmentTree(l, r, buildSegment(l, l + ((r - l) &amp;gt;&amp;gt; &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)), buildSegment(l + ((r - l) &amp;gt;&amp;gt; &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, r));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;cut&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;stack&lt;/span&gt;&amp;lt;Node *&amp;gt; s;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    s.push(&amp;amp;N[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    N[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;].d = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (!s.empty()) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Node *v = s.top();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!v-&amp;gt;v) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            v-&amp;gt;v = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (Edge *e = v-&amp;gt;e; e; e = e-&amp;gt;next) &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!e-&amp;gt;t-&amp;gt;d) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                e-&amp;gt;t-&amp;gt;d = v-&amp;gt;d + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                e-&amp;gt;t-&amp;gt;p = v;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                s.push(e-&amp;gt;t);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        } &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            v-&amp;gt;s = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (Edge *e = v-&amp;gt;e; e; e = e-&amp;gt;next) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                v-&amp;gt;s += e-&amp;gt;t-&amp;gt;s;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!v-&amp;gt;c || v-&amp;gt;c-&amp;gt;s &amp;lt; e-&amp;gt;t-&amp;gt;s) v-&amp;gt;c = e-&amp;gt;t;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            s.pop();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) N[i].v = &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    s.push(&amp;amp;N[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; time = -&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (!s.empty()) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Node *v = s.top();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!v-&amp;gt;v) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            v-&amp;gt;v = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!v-&amp;gt;p || v != v-&amp;gt;p-&amp;gt;c) v-&amp;gt;t = v;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; v-&amp;gt;t = v-&amp;gt;p-&amp;gt;t;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            v-&amp;gt;i = ++time;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (Edge *e = v-&amp;gt;e; e; e = e-&amp;gt;next) &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (e-&amp;gt;t-&amp;gt;p == v &amp;amp;&amp;amp; e-&amp;gt;t != v-&amp;gt;c) s.push(e-&amp;gt;t);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (v-&amp;gt;c) s.push(v-&amp;gt;c);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        } &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; s.pop();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    seg = buildSegment(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; u, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; v, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::pair&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; *&amp;gt; &amp;amp;p)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Node *a = &amp;amp;N[u], *b = &amp;amp;N[v];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;vector&lt;/span&gt;&amp;lt; &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::pair&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;&amp;gt; &amp;gt; vec;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (a-&amp;gt;t != b-&amp;gt;t) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (a-&amp;gt;t-&amp;gt;d &amp;lt; b-&amp;gt;t-&amp;gt;d) &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::swap(a, b);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        vec.push_back(&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::make_pair(a-&amp;gt;t-&amp;gt;i, a-&amp;gt;i));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        a = a-&amp;gt;t-&amp;gt;p;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (a-&amp;gt;i &amp;gt; b-&amp;gt;i) &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::swap(a, b);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    vec.push_back(&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::make_pair(a-&amp;gt;i, b-&amp;gt;i));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (vec.empty()) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::sort(vec.begin(), vec.end());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::pair&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;&amp;gt; last = &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::make_pair(-&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, -&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;vector&lt;/span&gt;&amp;lt; &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::pair&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;&amp;gt; &amp;gt;::const_iterator it = vec.begin(); it != vec.end(); it++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        seg-&amp;gt;update(last.second + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, it-&amp;gt;first - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, p);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// printf(&amp;quot;[%d, %d]\n&amp;quot;, last.second + 1, it-&amp;gt;first - 1);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        last = *it;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    seg-&amp;gt;update(last.second + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, p);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// printf(&amp;quot;[%d, %d]\n&amp;quot;, last.second + 1, n - 1);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; x)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// printf(&amp;quot;query(%d)\n&amp;quot;, x);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; seg-&amp;gt;query(N[x].i);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    freopen(&lt;span class=&quot;string&quot;&gt;&amp;quot;network_tenderRun.in&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;r&amp;quot;&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;stdin&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    freopen(&lt;span class=&quot;string&quot;&gt;&amp;quot;network_tenderRun.out&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;w&amp;quot;&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;stdout&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d&amp;quot;&lt;/span&gt;, &amp;amp;n, &amp;amp;m);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; u, v;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d&amp;quot;&lt;/span&gt;, &amp;amp;u, &amp;amp;v), u--, v--;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        addEdge(u, v);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    cut();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// for (int i = 0; i &amp;lt; n; i++) printf(&amp;quot;#%d: i = %d\n&amp;quot;, i + 1, N[i].i);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; m; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; c;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;c);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (c == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; u, v, w;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d %d&amp;quot;&lt;/span&gt;, &amp;amp;u, &amp;amp;v, &amp;amp;w), u--, v--;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            update(u, v, &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::make_pair(w, &amp;amp;del[i]));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        } &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (c == &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; t;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;t), t--;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            del[t] = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        } &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (c == &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; x;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;x), x--;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d\n&amp;quot;&lt;/span&gt;, query(x));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    fclose(&lt;span class=&quot;built_in&quot;&gt;stdin&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    fclose(&lt;span class=&quot;built_in&quot;&gt;stdout&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x4E00;&amp;#x4E2A;&amp;#x7B80;&amp;#x5355;&amp;#x7684;&amp;#x7F51;&amp;#x7EDC;&amp;#x7CFB;&amp;#x7EDF;&amp;#x53EF;&amp;#x4EE5;&amp;#x88AB;&amp;#x63CF;&amp;#x8FF0;&amp;#x6210;&amp;#x4E00;&amp;#x68F5;&amp;#x65E0;&amp;#x6839;&amp;#x6811;&amp;#x3002;&amp;#x4E24;&amp;#x4E2A;&amp;#x670D;&amp;#x52A1;&amp;#x5668;&amp;#x8FDB;&amp;#x884C;&amp;#x6570;&amp;#x636E;&amp;#x7684;&amp;#x4EA4;&amp;#x4E92;&amp;#x65F6;&amp;#xFF0C;&amp;#x6570;&amp;#x636E;&amp;#x4F1A;&amp;#x7ECF;&amp;#x8FC7;&amp;#x8FDE;&amp;#x63A5;&amp;#x8FD9;&amp;#x4E24;&amp;#x4E2A;&amp;#x670D;&amp;#x52A1;&amp;#x5668;&amp;#x7684;&amp;#x8DEF;&amp;#x5F84;&amp;#x4E0A;&amp;#x7684;&amp;#x6240;&amp;#x6709;&amp;#x670D;&amp;#x52A1;&amp;#x5668;&amp;#xFF08;&amp;#x5305;&amp;#x62EC;&amp;#x8FD9;&amp;#x4E24;&amp;#x4E2A;&amp;#x670D;&amp;#x52A1;&amp;#x5668;&amp;#x81EA;&amp;#x8EAB;&amp;#xFF09;&amp;#x3002;&amp;#x5F53;&amp;#x8DEF;&amp;#x5F84;&amp;#x4E0A;&amp;#x7684;&amp;#x67D0;&amp;#x4E2A;&amp;#x670D;&amp;#x52A1;&amp;#x5668;&amp;#x51FA;&amp;#x73B0;&amp;#x6545;&amp;#x969C;&amp;#xFF0C;&amp;#x65E0;&amp;#x6CD5;&amp;#x6B63;&amp;#x5E38;&amp;#x8FD0;&amp;#x884C;&amp;#x65F6;&amp;#xFF0C;&amp;#x6570;&amp;#x636E;&amp;#x4FBF;&amp;#x65E0;&amp;#x6CD5;&amp;#x4EA4;&amp;#x4E92;&amp;#x3002;&amp;#x6B64;&amp;#x5916;&amp;#xFF0C;&amp;#x6BCF;&amp;#x4E2A;&amp;#x6570;&amp;#x636E;&amp;#x4EA4;&amp;#x4E92;&amp;#x8BF7;&amp;#x6C42;&amp;#x90FD;&amp;#x6709;&amp;#x4E00;&amp;#x4E2A;&amp;#x91CD;&amp;#x8981;&amp;#x5EA6;&amp;#x3002;&amp;#x5728;&amp;#x6BCF;&amp;#x4E00;&amp;#x4E2A;&amp;#x65F6;&amp;#x523B;&amp;#xFF0C;&amp;#x53EA;&amp;#x6709;&amp;#x53EF;&amp;#x80FD;&amp;#x51FA;&amp;#x73B0;&amp;#x4E0B;&amp;#x5217;&amp;#x4E09;&amp;#x79CD;&amp;#x4E8B;&amp;#x4EF6;&amp;#x4E2D;&amp;#x7684;&amp;#x4E00;&amp;#x79CD;&amp;#xFF1A;&lt;/p&gt;
&lt;ol style=&quot;list-style-type: decimal&quot;&gt;
&lt;li&gt;&amp;#x5728;&amp;#x67D0;&amp;#x4E24;&amp;#x4E2A;&amp;#x670D;&amp;#x52A1;&amp;#x5668;&amp;#x4E4B;&amp;#x95F4;&amp;#x51FA;&amp;#x73B0;&amp;#x4E00;&amp;#x6761;&amp;#x65B0;&amp;#x7684;&amp;#x6570;&amp;#x636E;&amp;#x4EA4;&amp;#x4E92;&amp;#x8BF7;&amp;#x6C42;&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x67D0;&amp;#x4E2A;&amp;#x6570;&amp;#x636E;&amp;#x4EA4;&amp;#x4E92;&amp;#x7ED3;&amp;#x675F;&amp;#x8BF7;&amp;#x6C42;&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x67D0;&amp;#x4E2A;&amp;#x670D;&amp;#x52A1;&amp;#x5668;&amp;#x51FA;&amp;#x73B0;&amp;#x6545;&amp;#x969C;&amp;#x3002;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&amp;#x7CFB;&amp;#x7EDF;&amp;#x4F1A;&amp;#x5728;&amp;#x4EFB;&amp;#x4F55;&amp;#x6545;&amp;#x969C;&amp;#x53D1;&amp;#x751F;&amp;#x540E;&amp;#x7ACB;&amp;#x5373;&amp;#x4FEE;&amp;#x590D;&amp;#x3002;&amp;#x4E5F;&amp;#x5C31;&amp;#x662F;&amp;#x5728;&amp;#x51FA;&amp;#x73B0;&amp;#x6545;&amp;#x969C;&amp;#x7684;&amp;#x65F6;&amp;#x523B;&amp;#x4E4B;&amp;#x540E;&amp;#xFF0C;&amp;#x8FD9;&amp;#x4E2A;&amp;#x670D;&amp;#x52A1;&amp;#x5668;&amp;#x4F9D;&amp;#x7136;&amp;#x662F;&amp;#x6B63;&amp;#x5E38;&amp;#x7684;&amp;#x3002;&amp;#x4F46;&amp;#x5728;&amp;#x670D;&amp;#x52A1;&amp;#x5668;&amp;#x4EA7;&amp;#x751F;&amp;#x6545;&amp;#x969C;&amp;#x65F6;&amp;#x4F9D;&amp;#x7136;&amp;#x4F1A;&amp;#x5BF9;&amp;#x9700;&amp;#x8981;&amp;#x7ECF;&amp;#x8FC7;&amp;#x8BE5;&amp;#x670D;&amp;#x52A1;&amp;#x5668;&amp;#x7684;&amp;#x6570;&amp;#x636E;&amp;#x4EA4;&amp;#x4E92;&amp;#x8BF7;&amp;#x6C42;&amp;#x9020;&amp;#x6210;&amp;#x5F71;&amp;#x54CD;&amp;#x3002;&amp;#x4F60;&amp;#x7684;&amp;#x4EFB;&amp;#x52A1;&amp;#x662F;&amp;#x5728;&amp;#x6BCF;&amp;#x6B21;&amp;#x51FA;&amp;#x73B0;&amp;#x6545;&amp;#x969C;&amp;#x65F6;&amp;#xFF0C;&amp;#x7EF4;&amp;#x62A4;&amp;#x672A;&amp;#x88AB;&amp;#x5F71;&amp;#x54CD;&amp;#x7684;&amp;#x8BF7;&amp;#x6C42;&amp;#x4E2D;&amp;#x91CD;&amp;#x8981;&amp;#x5EA6;&amp;#x7684;&amp;#x6700;&amp;#x5927;&amp;#x503C;&amp;#x3002;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="BZOJ" scheme="https://blog.menci.moe/tag/bzoj/"/>
    
      <category term="COGS" scheme="https://blog.menci.moe/tag/cogs/"/>
    
      <category term="DFS 序" scheme="https://blog.menci.moe/tag/dfs-%E5%BA%8F/"/>
    
      <category term="HNOI" scheme="https://blog.menci.moe/tag/hnoi/"/>
    
      <category term="树链剖分" scheme="https://blog.menci.moe/tag/%E6%A0%91%E9%93%BE%E5%89%96%E5%88%86/"/>
    
  </entry>
  
  <entry>
    <title>「HNOI2016」最小公倍数 - 分块 + 并查集</title>
    <link href="https://blog.menci.moe/hnoi2016-multiple/"/>
    <id>https://blog.menci.moe/hnoi2016-multiple/</id>
    <published>2016-05-11T08:39:00.000Z</published>
    <updated>2016-05-11T09:33:24.440Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x7ED9;&amp;#x5B9A;&amp;#x4E00;&amp;#x5F20; $ N $ &amp;#x4E2A;&amp;#x9876;&amp;#x70B9; $ M $ &amp;#x6761;&amp;#x8FB9;&amp;#x7684;&amp;#x65E0;&amp;#x5411;&amp;#x56FE;&amp;#xFF08;&amp;#x9876;&amp;#x70B9;&amp;#x7F16;&amp;#x53F7;&amp;#x4E3A; $ 1,\ 2,\ \dots,\ n $&amp;#xFF09;&amp;#xFF0C;&amp;#x6BCF;&amp;#x6761;&amp;#x8FB9;&amp;#x4E0A;&amp;#x5E26;&amp;#x6709;&amp;#x6743;&amp;#x503C;&amp;#x3002;&amp;#x6240;&amp;#x6709;&amp;#x6743;&amp;#x503C;&amp;#x90FD;&amp;#x53EF;&amp;#x4EE5;&amp;#x5206;&amp;#x89E3;&amp;#x6210; $ 2 ^ a 3 ^ b $ &amp;#x7684;&amp;#x5F62;&amp;#x5F0F;&amp;#x3002;&amp;#x73B0;&amp;#x5728;&amp;#x6709; $ q $ &amp;#x4E2A;&amp;#x8BE2;&amp;#x95EE;&amp;#xFF0C;&amp;#x6BCF;&amp;#x6B21;&amp;#x8BE2;&amp;#x95EE;&amp;#x7ED9;&amp;#x5B9A;&amp;#x56DB;&amp;#x4E2A;&amp;#x53C2;&amp;#x6570; $ u $&amp;#x3001;$ v $&amp;#x3001;$ a $ &amp;#x548C; $ b $&amp;#xFF0C;&amp;#x8BF7;&amp;#x4F60;&amp;#x6C42;&amp;#x51FA;&amp;#x662F;&amp;#x5426;&amp;#x5B58;&amp;#x5728;&amp;#x4E00;&amp;#x6761;&amp;#x9876;&amp;#x70B9; $ u $ &amp;#x5230; $ v $ &amp;#x4E4B;&amp;#x95F4;&amp;#x7684;&amp;#x8DEF;&amp;#x5F84;&amp;#xFF0C;&amp;#x4F7F;&amp;#x5F97;&amp;#x8DEF;&amp;#x5F84;&amp;#x4F9D;&amp;#x6B21;&amp;#x7ECF;&amp;#x8FC7;&amp;#x7684;&amp;#x8FB9;&amp;#x4E0A;&amp;#x7684;&amp;#x6743;&amp;#x503C;&amp;#x7684;&amp;#x6700;&amp;#x5C0F;&amp;#x516C;&amp;#x500D;&amp;#x6570;&amp;#x4E3A; $ 2 ^ a 3 ^ b $&amp;#x3002;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;&amp;#x94FE;&amp;#x63A5;&quot;&gt;&amp;#x94FE;&amp;#x63A5;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://www.lydsy.com/JudgeOnline/problem.php?id=4537&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;BZOJ 4537&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://cogs.top/cogs/problem/problem.php?pid=2241&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;COGS 2241&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://codevs.cn/problem/4890/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;CodeVS 4890&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x9898;&amp;#x89E3;&quot;&gt;&amp;#x9898;&amp;#x89E3;&lt;/h3&gt;
&lt;p&gt;&amp;#x56E0;&amp;#x4E3A;&lt;strong&gt;&amp;#x8DEF;&amp;#x5F84;&lt;/strong&gt;&amp;#x53EF;&amp;#x4EE5;&amp;#x4E0D;&amp;#x662F;&lt;strong&gt;&amp;#x7B80;&amp;#x5355;&amp;#x8DEF;&amp;#x5F84;&lt;/strong&gt;&amp;#xFF0C;&amp;#x6240;&amp;#x4EE5;&amp;#x53EA;&amp;#x8981;&amp;#x4E24;&amp;#x4E2A;&amp;#x70B9;&amp;#x5728;&amp;#x540C;&amp;#x4E00;&amp;#x8FDE;&amp;#x901A;&amp;#x5757;&amp;#x5185;&amp;#xFF0C;&amp;#x5C31;&amp;#x4E00;&amp;#x5B9A;&amp;#x53EF;&amp;#x4EE5;&amp;#x627E;&amp;#x5230;&amp;#x4E00;&amp;#x6761;&amp;#x8FDE;&amp;#x63A5;&amp;#x5B83;&amp;#x4EEC;&amp;#x7684;&amp;#x8DEF;&amp;#x5F84;&amp;#x3002;&amp;#x591A;&amp;#x4E2A;&amp;#x6570;&amp;#x5199;&amp;#x6210; $ 2 $ &amp;#x548C; $ 3 $ &amp;#x7684;&amp;#x5E42;&amp;#x7684;&amp;#x79EF;&amp;#x7684;&amp;#x5F62;&amp;#x5F0F;&amp;#x7684;&amp;#x6570; $ 2 ^ {a_1} 3 ^ {b_1},\ 2 ^ {a_2} 3 ^ {b_2},\ \dots,\ 2 ^ {a_n} 3 ^ {b_n} $ &amp;#x7684;&amp;#x6700;&amp;#x5C0F;&amp;#x516C;&amp;#x500D;&amp;#x6570;&amp;#xFF0C;&amp;#x4E3A;&amp;#x8FD9;&amp;#x4E9B;&amp;#x6570;&amp;#x4E2D; $ 2 $ &amp;#x7684;&amp;#x6700;&amp;#x9AD8;&amp;#x6B21;&amp;#x5E42;&amp;#x4E58;&amp;#x4EE5; $ 3 $ &amp;#x7684;&amp;#x6700;&amp;#x9AD8;&amp;#x6B21;&amp;#x5E42;&amp;#xFF0C;&amp;#x5373; $ 2 ^ {\max\{a_i\}} 3 ^ {\max\{b_i\}} $&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x95EE;&amp;#x9898;&amp;#x8F6C;&amp;#x5316;&amp;#x4E3A;&amp;#xFF0C;&amp;#x5224;&amp;#x65AD;&amp;#x662F;&amp;#x5426;&amp;#x80FD;&amp;#x9009;&amp;#x53D6;&amp;#x82E5;&amp;#x5E72;&amp;#x6761;&amp;#x7EC4;&amp;#x6210;&amp;#x540C;&amp;#x4E00;&amp;#x8FDE;&amp;#x901A;&amp;#x5757;&amp;#x7684;&amp;#x8FB9;&amp;#xFF0C;&amp;#x4FDD;&amp;#x8BC1;&amp;#x7ED9;&amp;#x5B9A;&amp;#x7684;&amp;#x4E24;&amp;#x4E2A;&amp;#x70B9;&amp;#x76F8;&amp;#x8FDE;&amp;#x901A;&amp;#xFF0C;&amp;#x5E76;&amp;#x4E14;&amp;#x8FDE;&amp;#x901A;&amp;#x5757;&amp;#x5185; $ a $ &amp;#x548C; $ b $ &amp;#x7684;&amp;#x6700;&amp;#x5927;&amp;#x503C;&amp;#x5206;&amp;#x522B;&amp;#x7B49;&amp;#x4E8E;&amp;#x7ED9;&amp;#x5B9A;&amp;#x7684;&amp;#x503C;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x663E;&amp;#x7136;&amp;#xFF0C;&amp;#x8FB9;&amp;#x4E0A;&amp;#x7684; $ a $ &amp;#x548C; $ b $ &amp;#x4E2D;&amp;#x7684;&amp;#x4EFB;&amp;#x610F;&amp;#x4E00;&amp;#x4E2A;&amp;#x6BD4;&amp;#x8BE2;&amp;#x95EE;&amp;#x7684;&amp;#x5BF9;&amp;#x5E94;&amp;#x503C;&amp;#x8981;&amp;#x5927;&amp;#xFF0C;&amp;#x5219;&amp;#x8FD9;&amp;#x6761;&amp;#x8FB9;&amp;#x4E0D;&amp;#x4F1A;&amp;#x5BF9;&amp;#x8BE2;&amp;#x95EE;&amp;#x4EA7;&amp;#x751F;&amp;#x5F71;&amp;#x54CD;&amp;#x3002;&amp;#x8003;&amp;#x8651;&amp;#x5BF9;&amp;#x4E8E;&amp;#x67D0;&amp;#x4E00;&amp;#x6B21;&amp;#x8BE2;&amp;#x95EE;&amp;#xFF0C;&amp;#x4ECE;&amp;#x5C0F;&amp;#x5230;&amp;#x5927;&amp;#x52A0;&amp;#x5165; $ a $ &amp;#x548C; $ b $ &amp;#x5747;&amp;#x5C0F;&amp;#x4E8E;&amp;#x7B49;&amp;#x4E8E;&amp;#x8BE2;&amp;#x95EE;&amp;#x503C;&amp;#x7684;&amp;#x8FB9;&amp;#xFF0C;&amp;#x4F7F;&amp;#x7528;&amp;#x5E76;&amp;#x67E5;&amp;#x96C6;&amp;#x7EF4;&amp;#x62A4;&amp;#x8FDE;&amp;#x901A;&amp;#x6027;&amp;#x548C;&amp;#x8FDE;&amp;#x901A;&amp;#x5757;&amp;#x5185;&amp;#x7684;&amp;#x6700;&amp;#x5927;&amp;#x503C;&amp;#xFF0C;&amp;#x5E76;&amp;#x5728;&amp;#x52A0;&amp;#x5165;&amp;#x6240;&amp;#x6709;&amp;#x8FB9;&amp;#x540E;&amp;#x5224;&amp;#x65AD;&amp;#x8FDE;&amp;#x901A;&amp;#x5757;&amp;#x5185;&amp;#x6700;&amp;#x5927;&amp;#x503C;&amp;#x662F;&amp;#x5426;&amp;#x7B49;&amp;#x4E8E;&amp;#x8BE2;&amp;#x95EE;&amp;#x503C;&amp;#x3002;&amp;#x603B;&amp;#x65F6;&amp;#x95F4;&amp;#x590D;&amp;#x6742;&amp;#x5EA6;&amp;#x4E3A; $ O(qm \ \alpha(m)) $&amp;#xFF0C;&amp;#x8D85;&amp;#x65F6;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x6CE8;&amp;#x610F;&amp;#x5230;&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x6211;&amp;#x4EEC;&amp;#x5C06;&amp;#x8FB9;&amp;#x6309;&amp;#x7167; $ a $ &amp;#x6392;&amp;#x5E8F;&amp;#xFF0C;&amp;#x5E76;&amp;#x79BB;&amp;#x7EBF;&amp;#x5904;&amp;#x7406;&amp;#x6240;&amp;#x6709;&amp;#x8BE2;&amp;#x95EE;&amp;#xFF0C;&amp;#x53EF;&amp;#x4EE5;&amp;#x6BCF;&amp;#x6B21;&amp;#x5C06; $ a $ &amp;#x5C0F;&amp;#x4E8E;&amp;#x7B49;&amp;#x4E8E;&amp;#x67D0;&amp;#x4E2A;&amp;#x8BE2;&amp;#x95EE;&amp;#x7684;&amp;#x8FB9;&amp;#x6309;&amp;#x7167; $ b $ &amp;#x518D;&amp;#x6B21;&amp;#x6392;&amp;#x5E8F;&amp;#xFF0C;&amp;#x5F97;&amp;#x5230;&amp;#x6240;&amp;#x6709;&amp;#x5BF9;&amp;#x7B54;&amp;#x6848;&amp;#x6709;&amp;#x8D21;&amp;#x732E;&amp;#x7684;&amp;#x8FB9;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x8003;&amp;#x8651;&amp;#x5C06;&amp;#x6240;&amp;#x6709;&amp;#x8FB9;&amp;#x6309;&amp;#x7167; $ a $ &amp;#x6392;&amp;#x5E8F;&amp;#x540E;&amp;#x5206;&amp;#x4E3A; $ T $ &amp;#x5757;&amp;#xFF0C;&amp;#x6BCF;&amp;#x6B21;&amp;#x5904;&amp;#x7406;&amp;#x67D0;&amp;#x4E00;&amp;#x5757;&amp;#x65F6;&amp;#xFF0C;&amp;#x53D6;&amp;#x51FA;&amp;#x4E4B;&amp;#x524D;&amp;#x6240;&amp;#x6709;&amp;#x5757;&amp;#x4E2D;&amp;#x7684;&amp;#x8FB9;&amp;#xFF08;&amp;#x8FD9;&amp;#x4E9B;&amp;#x8FB9;&amp;#x4E2D;&amp;#x7684; $ a $ &amp;#x5747;&amp;#x5C0F;&amp;#x4E8E;&amp;#x7B49;&amp;#x4E8E;&amp;#x5F53;&amp;#x524D;&amp;#x5757;&amp;#x5185;&amp;#x7684;&amp;#x6240;&amp;#x6709;&amp;#x8BE2;&amp;#x95EE;&amp;#x4E2D;&amp;#x7684; $ a $&amp;#xFF09;&amp;#xFF0C;&amp;#x5E76;&amp;#x5C06;&amp;#x5176;&amp;#x6309;&amp;#x7167; $ b $ &amp;#x6392;&amp;#x5E8F;&amp;#x3002;&amp;#x53D6;&amp;#x51FA;&amp;#x8BE2;&amp;#x95EE;&amp;#x503C; $ a $ &amp;#x5728;&amp;#x5F53;&amp;#x524D;&amp;#x5757;&amp;#x8303;&amp;#x56F4;&amp;#x5185;&amp;#x7684;&amp;#x6240;&amp;#x6709;&amp;#x8BE2;&amp;#x95EE;&amp;#xFF0C;&amp;#x4E5F;&amp;#x5C06;&amp;#x5176;&amp;#x6309;&amp;#x7167; $ b $ &amp;#x6392;&amp;#x5E8F;&amp;#x3002;&amp;#x5C06;&amp;#x53D6;&amp;#x51FA;&amp;#x7684;&amp;#x6240;&amp;#x6709;&amp;#x8FB9;&amp;#x589E;&amp;#x91CF;&amp;#x52A0;&amp;#x5165;&amp;#x5E76;&amp;#x67E5;&amp;#x96C6;&amp;#xFF0C;&amp;#x5E76;&amp;#x540C;&amp;#x65F6;&amp;#x4F9D;&amp;#x6B21;&amp;#x5904;&amp;#x7406;&amp;#x6240;&amp;#x6709;&amp;#x53D6;&amp;#x51FA;&amp;#x7684;&amp;#x8BE2;&amp;#x95EE;&amp;#x3002;&amp;#x800C;&amp;#x5757;&amp;#x5185;&amp;#x7684;&amp;#x8FB9;&amp;#x4E5F;&amp;#x4F1A;&amp;#x5BF9;&amp;#x5757;&amp;#x5185;&amp;#x8BE2;&amp;#x95EE;&amp;#x6709;&amp;#x5F71;&amp;#x54CD;&amp;#xFF0C;&amp;#x6BCF;&amp;#x5904;&amp;#x7406;&amp;#x4E00;&amp;#x6B21;&amp;#x8BE2;&amp;#x95EE;&amp;#x65F6;&amp;#xFF0C;&amp;#x679A;&amp;#x4E3E;&amp;#x5757;&amp;#x5185;&amp;#x6240;&amp;#x6709;&amp;#x8FB9;&amp;#xFF0C;&amp;#x7528;&amp;#x4E0A;&amp;#x6587;&amp;#x4E2D;&amp;#x7684;&amp;#x66B4;&amp;#x529B;&amp;#x65B9;&amp;#x5F0F;&amp;#x5C06;&amp;#x5176;&amp;#x52A0;&amp;#x5165;&amp;#x5E76;&amp;#x67E5;&amp;#x96C6;&amp;#xFF0C;&amp;#x5E76;&amp;#x5728;&amp;#x5904;&amp;#x7406;&amp;#x5B8C;&amp;#x4E00;&amp;#x6B21;&amp;#x8BE2;&amp;#x95EE;&amp;#x540E;&amp;#x5C06;&amp;#x64CD;&amp;#x4F5C;&lt;strong&gt;&amp;#x64A4;&amp;#x9500;&lt;/strong&gt;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x64A4;&amp;#x9500;&amp;#x5E76;&amp;#x67E5;&amp;#x96C6;&amp;#x7684;&amp;#x65B9;&amp;#x6CD5;&amp;#x662F;&amp;#xFF0C;&amp;#x7EF4;&amp;#x62A4;&amp;#x4E00;&amp;#x4E2A;&amp;#x6808;&amp;#xFF0C;&amp;#x6808;&amp;#x5185;&amp;#x5B58;&amp;#x50A8;&amp;#x6240;&amp;#x6709;&amp;#x88AB;&amp;#x4FEE;&amp;#x6539;&amp;#x7684;&amp;#x4F4D;&amp;#x7F6E;&amp;#x53CA;&amp;#x5176;&amp;#x539F;&amp;#x672C;&amp;#x7684;&amp;#x503C;&amp;#xFF0C;&amp;#x4EE5;&amp;#x6808;&amp;#x7684;&amp;#x5927;&amp;#x5C0F;&amp;#x4F5C;&amp;#x4E3A;&amp;#x72B6;&amp;#x6001;&amp;#x3002;&amp;#x6062;&amp;#x590D;&amp;#x65F6;&amp;#xFF0C;&amp;#x4ECE;&amp;#x6808;&amp;#x9876;&amp;#x5F39;&amp;#x51FA;&amp;#xFF0C;&amp;#x6BCF;&amp;#x6B21;&amp;#x5C06;&amp;#x539F;&amp;#x672C;&amp;#x7684;&amp;#x503C;&amp;#x4FEE;&amp;#x6539;&amp;#x56DE;&amp;#x53BB;&amp;#xFF0C;&amp;#x76F4;&amp;#x5230;&amp;#x6808;&amp;#x5927;&amp;#x5C0F;&amp;#x7B49;&amp;#x4E8E;&amp;#x539F;&amp;#x672C;&amp;#x7684;&amp;#x6808;&amp;#x5927;&amp;#x5C0F;&amp;#x3002;&amp;#x6CE8;&amp;#x610F;&amp;#x8FD9;&amp;#x91CC;&lt;strong&gt;&amp;#x4E0D;&amp;#x80FD;&lt;/strong&gt;&amp;#x4F7F;&amp;#x7528;&amp;#x8DEF;&amp;#x5F84;&amp;#x538B;&amp;#x7F29;&amp;#xFF0C;&amp;#x800C;&amp;#x662F;&amp;#x8981;&amp;#x4F7F;&amp;#x7528;&lt;strong&gt;&amp;#x6309;&amp;#x79E9;&amp;#x5408;&amp;#x5E76;&lt;/strong&gt;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x5206;&amp;#x6790;&amp;#x4E00;&amp;#x4E0B;&amp;#x4E0A;&amp;#x8FF0;&amp;#x7B97;&amp;#x6CD5;&amp;#x7684;&amp;#x65F6;&amp;#x95F4;&amp;#x590D;&amp;#x6742;&amp;#x5EA6;&amp;#xFF1A;&amp;#x6BCF;&amp;#x4E2A;&amp;#x8BE2;&amp;#x95EE;&amp;#x53EA;&amp;#x4F1A;&amp;#x88AB;&amp;#x5904;&amp;#x7406;&amp;#x6700;&amp;#x591A;&amp;#x4E00;&amp;#x6B21;&amp;#xFF0C;&amp;#x5904;&amp;#x7406;&amp;#x6BCF;&amp;#x6B21;&amp;#x8BE2;&amp;#x95EE;&amp;#x65F6;&amp;#x904D;&amp;#x5386;&amp;#x4E86;&amp;#x5927;&amp;#x5C0F;&amp;#x4E3A; $ O(\frac{n}{T}) $ &amp;#x7684;&amp;#x5757;&amp;#xFF0C;&amp;#x5176;&amp;#x4E2D;&amp;#x5BF9;&amp;#x5E76;&amp;#x67E5;&amp;#x96C6;&amp;#x8FDB;&amp;#x884C;&amp;#x4E86;&amp;#x6700;&amp;#x591A; $ O(\frac{n}{T}) $ &amp;#x6B21;&amp;#xFF0C;&amp;#x8FD9;&amp;#x90E8;&amp;#x5206;&amp;#x7684;&amp;#x65F6;&amp;#x95F4;&amp;#x590D;&amp;#x6742;&amp;#x5EA6;&amp;#x4E3A; $ O(q \frac{n}{T} \log \frac{n}{T}) $&amp;#x3002;&amp;#x5904;&amp;#x7406;&amp;#x5757;&amp;#x4E4B;&amp;#x524D;&amp;#x7684;&amp;#x8FB9;&amp;#x65F6;&amp;#xFF0C;&amp;#x6BCF;&amp;#x6761;&amp;#x8FB9;&amp;#x6700;&amp;#x591A;&amp;#x53C2;&amp;#x4E0E; $ T $ &amp;#x6B21;&amp;#x6392;&amp;#x5E8F;&amp;#xFF0C;&amp;#x6BCF;&amp;#x4E2A;&amp;#x8BE2;&amp;#x95EE;&amp;#x6700;&amp;#x591A;&amp;#x53C2;&amp;#x4E0E; $ 1 $ &amp;#x6B21;&amp;#x6392;&amp;#x5E8F;&amp;#xFF0C;&amp;#x8FD9;&amp;#x90E8;&amp;#x5206;&amp;#x7684;&amp;#x65F6;&amp;#x95F4;&amp;#x590D;&amp;#x6742;&amp;#x5EA6;&amp;#x4E3A; $ O(T m \log m + q \log q) $&amp;#x3002;&amp;#x53D6; $ T = \sqrt m $&amp;#xFF0C;&amp;#x5219;&amp;#x603B;&amp;#x65F6;&amp;#x95F4;&amp;#x590D;&amp;#x6742;&amp;#x5EA6;&amp;#x4E3A; $ O(q \sqrt m \log \sqrt m + m \sqrt m \log m + q \log q) $&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x4EE3;&amp;#x7801;&quot;&gt;&amp;#x4EE3;&amp;#x7801;&lt;/h3&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;93&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;94&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;95&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;96&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;97&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;98&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;99&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;100&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;101&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;102&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;103&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;104&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;105&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;106&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;107&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;108&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;109&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;110&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;111&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;112&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;113&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;114&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;115&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;116&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;117&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;118&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;119&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;120&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;121&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;122&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;123&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;124&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;125&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;126&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;127&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;128&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;129&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;130&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;131&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;132&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;133&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;134&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;135&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;136&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;137&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;138&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;139&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;140&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;141&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;142&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;143&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;144&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;145&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;146&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;147&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;148&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;149&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;150&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;151&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;152&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;153&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;154&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;155&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;156&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;157&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;158&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;159&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;160&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;161&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;162&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;163&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;164&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;165&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;166&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;167&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;168&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;169&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;170&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;171&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;172&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;173&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;174&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;175&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;176&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;177&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;178&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;179&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;180&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;181&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;182&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;183&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;184&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;185&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;186&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;187&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;188&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;189&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;190&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;191&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;192&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;193&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;194&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;195&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;196&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;197&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;198&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;199&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;200&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;201&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;202&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;203&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;204&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;205&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;206&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;207&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;208&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;209&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;210&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;211&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;212&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;213&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cmath&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// #include &amp;lt;cstring&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// #include &amp;lt;cassert&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;algorithm&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;stack&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;utility&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;vector&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXN = &lt;span class=&quot;number&quot;&gt;50000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXM = &lt;span class=&quot;number&quot;&gt;100000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXQ = &lt;span class=&quot;number&quot;&gt;50000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; UnionFindSet {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; p[MAXN], rk[MAXN], a[MAXN], b[MAXN];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// int n;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;stack&lt;/span&gt;&amp;lt; &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::pair&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; *, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;&amp;gt; &amp;gt; s;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// this-&amp;gt;n = n;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) p[i] = i, rk[i] = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, a[i] = -&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, b[i] = -&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (!s.empty()) s.pop();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;find&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; x)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// assert(x &amp;lt; n);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; p[x] == x ? x : find(p[x]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;find&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; x, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &amp;amp;a, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &amp;amp;b)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// assert(x &amp;lt; n);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (p[x] == x) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            a = &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;a[x], b = &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;b[x];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; x;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; find(p[x], a, b);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;merge&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; x, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; y, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; a, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; b)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; _x = find(x), _y = find(y);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (_x != _y) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (rk[_x] == rk[_y]) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                s.push(&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::make_pair(&amp;amp;rk[_y], rk[_y]));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                rk[_y]++;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            } &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (rk[_x] &amp;gt; rk[_y]) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::swap(_x, _y);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            s.push(&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::make_pair(&amp;amp;&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;a[_y], &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;a[_y]));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            s.push(&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::make_pair(&amp;amp;&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;b[_y], &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;b[_y]));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            s.push(&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::make_pair(&amp;amp;p[_x], p[_x]));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            p[_x] = _y;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;a[_y] = &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::max(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;a[_y], &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;a[_x]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;a[_y] = &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::max(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;a[_y], a);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;b[_y] = &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::max(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;b[_y], &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;b[_x]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;b[_y] = &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::max(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;b[_y], b);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        } &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            s.push(&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::make_pair(&amp;amp;&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;a[_y], &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;a[_y]));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            s.push(&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::make_pair(&amp;amp;&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;b[_y], &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;b[_y]));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;a[_x] = &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::max(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;a[_x], a);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;b[_x] = &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::max(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;b[_x], b);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; size_t &lt;span class=&quot;title&quot;&gt;status&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{ &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; s.size(); }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;restore&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; size_t s)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;s.size() &amp;gt; s) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::pair&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; *, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;&amp;gt; p = &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;s.top();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            *p.first = p.second;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;s.pop();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} ufs;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Edge {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; u, v, a, b;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} E[MAXM];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Query {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; u, v, a, b; &lt;span class=&quot;comment&quot;&gt;// , cnt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; ans; &lt;span class=&quot;comment&quot;&gt;// , solved;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} Q[MAXQ];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, m, q;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// bool ans[MAXQ];&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;compareByA&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; Edge &amp;amp;a, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; Edge &amp;amp;b)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; a.a &amp;lt; b.a;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;compareByB&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; Edge &amp;amp;a, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; Edge &amp;amp;b)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; a.b &amp;lt; b.b;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;compareQueryByB&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; Query *a, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; Query *b)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; a-&amp;gt;b &amp;lt; b-&amp;gt;b;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;/*&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;inline void forceSolve() {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    for (int i = 0; i &amp;lt; q; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ufs.init(n);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        for (int j = 0; j &amp;lt; m; j++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            if (E[j].a &amp;lt;= Q[i].a &amp;amp;&amp;amp; E[j].b &amp;lt;= Q[i].b) ufs.merge(E[j].u, E[j].v, E[j].a, E[j].b);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        int a, b;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        if (ufs.find(Q[i].u, a, b) == ufs.find(Q[i].v)) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            if (a == Q[i].a &amp;amp;&amp;amp; b == Q[i].b) Q[i].ans = true;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            else Q[i].ans = false;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        } else Q[i].ans = false;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;*/&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;solve&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::sort(E, E + m, &amp;amp;compareByA);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; blockSize = &lt;span class=&quot;built_in&quot;&gt;floor&lt;/span&gt;(&lt;span class=&quot;built_in&quot;&gt;sqrt&lt;/span&gt;(m) + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// printf(&amp;quot;blockSize = %d\n&amp;quot;, blockSize);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; m; i += blockSize) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; curr = &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::min(m - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, i);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// printf(&amp;quot;curr = %d, curr + blockSize = %d\n&amp;quot;, curr, curr + blockSize);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::sort(E, E + curr, &amp;amp;compareByB);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ufs.init(n);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;vector&lt;/span&gt;&amp;lt;Query *&amp;gt; vec;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; j = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; j &amp;lt; q; j++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (Q[j].a &amp;gt;= E[curr].a &amp;amp;&amp;amp; (curr + blockSize &amp;gt;= m || Q[j].a &amp;lt; E[curr + blockSize].a)) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                vec.push_back(&amp;amp;Q[j]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;comment&quot;&gt;// printf(&amp;quot;getting queries -&amp;gt;  saved  { %d -&amp;gt; %d, [%d, %d] }\n&amp;quot;, Q[j].u + 1, Q[j].v + 1, Q[j].a, Q[j].b);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            } &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;comment&quot;&gt;// printf(&amp;quot;getting queries -&amp;gt; ignored { %d -&amp;gt; %d, [%d, %d] }\n&amp;quot;, Q[j].u + 1, Q[j].v + 1, Q[j].a, Q[j].b);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::sort(vec.begin(), vec.end(), &amp;amp;compareQueryByB);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; j = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;vector&lt;/span&gt;&amp;lt;Query *&amp;gt;::const_iterator it = vec.begin(); it != vec.end(); it++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Query *p = *it;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (j &amp;lt; curr &amp;amp;&amp;amp; E[j].b &amp;lt;= p-&amp;gt;b) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                Edge &amp;amp;e = E[j];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                ufs.merge(e.u, e.v, e.a, e.b);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;comment&quot;&gt;// printf(&amp;quot;E(%d -&amp;gt; %d, [%d, %d])\n&amp;quot;, e.u + 1, e.v + 1, e.a, e.b);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                j++;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;// static char restoreBuffers[sizeof(UnionFindSet)];&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;// memcpy(restoreBuffers, &amp;amp;ufs, sizeof(UnionFindSet));&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;size_t&lt;/span&gt; s = ufs.status();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; k = curr; k &amp;lt; &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::min(curr + blockSize, m); k++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;// for (int k = 0; k &amp;lt; m; k++) {&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                Edge &amp;amp;e = E[k];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (e.a &amp;lt;= p-&amp;gt;a &amp;amp;&amp;amp; e.b &amp;lt;= p-&amp;gt;b) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    ufs.merge(e.u, e.v, e.a, e.b);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; a, b;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (ufs.find(p-&amp;gt;u, a, b) == ufs.find(p-&amp;gt;v)) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (a == p-&amp;gt;a &amp;amp;&amp;amp; b == p-&amp;gt;b) p-&amp;gt;ans = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; p-&amp;gt;ans = &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            } &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; p-&amp;gt;ans = &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;// assert(p-&amp;gt;ans == ans[&amp;amp;*p - Q]);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;// if (p - Q + 1 &amp;gt;= 200 &amp;amp;&amp;amp; p - Q + 1 &amp;lt;= 220) {&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;//     printf(&amp;quot;Q(%d -&amp;gt; %d, [%d, %d]) = %s\n&amp;quot;, p-&amp;gt;u + 1, p-&amp;gt;v + 1, p-&amp;gt;a, p-&amp;gt;b, p-&amp;gt;ans ? &amp;quot;Yes&amp;quot; : &amp;quot;No&amp;quot;);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;// }&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;// p-&amp;gt;cnt++;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;// p-&amp;gt;solved = true;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            ufs.restore(s);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;// memcpy(&amp;amp;ufs, restoreBuffers, sizeof(UnionFindSet));&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    freopen(&lt;span class=&quot;string&quot;&gt;&amp;quot;multiple.in&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;r&amp;quot;&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;stdin&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    freopen(&lt;span class=&quot;string&quot;&gt;&amp;quot;multiple.out&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;w&amp;quot;&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;stdout&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d&amp;quot;&lt;/span&gt;, &amp;amp;n, &amp;amp;m);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; m; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d %d %d&amp;quot;&lt;/span&gt;, &amp;amp;E[i].u, &amp;amp;E[i].v, &amp;amp;E[i].a, &amp;amp;E[i].b);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        E[i].u--, E[i].v--;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;q);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; q; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d %d %d&amp;quot;&lt;/span&gt;, &amp;amp;Q[i].u, &amp;amp;Q[i].v, &amp;amp;Q[i].a, &amp;amp;Q[i].b);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Q[i].u--, Q[i].v--;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// forceSolve();&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    solve();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; q; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// assert(Q[i].solved);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// printf(&amp;quot;%d &amp;quot;, Q[i].cnt);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;puts&lt;/span&gt;(Q[i].ans ? &lt;span class=&quot;string&quot;&gt;&amp;quot;Yes&amp;quot;&lt;/span&gt; : &lt;span class=&quot;string&quot;&gt;&amp;quot;No&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    fclose(&lt;span class=&quot;built_in&quot;&gt;stdin&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    fclose(&lt;span class=&quot;built_in&quot;&gt;stdout&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x7ED9;&amp;#x5B9A;&amp;#x4E00;&amp;#x5F20; $ N $ &amp;#x4E2A;&amp;#x9876;&amp;#x70B9; $ M $ &amp;#x6761;&amp;#x8FB9;&amp;#x7684;&amp;#x65E0;&amp;#x5411;&amp;#x56FE;&amp;#xFF08;&amp;#x9876;&amp;#x70B9;&amp;#x7F16;&amp;#x53F7;&amp;#x4E3A; $ 1,\ 2,\ \dots,\ n $&amp;#xFF09;&amp;#xFF0C;&amp;#x6BCF;&amp;#x6761;&amp;#x8FB9;&amp;#x4E0A;&amp;#x5E26;&amp;#x6709;&amp;#x6743;&amp;#x503C;&amp;#x3002;&amp;#x6240;&amp;#x6709;&amp;#x6743;&amp;#x503C;&amp;#x90FD;&amp;#x53EF;&amp;#x4EE5;&amp;#x5206;&amp;#x89E3;&amp;#x6210; $ 2 ^ a 3 ^ b $ &amp;#x7684;&amp;#x5F62;&amp;#x5F0F;&amp;#x3002;&amp;#x73B0;&amp;#x5728;&amp;#x6709; $ q $ &amp;#x4E2A;&amp;#x8BE2;&amp;#x95EE;&amp;#xFF0C;&amp;#x6BCF;&amp;#x6B21;&amp;#x8BE2;&amp;#x95EE;&amp;#x7ED9;&amp;#x5B9A;&amp;#x56DB;&amp;#x4E2A;&amp;#x53C2;&amp;#x6570; $ u $&amp;#x3001;$ v $&amp;#x3001;$ a $ &amp;#x548C; $ b $&amp;#xFF0C;&amp;#x8BF7;&amp;#x4F60;&amp;#x6C42;&amp;#x51FA;&amp;#x662F;&amp;#x5426;&amp;#x5B58;&amp;#x5728;&amp;#x4E00;&amp;#x6761;&amp;#x9876;&amp;#x70B9; $ u $ &amp;#x5230; $ v $ &amp;#x4E4B;&amp;#x95F4;&amp;#x7684;&amp;#x8DEF;&amp;#x5F84;&amp;#xFF0C;&amp;#x4F7F;&amp;#x5F97;&amp;#x8DEF;&amp;#x5F84;&amp;#x4F9D;&amp;#x6B21;&amp;#x7ECF;&amp;#x8FC7;&amp;#x7684;&amp;#x8FB9;&amp;#x4E0A;&amp;#x7684;&amp;#x6743;&amp;#x503C;&amp;#x7684;&amp;#x6700;&amp;#x5C0F;&amp;#x516C;&amp;#x500D;&amp;#x6570;&amp;#x4E3A; $ 2 ^ a 3 ^ b $&amp;#x3002;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="BZOJ" scheme="https://blog.menci.moe/tag/bzoj/"/>
    
      <category term="COGS" scheme="https://blog.menci.moe/tag/cogs/"/>
    
      <category term="CodeVS" scheme="https://blog.menci.moe/tag/codevs/"/>
    
      <category term="HNOI" scheme="https://blog.menci.moe/tag/hnoi/"/>
    
      <category term="分块" scheme="https://blog.menci.moe/tag/%E5%88%86%E5%9D%97/"/>
    
      <category term="并查集" scheme="https://blog.menci.moe/tag/%E5%B9%B6%E6%9F%A5%E9%9B%86/"/>
    
  </entry>
  
  <entry>
    <title>CTSC2016 &amp; APIO2016 行纪</title>
    <link href="https://blog.menci.moe/ctsc-apio-2016/"/>
    <id>https://blog.menci.moe/ctsc-apio-2016/</id>
    <published>2016-05-09T10:18:13.000Z</published>
    <updated>2016-05-11T09:33:24.430Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x7B2C;&amp;#x4E00;&amp;#x6B21;&amp;#x53C2;&amp;#x52A0; CTSC &amp;amp; APIO&amp;#xFF0C;&amp;#x6D41;&amp;#x6C34;&amp;#x8D26;&amp;#x5982;&amp;#x4E0B;&amp;#x3002;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;section&quot;&gt;5.1&lt;/h3&gt;
&lt;p&gt;&amp;#x65E9;&amp;#x4E0A;&amp;#x4E94;&amp;#x70B9;&amp;#x6765;&amp;#x5230;&amp;#x4E86;&amp;#x5317;&amp;#x4EAC;&amp;#xFF0C;&amp;#x8F6C;&amp;#x4E86;&amp;#x4E24;&amp;#x8DEF;&amp;#x5730;&amp;#x94C1;&amp;#x4E00;&amp;#x8DEF;&amp;#x516C;&amp;#x4EA4;&amp;#x53C8;&amp;#x8D70;&amp;#x4E86;&amp;#x6BB5;&amp;#x8DEF;&amp;#xFF0C;&amp;#x7EC8;&amp;#x4E8E;&amp;#x5230;&amp;#x4E86;&amp;#x6606;&amp;#x6CF0;&amp;#x9152;&amp;#x5E97; &amp;#x2026;&amp;#x2026;&lt;br&gt;
&amp;#x56E0;&amp;#x4E3A;&amp;#x6765;&amp;#x7684;&amp;#x6709;&amp;#x70B9;&amp;#x65E9;&amp;#xFF0C;&amp;#x8FD8;&amp;#x4E0D;&amp;#x80FD;&amp;#x5F00;&amp;#x623F;&amp;#xFF0C;&amp;#x62A5;&amp;#x540D;&amp;#x4EBA;&amp;#x5458;&amp;#x4E5F;&amp;#x6CA1;&amp;#x6765;&amp;#xFF0C;&amp;#x53EA;&amp;#x597D;&amp;#x5148;&amp;#x5728;&amp;#x5927;&amp;#x5385;&amp;#x5750;&amp;#x4E0B;&amp;#x4E86;&amp;#xFF0C;&amp;#x611F;&amp;#x89C9;&amp;#x8FD9;&amp;#x9152;&amp;#x5E97;&amp;#x7F51;&amp;#x901F;&amp;#x4E0D;&amp;#x7ED9;&amp;#x529B;&amp;#x554A; QAQ&lt;br&gt;
&amp;#x516B;&amp;#x70B9;&amp;#x5F00;&amp;#x4E86;&amp;#x623F;&amp;#xFF0C;&amp;#x4F4F;&amp;#x5728;&amp;#x5341;&amp;#x697C;&amp;#xFF0C;&amp;#x53CC;&amp;#x4EBA;&amp;#x95F4;&amp;#x3002;&amp;#x548C;&amp;#x6211;&amp;#x4F4F;&amp;#x4E00;&amp;#x95F4;&amp;#x5C4B;&amp;#x7684;&amp;#x8FD8;&amp;#x6CA1;&amp;#x6765;&amp;#xFF0C;&amp;#x4F30;&amp;#x8BA1;&amp;#x662F;&amp;#x83B1;&amp;#x829C;&amp;#x6216;&amp;#x8005;&amp;#x9752;&amp;#x5C9B;&amp;#x7684;&amp;#x795E;&amp;#x7287;&amp;#xFF1F;qwq&lt;/p&gt;
&lt;p&gt;&amp;#x8FC7;&amp;#x4E86;&amp;#x4F1A;&amp;#x9752;&amp;#x5C9B;&amp;#x4E8C;&amp;#x4E2D;&amp;#x7684;&amp;#x6765;&amp;#x4E86;&amp;#xFF0C;Oxer &amp;#x548C;&amp;#x6211;&amp;#x4F4F;&amp;#x4E00;&amp;#x95F4;&amp;#x5C4B;&amp;#x3002;&amp;#x53BB;&amp;#x65C1;&amp;#x8FB9;&amp;#x5C4B;&amp;#x91CC;&amp;#x819C;&amp;#x4E86;&amp;#x4E00;&amp;#x53D1; yts1999 &amp;#x5927;&amp;#x7237;&amp;#xFF0C;RP++&lt;/p&gt;
&lt;p&gt;&amp;#x770B;&amp;#x4E86;&amp;#x770B;&amp;#x62A5;&amp;#x540D;&amp;#x8868;&amp;#xFF0C;&amp;#x770B;&amp;#x5230; Teachk &amp;#x6765;&amp;#x4E86;&amp;#xFF0C;&amp;#x4E8E;&amp;#x662F;&amp;#x627E;&amp;#x4ED6;&amp;#x9762;&amp;#x57FA;&amp;#x53BB;&amp;#x4E86; ovo &amp;#x8FD8;&amp;#x6709;&amp;#x5927;&amp;#x8FDE;&amp;#x7684;&amp;#x597D;&amp;#x51E0;&amp;#x4E2A;&amp;#x795E;&amp;#x7287;&amp;#xFF08;&amp;#x867D;&amp;#x7136;&amp;#x6211;&amp;#x90FD;&amp;#x4E0D;&amp;#x8BA4;&amp;#x8BC6;&lt;/p&gt;
&lt;p&gt;&amp;#x548C; HA &amp;#x7684;&amp;#x5C0F;&amp;#x4F19;&amp;#x4F34;&amp;#x78B0;&amp;#x4E86;&amp;#x78B0;&amp;#x5934;&amp;#xFF0C;CXC &amp;#x5E76;&amp;#x6CA1;&amp;#x6709;&amp;#x6765;&amp;#xFF08;&amp;#x5509;&amp;#x3002;&amp;#x3002;&amp;#x3002;&amp;#xFF09;&lt;br&gt;
&amp;#x4E2D;&amp;#x5348;&amp;#x4E00;&amp;#x8D77;&amp;#x53BB;&amp;#x6B21;&amp;#x996D;&amp;#x4E86; QwQ &amp;#x98DF;&amp;#x5802;&amp;#x7684;&amp;#x996D;&amp;#x597D;&amp;#x8BC4; &amp;#x53EA;&amp;#x662F;&amp;#x5B66;&amp;#x6821;&amp;#x6709;&amp;#x70B9;&amp;#x8FDC;&amp;#x5594; &amp;#x2026;&amp;#x2026;&lt;/p&gt;
&lt;p&gt;&amp;#x4E0B;&amp;#x5348;&amp;#x7761;&amp;#x4E86;&amp;#x4E00;&amp;#x4F1A;&amp;#xFF0C;&amp;#x9192;&amp;#x6765;&amp;#x53BB;&amp;#x4ED6;&amp;#x4EEC;&amp;#x90A3;&amp;#x91CC;&amp;#xFF0C;&lt;del&gt;sui &amp;#x548C; Fancy &amp;#x5728;&amp;#x7ED9;&amp;#x4ED6;&amp;#x4EEC;&amp;#x5B66;&amp;#x6821;&amp;#x9AD8;&amp;#x4E00;&amp;#x7684;&amp;#x540C;&amp;#x5B66;&amp;#x8BB2;&amp;#x8BFE;&amp;#xFF0C;&amp;#x8BB2;&amp;#x5B8C;&lt;/del&gt;&amp;#x8FC7;&amp;#x4E86;&amp;#x4E00;&amp;#x4F1A;&amp;#x6211;&amp;#x4EEC;&amp;#x5C31;&amp;#x53BB;&amp;#x8BD5;&amp;#x673A;&amp;#x4E86;&lt;br&gt;
COGS &amp;#x89C2;&amp;#x5149;&amp;#x56E2;&amp;#x5230;&amp;#x9F50;&amp;#x4E86;&amp;#x561B; QwQ &lt;del&gt;&amp;#x7136;&amp;#x800C;&amp;#x597D;&amp;#x591A;&amp;#x4EBA;&amp;#x3001;&amp;#x59D3;&amp;#x540D;&amp;#x3001;ID &amp;#x5BF9;&amp;#x4E0D;&amp;#x8D77;&amp;#x6765;&lt;/del&gt;&lt;br&gt;
&amp;#x987A;&amp;#x4FBF;&amp;#x53C2;&amp;#x89C2;&amp;#x4E86;&amp;#x4E00;&amp;#x4E0B;&amp;#x516B;&amp;#x5341;&amp;#x4E2D;&amp;#x7684;&amp;#x6559;&amp;#x5B66;&amp;#x697C;&amp;#xFF0C;&amp;#x597D;&amp;#x9AD8;&amp;#x7AEF; ovo&lt;br&gt;
&amp;#x9009;&amp;#x624B;&amp;#x7528;&amp;#x673A;&amp;#x64CD;&amp;#x4F5C;&amp;#x7CFB;&amp;#x7EDF;&amp;#x662F; NOI Linux&amp;#xFF08;Ubuntu 14.04 LTS&amp;#xFF09;&amp;#x597D;&amp;#x8BC4;&amp;#xFF01;&lt;br&gt;
&lt;del&gt;&amp;#xFF08;&amp;#x60F3;&amp;#x60F3; SDOI &amp;#x8FDE;&amp;#x4E2A;&amp;#x50CF;&amp;#x6837;&amp;#x7684;&amp;#x7F16;&amp;#x7A0B;&amp;#x73AF;&amp;#x5883;&amp;#x90FD;&amp;#x6CA1;&amp;#x6709;&amp;#x771F;&amp;#x662F;&amp;#x592A;&amp;#x53CD;&amp;#x4EBA;&amp;#x7C7B;&amp;#x4E86;&amp;#x554A;&amp;#x5582;&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;Fancy &amp;#x95EE;&amp;#x6211;&amp;#x600E;&amp;#x6837;&amp;#x624D;&amp;#x80FD;&amp;#x628A; vim &amp;#x914D;&amp;#x7F6E;&amp;#x80CC;&amp;#x4E0B;&amp;#x6765;&amp;#xFF0C;&amp;#x4E8E;&amp;#x662F;&amp;#x6211;&amp;#x628A;&amp;#x6BCF;&amp;#x4E00;&amp;#x884C;&amp;#x7684;&amp;#x542B;&amp;#x4E49;&amp;#x7ED9;&amp;#x5979;&amp;#x8BB2;&amp;#x4E86;&amp;#x4E00;&amp;#x904D;&lt;br&gt;
&amp;#x7136;&amp;#x800C; sui &amp;#x8868;&amp;#x793A;&amp;#x7F29;&amp;#x5199;&amp;#x591A;&amp;#x597D;&amp;#x8BB0;&amp;#x5440;~&lt;br&gt;
&lt;del&gt;&amp;#x6211;&amp;#x4F1A;&amp;#x544A;&amp;#x8BC9;&amp;#x4F60;&amp;#x4EEC;&amp;#x6211;&amp;#x7B2C;&amp;#x4E00;&amp;#x6B21;&amp;#x5728; JSOI &amp;#x8003;&amp;#x573A;&amp;#x4E0A;&amp;#x5199; vim &amp;#x914D;&amp;#x7F6E;&amp;#x7684;&amp;#x65F6;&amp;#x5019;&amp;#x8FD8;&amp;#x5217;&amp;#x51FA;&amp;#x6240;&amp;#x6709;&amp;#x547D;&amp;#x4EE4;&amp;#x627E;&amp;#x4E86;&amp;#x4E00;&amp;#x904D;&amp;#xFF1F;&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x8FC7;&amp;#x4E00;&amp;#x4F1A;&amp;#x5B89;&amp;#x5E08;&amp;#x5927;&amp;#x9644;&amp;#x4E2D;&amp;#x7684;&amp;#x795E;&amp;#x7287;&amp;#x4EEC;&amp;#x6765;&amp;#x4E86;&amp;#xFF0C;&amp;#x5728;&amp;#x558A;&amp;#x8BD5;&amp;#x673A;&amp;#x9898;&amp;#x76EE;&amp;#x662F;&amp;#x54EA;&amp;#x5E74;&amp;#x7684; NOI &amp;#x9898;&amp;#x76EE;&amp;#xFF0C;&amp;#x6C34;&amp;#x6C34;&amp;#x6C34; &amp;#x2026;&amp;#x2026; &lt;del&gt;&amp;#x542C;&amp;#x4E0D;&amp;#x4E0B;&amp;#x53BB;&amp;#x4E86;&amp;#x5C31;&amp;#x548C;&amp;#x5C0F;&amp;#x4F19;&amp;#x4F34;&amp;#x8D70;&amp;#x4E86;&lt;/del&gt;&lt;br&gt;
&amp;#x901B;&amp;#x4E86;&amp;#x901B;&amp;#x6821;&amp;#x56ED;&amp;#x5C31;&amp;#x53BB;&amp;#x6B21;&amp;#x4E0B;&amp;#x5348;&amp;#x996D;&amp;#x4E86;&lt;del&gt;&amp;#x8FD9;&amp;#x91CC;&amp;#x7684;&amp;#x996D;&amp;#x771F;&amp;#x597D;&amp;#x6B21;&amp;#x5440;&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x6B21;&amp;#x5B8C;&amp;#x996D;&amp;#x56DE;&amp;#x5230;&amp;#x9152;&amp;#x5E97;&amp;#xFF0C;&amp;#x4E0A;&amp;#x5B8C;&amp;#x5395;&amp;#x6240;&amp;#x53D1;&amp;#x73B0;&amp;#x81EA;&amp;#x5DF1; QQ &amp;#x767B;&amp;#x4E0D;&amp;#x4E0A;&amp;#x4E86;&amp;#xFF08;smg &amp;#x2026;&amp;#x2026;&lt;br&gt;
&amp;#x5582;&amp;#x5582;&amp;#x5582;&amp;#x6211;&amp;#x521A;&amp;#x624D;&amp;#x4E0D;&amp;#x5C31;&amp;#x662F;&amp;#x8BF4;&amp;#x4E86;&amp;#x4E00;&amp;#x53E5; %fqk &amp;#x5417;&amp;#x600E;&amp;#x4E48;&amp;#x6210;&amp;#x4E0D;&amp;#x826F;&amp;#x4FE1;&amp;#x606F;&amp;#x4E86; &amp;#x2026;&amp;#x2026;&lt;br&gt;
&amp;#x6362;&amp;#x4E86;&amp;#x4E2A; QQ &amp;#x53F7;&amp;#xFF0C;&amp;#x987A;&amp;#x4FBF;&amp;#x627E;&amp;#x5230; DQS &amp;#x795E;&amp;#x7287;&amp;#x52A0;&amp;#x56DE;&amp;#x4E86;&amp;#x4E4B;&amp;#x524D;&amp;#x7684;&amp;#x7FA4; &amp;#x2026;&amp;#x2026;&lt;br&gt;
&lt;del&gt;&amp;#x8FA3;&amp;#x9E21;&amp;#x817E;&amp;#x8BAF;&amp;#xFF0C;&amp;#x5403;&amp;#x67A3;&amp;#x836F;&amp;#x4E38;&amp;#xFF01;&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x665A;&amp;#x4E0A;&amp;#x627E;&amp;#x5C0F;&amp;#x4F19;&amp;#x4F34;&amp;#x4EEC;&amp;#x73A9;&amp;#xFF0C;&amp;#x7136;&amp;#x540E;&amp;#x88AB;&amp;#x62C9;&amp;#x5230;&amp;#x53E6;&amp;#x4E00;&amp;#x4E2A;&amp;#x623F;&amp;#x95F4;&amp;#xFF0C;&amp;#x53D1;&amp;#x73B0; COGS &amp;#x89C2;&amp;#x5149;&amp;#x56E2;&amp;#x7684;&amp;#x4EBA;&amp;#x90FD;&amp;#x5728;&amp;#x3002;&lt;br&gt;
sui&amp;#xFF1A;&amp;#x8FD9;&amp;#x5C31;&amp;#x662F; Menci&amp;#xFF01;&lt;br&gt;
&amp;#x4F17;&amp;#x4EBA;&amp;#xFF1A;%%%%% &amp;#x2026;&amp;#x2026;&lt;br&gt;
&lt;del&gt;Menci&amp;#xFF1A;mdzz &amp;#x2026; &amp;amp;@!#@%~&amp;amp; &amp;#x2026;&amp;#x2026;&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x4ED6;&amp;#x4EEC;&amp;#x8BF4; wmd &amp;#x660E;&amp;#x540E;&amp;#x5929;&amp;#x4F1A;&amp;#x6765;&amp;#x76D1;&amp;#x8003;&amp;#xFF0C;&amp;#x7136;&amp;#x540E;&amp;#x6211;&amp;#x968F;&amp;#x53E3;&amp;#x95EE;&amp;#x4E86;&amp;#x4E00;&amp;#x53E5; Chenyao &amp;#x600E;&amp;#x4E48;&amp;#x4E0D;&amp;#x6765; &amp;#x2026;&amp;#x2026;&lt;br&gt;
&amp;#x4ED6;&amp;#x4EEC;&amp;#x7ED9;&amp;#x6211;&amp;#x6307;&amp;#x4E86;&amp;#x4E00;&amp;#x4E0B;&amp;#x5C4B;&amp;#x5B50;&amp;#x91CC;&amp;#x7684;&amp;#x67D0;&amp;#x4E2A;&amp;#x4EBA;&amp;#xFF0C;&amp;#x8BF4;&amp;#xFF0C;&amp;#x8FD9;&amp;#x5C31;&amp;#x662F; Chenyao &amp;#x2026;&amp;#x2026;&lt;br&gt;
&lt;del&gt;mdzz &amp;#x2026;&amp;#x2026;&lt;/del&gt; &lt;del&gt;Chenyao &amp;#x771F;&amp;#x7684;&amp;#x597D;&amp;#x840C;&amp;#x597D;&amp;#x5E05;&amp;#x5440; Orz&amp;#xFF01;&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x770B;&amp;#x4ED6;&amp;#x4EEC;&amp;#x73A9;&amp;#x4E86;&amp;#x4E00;&amp;#x4E2A;&amp;#x53EB;&amp;#x505A;&amp;#x300E;&amp;#x5999;&amp;#x4E0D;&amp;#x53EF;&amp;#x8A00;&amp;#x300F;&amp;#x7684;&amp;#x795E;&amp;#x5947;&amp;#x7684;&amp;#x5361;&amp;#x724C;&amp;#x6E38;&amp;#x620F; &amp;#x2026;&amp;#x2026;&lt;br&gt;
&amp;#x73A9;&amp;#x4E86;&amp;#x4E00;&amp;#x5C40;&amp;#x4E4B;&amp;#x540E;&amp;#x4ED6;&amp;#x4EEC;&amp;#x5899;&amp;#x88C2;&amp;#x8981;&amp;#x6C42;&amp;#x6211;&amp;#x52A0;&amp;#x5165;&amp;#xFF0C;&amp;#x4E8E;&amp;#x662F;&amp;#x6211;&amp;#x4E5F;&amp;#x6CA1;&amp;#x62D2;&amp;#x7EDD; &amp;#x2026;&amp;#x2026;&lt;br&gt;
&amp;#x6109;&amp;#x2642;&amp;#x5FEB;&amp;#x5730;&amp;#x73A9;&amp;#x5B8C;&amp;#x4E00;&amp;#x5C40;&amp;#x4E4B;&amp;#x540E;&amp;#x53D1;&amp;#x73B0;&amp;#x65F6;&amp;#x95F4;&amp;#x4E0D;&amp;#x65E9;&amp;#x4E86;&amp;#xFF0C;&amp;#x56DE;&amp;#x5C4B;&amp;#x6D17;&amp;#x6FA1;&amp;#x7761;&amp;#x89C9; &amp;#x2026;&amp;#x2026; qwq&lt;/p&gt;
&lt;h3 id=&quot;section-1&quot;&gt;5.2&lt;/h3&gt;
&lt;p&gt;CTSC2016 Day1&lt;/p&gt;
&lt;p&gt;&amp;#x4E03;&amp;#x70B9;&amp;#x949F;&amp;#x4ECE;&amp;#x9152;&amp;#x5E97;&amp;#x51FA;&amp;#x53D1;&amp;#xFF0C;&amp;#x548C;&amp;#x4ED6;&amp;#x4EEC;&amp;#x4E00;&amp;#x8D77;&amp;#x53BB;&amp;#x4E86;&amp;#x5B66;&amp;#x6821;&lt;br&gt;
&amp;#x65E9;&amp;#x996D;&amp;#x8FD8;&amp;#x4E0D;&amp;#x9519;&amp;#x561B;&amp;#xFF0C;&amp;#x6CB9;&amp;#x6761;&amp;#x3001;&amp;#x9E21;&amp;#x86CB;&amp;#x3001;&amp;#x714E;&amp;#x997C;&amp;#x6CA1;&amp;#x6709;&amp;#x679C;&amp;#x5B50;&amp;#x3001;&amp;#x8C46;&amp;#x6D46;&amp;#x3001;&amp;#x5305;&amp;#x5B50; &amp;#x2026;&amp;#x2026;&lt;/p&gt;
&lt;p&gt;&amp;#x600E;&amp;#x4E48;&amp;#x5C31;&amp;#x6211;&amp;#x4E00;&amp;#x4E2A;&amp;#x5728;&amp;#x56FE;&amp;#x4E66;&amp;#x9986;&amp;#x8003;&amp;#x554A;&amp;#x5582; &amp;#x2026;&amp;#x2026; &amp;#x6CE5;&amp;#x840C;&amp;#x90FD;&amp;#x5728;&amp;#x6559;&amp;#x5B66;&amp;#x697C; &amp;#x2026;&amp;#x2026;&lt;br&gt;
&amp;#x56FE;&amp;#x4E66;&amp;#x9986;&amp;#x5728;&amp;#x54EA;&amp;#x91CC;&amp;#x554A;&amp;#x5582; &amp;#x2026;&amp;#x2026;&lt;br&gt;
&amp;#x54E6; &amp;#x2026;&amp;#x2026; &amp;#x5C31;&amp;#x5728;&amp;#x6559;&amp;#x5B66;&amp;#x697C;&amp;#x65C1;&amp;#x8FB9; &amp;#x2026;&amp;#x2026;&lt;/p&gt;
&lt;p&gt;&amp;#x56FE;&amp;#x4E66;&amp;#x9986;&amp;#x5916;&amp;#x9762;&amp;#x9047;&amp;#x5230;&amp;#x4E86;&amp;#x9752;&amp;#x5C9B;&amp;#x4E8C;&amp;#x4E2D;&amp;#x7684; dms &amp;#x795E;&amp;#x7287;&amp;#xFF0C;&amp;#x819C;&amp;#x4E86;&amp;#x4E00;&amp;#x53D1; &amp;#x2026;&amp;#x2026;&lt;br&gt;
&amp;#x8BF6;&amp;#x600E;&amp;#x4E48;&amp;#x8FD8;&amp;#x4E0D;&amp;#x5165;&amp;#x573A; &amp;#x2026;&amp;#x2026; &amp;#x90FD;&amp;#x516B;&amp;#x70B9;&amp;#x534A;&amp;#x4E86;&amp;#x554A;&amp;#x5582; &amp;#x2026;&amp;#x2026;&lt;br&gt;
&amp;#x5165;&amp;#x573A;&amp;#x4E4B;&amp;#x540E;&amp;#x770B;&amp;#x4E86;&amp;#x4E0B;&amp;#x7535;&amp;#x8111;&amp;#x4E0A;&amp;#x7684;&amp;#x65F6;&amp;#x95F4;&amp;#xFF0C;&amp;#x516B;&amp;#x70B9;&amp;#x56DB;&amp;#x5341;&amp;#x591A; &amp;#x2026;&amp;#x2026;&lt;br&gt;
&lt;del&gt;mdzz &amp;#x2026;&amp;#x2026;&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x559D;&amp;#x6C34;&amp;#x770B;&amp;#x9898; &amp;#x2026;&amp;#x2026;&lt;/p&gt;
&lt;p&gt;&amp;#x7B2C;&amp;#x4E00;&amp;#x9898;&amp;#xFF0C;&amp;#x86E4;&amp;#xFF1F;&amp;#x9898;&amp;#x610F;&amp;#x90FD;&amp;#x8BFB;&amp;#x4E0D;&amp;#x61C2;&amp;#x8BED;&amp;#x6587;&amp;#x6C34;&amp;#x5E73;&amp;#x771F;&amp;#x662F;&amp;#x592A;&amp;#x5DEE;&amp;#x4E86; &amp;#x2026;&amp;#x2026;&lt;br&gt;
&amp;#x7B2C;&amp;#x4E09;&amp;#x9898;&amp;#xFF0C;&amp;#x63D0;&amp;#x4EA4;&amp;#x7B54;&amp;#x6848;&amp;#xFF1F;&amp;#x86E4;&amp;#xFF1F;&amp;#xFF08;&amp;#x6B64;&amp;#x5904;&amp;#x7701;&amp;#x7565;&amp;#x4E00;&amp;#x5F20; &amp;#x8FD9;&amp;#x9898;&amp;#x80FD;&amp;#x505A;&amp;#xFF1F;.jpg&amp;#xFF09;&lt;br&gt;
&amp;#x7B2C;&amp;#x4E8C;&amp;#x9898;&amp;#xFF0C;Suffix Array&amp;#xFF1F;&amp;#x5199;&amp;#x4E2A;&amp;#x540E;&amp;#x7F00;&amp;#x6570;&amp;#x7EC4;&amp;#x6253;&amp;#x6253;&amp;#x66B4;&amp;#x529B;&amp;#x5427;&amp;#xFF0C;&amp;#x600E;&amp;#x4E48;&amp;#x8FD9;&amp;#x4E48;&amp;#x5C0F;&amp;#x6C14;&amp;#x624D;&amp;#x7ED9; 5 &amp;#x5206;&amp;#x66B4;&amp;#x529B;&amp;#x5206;&amp;#x554A; &amp;#x2026;&amp;#x2026;&lt;/p&gt;
&lt;p&gt;&amp;#x5F00;&amp;#x59CB;&amp;#x6572;&amp;#x540E;&amp;#x7F00;&amp;#x6570;&amp;#x7EC4; &amp;#x2026;&amp;#x2026;&lt;br&gt;
&amp;#x4E8C;&amp;#x5341;&amp;#x5206;&amp;#x949F;&amp;#x540E;&amp;#xFF0C;&amp;#x540E;&amp;#x7F00;&amp;#x6570;&amp;#x7EC4;&amp;#x6572;&amp;#x5B8C;&amp;#x4E86; &amp;#x2026;&amp;#x2026;&lt;br&gt;
&amp;#x5BF9;&amp;#x62CD;&amp;#x4E00;&amp;#x4E0B;&amp;#x5427; &amp;#x2026;&amp;#x2026;&lt;br&gt;
&amp;#x8BF6;&amp;#x600E;&amp;#x4E48;&amp;#x663E;&amp;#x793A;&amp;#x51FA;&amp;#x9519;&amp;#x7684;&amp;#x4E24;&amp;#x884C;&amp;#x90FD;&amp;#x4E00;&amp;#x6837;&amp;#xFF1F;&lt;br&gt;
&amp;#x81EA;&amp;#x5DF1;&amp;#x770B;&amp;#x770B;&amp;#x8F93;&amp;#x51FA;&amp;#x6587;&amp;#x4EF6;&amp;#x5427;&amp;#xFF0C;&amp;#x53D1;&amp;#x73B0;&amp;#x6709;&amp;#x4E24;&amp;#x4E2A;&amp;#x6392;&amp;#x540D;&amp;#x88AB;&amp;#x5F04;&amp;#x53CD;&amp;#x4E86; &amp;#x2026;&amp;#x2026;&lt;br&gt;
&amp;#x8DDF;&amp;#x8E2A;&amp;#x8C03;&amp;#x8BD5;&amp;#x4E86;&amp;#x597D;&amp;#x4E45;&amp;#xFF0C;&amp;#x53D1;&amp;#x73B0;&amp;#x67D0;&amp;#x4E2A;&amp;#x5730;&amp;#x65B9;&amp;#x6F0F;&amp;#x4E86;&amp;#x4E2A; &lt;code&gt;else&lt;/code&gt; &amp;#x2026;&amp;#x2026;&lt;br&gt;
&lt;del&gt;mdzz &amp;#x2026;&amp;#x2026;&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x7801;&amp;#x597D;&amp;#x7206;&amp;#x641C;&amp;#xFF0C;&amp;#x8BD5;&amp;#x8BD5;&amp;#x6837;&amp;#x4F8B; &amp;#x2026;&amp;#x2026;&lt;br&gt;
&amp;#x6837;&amp;#x4F8B;&amp;#x4E00;&amp;#x8FC7;&amp;#x4E86; &amp;#x2026;&amp;#x2026;&lt;br&gt;
&amp;#x6837;&amp;#x4F8B;&amp;#x4E8C;&amp;#x8F93;&amp;#x51FA;&amp;#x5C0F;&amp;#x4E86;&amp;#x5F88;&amp;#x591A; &amp;#x2026;&amp;#x2026;&lt;br&gt;
&amp;#x8C03;&amp;#x4E86;&amp;#x597D;&amp;#x4E45;&amp;#x8C03;&amp;#x4E0D;&amp;#x51FA;&amp;#x6765;&amp;#xFF0C;&amp;#x6700;&amp;#x540E;&amp;#x8F93;&amp;#x51FA;&amp;#x4E86;&amp;#xFF0C;&amp;#x8BF6;&amp;#x53D1;&amp;#x73B0;&amp;#x5B57;&amp;#x7B26;&amp;#x4E32;&amp;#x600E;&amp;#x4E48;&amp;#x53D8;&amp;#x77ED;&amp;#x4E86; &amp;#x2026;&amp;#x2026; &amp;#x8BF6;&amp;#x8FD9;&amp;#x4E2A; &lt;code&gt;n&lt;/code&gt; &amp;#x600E;&amp;#x4E48;&amp;#x53D8;&amp;#x5C0F;&amp;#x4E86; &amp;#x2026;&amp;#x2026;&lt;br&gt;
&lt;del&gt;mdzz&lt;/del&gt;&amp;#xFF0C;&amp;#x5FD8;&amp;#x4E86;&amp;#x6E05;&amp;#x6570;&amp;#x7EC4;&amp;#x4E86; &amp;#x2026;&amp;#x2026;&lt;/p&gt;
&lt;p&gt;&amp;#x6E05;&amp;#x4E86;&amp;#x6570;&amp;#x7EC4;&amp;#x53C8;&amp;#x8BD5;&amp;#x4E86;&amp;#x4E0B;&amp;#x6837;&amp;#x4F8B;&amp;#xFF0C;&amp;#x600E;&amp;#x4E48;&amp;#x8FD8;&amp;#x662F;&amp;#x4E0D;&amp;#x5BF9;&amp;#x554A;&amp;#x5582; &amp;#x2026;&amp;#x2026;&lt;br&gt;
&amp;#x5F00;&amp;#x59CB;&amp;#x5404;&amp;#x79CD;&amp;#x4E71;&amp;#x8C03; &amp;#x2026;&amp;#x2026;&lt;br&gt;
&amp;#x8C03;&amp;#x4E86;&amp;#x4E00;&amp;#x4E2A;&amp;#x5C0F;&amp;#x65F6;&amp;#xFF0C;&amp;#x7B54;&amp;#x6848;&amp;#x6CA1;&amp;#x53D8; &amp;#x2026;&amp;#x2026;&lt;br&gt;
&lt;del&gt;&amp;#x4ECA;&amp;#x5929;&amp;#x4E0A;&amp;#x5348;&amp;#x5C31;&amp;#x6760;&amp;#x8FD9;&amp;#x9898;&amp;#x4E86;&amp;#xFF01;&amp;#x6760;&amp;#x51FA;&amp;#x6765;&amp;#x5C31;&amp;#x6709; 5 &amp;#x5206;&amp;#x4E86;&amp;#xFF01;&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x300E;&amp;#x9009;&amp;#x624B;&amp;#x6CE8;&amp;#x610F;&amp;#xFF0C;&amp;#x7B2C;&amp;#x4E8C;&amp;#x9898;&amp;#x7B2C;&amp;#x4E8C;&amp;#x4E2A;&amp;#x6837;&amp;#x4F8B;&amp;#x6539;&amp;#x4E3A; &amp;#x2026;&amp;#x2026;&amp;#x300F;&lt;br&gt;
&amp;#x554A;&amp;#xFF0C;&amp;#x6240;&amp;#x4EE5;&amp;#x8BF4;&amp;#x6211;&amp;#x7684;&amp;#x662F;&amp;#x5BF9;&amp;#x7684;&amp;#xFF1F;&lt;br&gt;
&lt;del&gt;mdzz &amp;#x6211;&amp;#x90FD;&amp;#x8C03;&amp;#x4E86;&amp;#x4E00;&amp;#x4E2A;&amp;#x591A;&amp;#x5C0F;&amp;#x65F6;&amp;#x4E86;&amp;#x554A;&amp;#x5582;&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x770B;&amp;#x6765;&amp;#x7B2C;&amp;#x4E8C;&amp;#x9898;&amp;#x6709; 5 &amp;#x5206;&amp;#x4E86;&amp;#xFF0C;&amp;#x51B7;&amp;#x9759;&amp;#x4E0B;&amp;#x6765;&amp;#x8BFB;&amp;#x4E86;&amp;#x8BFB;&amp;#x7B2C;&amp;#x4E00;&amp;#x9898;&amp;#x9898;&amp;#x610F;&amp;#xFF0C;&amp;#x53D1;&amp;#x73B0;&amp;#x80FD;&amp;#x8BFB;&amp;#x61C2;&amp;#x4E86;&amp;#xFF0C;&amp;#x5C1D;&amp;#x8BD5;&amp;#x5199;&amp;#x4E86;&amp;#x4E0B; 5 &amp;#x5206;&amp;#x66B4;&amp;#x529B;&amp;#xFF0C;&amp;#x5F88;&amp;#x5FEB;&amp;#x8C03;&amp;#x51FA;&amp;#x6765;&amp;#x4E86; &amp;#x2026;&amp;#x2026;&lt;/p&gt;
&lt;p&gt;&amp;#x770B;&amp;#x5230;&amp;#x4E86;&amp;#x4E00;&amp;#x4E8C;&amp;#x4E24;&amp;#x9898;&amp;#x90FD;&amp;#x6709;&amp;#x597D;&amp;#x591A;&amp;#x90E8;&amp;#x5206;&amp;#x5206;&amp;#xFF0C;&amp;#x4F46;&amp;#x662F;&amp;#x4E0D;&amp;#x597D;&amp;#x641E;&amp;#x554A; &amp;#x2026;&amp;#x2026;&lt;br&gt;
&amp;#x770B;&amp;#x4E86;&amp;#x4E0B; T3&amp;#xFF0C;&amp;#x6839;&amp;#x672C;&amp;#x4E0D;&amp;#x53EF;&amp;#x505A;&amp;#x554A;&amp;#xFF0C;&amp;#x9898;&amp;#x7B54;&amp;#x600E;&amp;#x4E48;&amp;#x73A9;&amp;#x554A;&amp;#x6211;&amp;#x4E0D;&amp;#x4F1A; &amp;#x2026;&amp;#x2026;&lt;/p&gt;
&lt;p&gt;&amp;#x8FD8;&amp;#x5269;&amp;#x4E8C;&amp;#x5341;&amp;#x5206;&amp;#x949F;&amp;#x4E86;&amp;#xFF0C;&amp;#x60F3;&amp;#x60F3;&amp;#x628A; T3 &amp;#x5168;&amp;#x586B;&amp;#x4E0A;&amp;#x968F;&amp;#x673A;&amp;#x6570;&amp;#x5427; &amp;#x2026;&amp;#x2026; &amp;#x8BF4;&amp;#x4E0D;&amp;#x5B9A;&amp;#x80FD;&amp;#x6709;&amp;#x51E0;&amp;#x5206; &amp;#x2026;&amp;#x2026;&lt;/p&gt;
&lt;p&gt;&amp;#x51FA;&amp;#x4E86;&amp;#x8003;&amp;#x573A;&amp;#xFF0C;&amp;#x5916;&amp;#x9762;&amp;#x4E0B;&amp;#x96E8;&amp;#x4E86;&amp;#xFF0C;&amp;#x6253;&amp;#x5F00;&amp;#x624B;&amp;#x673A;&amp;#x63A5;&amp;#x7740;&amp;#x63A5;&amp;#x5230;&amp;#x4E86; Fancy &amp;#x7684;&amp;#x7535;&amp;#x8BDD; &amp;#x2026;&amp;#x2026;&lt;br&gt;
Fancy&amp;#xFF1A;&amp;#x6211;&amp;#x4EEC;&amp;#x7B49;&amp;#x4E86;&amp;#x4F60;&amp;#x5341;&amp;#x591A;&amp;#x5206;&amp;#x949F;&amp;#xFF0C;&amp;#x6CA1;&amp;#x7B49;&amp;#x5230;&amp;#x4F60;&amp;#xFF0C;&amp;#x5C31;&amp;#x5148;&amp;#x53BB;&amp;#x98DF;&amp;#x5802;&amp;#x4E86;&lt;br&gt;
Menci&amp;#xFF1A;&amp;amp;@!#@%~&amp;amp; &amp;#x2026;&amp;#x2026; &amp;#x8981;&amp;#x4E0D;&amp;#x8BA9; sui &amp;#x6765;&amp;#x63A5;&amp;#x6211;&amp;#x5427; &amp;#x2026;&amp;#x2026;&lt;br&gt;
&lt;del&gt;mdzz &amp;#x4E3A;&amp;#x4EC0;&amp;#x4E48;&amp;#x53EA;&amp;#x6709;&amp;#x56FE;&amp;#x4E66;&amp;#x9986;&amp;#x5EF6;&amp;#x65F6;&amp;#x4E86;&amp;#x554A;&amp;#x5582; &amp;#x2026;&amp;#x2026;&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x548C;&amp;#x4ED6;&amp;#x4EEC;&amp;#x8BA8;&amp;#x8BBA;&amp;#x4E86;&amp;#x4E00;&amp;#x4E0B;&amp;#x9898;&lt;br&gt;
&amp;#x300E;&amp;#x7B2C;&amp;#x4E09;&amp;#x9898;&amp;#x7B2C;&amp;#x4E00;&amp;#x4E2A;&amp;#x70B9;&amp;#x7EC4;&amp;#x5408;&amp;#x6570;&amp;#x3001;&amp;#x7B2C;&amp;#x4E8C;&amp;#x4E2A;&amp;#x70B9; 01 &amp;#x80CC;&amp;#x5305;&amp;#x3001;&amp;#x7B2C; X &amp;#x4E2A;&amp;#x70B9;&amp;#x77E9;&amp;#x9635;&amp;#x4E58;&amp;#x6CD5;&amp;#xFF0C;&amp;#x8FD8;&amp;#x771F;&amp;#x662F;&amp;#x5341;&amp;#x5408;&amp;#x4E00; &amp;#x2026;&amp;#x2026;&amp;#x300F;&lt;br&gt;
&amp;#x86E4;&amp;#xFF1F;&lt;br&gt;
&amp;#x300E;&amp;#x7B2C;&amp;#x4E00;&amp;#x9898;&amp;#x9898;&amp;#x610F;&amp;#x8BFB;&amp;#x4E0D;&amp;#x61C2;&amp;#x554A; &amp;#x2026;&amp;#x2026; &amp;#x7B2C;&amp;#x4E8C;&amp;#x9898;&amp;#x4E2D;&amp;#x95F4;&amp;#x7684;&amp;#x90E8;&amp;#x5206;&amp;#x5206;&amp;#x53EF;&amp;#x4EE5;&amp;#x6253;&amp;#x8868;&amp;#x627E;&amp;#x89C4;&amp;#x5F8B; &amp;#x2026;&amp;#x2026;&amp;#x300F;&lt;br&gt;
&amp;#x86E4;&amp;#xFF1F;&lt;br&gt;
&amp;#x300E;&amp;#x7B2C;&amp;#x4E09;&amp;#x9898;&amp;#x641E;&amp;#x4E86;&amp;#x641E;&amp;#x524D;&amp;#x4E24;&amp;#x4E2A;&amp;#x70B9;&amp;#xFF0C;&amp;#x540E;&amp;#x9762;&amp;#x7684;&amp;#x5168;&amp;#x8F93;&amp;#x51FA; 0 &amp;#x2026;&amp;#x2026;&amp;#x300F;&lt;br&gt;
&amp;#x86E4;&amp;#xFF1F;&lt;br&gt;
&amp;#x86E4;&amp;#xFF1F;&amp;#x86E4;&amp;#xFF1F;&lt;br&gt;
mdzz &amp;#x2026;&amp;#x2026; &amp;#x6211;&amp;#x4E3A;&amp;#x4EC0;&amp;#x4E48;&amp;#x8981;&amp;#x8F93;&amp;#x51FA;&amp;#x968F;&amp;#x673A;&amp;#x6570;&amp;#x554A;&amp;#x5582;&amp;#xFF0C;&amp;#x8F93;&amp;#x51FA; 0 &amp;#x624D;&amp;#x80FD;&amp;#x5F97;&amp;#x5206;&amp;#x554A;&amp;#x5582; &amp;#x2026;&amp;#x2026;&lt;/p&gt;
&lt;p&gt;&lt;del&gt;&amp;#x6211;&amp;#x600E;&amp;#x4E48;&amp;#x611F;&amp;#x89C9;&amp;#x5C31;&amp;#x6211;&amp;#x5206;&amp;#x6570;&amp;#x6700;&amp;#x4F4E;&amp;#x554A;&amp;#x5582; &amp;#x2026;&amp;#x2026;&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x4E0B;&amp;#x5348;&amp;#x8BB2;&amp;#x9898;&amp;#xFF0C;&amp;#x5168;&amp;#x7A0B;&amp;#x542C;&amp;#x4E0D;&amp;#x61C2; &amp;#x2026;&amp;#x2026; &amp;#x542C;&amp;#x4E0D;&amp;#x61C2; &amp;#x2026;&amp;#x2026; XD&lt;br&gt;
&amp;#x7B2C;&amp;#x4E00;&amp;#x9898; yts1999 &amp;#x7528;&amp;#x4E00;&amp;#x79CD;&amp;#x5947;&amp;#x602A;&amp;#x7684;&amp;#x65B9;&amp;#x6CD5;&amp;#x7528;&amp;#x8D85;&amp;#x54E5;&amp;#x7EBF;&amp;#x6BB5;&amp;#x6811;&amp;#x641E;&amp;#x4E86;&amp;#x641E;&amp;#x90E8;&amp;#x5206;&amp;#x5206; &amp;#x2026;&amp;#x2026;&lt;br&gt;
&amp;#x86E4;&amp;#xFF1F;&lt;br&gt;
&amp;#x7B2C;&amp;#x4E09;&amp;#x9898;&amp;#x5341;&amp;#x4E2A;&amp;#x70B9;&amp;#x5341;&amp;#x4E2A;&amp;#x7B97;&amp;#x6CD5; &amp;#x2026;&amp;#x2026; &amp;#x5F03;&amp;#x7597;&amp;#x4FDD;&amp;#x5E73;&amp;#x5B89; &amp;#x2026;&amp;#x2026;&lt;/p&gt;
&lt;p&gt;&amp;#x770B;&amp;#x4E86;&amp;#x6210;&amp;#x7EE9;&amp;#xFF0C;&lt;code&gt;5 + 5 + 2 = 12&lt;/code&gt; &amp;#x5206;&amp;#xFF0C;&amp;#x7B2C;&amp;#x4E09;&amp;#x9898;&amp;#x968F;&amp;#x673A;&amp;#x6570;&amp;#x70B8;&amp;#x4E86; &amp;#x2026;&amp;#x2026;&lt;br&gt;
&amp;#x679C;&amp;#x7136;&amp;#x5C31;&amp;#x6211;&amp;#x5206;&amp;#x6700;&amp;#x4F4E;&amp;#xFF0C;Fancy &amp;#x8F93;&amp;#x51FA; 0 &amp;#x62FF;&amp;#x4E86; 15 &amp;#x5206; &amp;#x2026;&amp;#x2026;&lt;/p&gt;
&lt;p&gt;&amp;#x611F;&amp;#x89C9;&amp;#x8981; Fe &amp;#x6EDA;&amp;#x7C97;&amp;#x4E86; &amp;#x2026;&amp;#x2026;&lt;/p&gt;
&lt;p&gt;&amp;#x665A;&amp;#x4E0A;&amp;#xFF0C;sui &amp;#x7ED9;&amp;#x6211;&amp;#x8BB2;&amp;#x4E86; HNOI &amp;#x7684;&amp;#x51E0;&amp;#x9053;&amp;#x9898;&amp;#xFF0C;&amp;#x4E8E;&amp;#x662F;&amp;#x6211;&amp;#x5728;&amp;#x8C03;&amp;#x9898;&amp;#xFF0C;&lt;del&gt;&amp;#x4ED6;&amp;#x4EEC;&amp;#x90FD;&amp;#x53BB;&amp;#x9893;&amp;#x4E86;&lt;/del&gt;&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;section-2&quot;&gt;5.3&lt;/h3&gt;
&lt;p&gt;&amp;#x4E0A;&amp;#x5348;&amp;#xFF0C;&amp;#x96C6;&amp;#x8BAD;&amp;#x961F;&amp;#x8BBA;&amp;#x6587;&amp;#x7B54;&amp;#x8FA9;&amp;#xFF0C;&amp;#x542C;&amp;#x61C2;&amp;#x7684;&amp;#x4E1C;&amp;#x897F;&amp;#x4E0D;&amp;#x591A;&amp;#x554A; &amp;#x2026;&amp;#x2026; QAQ&amp;#xFF08;&amp;#x7A9D;&amp;#x8FD8;&amp;#x662F;&amp;#x592A;&amp;#x5F31;&amp;#x8FA3;&lt;/p&gt;
&lt;p&gt;faebdc &amp;#x8BB2;&amp;#x7684;&amp;#x7F51;&amp;#x7EDC;&amp;#x6D41;&amp;#x8FD8;&amp;#x662F;&amp;#x633A;&amp;#x8D5E;&amp;#x7684; &amp;#x2026;&amp;#x2026;&lt;/p&gt;
&lt;p&gt;&amp;#x4E0B;&amp;#x5348;&amp;#x62A5;&amp;#x544A;&amp;#x4F1A;&amp;#xFF0C;&amp;#x5927;&amp;#x5BB6;&amp;#x90FD;&amp;#x8BF4;&amp;#x4E0D;&amp;#x60F3;&amp;#x53BB;&amp;#x4E86; &amp;#x2026;&amp;#x2026; &amp;#x4E8E;&amp;#x662F;&amp;#x6253;&amp;#x7B97;&amp;#x5728;&amp;#x9152;&amp;#x5E97;&amp;#x788E;&amp;#x89C9; &amp;#x2026;&amp;#x2026;&lt;br&gt;
&amp;#x7136;&amp;#x540E;&amp;#x63A5;&amp;#x5230; Fancy &amp;#x7684;&amp;#x7535;&amp;#x8BDD;&amp;#xFF0C;&amp;#x8BF4;&amp;#x4E0D;&amp;#x53C2;&amp;#x52A0;&amp;#x62A5;&amp;#x544A;&amp;#x4F1A;&amp;#x53D6;&amp;#x6D88;&amp;#x660E;&amp;#x5929;&amp;#x6BD4;&amp;#x8D5B;&amp;#x8D44;&amp;#x683C; &amp;#x2026;&amp;#x2026;&lt;/p&gt;
&lt;p&gt;&amp;#x86E4;&amp;#xFF1F;&amp;#x8D76;&amp;#x7D27;&amp;#x8D77;&amp;#x6765;&amp;#x8D70;&amp;#x5427; &amp;#x2026;&amp;#x2026;&lt;br&gt;
&amp;#x5728;&amp;#x8BA8;&amp;#x8BBA;&amp;#x7EC4;&amp;#x91CC;&amp;#x95EE;&amp;#x4E86;&amp;#x4E00;&amp;#x4E0B;&amp;#xFF0C;&amp;#x4ED6;&amp;#x4EEC;&amp;#x8868;&amp;#x793A;&amp;#x90FD;&amp;#x4E0D;&amp;#x53BB; &amp;#x2026;&amp;#x2026;&lt;/p&gt;
&lt;p&gt;&amp;#x6765;&amp;#x5230;&amp;#x4E4B;&amp;#x540E;&amp;#x62A5;&amp;#x544A;&amp;#x4F1A;&amp;#x5DF2;&amp;#x7ECF;&amp;#x5F00;&amp;#x59CB;&amp;#x4E86; &amp;#x2026;&amp;#x2026; &amp;#x4EBA;&amp;#x597D;&amp;#x5C11; QAQ &amp;#x770B;&amp;#x6765;&amp;#x662F;&amp;#x6CA1;&amp;#x8FD9;&amp;#x56DE;&amp;#x4E8B; &amp;#x2026;&amp;#x2026; mdzz &amp;#x2026;&amp;#x2026;&lt;br&gt;
&amp;#x7761;&amp;#x89C9;&amp;#x7761;&amp;#x4E0D;&amp;#x7740;&amp;#x4E86;&amp;#x8FD8;&amp;#x662F;&amp;#x6253;&amp;#x5F00;&amp;#x7535;&amp;#x8111;&amp;#x770B;&amp;#x9898;&amp;#x5427; qwq &amp;#x2026;&amp;#x2026;&lt;br&gt;
sui &amp;#x6253;&amp;#x5F00;&amp;#x7535;&amp;#x8111;&amp;#x6253;&amp;#x4E00;&amp;#x4E2A;&amp;#x53EB;&amp;#x300E;&amp;#x4EE5;&amp;#x6492;&amp;#x300F;&amp;#xFF08;&amp;#x2190; &amp;#x662F;&amp;#x4E0D;&amp;#x662F;&amp;#x8FD9;&amp;#x4E24;&amp;#x4E2A;&amp;#x5B57;&amp;#x554A;&amp;#x5582; 0.0&amp;#xFF09;&amp;#x7684;&amp;#x6E38;&amp;#x620F;&amp;#xFF0C;&amp;#x597D;&amp;#x9AD8;&amp;#x7AEF; ovo&amp;#xFF0C;Fancy &amp;#x62FF;&amp;#x51FA; Kindle &amp;#x770B;&amp;#x77E5;&amp;#x4E4E;&amp;#x65E5;&amp;#x62A5;&amp;#xFF0C;&amp;#x597D;&amp;#x9AD8;&amp;#x7AEF; ovo &amp;#x2026;&amp;#x2026;&lt;/p&gt;
&lt;p&gt;&amp;#x653E;&amp;#x773C;&amp;#x671B;&amp;#x53BB;&amp;#x6574;&amp;#x4E2A;&amp;#x62A5;&amp;#x544A;&amp;#x5385;&amp;#x57FA;&amp;#x672C;&amp;#x4E0A;&amp;#x90FD;&amp;#x5728;&amp;#x5E72;&amp;#x6B63;&amp;#x4E8B;&amp;#xFF08;&amp;#x5927;&amp;#x96FE; &amp;#x2026;&amp;#x2026;&lt;/p&gt;
&lt;p&gt;&amp;#x665A;&amp;#x4E0A;&amp;#x6B63;&amp;#x5728;&amp;#x8C03;&amp;#x9898;&amp;#x7684;&amp;#x65F6;&amp;#x5019;&amp;#xFF0C;Fancy &amp;#x62FF;&amp;#x8D77;&amp;#x624B;&amp;#x673A;&amp;#x95EE;&amp;#x6211;&amp;#x8FD9;&amp;#x4EBA;&amp;#x662F;&amp;#x8C01; &amp;#x2026;&amp;#x2026;&lt;br&gt;
woc &amp;#x2026; &amp;#x8FD9;&amp;#x4E0D;&amp;#x662F; fqk &amp;#x795E;&amp;#x7287;&amp;#x4E48;&amp;#xFF01;&amp;#xFF01;&amp;#xFF01;&lt;br&gt;
fqk&amp;#xFF1A;Fancy &amp;#x662F;&amp;#x7537;&amp;#x7684;&amp;#x5973;&amp;#x7684;&amp;#xFF1F;&lt;br&gt;
Menci&amp;#xFF1A;&amp;amp;@!#@%~&amp;amp; &amp;#x2026;&amp;#x2026;&lt;br&gt;
fqk&amp;#xFF1A;wori &amp;#x2026; &amp;#xFF08;&amp;#x8EB2;&amp;#x5728;&amp;#x6905;&amp;#x5B50;&amp;#x4E0B;&amp;#x9762;.jpg&amp;#xFF09;&amp;#x4F60;&amp;#x5E38;&amp;#x8BF4;&amp;#x7684; HA &amp;#x7684;&amp;#x5C0F;&amp;#x4F19;&amp;#x4F34;&amp;#x6211;&amp;#x4EE5;&amp;#x4E3A;&amp;#x90FD;&amp;#x662F;&amp;#x7537;&amp;#x7684; &amp;#x2026;&amp;#x2026; &amp;#x6211;&amp;#x662F; sb &amp;#x2026;&amp;#x2026;&lt;br&gt;
&amp;#xFF08;fqk &amp;#x672C;&amp;#x6765;&amp;#x5C31;&amp;#x662F; s&amp;#xFF08;hen&amp;#xFF09;b&amp;#xFF08;en&amp;#xFF09;&amp;#x554A; 2333&lt;/p&gt;
&lt;h3 id=&quot;section-3&quot;&gt;5.4&lt;/h3&gt;
&lt;p&gt;CTSC2016 Day2&lt;/p&gt;
&lt;p&gt;&amp;#x8FD8;&amp;#x662F;&amp;#x5728;&amp;#x56FE;&amp;#x4E66;&amp;#x9986;&amp;#xFF0C;&amp;#x4E0D;&amp;#x8FC7;&amp;#x8FD9;&amp;#x6B21;&amp;#x51C6;&amp;#x65F6;&amp;#x5F00;&amp;#x8003;&amp;#x4E86;&lt;/p&gt;
&lt;p&gt;&amp;#x559D;&amp;#x6C34;&amp;#x770B;&amp;#x9898; &amp;#x2026;&amp;#x2026;&lt;/p&gt;
&lt;p&gt;&amp;#x7B2C;&amp;#x4E00;&amp;#x9898;&amp;#xFF0C;&amp;#x86E4;&amp;#xFF1F;&lt;br&gt;
&amp;#x7B2C;&amp;#x4E8C;&amp;#x9898;&amp;#xFF0C;&amp;#x86E4;&amp;#xFF1F;&lt;br&gt;
&amp;#x7B2C;&amp;#x4E09;&amp;#x9898;&amp;#xFF0C;&amp;#x63D0;&amp;#x4EA4;&amp;#x7B54;&amp;#x6848;&amp;#xFF0C;&amp;#x86E4;&amp;#xFF1F;&lt;/p&gt;
&lt;p&gt;&amp;#x5B8C;&amp;#x4E86;&amp;#x8FD9;&amp;#x662F;&amp;#x8981;&amp;#x7206;&amp;#x96F6;&amp;#x7684;&amp;#x8282;&amp;#x594F;&amp;#x5417; QAQ &amp;#x55EF;&amp;#x5148;&amp;#x770B;&amp;#x770B;&amp;#x9898;&amp;#x7B54;&amp;#x5427; &amp;#x2026;&amp;#x2026; XD&lt;/p&gt;
&lt;p&gt;&amp;#x7B2C;&amp;#x4E00;&amp;#x4E2A;&amp;#x70B9;&amp;#x6570;&amp;#x636E;&amp;#x597D;&amp;#x5C0F;&amp;#xFF0C;&amp;#x5199;&amp;#x4E2A;&amp;#x7206;&amp;#x641C;&amp;#x8BD5;&amp;#x8BD5; &amp;#x2026;&amp;#x2026;&lt;br&gt;
&amp;#x7206;&amp;#x641C;&amp;#x8C03;&amp;#x51FA;&amp;#x6765;&amp;#x4E86;&amp;#xFF0C;10 &amp;#x5206;&amp;#x5230;&amp;#x624B;&lt;br&gt;
&amp;#x641C;&amp;#x4E86;&amp;#x4E00;&amp;#x4E0B;&amp;#x7B2C;&amp;#x4E8C;&amp;#x4E2A;&amp;#x70B9;&amp;#xFF0C;&amp;#x7206;&amp;#x5185;&amp;#x5B58;&amp;#x4E86;&amp;#xFF0C;&amp;#x7206;&amp;#x5185;&amp;#x5B58;&amp;#x524D;&amp;#x5F97;&amp;#x5230;&amp;#x7684;&amp;#x6700;&amp;#x4F18;&amp;#x89E3;&amp;#x624D; 3 &amp;#x5206;&amp;#xFF0C;&amp;#x4E0D;&amp;#x884C;&amp;#x554A;&amp;#xFF0C;&amp;#x770B;&amp;#x770B;&amp;#x6570;&amp;#x636E;&amp;#x8BD5;&amp;#x8BD5; &amp;#x2026;&amp;#x2026;&lt;/p&gt;
&lt;p&gt;&amp;#x53EA;&amp;#x6709;&amp;#x4E00;&amp;#x4E2A;&amp;#x4EBA;&amp;#xFF0C;&amp;#x6CA1;&amp;#x6709;&amp;#x8D1F;&amp;#x8FB9;&amp;#xFF0C;&amp;#x6CA1;&amp;#x6709;&amp;#x9650;&amp;#x5236; &amp;#x2026;&amp;#x2026;&lt;br&gt;
&amp;#x8FD9;&amp;#x4E0D;&amp;#x662F;&amp;#x7F51;&amp;#x7EDC;&amp;#x6D41;&amp;#x4E48; 2333&lt;br&gt;
&amp;#x6572;&amp;#x4E86;&amp;#x4E2A;&amp;#x7F51;&amp;#x7EDC;&amp;#x6D41;&amp;#xFF0C;&amp;#x8FD8;&amp;#x6CA1;&amp;#x6572;&amp;#x5B8C; &amp;#x2026;&amp;#x2026; mdzz &amp;#x2026;&amp;#x2026; &amp;#x5565;&amp;#x7F51;&amp;#x7EDC;&amp;#x6D41;&amp;#x554A; &amp;#x2026;&amp;#x2026;&lt;/p&gt;
&lt;p&gt;&amp;#x55EF; &amp;#x2026;&amp;#x2026; &amp;#x8BD5;&amp;#x8BD5; SPFA &amp;#x6700;&amp;#x957F;&amp;#x8DEF; qwq &amp;#x2026;&amp;#x2026;&lt;br&gt;
&amp;#x4E8C;&amp;#x5341;&amp;#x5206;&amp;#x949F;&amp;#x540E; &amp;#x2026;&amp;#x2026; md&amp;#x600E;&amp;#x4E48;&amp;#x4E00;&amp;#x5206;&amp;#x591A;&amp;#x79CD;&amp;#x8FD8;&amp;#x6CA1;&amp;#x8DD1;&amp;#x5B8C;&amp;#xFF0C;&amp;#x8BE5;&amp;#x4E0D;&amp;#x4F1A;&amp;#x8FDB;&amp;#x73AF;&amp;#x4E86;&amp;#x5427; &amp;#x2026;&amp;#x2026;&lt;br&gt;
mdzz &amp;#x2026;&amp;#x2026; &amp;#x8FD9;&amp;#x6570;&amp;#x636E;&amp;#x6709;&amp;#xFF08;you&amp;#xFF09;&amp;#x73AF;&amp;#xFF08;du&amp;#xFF09;&amp;#xFF01;&lt;/p&gt;
&lt;p&gt;&amp;#x4E00;&amp;#x60F3;&amp;#xFF0C;&amp;#x8FD9;&amp;#x4E0D;&amp;#x662F; APIO2009 &amp;#x7684; atm &amp;#x90A3;&amp;#x9898;&amp;#x4E48; &amp;#x2026;&amp;#x2026;&lt;br&gt;
&amp;#x65E0;&amp;#x5948;&amp;#x5F00;&amp;#x59CB;&amp;#x7801; Tarjan &amp;#x2026;&amp;#x2026;&lt;/p&gt;
&lt;p&gt;Tarjan &amp;#x8C03;&amp;#x4E86;&amp;#x5FEB;&amp;#x4E00;&amp;#x4E2A;&amp;#x5C0F;&amp;#x65F6;&amp;#xFF0C;&amp;#x6211;&amp;#x771F;&amp;#x5F31;&amp;#x554A;&amp;#x8FD9;&amp;#x4E48;&amp;#x57FA;&amp;#x7840;&amp;#x7684;&amp;#x7B97;&amp;#x6CD5;&amp;#x90FD;&amp;#x8981;&amp;#x8C03;&amp;#x8FD9;&amp;#x4E48;&amp;#x4E45; &amp;#x2026;&amp;#x2026;&lt;br&gt;
&amp;#x7F29;&amp;#x70B9;&amp;#x8DD1;&amp;#x6700;&amp;#x957F;&amp;#x8DEF;&amp;#xFF0C;&amp;#x53D1;&amp;#x73B0;&amp;#x7B54;&amp;#x6848;&amp;#x662F;&amp;#x5BF9;&amp;#x7684;&amp;#xFF0C;&amp;#x7136;&amp;#x540E;&amp;#x5C31;&amp;#x662F;&amp;#x600E;&amp;#x4E48;&amp;#x8F93;&amp;#x51FA;&amp;#x8DEF;&amp;#x5F84;&amp;#x7684;&amp;#x95EE;&amp;#x9898;&amp;#x4E86; &amp;#x2026;&amp;#x2026;&lt;br&gt;
&amp;#x8111;&amp;#x8865;&amp;#x4E86;&amp;#x4E00;&amp;#x4E0B;&amp;#xFF0C;&amp;#x628A;&amp;#x4E00;&amp;#x4E2A;&amp;#x5F3A;&amp;#x8FDE;&amp;#x901A;&amp;#x5206;&amp;#x91CF;&amp;#x8D70;&amp;#x5B8C;&amp;#xFF0C;&amp;#x7136;&amp;#x540E;&amp;#x8D70;&amp;#x5230;&amp;#x4E0B;&amp;#x4E00;&amp;#x4E2A; &amp;#x2026;&amp;#x2026;&lt;/p&gt;
&lt;p&gt;&amp;#x55EF;&amp;#x597D;&amp;#x50CF;&amp;#x6CA1;&amp;#x9519;&amp;#xFF0C;&amp;#x5F00;&amp;#x59CB;&amp;#x5199;&amp;#x5427; &amp;#x2026;&amp;#x2026;&lt;br&gt;
&amp;#x5199;&amp;#x5B8C;&amp;#x5F00;&amp;#x59CB;&amp;#x8C03;&amp;#xFF0C;&amp;#x8BF6;&amp;#x8FD9;&amp;#x4E2A;&amp;#x51FD;&amp;#x6570;&amp;#x600E;&amp;#x4E48;&amp;#x6CA1;&amp;#x6709;&amp;#x88AB;&amp;#x8C03;&amp;#x7528; &amp;#x2026;&amp;#x2026;&lt;/p&gt;
&lt;p&gt;&lt;del&gt;mdzz &amp;#x2026;&amp;#x2026;&lt;/del&gt; &amp;#x600E;&amp;#x4E48;&amp;#x53EA;&amp;#x6709;&amp;#x4E00;&amp;#x4E2A;&amp;#x5F3A;&amp;#x8FDE;&amp;#x901A;&amp;#x5206;&amp;#x91CF;&amp;#x554A;&amp;#x5582; &amp;#x2026;&amp;#x2026;&lt;br&gt;
&amp;#x4E0D;&amp;#x8FC7;&amp;#x8FD9;&amp;#x6837;&amp;#x7B80;&amp;#x5355;&amp;#x4E00;&amp;#x4E9B;&amp;#xFF0C;&amp;#x76F4;&amp;#x63A5;&amp;#x8D70;&amp;#x5B8C;&amp;#x6574;&amp;#x4E2A;&amp;#x5F3A;&amp;#x8FDE;&amp;#x901A;&amp;#x5206;&amp;#x91CF;&amp;#x5C31;&amp;#x597D;&amp;#x4E86;&lt;/p&gt;
&lt;p&gt;&amp;#x601D;&amp;#x8DEF;&amp;#x662F;&amp;#xFF0C;&amp;#x8003;&amp;#x8651;&amp;#x4E00;&amp;#x68F5;&amp;#x641C;&amp;#x7D22;&amp;#x6811;&amp;#x4E0A;&amp;#xFF0C;&amp;#x6BCF;&amp;#x6761;&amp;#x8FB9;&amp;#x90FD;&amp;#x80FD;&amp;#x88AB;&amp;#x8BBF;&amp;#x95EE;&amp;#x5230;&lt;br&gt;
&amp;#x53EA;&amp;#x8981;&amp;#x53EF;&amp;#x4EE5;&amp;#x6CBF;&amp;#x7740;&amp;#x539F;&amp;#x6765;&amp;#x7684;&amp;#x8FB9;&amp;#x56DE;&amp;#x6EAF;&amp;#x56DE;&amp;#x53BB;&amp;#xFF0C;&amp;#x5C31;&amp;#x53EF;&amp;#x4EE5;&amp;#x5F88;&amp;#x5BB9;&amp;#x6613;&amp;#x5730;&amp;#x8D70;&amp;#x5B8C;&amp;#x6240;&amp;#x6709;&amp;#x8FB9;&lt;br&gt;
&amp;#x4E8E;&amp;#x662F;&amp;#x5728;&amp;#x6BCF;&amp;#x6B21;&amp;#x56DE;&amp;#x6EAF;&amp;#x7684;&amp;#x65F6;&amp;#x5019;&amp;#x518D;&amp;#x8DD1;&amp;#x4E00;&amp;#x904D;&amp;#x53E6;&amp;#x4E00;&amp;#x4E2A;&amp;#x641C;&amp;#x7D22;&amp;#xFF0C;&amp;#x641C;&amp;#x51FA;&amp;#x4E00;&amp;#x6761;&amp;#x8DEF;&amp;#x5F84;&amp;#x6765;&lt;/p&gt;
&lt;p&gt;&amp;#x5199;&amp;#x5B8C;&amp;#x4E4B;&amp;#x540E;&amp;#x8C03;&amp;#x4E86;&amp;#x534A;&amp;#x4E2A;&amp;#x5C0F;&amp;#x65F6;&amp;#xFF0C;&amp;#x5F00; &lt;code&gt;O3&lt;/code&gt; &amp;#x8DD1;&amp;#x4E86;&amp;#x4E00;&amp;#x5206;&amp;#x591A;&amp;#x79CD;&amp;#x7EC8;&amp;#x4E8E;&amp;#x8DD1;&amp;#x51FA;&amp;#x6765;&amp;#x4E86;&lt;br&gt;
&amp;#x6253;&amp;#x5F00;&amp;#x8F93;&amp;#x51FA;&amp;#x6587;&amp;#x4EF6;&amp;#x4E00;&amp;#x770B;&amp;#xFF0C;&amp;#x6709;&amp;#x5927;&amp;#x7EA6; n &amp;#x5E73;&amp;#x65B9;&amp;#x6761;&amp;#x8FB9; &amp;#x2026;&amp;#x2026; &amp;#x8F93;&amp;#x51FA;&amp;#x6587;&amp;#x4EF6; 3M+&lt;br&gt;
&lt;code&gt;checker&lt;/code&gt; &amp;#x8DD1;&amp;#x4E86;&amp;#x4E00;&amp;#x79D2;&amp;#x591A;&amp;#xFF0C;&amp;#x7B54;&amp;#x6848;&amp;#x662F;&amp;#x5BF9;&amp;#x7684;&amp;#xFF0C;20 &amp;#x5206;&amp;#x6709;&amp;#x4E86; &amp;#x2026;&amp;#x2026;&lt;/p&gt;
&lt;p&gt;&amp;#x770B;&amp;#x4E86;&amp;#x4E0B;&amp;#xFF0C;&amp;#x53D1;&amp;#x73B0;&amp;#x8FD9;&amp;#x4E2A;&amp;#x70B9;&amp;#x548C;&amp;#x5176;&amp;#x4ED6;&amp;#x70B9;&amp;#x4E0D;&amp;#x4E00;&amp;#x6837;&amp;#xFF0C;&amp;#x8FD9;&amp;#x4E2A;&amp;#x7A0B;&amp;#x5E8F;&amp;#x8DD1;&amp;#x4E0D;&amp;#x51FA;&amp;#x5176;&amp;#x4ED6;&amp;#x7684;&amp;#x70B9; QAQ &amp;#x53EA;&amp;#x597D;&amp;#x7206;&amp;#x641C;&amp;#xFF0C;&amp;#x4F46;&amp;#x6BCF;&amp;#x4E2A;&amp;#x70B9;&amp;#x90FD;&amp;#x8FDE;&amp;#x4E2A;&amp;#x53EF;&amp;#x884C;&amp;#x89E3;&amp;#x90FD;&amp;#x641C;&amp;#x4E0D;&amp;#x51FA;&amp;#x6765; &amp;#x2026;&amp;#x2026;&lt;br&gt;
&amp;#x8FD8;&amp;#x5269;&amp;#x4E0D;&amp;#x5230;&amp;#x4E8C;&amp;#x5341;&amp;#x5206;&amp;#x949F;&amp;#x4E86;&amp;#xFF0C;&amp;#x5F03;&amp;#x7597;&amp;#x5427; &amp;#x2026;&amp;#x2026; XD&lt;/p&gt;
&lt;p&gt;&amp;#x524D;&amp;#x4E24;&amp;#x9898;&amp;#x90FD;&amp;#x6CA1;&amp;#x5199; &amp;#x2026;&amp;#x2026;&lt;/p&gt;
&lt;p&gt;&amp;#x4E2D;&amp;#x5348;&amp;#x5728;&amp;#x98DF;&amp;#x5802;&amp;#x9047;&amp;#x89C1; Dashgua&amp;#xFF0C;&amp;#x4ED6;&amp;#x8BF4;&amp;#x7B2C;&amp;#x4E09;&amp;#x9898;&amp;#x76F4;&amp;#x63A5; SPFA&amp;#xFF0C;&amp;#x9047;&amp;#x5230;&amp;#x73AF;&amp;#x5C31;&amp;#x8DF3;&amp;#x51FA;&amp;#x6765;&amp;#xFF0C;&amp;#x5C31;&amp;#x6709; 70 &amp;#x5206;&amp;#x4E86; &amp;#x2026;&amp;#x2026;&lt;br&gt;
&lt;del&gt;mdzz &amp;#x2026;&amp;#x2026;&lt;/del&gt;&lt;br&gt;
&amp;#x611F;&amp;#x89C9;&amp;#x81EA;&amp;#x5DF1;&amp;#x771F;&amp;#x7684;&amp;#x8FDE; Cu &amp;#x90FD;&amp;#x62FF;&amp;#x4E0D;&amp;#x5230;&amp;#x554A; &amp;#x2026;&amp;#x2026;&lt;br&gt;
dms &amp;#x8BF4;&amp;#x4ED6; A &amp;#x4E86;&amp;#x4E00;&amp;#x63D0;&amp;#xFF0C;&amp;#x592A;&amp;#x795E;&amp;#x5566;&amp;#xFF01;&lt;/p&gt;
&lt;p&gt;&amp;#x4E0B;&amp;#x5348;&amp;#x8BB2;&amp;#x9898;&amp;#xFF0C;&amp;#x5F88;&amp;#x591A;&amp;#x4EBA;&amp;#x5410;&amp;#x69FD;&amp;#x9898;&amp;#x7B54;&amp;#x88AB;&amp;#x4E71;&amp;#x641E;&amp;#x597D;&amp;#x51E0;&amp;#x5341;&amp;#x5206;&amp;#xFF0C;&amp;#x4E2A;&amp;#x4E2A;&amp;#x7684;&amp;#x7A0B;&amp;#x5E8F;&amp;#x90FD;&amp;#x6BD4;&amp;#x6211;&amp;#x7B80;&amp;#x5355; &amp;#x2026;&amp;#x2026; &lt;del&gt;mdzz &amp;#x2026;&amp;#x2026;&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x665A;&amp;#x4E0A;&amp;#x95ED;&amp;#x5E55;&amp;#x5F0F;&amp;#xFF0C;&amp;#x4E2D;&amp;#x95F4;&amp;#x7684;&amp;#x6E38;&amp;#x620F;&amp;#x73AF;&amp;#x8282;&amp;#x6709;&amp;#x4E2A;&amp;#x731C;&amp;#x8C1C;&amp;#xFF0C;&amp;#x660E;&amp;#x660E;&amp;#x6211;&amp;#x731C;&amp;#x51FA;&amp;#x6765;&amp;#x4E86;&amp;#x4F46;&amp;#x4E3B;&amp;#x6301;&amp;#x4EBA;&amp;#x6CA1;&amp;#x542C;&amp;#x5230; qwq &amp;#xFF08;&lt;code&gt;O(E)&lt;/code&gt; &amp;#x4E0D;&amp;#x662F; SPFA &amp;#x8FD8;&amp;#x80FD;&amp;#x662F;&amp;#x5565;&amp;#x554A;&amp;#x5582;&lt;br&gt;
&amp;#x5BA3;&amp;#x8BFB;&amp;#x83B7;&amp;#x5956;&amp;#x540D;&amp;#x5355;&amp;#xFF0C;&amp;#x679C;&amp;#x7136; Fe &amp;#x6EDA;&amp;#x7C97;&amp;#x4E86; QAQ&lt;/p&gt;
&lt;p&gt;&amp;#x56DE;&amp;#x5230;&amp;#x9152;&amp;#x5E97;&amp;#xFF0C;&amp;#x88AB;&amp;#x9752;&amp;#x5C9B;&amp;#x4E8C;&amp;#x4E2D;&amp;#x7684;&amp;#x62D0;&amp;#x8D70;&amp;#x4E86;&amp;#xFF0C;yts1999&amp;#x3001;Oxer&amp;#x3001;dms&amp;#x3001;heheda &amp;#x7B49;&amp;#x51E0;&amp;#x4F4D;&amp;#x795E;&amp;#x7287;&amp;#x90FD;&amp;#x5728; &amp;#x2026;&amp;#x2026;&lt;br&gt;
&amp;#x4E8E;&amp;#x662F;&amp;#x4ED6;&amp;#x4EEC;&amp;#x6559;&amp;#x6211;&amp;#x4E00;&amp;#x79CD;&amp;#x53EB;&amp;#x505A;&amp;#x300E;&amp;#x591F;&amp;#x7EA7;&amp;#x300F;&amp;#x7684;&amp;#x6251;&amp;#x514B;&amp;#x724C;&amp;#x6E38;&amp;#x620F; 2333 &amp;#x2026;&amp;#x2026;&lt;/p&gt;
&lt;p&gt;&amp;#x73A9;&amp;#x4E86;&amp;#x51E0;&amp;#x5C40;&amp;#x4E4B;&amp;#x540E;&amp;#x5C31;&amp;#x8DD1;&amp;#x4E0B;&amp;#x53BB;&amp;#x4E86; qwq&lt;br&gt;
&amp;#x60F3;&amp;#x8D77;&amp;#x6765;&amp;#x8FD8;&amp;#x6CA1;&amp;#x627E;&amp;#x80DC;&amp;#x5229;&amp;#x4E00;&amp;#x4E2D;&amp;#x7684; abclzr &amp;#x795E;&amp;#x7287;&amp;#x9762;&amp;#x57FA;&amp;#x5462;&amp;#xFF0C;&amp;#x4E8E;&amp;#x662F;&amp;#x5C31;&amp;#x5148;&amp;#x53BB;&amp;#x627E;&amp;#x5230;&amp;#x4E86;&amp;#x4ED6;&amp;#x804A;&amp;#x4E86;&amp;#x4E00;&amp;#x4F1A;&amp;#xFF0C;lzr &amp;#x597D;&amp;#x795E;&amp;#x554A;&amp;#xFF01;&lt;/p&gt;
&lt;p&gt;KZ &amp;#x8981;&amp;#x6211;&amp;#x5E2E;&amp;#x4ED6;&amp;#x8C03;&amp;#x4E00;&amp;#x4E0B; Ubuntu&amp;#x3001;Windows &amp;#x53CC;&amp;#x7CFB;&amp;#x7EDF;&amp;#x7684;&amp;#x65F6;&amp;#x95F4;&amp;#x8BBE;&amp;#x7F6E; &amp;#x2026;&amp;#x2026; &amp;#x867D;&amp;#x7136;&amp;#x6CA1;&amp;#x641E;&amp;#x8FC7;&amp;#x4F46;&amp;#x542C;&amp;#x8D77;&amp;#x6765;&amp;#x597D;&amp;#x7B80;&amp;#x5355;&amp;#x7684;&amp;#x6837;&amp;#x5B50;&lt;br&gt;
&amp;#x8C03;&amp;#x4E86;&amp;#x597D;&amp;#x4E45;&amp;#x6700;&amp;#x540E;&amp;#x53D1;&amp;#x73B0;&amp;#x6539;&amp;#x6539;&amp;#x65F6;&amp;#x533A;&amp;#x5C31;&amp;#x53EF;&amp;#x4EE5; &amp;#x2026;&amp;#x2026;&lt;/p&gt;
&lt;h3 id=&quot;section-4&quot;&gt;5.5&lt;/h3&gt;
&lt;p&gt;&amp;#x4F11;&amp;#x606F;&amp;#x65E5;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x4E0A;&amp;#x5348;&amp;#x4ED6;&amp;#x4EEC;&amp;#x7761;&amp;#x5230;&amp;#x5F88;&amp;#x665A;&amp;#x624D;&amp;#x8D77;&amp;#x6765; &amp;#x2026;&amp;#x2026;&lt;/p&gt;
&lt;p&gt;&amp;#x53BB;&amp;#x5B66;&amp;#x6821;&amp;#x6B21;&amp;#x65E9;&amp;#x996D;&amp;#x56DE;&amp;#x6765;&amp;#x7684;&amp;#x8DEF;&amp;#x4E0A;&amp;#xFF0C;&amp;#x8BA8;&amp;#x8BBA;&amp;#x7EC4;&amp;#x91CC;&lt;br&gt;
KZ&amp;#xFF1A;&amp;#x628A; Menci &amp;#x53EB;&amp;#x8FC7;&amp;#x6765;&amp;#xFF0C;&amp;#x6211;&amp;#x4EEC;&amp;#x8981;&amp;#x5403;&amp;#x996D; &amp;#x2026;&amp;#x2026;&lt;br&gt;
Fancy&amp;#xFF1A;Menci &amp;#x80FD;&amp;#x5403;&amp;#x5417;&amp;#xFF1F;&lt;br&gt;
&lt;sub&gt;&lt;sub&gt;Menci&amp;#xFF1A;&amp;amp;@!#@%&lt;/sub&gt;&amp;amp;&lt;/sub&gt;~&lt;br&gt;
&lt;del&gt;&amp;#x6B64;&amp;#x5904;&amp;#x5E94;&amp;#x6709;&amp;#x300E;&amp;#x4E00;&amp;#x8138;&amp;#x832B;&amp;#x7136;.jpg&amp;#x300F;&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x56DE;&amp;#x6765;&amp;#x4E4B;&amp;#x540E;&amp;#x8C03;&amp;#x4E86;&amp;#x4E00;&amp;#x4F1A;&amp;#x9898;&amp;#x53C8;&amp;#x8BE5;&amp;#x6B21;&amp;#x4E2D;&amp;#x5348;&amp;#x996D;&amp;#x4E86; qvq&lt;/p&gt;
&lt;p&gt;Fancy &amp;#x8BF4;&amp;#x5979;&amp;#x5C0F;&amp;#x59E8;&amp;#x8981;&amp;#x5E26;&amp;#x5979;&amp;#x53BB;&amp;#x5929;&amp;#x5B89;&amp;#x95E8;&amp;#xFF0C;&amp;#x597D;&amp;#x9AD8;&amp;#x7AEF; &amp;#x2026;&amp;#x2026;&lt;br&gt;
&amp;#x5176;&amp;#x4ED6;&amp;#x4EBA;&amp;#x5546;&amp;#x91CF;&amp;#x7740;&amp;#x53BB;&amp;#x9999;&amp;#x5C71;&amp;#xFF0C;&amp;#x7A9D;&amp;#x8868;&amp;#x793A;&amp;#x5BF9;&amp;#x6B64;&amp;#x5E76;&amp;#x4E0D;&amp;#x611F;&amp;#x5174;&amp;#x8DA3; &amp;#x2026;&amp;#x2026;&lt;/p&gt;
&lt;p&gt;&amp;#x4E8E;&amp;#x662F;&amp;#x4E2D;&amp;#x5348;&amp;#x81EA;&amp;#x5DF1;&amp;#x56DE;&amp;#x6765;&amp;#x4E86;&amp;#xFF0C;&amp;#x7761;&amp;#x9192;&amp;#x89C9;&amp;#x5C31;&amp;#x56DB;&amp;#x70B9;&amp;#x591A;&amp;#x4E86;&amp;#xFF0C;&amp;#x5199;&amp;#x4E86;&amp;#x4E00;&amp;#x4F1A;&amp;#x9898;&amp;#xFF0C;&amp;#x4E0D;&amp;#x77E5;&amp;#x4E0D;&amp;#x89C9;&amp;#x4E00;&amp;#x9053;&amp;#x9898;&amp;#x5199;&amp;#x4E86; N &amp;#x5929;&amp;#x4E86; &amp;#x2026;&amp;#x2026;&lt;/p&gt;
&lt;p&gt;&amp;#x665A;&amp;#x4E0A;&amp;#x770B;&amp;#x89C1; SDOI &amp;#x7FA4;&amp;#x91CC;&amp;#x6709;&amp;#x4EBA;&amp;#x641E;&amp;#x5927;&amp;#x65B0;&amp;#x95FB; &amp;#x2026;&amp;#x2026;&amp;#xFF08;&amp;#x6B64;&amp;#x5904;&amp;#x7701;&amp;#x7565; &amp;amp;@!#@%~&amp;amp;&amp;#xFF09;&amp;#x2026;&amp;#x2026; 233333333&lt;/p&gt;
&lt;h3 id=&quot;section-5&quot;&gt;5.6&lt;/h3&gt;
&lt;p&gt;&amp;#x542C;&amp;#x8BF4; fqk &amp;#x7684;&amp;#x5B66;&amp;#x957F;&amp;#x8981;&amp;#x6765;&amp;#x8BB2;&amp;#x8BFE;&amp;#xFF1F;&amp;#x592A;&amp;#x795E;&amp;#x8FA3;&amp;#xFF01;&lt;/p&gt;
&lt;p&gt;&amp;#x5230;&amp;#x4E86;&amp;#x8BB2;&amp;#x5385;&amp;#xFF0C;&amp;#x62A2;&amp;#x4E86;&amp;#x7B2C;&amp;#x4E00;&amp;#x6392;&amp;#x7684;&amp;#x5EA7;&amp;#x4F4D;&amp;#x8FD1;&amp;#x8DDD;&amp;#x79BB;&amp;#x56F4;&amp;#x89C2;&amp;#xFF0C;&amp;#x7136;&amp;#x800C;&amp;#x5E76;&amp;#x4E0D;&amp;#x80FD;&amp;#x542C;&amp;#x61C2;&amp;#x4EC0;&amp;#x4E48;&amp;#x9AD8;&amp;#x7AEF;&amp;#x7684; XXXX &amp;#x641C;&amp;#x7D22;&amp;#x7B97;&amp;#x6CD5; Orz&amp;#xFF0C;&amp;#x4E0B;&amp;#x8BFE;&amp;#x671F;&amp;#x95F4;&amp;#x4E0A;&amp;#x53BB;&amp;#x95EE;&amp;#x4E86;&amp;#x95EE;&amp;#xFF0C;&amp;#x8FD8;&amp;#x771F;&amp;#x662F; fqk &amp;#x7684;&amp;#x5B66;&amp;#x957F;&amp;#xFF08;&amp;#x8FD9;&amp;#x8FD8;&amp;#x6709;&amp;#x5047;&amp;#xFF1F;&lt;/p&gt;
&lt;p&gt;&amp;#x5509;&amp;#xFF0C;&amp;#x542C;&amp;#x4E0D;&amp;#x61C2;&amp;#x5F03;&amp;#x7597;&amp;#x5427; qwq &amp;#x2026;&amp;#x2026;&lt;/p&gt;
&lt;p&gt;&amp;#x665A;&amp;#x4E0A;&amp;#x628A; HNOI &amp;#x67D0;&amp;#x6811;&amp;#x8C03;&amp;#x51FA;&amp;#x6765;&amp;#x4E86;&amp;#xFF0C;&amp;#x53C8;&amp;#x6309;&amp;#x7167;&amp;#x795E;&amp;#x517D;&amp;#x7684;&amp;#x505A;&amp;#x6CD5;&amp;#x5199;&amp;#x4E86;&amp;#x5199; APIO &amp;#x7EC3;&amp;#x4E60;&amp;#x8D5B;&amp;#x7684;&amp;#x4EA4;&amp;#x4E92;&amp;#xFF0C;&amp;#x597D;&amp;#x6C34;&amp;#x7684;&amp;#x9898; qwq&lt;br&gt;
APIO &amp;#x7684;&amp;#x9898;&amp;#x4E0D;&amp;#x53EF;&amp;#x80FD;&amp;#x8FD9;&amp;#x4E48;&amp;#x6C34;&amp;#x5427;&lt;/p&gt;
&lt;h3 id=&quot;section-6&quot;&gt;5.7&lt;/h3&gt;
&lt;p&gt;APIO2016 Day1&lt;/p&gt;
&lt;p&gt;APIO &amp;#x7684;&amp;#x5F00;&amp;#x8003;&amp;#x65F6;&amp;#x95F4;&amp;#x665A;&amp;#x4E00;&amp;#x4E9B;&amp;#xFF0C;&amp;#x53EF;&amp;#x4EE5;&amp;#x63D0;&amp;#x524D;&amp;#x8FDB;&amp;#x573A; qwq &amp;#x4E8E;&amp;#x662F;&amp;#x5C31;&amp;#x53EF;&amp;#x4EE5;&amp;#x5148;&amp;#x5199;&amp;#x597D; vim &amp;#x914D;&amp;#x7F6E;&amp;#x4E86; &amp;#x2026;&amp;#x2026;&lt;/p&gt;
&lt;p&gt;&amp;#x7701;&amp;#x5E38;&amp;#x4E2D;&amp;#x7684; Johann &amp;#x795E;&amp;#x7287;&amp;#x5750;&amp;#x6211;&amp;#x5DE6;&amp;#x8FB9;&amp;#xFF0C;%%% &amp;#x2026;&amp;#x2026;&lt;/p&gt;
&lt;p&gt;&amp;#x9898;&amp;#x76EE;&amp;#x6709;&amp;#x7EB8;&amp;#x5F20;&amp;#x548C; PDF &amp;#x7684;&amp;#xFF0C;&amp;#x5728;&amp;#x7EBF;&amp;#x8BC4;&amp;#x6D4B;&amp;#x5B9E;&amp;#x65F6;&amp;#x53CD;&amp;#x9988;&amp;#xFF0C;&amp;#x597D;&amp;#x9AD8;&amp;#x7AEF; qwq&lt;/p&gt;
&lt;p&gt;&amp;#x559D;&amp;#x6C34;&amp;#x770B;&amp;#x9898; &amp;#x2026;&amp;#x2026;&lt;/p&gt;
&lt;p&gt;&amp;#x7B2C;&amp;#x4E00;&amp;#x9898;&amp;#xFF0C;&amp;#x86E4;&amp;#xFF1F;&amp;#x6253;&amp;#x4E2A;&amp;#x66B4;&amp;#x529B;&amp;#x8BD5;&amp;#x8BD5; &amp;#x2026;&amp;#x2026;&lt;br&gt;
&amp;#x7B2C;&amp;#x4E8C;&amp;#x9898;&amp;#xFF0C;&amp;#x86E4;&amp;#xFF1F;&amp;#x7B2C;&amp;#x4E00;&amp;#x4E2A;&amp;#x5B50;&amp;#x4EFB;&amp;#x52A1;&amp;#x6211;&amp;#x90FD;&amp;#x4E0D;&amp;#x4F1A;&amp;#x554A; &amp;#x2026;&amp;#x2026;&lt;br&gt;
&amp;#x7B2C;&amp;#x4E09;&amp;#x9898;&amp;#xFF0C;&amp;#x86E4;&amp;#xFF1F;&amp;#x4EA4;&amp;#x4E92;&amp;#xFF0C;&amp;#x9650;&amp;#x5236;&amp;#x5565;&amp;#x5565;&amp;#x5565;&amp;#x6B21;&amp;#x6570;&amp;#xFF1F;&lt;/p&gt;
&lt;p&gt;&amp;#x6253;&amp;#x597D;&amp;#x4E86;&amp;#x7B2C;&amp;#x4E00;&amp;#x9898;&amp;#x66B4;&amp;#x529B;&amp;#xFF0C;&amp;#x51B7;&amp;#x9759;&amp;#x4E0B;&amp;#x6765;&amp;#x60F3;&amp;#x4E86;&amp;#x60F3;&amp;#x5176;&amp;#x5B9E;&amp;#x7B2C;&amp;#x4E00;&amp;#x4E2A;&amp;#x5B50;&amp;#x4EFB;&amp;#x52A1;&amp;#x5C31;&amp;#x662F;&amp;#x4E00;&amp;#x4E2A;&amp;#x5E8F;&amp;#x5217;&amp;#xFF0C;&amp;#x6C42;&amp;#x6240;&amp;#x6709;&amp;#x5355;&amp;#x8C03;&amp;#x4E0A;&amp;#x5347;&amp;#x5E8F;&amp;#x5217;&amp;#x6570;&amp;#x91CF;&amp;#x3002;&amp;#x600E;&amp;#x4E48;&amp;#x8DDF;&amp;#x98DF;&amp;#x7269;&amp;#x94FE;&amp;#x8FD9;&amp;#x4E48;&amp;#x50CF;&amp;#x5462; &amp;#x2026;&amp;#x2026; &amp;#x5EFA;&amp;#x56FE;&amp;#x62D3;&amp;#x6251;&amp;#x6392;&amp;#x5E8F;&amp;#x7136;&amp;#x540E;&amp;#x76F4;&amp;#x63A5; DP &amp;#x561B; &amp;#x2026;&amp;#x2026; &amp;#x534A;&amp;#x4E2A;&amp;#x5C0F;&amp;#x65F6;&amp;#x624D;&amp;#x8C03;&amp;#x51FA;&amp;#x6765;&amp;#xFF08;&amp;#x66B4;&amp;#x9732;&amp;#x6C34;&amp;#x5E73;&amp;#x4E86; XD&lt;/p&gt;
&lt;p&gt;&amp;#x7B2C;&amp;#x4E8C;&amp;#x9898;&amp;#x7B2C;&amp;#x4E00;&amp;#x4E2A;&amp;#x5B50;&amp;#x4EFB;&amp;#x52A1; &amp;#x2026;&amp;#x2026; &amp;#x8BD5;&amp;#x8BD5;&amp;#x5E73;&amp;#x5747;&amp;#x6570;&amp;#xFF1F;&amp;#x4E0D;&amp;#x884C;&amp;#x554A;&amp;#xFF0C;&amp;#x6253;&amp;#x4E2A;&amp;#x66B4;&amp;#x529B;&amp;#x5427; &amp;#x2026;&amp;#x2026; &amp;#x53D1;&amp;#x73B0;&amp;#x7B54;&amp;#x6848;&amp;#x662F;&amp;#x5168;&amp;#x90E8;&amp;#x53D8;&amp;#x6210;&amp;#x8FD9;&amp;#x4E9B;&amp;#x6570;&amp;#x4E2D;&amp;#x7684;&amp;#x5176;&amp;#x4E2D;&amp;#x4E00;&amp;#x4E2A;&amp;#xFF0C;&amp;#x90A3;&amp;#x5C31;&amp;#x679A;&amp;#x4E3E;&amp;#x4E00;&amp;#x904D;&amp;#x8FD9;&amp;#x4E9B;&amp;#x6570;&amp;#x5427; &amp;#x2026;&amp;#x2026;&lt;/p&gt;
&lt;p&gt;&amp;#x4E24;&amp;#x4E2A;&amp;#x534A;&amp;#x5C0F;&amp;#x65F6;&amp;#x62FF;&amp;#x4E86; 16 &amp;#x5206;&amp;#x4E86; &amp;#x2026;&amp;#x2026;&lt;/p&gt;
&lt;p&gt;&amp;#x770B;&amp;#x7B2C;&amp;#x4E09;&amp;#x9898;&amp;#xFF0C;&amp;#x4E0A;&amp;#x6765;&amp;#x4E00;&amp;#x4E2A;&amp;#x5C0F;&amp;#x65F6;&amp;#x5565;&amp;#x90FD;&amp;#x4E0D;&amp;#x4F1A;&amp;#xFF0C;&amp;#x540E;&amp;#x6765;&amp;#x4E00;&amp;#x60F3;&amp;#xFF0C;&lt;del&gt;mdzz&lt;/del&gt; &amp;#x2026;&amp;#x2026; &amp;#x76F4;&amp;#x63A5;&amp;#x4ECE;&amp;#x4E24;&amp;#x8FB9;&amp;#x5411;&amp;#x4E2D;&amp;#x95F4;&amp;#x903C;&amp;#x8FD1;&amp;#xFF0C;&amp;#x7136;&amp;#x540E;&amp;#x5F97;&amp;#x5230;&amp;#x6574;&amp;#x4E2A;&amp;#x5E8F;&amp;#x5217;&amp;#x4E0D;&amp;#x5C31;&amp;#x597D;&amp;#x4E86; &amp;#x2026;&amp;#x2026;&lt;br&gt;
&amp;#x63D0;&amp;#x4EA4;&amp;#xFF0C;30.38 &amp;#x5206; &amp;#x2026;&amp;#x2026; &amp;#x8FD9;&amp;#x6837;&amp;#x5C31;&amp;#x6709; 46.38 &amp;#x5206;&amp;#x4E86; &amp;#x2026;&amp;#x2026; &amp;#x8FD8;&amp;#x4E0D;&amp;#x591F;&amp;#x554A;&amp;#xFF0C;&amp;#x60F3;&amp;#x60F3;&amp;#x7B2C;&amp;#x4E8C;&amp;#x4E2A;&amp;#x5B50;&amp;#x4EFB;&amp;#x52A1; &amp;#x2026;&amp;#x2026;&lt;/p&gt;
&lt;p&gt;&amp;#x8111;&amp;#x8865;&amp;#x4E86;&amp;#x4E00;&amp;#x4E0B;&amp;#x611F;&amp;#x89C9;&amp;#x4E8C;&amp;#x5206;&amp;#x590D;&amp;#x6742;&amp;#x5EA6;&amp;#x662F;&amp;#x5BF9;&amp;#x7684;&amp;#xFF0C;&amp;#x968F;&amp;#x4FBF;&amp;#x5199;&amp;#x4E86;&amp;#x4E00;&amp;#x4E2A;&amp;#x4EA4;&amp;#x4E0A;&amp;#x53BB;&amp;#x53D1;&amp;#x73B0;&amp;#x624D; 42 &amp;#x5206;&amp;#xFF0C;&amp;#x54EA;&amp;#x91CC;&amp;#x4E0D;&amp;#x5BF9;&amp;#xFF1F;&amp;#x5361;&amp;#x5361;&amp;#x5E38;&amp;#x8BD5;&amp;#x8BD5; &amp;#x2026;&amp;#x2026;&lt;br&gt;
&amp;#x5361;&amp;#x4E86;&amp;#x5361;&amp;#x5E38;&amp;#x4EA4;&amp;#x4E0A;&amp;#x53BB;&amp;#x53D1;&amp;#x73B0; WA &amp;#x4E86;&amp;#xFF0C;&amp;#x53D1;&amp;#x73B0;&amp;#x6F0F;&amp;#x60C5;&amp;#x51B5;&amp;#x4E86;&amp;#xFF0C;&amp;#x6539;&amp;#x4E86;&amp;#x4E4B;&amp;#x540E;&amp;#x53C8;&amp;#x4EA4;&amp;#x4E0A;&amp;#x53BB; &amp;#x2026;&amp;#x2026; &amp;#x8BF6;&amp;#xFF0C;&amp;#x600E;&amp;#x4E48;&amp;#x4E0D;&amp;#x8BC4;&amp;#x6D4B;&amp;#x4E86; &amp;#x2026;&amp;#x2026;&lt;/p&gt;
&lt;p&gt;&amp;#x7528; CMS &amp;#x81EA;&amp;#x5E26;&amp;#x7684;&amp;#x63D0;&amp;#x95EE;&amp;#x529F;&amp;#x80FD;&amp;#x95EE;&amp;#x4E86;&amp;#x4E00;&amp;#x4E0B;&amp;#x4E3B;&amp;#x529E;&amp;#x65B9;&amp;#xFF0C;&amp;#x88AB;&amp;#x544A;&amp;#x77E5;&amp;#x670D;&amp;#x52A1;&amp;#x5668;&amp;#x4E0D;&amp;#x7A33;&amp;#x5B9A; &amp;#x2026;&amp;#x2026;&amp;#xFF08;&lt;del&gt;&amp;#x8FA3;&amp;#x9E21;&amp;#x670D;&amp;#x52A1;&amp;#x5668;&amp;#xFF0C;&amp;#x6BC1;&amp;#x6211;&amp;#x6BD4;&amp;#x8D5B;&lt;/del&gt;&lt;br&gt;
&amp;#x4E8E;&amp;#x662F;&amp;#x53EA;&amp;#x597D;&amp;#x81EA;&amp;#x5DF1;&amp;#x5BF9;&amp;#x62CD;&amp;#xFF0C;&amp;#x53D1;&amp;#x73B0;&amp;#x662F;&amp;#x5BF9;&amp;#x7684;&amp;#xFF0C;&amp;#x7EE7;&amp;#x7EED;&amp;#x5361;&amp;#x5E38;&amp;#x6570;&amp;#xFF0C;&amp;#x53D1;&amp;#x73B0;&amp;#x5361;&amp;#x4E0D;&amp;#x5230;&amp;#x5F88;&amp;#x4F4E;&amp;#x4E86;&amp;#xFF0C;&amp;#x611F;&amp;#x89C9;&amp;#x8FD9;&amp;#x4E0D;&amp;#x662F;&amp;#x6B63;&amp;#x89E3;&lt;del&gt;&amp;#xFF08;&amp;#x5F53;&amp;#x7136;&amp;#x4E0D;&amp;#x662F;&amp;#xFF09;&lt;/del&gt;&amp;#x2026;&amp;#x2026;&lt;/p&gt;
&lt;p&gt;&amp;#x6700;&amp;#x540E;&amp;#x53C8;&amp;#x4EA4;&amp;#x4E86;&amp;#x4E00;&amp;#x4E0B;&amp;#xFF0C;&amp;#x8FD8;&amp;#x662F;&amp;#x8BC4;&amp;#x4E0D;&amp;#x51FA;&amp;#x6765;&amp;#xFF0C;&amp;#x800C;&amp;#x4E14;&amp;#x6CA1;&amp;#x7ED9;&amp;#x52A0;&amp;#x65F6; &amp;#x2026;&amp;#x2026; &amp;#x5C31;&amp;#x8FD9;&amp;#x6837;&amp;#x7ED3;&amp;#x675F;&amp;#x4E86;&lt;/p&gt;
&lt;p&gt;&amp;#x4E0B;&amp;#x5348;&amp;#x8BB2;&amp;#x9898;&amp;#xFF0C;T3 &amp;#x6B63;&amp;#x89E3;&amp;#x5206;&amp;#x5757; &amp;#x2026;&amp;#x2026; &amp;#x6211;&amp;#x50BB;&amp;#x903C;&amp;#x4E86;&amp;#x90FD;&amp;#x60F3;&amp;#x5230;&amp;#x9E3D;&amp;#x7B3C;&amp;#x539F;&amp;#x7406;&amp;#x7684;&amp;#x600E;&amp;#x4E48;&amp;#x5C31;&amp;#x4E0D;&amp;#x5206;&amp;#x5757;&amp;#x5462; &amp;#x2026;&amp;#x2026;&lt;br&gt;
T2 &amp;#x6211;&amp;#x539F;&amp;#x672C;&amp;#x60F3;&amp;#x5230;&amp;#x7684;&amp;#x5B50;&amp;#x4EFB;&amp;#x52A1; 2 &amp;#x7684;&amp;#x6811;&amp;#x5F62; DP &amp;#x662F;&amp;#x5BF9;&amp;#x7684;&amp;#xFF0C;&amp;#x6CA1;&amp;#x65F6;&amp;#x95F4;&amp;#x5199;&amp;#x4E86;&amp;#x554A; &amp;#x2026;&amp;#x2026; QAQ&lt;/p&gt;
&lt;p&gt;&amp;#x53D1;&amp;#x73B0;&amp;#x53C8;&amp;#x662F;&amp;#x5C31;&amp;#x6211;&amp;#x5206;&amp;#x4F4E;&amp;#xFF0C;&amp;#x8FD9;&amp;#x662F;&amp;#x4E09;&amp;#x9898;&amp;#x7B7E;&amp;#x5230;&amp;#x5206;&amp;#x554A;&amp;#xFF0C;&amp;#x53C8;&amp;#x8981; Fe &amp;#x6EDA;&amp;#x7C97;&amp;#x4E86;&amp;#x4E48; XD&lt;/p&gt;
&lt;p&gt;&amp;#x665A;&amp;#x4E0A;&amp;#x4ED6;&amp;#x4EEC;&amp;#x90FD;&amp;#x53BB; THU &amp;#x770B;&amp;#x667A;&amp;#x80FD;&amp;#x4F53;&amp;#x5927;&amp;#x8D5B;&amp;#x4E86;&amp;#xFF0C;&amp;#x7136;&amp;#x800C;&amp;#x6211;&amp;#x8868;&amp;#x793A;&amp;#x5E76;&amp;#x4E0D;&amp;#x60F3;&amp;#x53BB;&amp;#xFF0C;&amp;#x5C31;&amp;#x4F1A;&amp;#x9152;&amp;#x5E97;&amp;#x627E;&amp;#x6E56;&amp;#x5317;&amp;#x7684;&amp;#x5C0F;&amp;#x4F19;&amp;#x4F34;&amp;#x73A9;&amp;#x4E86; QwQ&lt;br&gt;
&amp;#x548C; Fuxey &amp;#x548C; Sengxian &amp;#x4ED6;&amp;#x4EEC;&amp;#x804A;&amp;#x4E86;&amp;#x4E00;&amp;#x665A;&amp;#x4E0A;&amp;#xFF0C;&amp;#x5341;&amp;#x4E00;&amp;#x70B9;&amp;#x591A;&amp;#x624D;&amp;#x56DE;&amp;#x53BB; &amp;#x2026;&amp;#x2026; qwq&lt;br&gt;
Sengxian &amp;#x8868;&amp;#x793A;&amp;#x4ED6;&amp;#x624D;&amp;#x662F;&lt;strong&gt;&amp;#x771F;&amp;#xB7;&amp;#x7B7E;&amp;#x5230;&amp;#x5206;&lt;/strong&gt;&amp;#xFF0C;46.38 &amp;#x5206; 23333&lt;/p&gt;
&lt;h3 id=&quot;section-7&quot;&gt;5.8&lt;/h3&gt;
&lt;p&gt;&amp;#x542C;&amp;#x8BFE;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x4E0A;&amp;#x5348;&amp;#x8BB2;&amp;#x7269;&amp;#x7406;&amp;#x5F15;&amp;#x64CE; &amp;#x2026;&amp;#x2026; smg &amp;#x2026;&amp;#x2026; &amp;#x62FF;&amp;#x51FA;&amp;#x7B14;&amp;#x8BB0;&amp;#x672C;&amp;#x7535;&amp;#x8111;&amp;#x51C6;&amp;#x5907;&amp;#x5199; sui &amp;#x7ED9;&amp;#x6211;&amp;#x8BB2;&amp;#x7684;&amp;#x9898; &amp;#x2026;&amp;#x2026; &amp;#x8BF6;&amp;#x600E;&amp;#x4E48;&amp;#x5F00;&amp;#x4E0D;&amp;#x4E86;&amp;#x673A; &amp;#x2026;&amp;#x2026;&lt;br&gt;
mdzz &amp;#x2026;&amp;#x2026; &amp;#x6628;&amp;#x665A;&amp;#x5FD8;&amp;#x5173;&amp;#x673A;&amp;#x4E86;&amp;#xFF0C;&amp;#x6CA1;&amp;#x7535;&amp;#x4E86; XD&lt;/p&gt;
&lt;p&gt;&amp;#x4E8E;&amp;#x662F; Fancy &amp;#x628A;&amp;#x7B14;&amp;#x8BB0;&amp;#x672C;&amp;#x7535;&amp;#x8111;&amp;#x501F;&amp;#x7ED9;&amp;#x4E86;&amp;#x6211;&amp;#xFF0C;&amp;#x5199;&amp;#x4E86;&amp;#x4E00;&amp;#x4E0A;&amp;#x5348;&amp;#x7684;&amp;#x9898;&amp;#xFF0C;&amp;#x8FD8;&amp;#x662F;&amp;#x6CA1;&amp;#x8C03;&amp;#x51FA;&amp;#x6765; &amp;#x2026;&amp;#x2026;&lt;br&gt;
&amp;#x4E0B;&amp;#x5348;&amp;#x8FD8;&amp;#x662F;&amp;#x542C;&amp;#x4E0D;&amp;#x61C2;&amp;#x8BFE;&amp;#xFF0C;&amp;#x7EE7;&amp;#x7EED;&amp;#x8C03;&amp;#x9898; &amp;#x2026;&amp;#x2026; &amp;#x7136;&amp;#x800C; Fancy &amp;#x7684;&amp;#x7535;&amp;#x8111;&amp;#x4E5F;&amp;#x6CA1;&amp;#x7535;&amp;#x4E86; XD&lt;/p&gt;
&lt;p&gt;&amp;#x665A;&amp;#x4E0A;&amp;#x95ED;&amp;#x5E55;&amp;#x5F0F; &amp;#x2026;&amp;#x2026; Cu &amp;#x7EBF;&amp;#x597D;&amp;#x4F4E;&amp;#xFF0C;46 &amp;#x5206;&amp;#x5C31;&amp;#x6709; &amp;#x2026;&amp;#x2026;&lt;/p&gt;
&lt;p&gt;&amp;#x56DE;&amp;#x5230;&amp;#x9152;&amp;#x5E97;&amp;#x53C8;&amp;#x88AB;&amp;#x9752;&amp;#x5C9B;&amp;#x4E8C;&amp;#x4E2D;&amp;#x7684;&amp;#x62D0;&amp;#x8D70;&amp;#x4E86;&amp;#xFF0C;zdw1999 &amp;#x7ADF;&amp;#x7136;&amp;#x4E5F;&amp;#x88AB;&amp;#x62D0;&amp;#x8FC7;&amp;#x53BB;&amp;#x4E86; qvq&lt;br&gt;
&amp;#x6253;&amp;#x4E86;&amp;#x4E24;&amp;#x5C40;&amp;#x4FDD;&amp;#x7687; &amp;#x2026;&amp;#x2026;&lt;/p&gt;
&lt;p&gt;&amp;#x4E8E;&amp;#x662F;&amp;#x53C8;&amp;#x53BB;&amp;#x627E; HA &amp;#x7684;&amp;#x5C0F;&amp;#x4F19;&amp;#x4F34;&amp;#x4E86; &amp;#x2026;&amp;#x2026; &amp;#x521A;&amp;#x8FDB;&amp;#x623F;&amp;#x95F4;&amp;#x5927;&amp;#x5BB6;&amp;#x90FD;&amp;#x5F88;&amp;#x5174;&amp;#x594B;&amp;#x7684;&amp;#x6837;&amp;#x5B50; &amp;#x2026;&amp;#x2026; &lt;del&gt;&amp;#x8FD9;&amp;#x662F;&amp;#x8981;&amp;#x641E;&amp;#x4E2A;&amp;#x5927;&amp;#x65B0;&amp;#x95FB;&amp;#xFF1F;&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;&lt;del&gt;&amp;#xFF08;&amp;#x7531;&amp;#x4E8E;&amp;#x67D0;&amp;#x4E9B;&amp;#x539F;&amp;#x56E0;&amp;#xFF0C;&amp;#x6B64;&amp;#x5904;&amp;#x5220;&amp;#x9664;&amp;#x82E5;&amp;#x5E72;&amp;#x5B57;&amp;#xFF09;&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x7136;&amp;#x540E;&amp;#x7EE7;&amp;#x7EED;&amp;#x8C03;&amp;#x4ECA;&amp;#x5929;&amp;#x4E0A;&amp;#x5348;&amp;#x5199;&amp;#x7684;&amp;#x9898;&amp;#xFF0C;&amp;#x8FC7;&amp;#x4E86;&amp;#x6837;&amp;#x4F8B;&amp;#xFF0C;&amp;#x4EA4;&amp;#x5230; COGS &amp;#x4E0A;&amp;#xFF0C;WWTTTTTTTT&amp;#xFF0C;&amp;#x5F03;&amp;#x7597; &amp;#x2026;&amp;#x2026;&lt;/p&gt;
&lt;p&gt;&amp;#x6700;&amp;#x540E;&amp;#x5E2E; Fancy &amp;#x641E;&amp;#x4E86;&amp;#x641E; Ubuntu &amp;#x4E0B;&amp;#x7684;&amp;#x6307;&amp;#x7EB9;&amp;#x8BC6;&amp;#x522B;&amp;#xFF0C;KZ &amp;#x8868;&amp;#x793A;&amp;#x4E5F;&amp;#x8981;&amp;#x6211;&amp;#x5E2E;&amp;#x4ED6;&amp;#x5F04;&amp;#x5F04;&amp;#xFF0C;&amp;#x7136;&amp;#x800C;&amp;#x5DF2;&amp;#x7ECF;&amp;#x5FEB;&amp;#x5341;&amp;#x4E8C;&amp;#x70B9;&amp;#x4E86; &amp;#x2026;&amp;#x2026; XD&lt;/p&gt;
&lt;h3 id=&quot;section-8&quot;&gt;5.9&lt;/h3&gt;
&lt;p&gt;&amp;#x65E9;&amp;#x4E0A;&amp;#x516B;&amp;#x70B9;&amp;#x53BB;&amp;#x6B21;&amp;#x996D;&amp;#xFF0C;get &amp;#x6210;&amp;#x5C31; &amp;#x6700;&amp;#x540E;&amp;#x4E00;&amp;#x4E2A;&amp;#x8D70;&amp;#x51FA;&amp;#x98DF;&amp;#x5802; 23333&lt;/p&gt;
&lt;p&gt;&amp;#x665A;&amp;#x4E0A;&amp;#x7684;&amp;#x706B;&amp;#x8F66;&amp;#xFF0C;&amp;#x4E8E;&amp;#x662F;&amp;#x5148;&amp;#x5728;&amp;#x9152;&amp;#x5E97;&amp;#x5F85;&amp;#x4E86;&amp;#x4E00;&amp;#x4E0A;&amp;#x5348; &amp;#x2026;&amp;#x2026;&lt;/p&gt;
&lt;p&gt;&amp;#x8003;&amp;#x8651;&amp;#x5230;&amp;#x8F66;&amp;#x7AD9;&amp;#x73AF;&amp;#x5883;&amp;#x5E76;&amp;#x4E0D;&amp;#x592A;&amp;#x597D;&amp;#xFF0C;&amp;#x53C8;&amp;#x5728;&amp;#x9152;&amp;#x5E97;&amp;#x5927;&amp;#x5385;&amp;#x91CC;&amp;#x5F85;&amp;#x4E86;&amp;#x4E00;&amp;#x4E0B;&amp;#x5348; &amp;#x2026;&amp;#x2026; qwq&lt;/p&gt;
&lt;p&gt;&amp;#x665A;&amp;#x4E0A;&amp;#x5C31;&amp;#x8981;&amp;#x5750;&amp;#x8F66;&amp;#x56DE;&amp;#x53BB;&amp;#x54AF; &amp;#x2026;&amp;#x2026;&lt;/p&gt;
&lt;p&gt;&amp;#x518D;&amp;#x89C1; &amp;#x2026;&amp;#x2026;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x7B2C;&amp;#x4E00;&amp;#x6B21;&amp;#x53C2;&amp;#x52A0; CTSC &amp;amp; APIO&amp;#xFF0C;&amp;#x6D41;&amp;#x6C34;&amp;#x8D26;&amp;#x5982;&amp;#x4E0B;&amp;#x3002;&lt;/p&gt;
    
    </summary>
    
      <category term="Diary" scheme="https://blog.menci.moe/categories/diary/"/>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/diary/oi/"/>
    
    
      <category term="APIO" scheme="https://blog.menci.moe/tag/apio/"/>
    
      <category term="CTSC" scheme="https://blog.menci.moe/tag/ctsc/"/>
    
      <category term="游记" scheme="https://blog.menci.moe/tag/%E6%B8%B8%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>莫队算法学习笔记</title>
    <link href="https://blog.menci.moe/mo-algorithm-notes/"/>
    <id>https://blog.menci.moe/mo-algorithm-notes/</id>
    <published>2016-05-01T00:14:50.000Z</published>
    <updated>2016-05-11T09:33:24.440Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x7B97;&amp;#x6CD5;&amp;#x7ADE;&amp;#x8D5B;&amp;#x4E2D;&amp;#x6709;&amp;#x8FD9;&amp;#x6837;&amp;#x4E00;&amp;#x7C7B;&amp;#x9898;&amp;#x76EE;&amp;#xFF0C;&amp;#x7ED9;&amp;#x5B9A;&amp;#x4E00;&amp;#x4E2A;&amp;#x5E8F;&amp;#x5217; $ [1,\ n] $&amp;#xFF0C;&amp;#x6BCF;&amp;#x6B21;&amp;#x67E5;&amp;#x8BE2; $ [l,\ r] $ &amp;#x533A;&amp;#x95F4;&amp;#x7684;&amp;#x4FE1;&amp;#x606F;&amp;#x3002;&amp;#x8FD9;&amp;#x7C7B;&amp;#x9898;&amp;#x76EE;&amp;#x6CA1;&amp;#x6709;&amp;#x4FEE;&amp;#x6539;&amp;#x64CD;&amp;#x4F5C;&amp;#xFF0C;&amp;#x53EA;&amp;#x6709;&amp;#x67E5;&amp;#x8BE2;&amp;#xFF0C;&amp;#x5E76;&amp;#x4E14;&amp;#x64CD;&amp;#x4F5C;&amp;#x6CA1;&amp;#x6709;&amp;#x52A0;&amp;#x5BC6;&amp;#xFF08;&amp;#x5141;&amp;#x8BB8;&amp;#x79BB;&amp;#x7EBF;&amp;#xFF09;&amp;#xFF0C;&amp;#x83AB;&amp;#x961F;&amp;#x7B97;&amp;#x6CD5;&amp;#x5C31;&amp;#x662F;&amp;#x9488;&amp;#x5BF9;&amp;#x8FD9;&amp;#x7C7B;&amp;#x9898;&amp;#x76EE;&amp;#x7684;&amp;#x4E00;&amp;#x4E2A;&amp;#x79BB;&amp;#x7EBF;&amp;#x7B97;&amp;#x6CD5;&amp;#x3002;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;&amp;#x83AB;&amp;#x961F;&amp;#x7B97;&amp;#x6CD5;&amp;#x7684;&amp;#x6838;&amp;#x5FC3;&amp;#x601D;&amp;#x60F3;&amp;#x662F;&amp;#xFF0C;&amp;#x5047;&amp;#x5982;&amp;#x6211;&amp;#x4EEC;&amp;#x5DF2;&amp;#x7ECF;&amp;#x77E5;&amp;#x9053;&amp;#x4E86; $ [l,\ r] $ &amp;#x7684;&amp;#x7B54;&amp;#x6848;&amp;#xFF0C;&amp;#x53C8;&amp;#x53EF;&amp;#x4EE5;&amp;#x5F88;&amp;#x65B9;&amp;#x4FBF;&amp;#x5730;&amp;#x5411; $ [l,\ r + 1] $&amp;#x3001;$ [l,\ r - 1] $&amp;#x3001;$ [l - 1,\ r] $&amp;#x3001;$ [l + 1,\ r] $ &amp;#x6269;&amp;#x5C55;&amp;#xFF0C;&amp;#x5C31;&amp;#x53EF;&amp;#x4EE5;&amp;#x5B9E;&amp;#x73B0;&amp;#x8BA9;&amp;#x7B54;&amp;#x6848;&amp;#x5728;&amp;#x6BCF;&amp;#x4E2A;&amp;#x8BE2;&amp;#x95EE;&amp;#x4E4B;&amp;#x95F4;&amp;#x8F6C;&amp;#x79FB;&amp;#x3002;&amp;#x5047;&amp;#x8BBE;&amp;#x6BCF;&amp;#x6B21;&amp;#x6269;&amp;#x5C55;&amp;#x7684;&amp;#x65F6;&amp;#x95F4;&amp;#x4E3A; $ O(1) $&amp;#xFF0C;&amp;#x53C8;&amp;#x56E0;&amp;#x4E3A;&amp;#x6BCF;&amp;#x6B21;&amp;#x8F6C;&amp;#x79FB;&amp;#x6700;&amp;#x591A;&amp;#x6709; $ O(n) $ &amp;#x6B21;&amp;#x6269;&amp;#x5C55;&amp;#xFF0C;&amp;#x6240;&amp;#x4EE5;&amp;#x7B97;&amp;#x6CD5;&amp;#x603B;&amp;#x65F6;&amp;#x95F4;&amp;#x590D;&amp;#x6742;&amp;#x5EA6;&amp;#x4E3A; $ O(n ^ 2) $&amp;#xFF0C;&amp;#x901A;&amp;#x5E38;&amp;#x4F1A;&amp;#x8D85;&amp;#x65F6;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x6211;&amp;#x4EEC;&amp;#x53EF;&amp;#x4EE5;&amp;#x5C06;&amp;#x533A;&amp;#x95F4;&amp;#x5206;&amp;#x4E3A; $ \sqrt n $ &amp;#x5757;&amp;#xFF0C;&amp;#x6BCF;&amp;#x5757;&amp;#x7684;&amp;#x5927;&amp;#x5C0F;&amp;#x4E3A; $ \sqrt n $&amp;#xFF0C;&amp;#x5E76;&amp;#x4E14;&amp;#x5C06;&amp;#x8BE2;&amp;#x95EE;&amp;#x4EE5;&lt;strong&gt;&amp;#x5DE6;&amp;#x7AEF;&amp;#x70B9;&amp;#x6240;&amp;#x5728;&amp;#x7684;&amp;#x5757;&lt;/strong&gt;&amp;#x4E3A;&amp;#x7B2C;&amp;#x4E00;&amp;#x5173;&amp;#x952E;&amp;#x5B57;&amp;#x3001;&amp;#x4EE5;&lt;strong&gt;&amp;#x53F3;&amp;#x7AEF;&amp;#x70B9;&lt;/strong&gt;&amp;#x4E3A;&amp;#x7B2C;&amp;#x4E8C;&amp;#x5173;&amp;#x952E;&amp;#x5B57;&amp;#x6392;&amp;#x5E8F;&amp;#xFF0C;&amp;#x4E4B;&amp;#x540E;&amp;#x518D;&amp;#x8FDB;&amp;#x884C;&amp;#x4E0A;&amp;#x8FF0;&amp;#x7B97;&amp;#x6CD5;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x6392;&amp;#x5E8F;&amp;#x540E;&amp;#xFF0C;&amp;#x53EA;&amp;#x6709;&amp;#x7B2C;&amp;#x4E00;&amp;#x5173;&amp;#x952E;&amp;#x5B57;&amp;#x4E0D;&amp;#x540C;&amp;#x7684;&amp;#x8BE2;&amp;#x95EE;&amp;#x4E4B;&amp;#x95F4;&amp;#x624D;&amp;#x4F1A;&amp;#x4EA7;&amp;#x751F;&amp;#x5757;&amp;#x4E4B;&amp;#x95F4;&amp;#x7684;&amp;#x8F6C;&amp;#x79FB;&amp;#xFF0C;&amp;#x800C;&amp;#x53C8;&amp;#x56E0;&amp;#x4E3A;&amp;#x5171;&amp;#x6709; $ O(\sqrt n) $ &amp;#x5757;&amp;#xFF0C;&amp;#x6240;&amp;#x4EE5;&amp;#x4E0D;&amp;#x540C;&amp;#x5757;&amp;#x4E4B;&amp;#x95F4;&amp;#x7684;&amp;#x8F6C;&amp;#x79FB;&amp;#x6700;&amp;#x591A;&amp;#x53D1;&amp;#x751F; $ O(\sqrt n) $ &amp;#x6B21;&amp;#xFF0C;&amp;#x4E0D;&amp;#x540C;&amp;#x5757;&amp;#x4E4B;&amp;#x95F4;&amp;#x8F6C;&amp;#x79FB;&amp;#x7684;&amp;#x603B;&amp;#x6B21;&amp;#x6570;&amp;#x4E3A; $ O((\sqrt n) ^ 2) = O(n) $&amp;#x3002;&amp;#x6BCF;&amp;#x4E00;&amp;#x5757;&amp;#x7684;&amp;#x5927;&amp;#x5C0F;&amp;#x4E3A; $ O(\sqrt n) $&amp;#xFF0C;&amp;#x5373;&amp;#x6BCF;&amp;#x4E00;&amp;#x5757;&amp;#x5185;&amp;#x6700;&amp;#x591A;&amp;#x6709; $ O((\sqrt n) ^ 2) = O(n) $ &amp;#x4E2A;&amp;#x4E0D;&amp;#x540C;&amp;#x7684;&amp;#x533A;&amp;#x95F4;&amp;#x3002;&amp;#x6240;&amp;#x4EE5;&amp;#xFF0C;&amp;#x6BCF;&amp;#x7ECF;&amp;#x8FC7;&amp;#x4E00;&amp;#x4E2A;&amp;#x5757;&amp;#xFF0C;&amp;#x90FD;&amp;#x8981;&amp;#x8FDB;&amp;#x884C; $ O(n) $ &amp;#x6B21;&amp;#x8F6C;&amp;#x79FB;&amp;#xFF0C;&amp;#x4E58;&amp;#x4E0A;&amp;#x603B;&amp;#x5757;&amp;#x6570; $ O(\sqrt n) $&amp;#xFF0C;&amp;#x5373;&amp;#x76F8;&amp;#x540C;&amp;#x5757;&amp;#x5185;&amp;#x7684;&amp;#x8F6C;&amp;#x79FB;&amp;#x7684;&amp;#x603B;&amp;#x6B21;&amp;#x6570;&amp;#x4E3A; $ O(n \sqrt n) $&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x6BCF;&amp;#x6B21;&amp;#x6269;&amp;#x5C55;&amp;#x7684;&amp;#x65F6;&amp;#x95F4;&amp;#x590D;&amp;#x6742;&amp;#x5EA6;&amp;#x4E0D;&amp;#x540C;&amp;#x65F6;&amp;#xFF0C;&amp;#x9002;&amp;#x5F53;&amp;#x8C03;&amp;#x6574;&amp;#x5757;&amp;#x7684;&amp;#x5927;&amp;#x5C0F;&amp;#xFF0C;&amp;#x53EF;&amp;#x4EE5;&amp;#x964D;&amp;#x4F4E;&amp;#x4F7F;&amp;#x6574;&amp;#x4E2A;&amp;#x7B97;&amp;#x6CD5;&amp;#x7684;&amp;#x65F6;&amp;#x95F4;&amp;#x590D;&amp;#x6742;&amp;#x5EA6;&amp;#x3002;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x7B97;&amp;#x6CD5;&amp;#x7ADE;&amp;#x8D5B;&amp;#x4E2D;&amp;#x6709;&amp;#x8FD9;&amp;#x6837;&amp;#x4E00;&amp;#x7C7B;&amp;#x9898;&amp;#x76EE;&amp;#xFF0C;&amp;#x7ED9;&amp;#x5B9A;&amp;#x4E00;&amp;#x4E2A;&amp;#x5E8F;&amp;#x5217; $ [1,\ n] $&amp;#xFF0C;&amp;#x6BCF;&amp;#x6B21;&amp;#x67E5;&amp;#x8BE2; $ [l,\ r] $ &amp;#x533A;&amp;#x95F4;&amp;#x7684;&amp;#x4FE1;&amp;#x606F;&amp;#x3002;&amp;#x8FD9;&amp;#x7C7B;&amp;#x9898;&amp;#x76EE;&amp;#x6CA1;&amp;#x6709;&amp;#x4FEE;&amp;#x6539;&amp;#x64CD;&amp;#x4F5C;&amp;#xFF0C;&amp;#x53EA;&amp;#x6709;&amp;#x67E5;&amp;#x8BE2;&amp;#xFF0C;&amp;#x5E76;&amp;#x4E14;&amp;#x64CD;&amp;#x4F5C;&amp;#x6CA1;&amp;#x6709;&amp;#x52A0;&amp;#x5BC6;&amp;#xFF08;&amp;#x5141;&amp;#x8BB8;&amp;#x79BB;&amp;#x7EBF;&amp;#xFF09;&amp;#xFF0C;&amp;#x83AB;&amp;#x961F;&amp;#x7B97;&amp;#x6CD5;&amp;#x5C31;&amp;#x662F;&amp;#x9488;&amp;#x5BF9;&amp;#x8FD9;&amp;#x7C7B;&amp;#x9898;&amp;#x76EE;&amp;#x7684;&amp;#x4E00;&amp;#x4E2A;&amp;#x79BB;&amp;#x7EBF;&amp;#x7B97;&amp;#x6CD5;&amp;#x3002;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="学习笔记" scheme="https://blog.menci.moe/tag/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
      <category term="数据结构" scheme="https://blog.menci.moe/tag/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
      <category term="莫队" scheme="https://blog.menci.moe/tag/%E8%8E%AB%E9%98%9F/"/>
    
  </entry>
  
  <entry>
    <title>「HNOI2016」序列 - 莫队 + RMQ</title>
    <link href="https://blog.menci.moe/hnoi2016-sequence/"/>
    <id>https://blog.menci.moe/hnoi2016-sequence/</id>
    <published>2016-04-30T13:23:18.000Z</published>
    <updated>2016-05-11T09:33:24.440Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x7ED9;&amp;#x5B9A;&amp;#x957F;&amp;#x5EA6;&amp;#x4E3A; $ n $ &amp;#x7684;&amp;#x5E8F;&amp;#x5217;&amp;#xFF1A;$ a_1,\ a_2,\ \dots,\ a_n $&amp;#xFF0C;&amp;#x8BB0;&amp;#x4E3A; $ a[1:n] $&amp;#x3002;&amp;#x7C7B;&amp;#x4F3C;&amp;#x7684;&amp;#xFF0C;$ a[l:r] $&amp;#xFF08;$ 1 \leq l \leq r \leq n $&amp;#xFF09;&amp;#x662F;&amp;#x6307;&amp;#x5E8F;&amp;#x5217;&amp;#xFF1A;$ a_l,\ a_{l + 1},\ \dots,\ a_{r - 1},\ a_r $&amp;#x3002;&amp;#x82E5; $ 1 \leq l \leq s \leq t \leq r \leq n $&amp;#xFF0C;&amp;#x5219;&amp;#x79F0; $ a[s:t] $ &amp;#x662F; $ a[l:r] $ &amp;#x7684;&amp;#x5B50;&amp;#x5E8F;&amp;#x5217;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x73B0;&amp;#x5728;&amp;#x6709; $ q $ &amp;#x4E2A;&amp;#x8BE2;&amp;#x95EE;&amp;#xFF0C;&amp;#x6BCF;&amp;#x4E2A;&amp;#x8BE2;&amp;#x95EE;&amp;#x7ED9;&amp;#x5B9A;&amp;#x4E24;&amp;#x4E2A;&amp;#x6570; $ l $ &amp;#x548C; $ r $&amp;#xFF0C;$ 1 \leq l \leq r \leq n $&amp;#xFF0C;&amp;#x6C42; $ a[l:r] $ &amp;#x7684;&amp;#x4E0D;&amp;#x540C;&amp;#x5B50;&amp;#x5E8F;&amp;#x5217;&amp;#x7684;&amp;#x6700;&amp;#x5C0F;&amp;#x503C;&amp;#x4E4B;&amp;#x548C;&amp;#x3002;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;&amp;#x94FE;&amp;#x63A5;&quot;&gt;&amp;#x94FE;&amp;#x63A5;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://www.lydsy.com/JudgeOnline/problem.php?id=4540&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;BZOJ 4540&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x9898;&amp;#x89E3;&quot;&gt;&amp;#x9898;&amp;#x89E3;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;https://blog.sengxian.com/solutions/bzoj-4540&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Sengxian &amp;#x7684;&amp;#x9898;&amp;#x89E3;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x5BF9;&amp;#x4E8E;&amp;#x65E0;&amp;#x4FEE;&amp;#x6539;&amp;#x7684;&amp;#x533A;&amp;#x95F4;&amp;#x8BE2;&amp;#x95EE;&amp;#xFF0C;&amp;#x6211;&amp;#x4EEC;&amp;#x53EF;&amp;#x4EE5;&amp;#x5C06;&amp;#x64CD;&amp;#x4F5C;&amp;#x79BB;&amp;#x7EBF;&amp;#xFF0C;&amp;#x91C7;&amp;#x7528;&amp;#x83AB;&amp;#x961F;&amp;#x7B97;&amp;#x6CD5;&amp;#x89E3;&amp;#x51B3;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x4E3A;&amp;#x4FBF;&amp;#x4E8E;&amp;#x53D9;&amp;#x8FF0;&amp;#xFF0C;&amp;#x5B9A;&amp;#x4E49; $ [i] $ &amp;#x4E3A;&amp;#x4F4D;&amp;#x7F6E; $ i $ &amp;#x5904;&amp;#x7684;&amp;#x5143;&amp;#x7D20;&amp;#xFF08;&amp;#x5373; $ a_i $&amp;#xFF09;&amp;#xFF1B;$ [ \ [l,\ r],\ R \ ] $ &amp;#x4E3A;&amp;#x5DE6;&amp;#x7AEF;&amp;#x70B9;&amp;#x5C5E;&amp;#x4E8E; $ [l,\ r] $&amp;#xFF0C;&amp;#x53F3;&amp;#x7AEF;&amp;#x70B9;&amp;#x4E3A; $ R $ &amp;#x7684;&amp;#x6240;&amp;#x6709;&amp;#x5B50;&amp;#x5E8F;&amp;#x5217;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x5DF2;&amp;#x77E5;&amp;#x533A;&amp;#x95F4; $ [l,\ r - 1] $ &amp;#x7684;&amp;#x7B54;&amp;#x6848;&amp;#xFF0C;&amp;#x8003;&amp;#x8651;&amp;#x65B0;&amp;#x52A0;&amp;#x5165;&amp;#x7684;&amp;#x5143;&amp;#x7D20; $ [r] $ &amp;#x5BF9;&amp;#x8BE2;&amp;#x95EE;&amp;#x7684;&amp;#x5F71;&amp;#x54CD;&amp;#x3002;&amp;#x65B0;&amp;#x5143;&amp;#x7D20;&amp;#x52A0;&amp;#x5165;&amp;#x540E;&amp;#xFF0C;&amp;#x4EA7;&amp;#x751F;&amp;#x4E86; $ r - l + 1 $ &amp;#x4E2A;&amp;#x5B50;&amp;#x5E8F;&amp;#x5217;&amp;#xFF0C;&amp;#x5B83;&amp;#x4EEC;&amp;#x662F; $ [ \ [l,\ r] \ ,\ r \ ] $&amp;#x3002;&lt;/p&gt;
&lt;p&gt;$ [l, r] $ &amp;#x4E2D;&amp;#x5B58;&amp;#x5728;&amp;#x4E00;&amp;#x4E2A;&amp;#x6700;&amp;#x5C0F;&amp;#x503C; $ [m] $&amp;#xFF0C;&amp;#x4F7F;&amp;#x5F97; $ [ \ [l,\ m],\ r \ ] $ &amp;#x7684;&amp;#x6700;&amp;#x5C0F;&amp;#x503C;&amp;#x5747;&amp;#x4E3A; $ [m] $&amp;#xFF0C;&amp;#x4E3E;&amp;#x4E2A;&amp;#x4F8B;&amp;#x5B50;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&quot;header&quot;&gt;
&lt;th align=&quot;center&quot;&gt;&amp;#x4F4D;&amp;#x7F6E;&lt;/th&gt;
&lt;th align=&quot;center&quot;&gt;&lt;em&gt;1&lt;/em&gt;&lt;/th&gt;
&lt;th align=&quot;center&quot;&gt;2&lt;/th&gt;
&lt;th align=&quot;center&quot;&gt;3&lt;/th&gt;
&lt;th align=&quot;center&quot;&gt;&lt;em&gt;4&lt;/em&gt;&lt;/th&gt;
&lt;th align=&quot;center&quot;&gt;5&lt;/th&gt;
&lt;th align=&quot;center&quot;&gt;6&lt;/th&gt;
&lt;th align=&quot;center&quot;&gt;7&lt;/th&gt;
&lt;th align=&quot;center&quot;&gt;8&lt;/th&gt;
&lt;th align=&quot;center&quot;&gt;9&lt;/th&gt;
&lt;th align=&quot;center&quot;&gt;&lt;em&gt;10&lt;/em&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&quot;odd&quot;&gt;
&lt;td align=&quot;center&quot;&gt;&amp;#x503C;&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;5&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;7&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;3&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;1&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;5&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;2&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;8&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;3&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;6&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&quot;even&quot;&gt;
&lt;td align=&quot;center&quot;&gt;&amp;#x6807;&amp;#x8BB0;&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;$ l $&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;$ m $&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;$ r $&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&amp;#x533A;&amp;#x95F4; $ [ \ [1,\ 4],\ 6 \ ] $ &amp;#x7684;&amp;#x6700;&amp;#x5C0F;&amp;#x503C;&amp;#x5747;&amp;#x4E3A; $ [4] $&amp;#xFF0C;&amp;#x5373; $ 1 $&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x8003;&amp;#x8651;&amp;#x5269;&amp;#x4E0B;&amp;#x7684; $ r - m $ &amp;#x4E2A;&amp;#x5B50;&amp;#x5E8F;&amp;#x5217;&amp;#xFF0C;&amp;#x4ECE; $ r $ &amp;#x5411;&amp;#x5DE6;&amp;#x8D70;&amp;#xFF0C;&amp;#x7ECF;&amp;#x8FC7;&amp;#x7684;&amp;#x6240;&amp;#x6709;&amp;#x6BD4; $ [r] $ &lt;strong&gt;&amp;#x5927;&lt;/strong&gt;&amp;#x7684;&amp;#x5143;&amp;#x7D20;&amp;#xFF0C;&amp;#x4EE5;&amp;#x8FD9;&amp;#x4E9B;&amp;#x5143;&amp;#x7D20;&amp;#x7684;&amp;#x4F4D;&amp;#x7F6E;&amp;#x4E3A;&amp;#x5DE6;&amp;#x7AEF;&amp;#x70B9;&amp;#xFF0C;$ r $ &amp;#x4E3A;&amp;#x53F3;&amp;#x7AEF;&amp;#x70B9;&amp;#x7684;&amp;#x6240;&amp;#x6709;&amp;#x5B50;&amp;#x5E8F;&amp;#x5217;&amp;#x7684;&amp;#x6700;&amp;#x5C0F;&amp;#x503C;&amp;#x5747;&amp;#x4E3A; $ [r] $&amp;#x3002;&amp;#x76F4;&amp;#x5230;&amp;#x5230;&amp;#x8FBE;&amp;#x7B2C;&amp;#x4E00;&amp;#x4E2A;&amp;#x6BD4; $ [r] $ &amp;#x5C0F;&amp;#x7684;&amp;#x5143;&amp;#x7D20;&amp;#xFF08;&amp;#x4F8B;&amp;#x5B50;&amp;#x4E2D;&amp;#x7684; $ [8] = 3 $&amp;#xFF09;&amp;#xFF0C;&amp;#x5176;&amp;#x4F4D;&amp;#x7F6E;&amp;#x8BB0;&amp;#x505A; $ {\rm left}(r) = p $&amp;#x3002;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&quot;header&quot;&gt;
&lt;th align=&quot;center&quot;&gt;&amp;#x4F4D;&amp;#x7F6E;&lt;/th&gt;
&lt;th align=&quot;center&quot;&gt;&lt;em&gt;1&lt;/em&gt;&lt;/th&gt;
&lt;th align=&quot;center&quot;&gt;2&lt;/th&gt;
&lt;th align=&quot;center&quot;&gt;3&lt;/th&gt;
&lt;th align=&quot;center&quot;&gt;&lt;em&gt;4&lt;/em&gt;&lt;/th&gt;
&lt;th align=&quot;center&quot;&gt;5&lt;/th&gt;
&lt;th align=&quot;center&quot;&gt;6&lt;/th&gt;
&lt;th align=&quot;center&quot;&gt;7&lt;/th&gt;
&lt;th align=&quot;center&quot;&gt;&lt;em&gt;8&lt;/em&gt;&lt;/th&gt;
&lt;th align=&quot;center&quot;&gt;9&lt;/th&gt;
&lt;th align=&quot;center&quot;&gt;&lt;em&gt;10&lt;/em&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&quot;odd&quot;&gt;
&lt;td align=&quot;center&quot;&gt;&amp;#x503C;&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;5&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;7&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;3&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;1&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;5&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;2&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;8&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;3&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;6&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&quot;even&quot;&gt;
&lt;td align=&quot;center&quot;&gt;&amp;#x6807;&amp;#x8BB0;&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;$ l $&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;$ m $&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;$ p $&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;$ r $&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;$ p $ &amp;#x53F3;&amp;#x8FB9;&amp;#x6709; $ r - p = 10 - 8 = 2 $ &amp;#x4E2A;&amp;#x5B50;&amp;#x5E8F;&amp;#x5217;&amp;#xFF0C;&amp;#x4ED6;&amp;#x4EEC;&amp;#x7684;&amp;#x6700;&amp;#x5C0F;&amp;#x503C;&amp;#x5747;&amp;#x4E3A; $ [10] = 4 $&amp;#xFF0C;&amp;#x8FD9;&amp;#x4E9B;&amp;#x5B50;&amp;#x5E8F;&amp;#x5217;&amp;#x5BF9;&amp;#x7B54;&amp;#x6848;&amp;#x7684;&amp;#x8D21;&amp;#x732E;&amp;#x4E3A; $ (r - p) \times [r] $&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x4EFF;&amp;#x7167;&amp;#x521A;&amp;#x624D;&amp;#x7684;&amp;#x505A;&amp;#x6CD5;&amp;#xFF0C;&amp;#x7EE7;&amp;#x7EED;&amp;#x5411;&amp;#x5DE6;&amp;#x627E;&amp;#x7B2C;&amp;#x4E00;&amp;#x4E2A;&amp;#x5C0F;&amp;#x4E8E; $ [p] = 3 $ &amp;#x7684;&amp;#x5143;&amp;#x7D20;&amp;#xFF0C;&amp;#x5176;&amp;#x503C;&amp;#x4E3A; $ [6] = 2 $&amp;#xFF0C;&amp;#x5373; $ {\rm left}(p) = p&amp;#x2019; = 6 $&amp;#x3002;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&quot;header&quot;&gt;
&lt;th align=&quot;center&quot;&gt;&amp;#x4F4D;&amp;#x7F6E;&lt;/th&gt;
&lt;th align=&quot;center&quot;&gt;&lt;em&gt;1&lt;/em&gt;&lt;/th&gt;
&lt;th align=&quot;center&quot;&gt;2&lt;/th&gt;
&lt;th align=&quot;center&quot;&gt;3&lt;/th&gt;
&lt;th align=&quot;center&quot;&gt;&lt;em&gt;4&lt;/em&gt;&lt;/th&gt;
&lt;th align=&quot;center&quot;&gt;5&lt;/th&gt;
&lt;th align=&quot;center&quot;&gt;&lt;em&gt;6&lt;/em&gt;&lt;/th&gt;
&lt;th align=&quot;center&quot;&gt;7&lt;/th&gt;
&lt;th align=&quot;center&quot;&gt;&lt;em&gt;8&lt;/em&gt;&lt;/th&gt;
&lt;th align=&quot;center&quot;&gt;9&lt;/th&gt;
&lt;th align=&quot;center&quot;&gt;&lt;em&gt;10&lt;/em&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&quot;odd&quot;&gt;
&lt;td align=&quot;center&quot;&gt;&amp;#x503C;&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;5&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;7&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;3&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;1&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;5&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;2&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;8&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;3&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;6&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&quot;even&quot;&gt;
&lt;td align=&quot;center&quot;&gt;&amp;#x6807;&amp;#x8BB0;&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;$ l $&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;$ m $&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;$ p&amp;#x2019; $&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;$ p $&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;$ r $&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;$ p&amp;#x2019; $ &amp;#x53F3;&amp;#x8FB9;&amp;#x6709; $ p - p&amp;#x2019; = 8 - 6 = 2 $ &amp;#x4E2A;&amp;#x5B50;&amp;#x5E8F;&amp;#x5217;&amp;#xFF0C;&amp;#x4ED6;&amp;#x4EEC;&amp;#x7684;&amp;#x6700;&amp;#x5C0F;&amp;#x503C;&amp;#x5747;&amp;#x4E3A; $ [8] = 3 $&amp;#xFF0C;&amp;#x8FD9;&amp;#x4E9B;&amp;#x5B50;&amp;#x5E8F;&amp;#x5217;&amp;#x5BF9;&amp;#x7B54;&amp;#x6848;&amp;#x7684;&amp;#x8D21;&amp;#x732E;&amp;#x4E3A; $ (p - p&amp;#x2019;) \times [p] $&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x7EE7;&amp;#x7EED;&amp;#x5411;&amp;#x5DE6;&amp;#x627E;&amp;#xFF0C;&amp;#x627E;&amp;#x5230;&amp;#x7B2C;&amp;#x4E00;&amp;#x4E2A;&amp;#x6BD4; $ p&amp;#x2019; $ &amp;#x5C0F;&amp;#x7684;&amp;#x5143;&amp;#x7D20;&amp;#xFF0C;&amp;#x5176;&amp;#x503C;&amp;#x4E3A; $ 1 $&amp;#xFF0C;&amp;#x5373; $ {\rm left}(p&amp;#x2019;) = m = 4 $&amp;#xFF0C;&amp;#x6CE8;&amp;#x610F;&amp;#x6B64;&amp;#x65F6;&amp;#x5DF2;&amp;#x7ECF;&amp;#x627E;&amp;#x5230;&amp;#x6574;&amp;#x4E2A;&amp;#x533A;&amp;#x95F4;&amp;#x5185;&amp;#x7684;&amp;#x6700;&amp;#x5C0F;&amp;#x503C;&amp;#xFF0C;&amp;#x5DE6;&amp;#x7AEF;&amp;#x70B9;&amp;#x5728; $ m $ &amp;#x53CA;&amp;#x5176;&amp;#x5DE6;&amp;#x4FA7;&amp;#x7684;&amp;#x6240;&amp;#x6709;&amp;#x5B50;&amp;#x5E8F;&amp;#x5217;&amp;#x5BF9;&amp;#x7B54;&amp;#x6848;&amp;#x7684;&amp;#x8D21;&amp;#x732E;&amp;#x5DF2;&amp;#x7ECF;&amp;#x88AB;&amp;#x8003;&amp;#x8651;&amp;#x8FC7;&amp;#xFF0C;&amp;#x6070;&amp;#x597D;&amp;#x53EA;&amp;#x5269;&amp;#x4E0B; $ p&amp;#x2019; - m = 6 - 4 = 2 $ &amp;#x4E2A;&amp;#x5B50;&amp;#x5E8F;&amp;#x5217;&amp;#xFF0C;&amp;#x5176;&amp;#x6700;&amp;#x5C0F;&amp;#x503C;&amp;#x5747;&amp;#x4E3A; $ [p&amp;#x2019;] = 2 $&amp;#xFF0C;&amp;#x8FD9;&amp;#x4E9B;&amp;#x5B50;&amp;#x5E8F;&amp;#x5217;&amp;#x5BF9;&amp;#x7B54;&amp;#x6848;&amp;#x7684;&amp;#x8D21;&amp;#x732E;&amp;#x4E3A; $ (p&amp;#x2019; - m) \times [p&amp;#x2019;] $&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x82E5;&amp;#x76F4;&amp;#x63A5;&amp;#x4F7F;&amp;#x7528;&amp;#x4E0A;&amp;#x8FF0;&amp;#x7B97;&amp;#x6CD5;&amp;#x8BA1;&amp;#x7B97;&amp;#x6BCF;&amp;#x4E2A;&amp;#x5143;&amp;#x7D20;&amp;#x7684;&amp;#x8D21;&amp;#x732E;&amp;#xFF0C;&amp;#x5355;&amp;#x6B21;&amp;#x8BA1;&amp;#x7B97;&amp;#x7684;&amp;#x65F6;&amp;#x95F4;&amp;#x590D;&amp;#x6742;&amp;#x5EA6;&amp;#x4E3A; $ O(n) $&amp;#xFF0C;&amp;#x8D85;&amp;#x65F6;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x5B9A;&amp;#x4E49; $ m = \min[l,\ r] $ &amp;#x4E3A;&amp;#x533A;&amp;#x95F4; $ [l,\ r] $ &amp;#x7684;&amp;#x6700;&amp;#x5C0F;&amp;#x503C;&amp;#x6240;&amp;#x5728;&amp;#x7684;&amp;#x4F4D;&amp;#x7F6E;&amp;#xFF0C;&amp;#x8BBE; $ f(l, r) $ &amp;#x4E3A;&amp;#x533A;&amp;#x95F4; $ [l,\ r] $ &amp;#x5185;&amp;#x9664;&amp;#x6700;&amp;#x5C0F;&amp;#x503C;&amp;#x4E4B;&amp;#x5916;&amp;#x7684;&amp;#x5176;&amp;#x5B83;&amp;#x503C;&amp;#x5BF9;&amp;#x7B54;&amp;#x6848;&amp;#x7684;&amp;#x8D21;&amp;#x732E;&amp;#xFF0C;&amp;#x5219;&amp;#x6709;&lt;/p&gt;
&lt;p&gt;$$ f(l, r) = \begin{cases} 0 &amp;amp; r = m \\ [r] \times (r - {\rm left}(r)) + f(l, {\rm left}(r)) &amp;amp; {\rm otherwise} \\ \end{cases} $$&lt;/p&gt;
&lt;p&gt;&amp;#x6CE8;&amp;#x610F;&amp;#x5230;&amp;#x6574;&amp;#x4E2A;&amp;#x5F0F;&amp;#x5B50;&amp;#x9664;&amp;#x8FB9;&amp;#x754C;&amp;#x6761;&amp;#x4EF6;&amp;#x4E2D;&amp;#x7684; $ m $ &amp;#x4E4B;&amp;#x5916;&amp;#xFF0C;&amp;#x548C; $ l $ &amp;#x662F;&amp;#x65E0;&amp;#x5173;&amp;#x7684;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x8BBE; $ s(i) $ &amp;#x4E3A;&amp;#x4ECE; $ i $ &amp;#x4F4D;&amp;#x7F6E;&amp;#x4E00;&amp;#x76F4;&amp;#x5411;&amp;#x5DE6;&amp;#x8DF3;&amp;#xFF0C;&amp;#x76F4;&amp;#x5230;&amp;#x8DF3;&amp;#x5230;&amp;#x6240;&amp;#x6709;&amp;#x5143;&amp;#x7D20;&amp;#x4E2D;&amp;#x7684;&amp;#x6700;&amp;#x5C0F;&amp;#x503C;&amp;#xFF0C;&amp;#x7528;&amp;#x4E0A;&amp;#x8FF0;&amp;#x65B9;&amp;#x6CD5;&amp;#x8BA1;&amp;#x7B97;&amp;#x51FA;&amp;#x7684;&amp;#x8D21;&amp;#x732E;&amp;#x603B;&amp;#x548C;&amp;#xFF0C;&amp;#x5219;&amp;#x6709;&lt;/p&gt;
&lt;p&gt;$$ s(i) = \begin{cases} 0 &amp;amp; i = \min[1,\ n] \\ [i] \times (i - {\rm left}(i)) + s({\rm left}(i)) &amp;amp; {\rm otherwise} \\ \end{cases} $$&lt;/p&gt;
&lt;p&gt;&amp;#x6CE8;&amp;#x610F;&amp;#x5230;&amp;#x521A;&amp;#x624D;&amp;#x7684;&amp;#x4F8B;&amp;#x5B50;&amp;#x4E2D;&amp;#xFF0C;$ {\rm left}(p&amp;#x2019;) = {\rm left}(m + 1) = m $&amp;#xFF0C;&amp;#x5373;&lt;strong&gt;&amp;#x6700;&amp;#x540E;&amp;#x4E00;&amp;#x8DF3;&amp;#x7684;&amp;#x4F4D;&amp;#x7F6E;&lt;/strong&gt;&amp;#x548C;&lt;strong&gt;&amp;#x6700;&amp;#x5C0F;&amp;#x503C;&amp;#x7684;&amp;#x53F3;&amp;#x8FB9;&amp;#x4E00;&amp;#x4E2A;&amp;#x4F4D;&amp;#x7F6E;&lt;/strong&gt;&amp;#x5411;&amp;#x5DE6;&amp;#x8DF3;&amp;#x8DF3;&amp;#x5230;&amp;#x7684;&amp;#x4F4D;&amp;#x7F6E;&amp;#x76F8;&amp;#x540C;&amp;#x3002;&amp;#x6240;&amp;#x4EE5;&lt;/p&gt;
&lt;p&gt;$$ f(l, r) = s(r) - s(\min[l,\ r]) $$&lt;/p&gt;
&lt;p&gt;&amp;#x4F7F;&amp;#x7528;&amp;#x5355;&amp;#x8C03;&amp;#x6808;&amp;#x7B97;&amp;#x6CD5;&amp;#xFF08;&amp;#x4FDD;&amp;#x6301;&amp;#x6808;&amp;#x5E95;&amp;#x5230;&amp;#x6808;&amp;#x9876;&amp;#x7684;&amp;#x5143;&amp;#x7D20;&amp;#x5355;&amp;#x8C03;&amp;#x9012;&amp;#x589E;&amp;#xFF09;&amp;#x9884;&amp;#x5904;&amp;#x7406;&amp;#x51FA;&amp;#x6BCF;&amp;#x4E2A; $ {\rm left}(i) $&amp;#xFF0C;&amp;#x4E4B;&amp;#x540E;&amp;#x53EF;&amp;#x4EE5;&amp;#x5728; $ O(n) $ &amp;#x7684;&amp;#x65F6;&amp;#x95F4;&amp;#x5185;&amp;#x9012;&amp;#x63A8;&amp;#x51FA; $ s(i) $&amp;#x3002;&amp;#x533A;&amp;#x95F4;&amp;#x5411;&amp;#x5DE6;&amp;#x6269;&amp;#x5C55;&amp;#x65F6;&amp;#x540C;&amp;#x7406;&amp;#xFF0C;&amp;#x5411;&amp;#x53F3;&amp;#x8FB9;&amp;#x8DF3;&amp;#x5373;&amp;#x53EF;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x800C;&amp;#x5BF9;&amp;#x4E8E; RMQ&amp;#xFF0C;&amp;#x4F7F;&amp;#x7528;&amp;#x7A00;&amp;#x758F;&amp;#x8868;&amp;#x5728; $ O(n \log n) $ &amp;#x7684;&amp;#x65F6;&amp;#x95F4;&amp;#x5185;&amp;#x9884;&amp;#x5904;&amp;#x7406;&amp;#x540E;&amp;#xFF0C;&amp;#x5373;&amp;#x53EF;&amp;#x5728; $ O(1) $ &amp;#x7684;&amp;#x65F6;&amp;#x95F4;&amp;#x5185;&amp;#x56DE;&amp;#x7B54;&amp;#x6BCF;&amp;#x6B21;&amp;#x67E5;&amp;#x8BE2;&amp;#x3002;&amp;#x6700;&amp;#x7EC8;&amp;#xFF0C;&amp;#x6BCF;&amp;#x6B21;&amp;#x8F6C;&amp;#x79FB;&amp;#x7684;&amp;#x65F6;&amp;#x95F4;&amp;#x964D;&amp;#x4E3A; $ O(1) $&amp;#xFF0C;&amp;#x603B;&amp;#x65F6;&amp;#x95F4;&amp;#x590D;&amp;#x6742;&amp;#x5EA6;&amp;#x4E3A; $ O(q \log q + n \sqrt n) $&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x4EE3;&amp;#x7801;&quot;&gt;&amp;#x4EE3;&amp;#x7801;&lt;/h3&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;93&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;94&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;95&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;96&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;97&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;98&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;99&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;100&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;101&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;102&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;103&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;104&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;105&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;106&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;107&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;108&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;109&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;110&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;111&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;112&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;113&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;114&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;115&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;116&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;117&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;118&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;119&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;120&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;121&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;122&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;123&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;124&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;125&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;126&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;127&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;128&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;129&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;130&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;131&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;132&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;133&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;134&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;135&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;136&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;137&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;138&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;139&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;140&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;141&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;142&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;143&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;144&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;145&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;146&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;147&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;148&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;149&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;150&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;151&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;152&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;153&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;154&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;155&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;156&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;157&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;158&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;159&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cmath&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// #include &amp;lt;cassert&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;algorithm&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;stack&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXN = &lt;span class=&quot;number&quot;&gt;100000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXLOGN = &lt;span class=&quot;number&quot;&gt;17&lt;/span&gt;; &lt;span class=&quot;comment&quot;&gt;// log(100000, 2) = 16.609640474436812&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXM = &lt;span class=&quot;number&quot;&gt;100000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Element {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; val;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Element *left, *right;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; sumLeft, sumRight;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;operator&lt;/span&gt;&amp;lt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; Element &amp;amp;x) &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; { &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; val &amp;lt; x.val; }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;operator&lt;/span&gt;&amp;lt;=(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; Element &amp;amp;x) &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; { &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; val &amp;lt;= x.val; }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} a[MAXN];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, m, logTable[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Element *st[MAXN][MAXLOGN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; ans[MAXN];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Query {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; l, r;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; *ans;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;operator&lt;/span&gt;&amp;lt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; Query &amp;amp;x) &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; blockSize = &lt;span class=&quot;built_in&quot;&gt;floor&lt;/span&gt;(&lt;span class=&quot;built_in&quot;&gt;sqrt&lt;/span&gt;(n));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (l / blockSize == x.l / blockSize) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; r &amp;lt; x.r;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; l / blockSize &amp;lt; x.l / blockSize;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} Q[MAXM];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; Element *&lt;span class=&quot;title&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Element *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; a, Element *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; b)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!a) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; b;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!b) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; a;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; *a &amp;lt; *b ? a : b;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;sparseTable&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i++) st[i][&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;] = min(&amp;amp;a[i], &amp;amp;a[i + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    st[n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;][&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;] = &amp;amp;a[n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; j = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; (&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; j) &amp;lt;= n; j++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (i + (&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; (j - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)) &amp;lt; n) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                st[i][j] = min(st[i][j - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;], st[i + (&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; (j - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;))][j - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt;= n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        logTable[i] = &lt;span class=&quot;built_in&quot;&gt;floor&lt;/span&gt;(log2(i));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; Element *&lt;span class=&quot;title&quot;&gt;rmq&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; l, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; r)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (l == r) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &amp;amp;a[l];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; t = logTable[r - l];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; min(st[l][t], st[r - (&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; t)][t]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;prepare&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;stack&lt;/span&gt;&amp;lt;Element *&amp;gt; s;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    s.push(&amp;amp;a[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt; n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (!s.empty() &amp;amp;&amp;amp; a[i] &amp;lt;= *s.top()) s.pop();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!s.empty()) a[i].left = s.top();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; a[i].left = &lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        s.push(&amp;amp;a[i]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Element *x = &amp;amp;a[i];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (x-&amp;gt;left == &lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            x-&amp;gt;sumLeft = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        } &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            x-&amp;gt;sumLeft = x-&amp;gt;left-&amp;gt;sumLeft + (x - x-&amp;gt;left) * &lt;span class=&quot;keyword&quot;&gt;static_cast&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt;&amp;gt;(x-&amp;gt;val);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    s.push(&amp;amp;a[n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = n - &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;; i &amp;gt;= &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i--) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (!s.empty() &amp;amp;&amp;amp; a[i] &amp;lt;= *s.top()) s.pop();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!s.empty()) a[i].right = s.top();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; a[i].right = &lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        s.push(&amp;amp;a[i]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;gt;= &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i--) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Element *x = &amp;amp;a[i];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (x-&amp;gt;right == &lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            x-&amp;gt;sumRight = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        } &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            x-&amp;gt;sumRight = x-&amp;gt;right-&amp;gt;sumRight + (x-&amp;gt;right - x) * &lt;span class=&quot;keyword&quot;&gt;static_cast&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt;&amp;gt;(x-&amp;gt;val);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    sparseTable();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::sort(Q, Q + m);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// printf(&amp;quot;%lld %lld\n&amp;quot;, a[i].sumLeft, a[i].sumRight);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// printf(&amp;quot;%d: sumLeft = %lld, sumRight = %lld, &amp;quot;, a[i].val, a[i].sumLeft, a[i].sumRight);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// if (a[i].left == NULL) printf(&amp;quot;left = NULL, &amp;quot;);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// else printf(&amp;quot;left = %ld[%d], &amp;quot;, a[i].left - a, a[i].left-&amp;gt;val);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// if (a[i].right == NULL) printf(&amp;quot;right = NULL\n&amp;quot;);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// else printf(&amp;quot;right = %ld[%d]\n&amp;quot;, a[i].right - a, a[i].right-&amp;gt;val);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;expandRight&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; l, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; r)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// printf(&amp;quot;[%d, %d]\n&amp;quot;, l, r);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Element *pos = rmq(l, r);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; (pos - &amp;amp;a[l] + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) * &lt;span class=&quot;keyword&quot;&gt;static_cast&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt;&amp;gt;(pos-&amp;gt;val)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          + a[r].sumLeft - pos-&amp;gt;sumLeft;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;expandLeft&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; l, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; r)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// printf(&amp;quot;[%d, %d]\n&amp;quot;, l, r);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Element *pos = rmq(l, r);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; (&amp;amp;a[r] - pos + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) * &lt;span class=&quot;keyword&quot;&gt;static_cast&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt;&amp;gt;(pos-&amp;gt;val)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          + a[l].sumRight - pos-&amp;gt;sumRight;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;mo&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; l = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, r = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; ans = a[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;].val;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; m; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; Query &amp;amp;q = Q[i];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// assert(l &amp;lt;= r);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (r &amp;lt; q.r) r++, ans += expandRight(l, r);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (l &amp;gt; q.l) l--, ans += expandLeft(l, r);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (r &amp;gt; q.r) ans -= expandRight(l, r), r--;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (l &amp;lt; q.l) ans -= expandLeft(l, r), l++;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        *q.ans = ans;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d&amp;quot;&lt;/span&gt;, &amp;amp;n, &amp;amp;m);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;a[i].val);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; m; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d&amp;quot;&lt;/span&gt;, &amp;amp;Q[i].l, &amp;amp;Q[i].r);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Q[i].l--, Q[i].r--;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Q[i].ans = &amp;amp;ans[i];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    prepare();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    mo();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; m; i++) &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%lld\n&amp;quot;&lt;/span&gt;, ans[i]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x7ED9;&amp;#x5B9A;&amp;#x957F;&amp;#x5EA6;&amp;#x4E3A; $ n $ &amp;#x7684;&amp;#x5E8F;&amp;#x5217;&amp;#xFF1A;$ a_1,\ a_2,\ \dots,\ a_n $&amp;#xFF0C;&amp;#x8BB0;&amp;#x4E3A; $ a[1:n] $&amp;#x3002;&amp;#x7C7B;&amp;#x4F3C;&amp;#x7684;&amp;#xFF0C;$ a[l:r] $&amp;#xFF08;$ 1 \leq l \leq r \leq n $&amp;#xFF09;&amp;#x662F;&amp;#x6307;&amp;#x5E8F;&amp;#x5217;&amp;#xFF1A;$ a_l,\ a_{l + 1},\ \dots,\ a_{r - 1},\ a_r $&amp;#x3002;&amp;#x82E5; $ 1 \leq l \leq s \leq t \leq r \leq n $&amp;#xFF0C;&amp;#x5219;&amp;#x79F0; $ a[s:t] $ &amp;#x662F; $ a[l:r] $ &amp;#x7684;&amp;#x5B50;&amp;#x5E8F;&amp;#x5217;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x73B0;&amp;#x5728;&amp;#x6709; $ q $ &amp;#x4E2A;&amp;#x8BE2;&amp;#x95EE;&amp;#xFF0C;&amp;#x6BCF;&amp;#x4E2A;&amp;#x8BE2;&amp;#x95EE;&amp;#x7ED9;&amp;#x5B9A;&amp;#x4E24;&amp;#x4E2A;&amp;#x6570; $ l $ &amp;#x548C; $ r $&amp;#xFF0C;$ 1 \leq l \leq r \leq n $&amp;#xFF0C;&amp;#x6C42; $ a[l:r] $ &amp;#x7684;&amp;#x4E0D;&amp;#x540C;&amp;#x5B50;&amp;#x5E8F;&amp;#x5217;&amp;#x7684;&amp;#x6700;&amp;#x5C0F;&amp;#x503C;&amp;#x4E4B;&amp;#x548C;&amp;#x3002;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="BZOJ" scheme="https://blog.menci.moe/tag/bzoj/"/>
    
      <category term="HNOI" scheme="https://blog.menci.moe/tag/hnoi/"/>
    
      <category term="RMQ" scheme="https://blog.menci.moe/tag/rmq/"/>
    
      <category term="莫队" scheme="https://blog.menci.moe/tag/%E8%8E%AB%E9%98%9F/"/>
    
  </entry>
  
  <entry>
    <title>「HAOI2016」食物链 - 拓扑排序 + DP</title>
    <link href="https://blog.menci.moe/haoi2016-chain/"/>
    <id>https://blog.menci.moe/haoi2016-chain/</id>
    <published>2016-04-28T14:20:45.000Z</published>
    <updated>2016-05-11T09:33:24.440Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x7ED9; $ n $ &amp;#x4E2A;&amp;#x7269;&amp;#x79CD;&amp;#x548C; $ m $ &amp;#x6761;&amp;#x80FD;&amp;#x91CF;&amp;#x6D41;&amp;#x52A8;&amp;#x5173;&amp;#x7CFB;&amp;#xFF0C;&amp;#x6C42;&amp;#x5176;&amp;#x4E2D;&amp;#x7684;&amp;#x98DF;&amp;#x7269;&amp;#x94FE;&amp;#x6761;&amp;#x6570;&amp;#x3002;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;&amp;#x94FE;&amp;#x63A5;&quot;&gt;&amp;#x94FE;&amp;#x63A5;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://www.lydsy.com/JudgeOnline/problem.php?id=4562&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;BZOJ 4562&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://cogs.top/cogs/problem/problem.php?pid=2266&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;COGS 2266&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x9898;&amp;#x89E3;&quot;&gt;&amp;#x9898;&amp;#x89E3;&lt;/h3&gt;
&lt;p&gt;&amp;#x9898;&amp;#x610F;&amp;#x4E2D;&amp;#x6CA1;&amp;#x6709;&amp;#x8BF4;&amp;#x6E05;&amp;#x695A;&lt;strong&gt;&amp;#x98DF;&amp;#x7269;&amp;#x94FE;&lt;/strong&gt;&amp;#x7684;&amp;#x6982;&amp;#x5FF5;&amp;#xFF0C;&amp;#x6839;&amp;#x636E;&amp;#x6837;&amp;#x4F8B;&amp;#x53EF;&amp;#x77E5;&amp;#xFF0C;&amp;#x7531;&amp;#x751F;&amp;#x4EA7;&amp;#x8005;&amp;#x8D70;&amp;#x5411;&amp;#x6700;&amp;#x9AD8;&amp;#x7EA7;&amp;#x6D88;&amp;#x8D39;&amp;#x8005;&amp;#x7684;&amp;#x7B80;&amp;#x5355;&amp;#x8DEF;&amp;#x5F84;&amp;#xFF0C;&amp;#x591A;&amp;#x6761;&amp;#x98DF;&amp;#x7269;&amp;#x94FE;&amp;#x53EF;&amp;#x4EE5;&amp;#x6709;&amp;#x91CD;&amp;#x53E0;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x6211;&amp;#x4EEC;&amp;#x4EE4;&amp;#x8FB9;&amp;#x7684;&amp;#x65B9;&amp;#x5411;&amp;#x4E3A;&amp;#x751F;&amp;#x4EA7;&amp;#x8005;&amp;#x5230;&amp;#x6700;&amp;#x9AD8;&amp;#x7EA7;&amp;#x6D88;&amp;#x8D39;&amp;#x8005;&amp;#xFF0C;&amp;#x5BF9;&amp;#x6574;&amp;#x5F20;&amp;#x56FE;&amp;#x8FDB;&amp;#x884C;&amp;#x62D3;&amp;#x6251;&amp;#x6392;&amp;#x5E8F;&amp;#xFF0C;&amp;#x540C;&amp;#x65F6; DP &amp;#x51FA;&amp;#x4ECE;&amp;#x5165;&amp;#x5EA6;&amp;#x4E3A;&amp;#x96F6;&amp;#x7684;&amp;#x70B9;&amp;#xFF08;&amp;#x751F;&amp;#x4EA7;&amp;#x8005;&amp;#xFF09;&amp;#x5230;&amp;#x8BE5;&amp;#x70B9;&amp;#x7684;&amp;#x8DEF;&amp;#x5F84;&amp;#x6761;&amp;#x6570;&amp;#xFF08;&amp;#x4E00;&amp;#x5B9A;&amp;#x662F;&amp;#x7B80;&amp;#x5355;&amp;#x8DEF;&amp;#x5F84;&amp;#xFF09;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x6240;&amp;#x6709;&amp;#x51FA;&amp;#x5EA6;&amp;#x4E3A;&amp;#x96F6;&amp;#xFF08;&amp;#x4FDD;&amp;#x8BC1;&amp;#x662F;&amp;#x6700;&amp;#x9AD8;&amp;#x7EA7;&amp;#x6D88;&amp;#x8D39;&amp;#x8005;&amp;#xFF09;&amp;#x4E14;&amp;#x539F;&amp;#x5165;&amp;#x5EA6;&amp;#x4E0D;&amp;#x4E3A;&amp;#x96F6;&amp;#xFF08;&amp;#x4FDD;&amp;#x8BC1;&lt;strong&gt;&amp;#x4E0D;&amp;#x662F;&lt;/strong&gt;&amp;#x751F;&amp;#x4EA7;&amp;#x8005;&amp;#xFF0C;&amp;#x5355;&amp;#x72EC;&amp;#x4E00;&amp;#x4E2A;&amp;#x751F;&amp;#x4EA7;&amp;#x8005;&amp;#x6CA1;&amp;#x6709;&amp;#x6D88;&amp;#x8D39;&amp;#x8005;&amp;#x4E0D;&amp;#x7B97;&amp;#x98DF;&amp;#x7269;&amp;#x94FE;&amp;#xFF09;&amp;#x7684;&amp;#x70B9;&amp;#x4E0A;&amp;#x7684;&amp;#x8DEF;&amp;#x5F84;&amp;#x6761;&amp;#x6570;&amp;#x548C;&amp;#x5373;&amp;#x4E3A;&amp;#x98DF;&amp;#x7269;&amp;#x94FE;&amp;#x6570;&amp;#x91CF;&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x4EE3;&amp;#x7801;&quot;&gt;&amp;#x4EE3;&amp;#x7801;&lt;/h3&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;75&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;queue&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXN = &lt;span class=&quot;number&quot;&gt;100000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXM = &lt;span class=&quot;number&quot;&gt;200000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Node;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Edge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Node {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Edge *e;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; originInDegree, inDegree, outDegree;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; cnt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} N[MAXN];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Edge {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Node *s, *t;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Edge *next;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Edge(Node *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; s, Node *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; t) : s(s), t(t), next(s-&amp;gt;e) {}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;};&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;addEdge&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; s, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; t)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    N[s].e = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Edge(&amp;amp;N[s], &amp;amp;N[t]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    N[s].outDegree++, N[t].inDegree++, N[t].originInDegree++;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, m;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;toposort&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;queue&lt;/span&gt;&amp;lt;Node *&amp;gt; q;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (N[i].inDegree == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) N[i].cnt = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, q.push(&amp;amp;N[i]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (!q.empty()) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Node *v = q.front();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        q.pop();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (Edge *e = v-&amp;gt;e; e; e = e-&amp;gt;next) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            e-&amp;gt;t-&amp;gt;cnt += v-&amp;gt;cnt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!--e-&amp;gt;t-&amp;gt;inDegree) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                q.push(e-&amp;gt;t);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    freopen(&lt;span class=&quot;string&quot;&gt;&amp;quot;chain_2016.in&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;r&amp;quot;&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;stdin&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    freopen(&lt;span class=&quot;string&quot;&gt;&amp;quot;chain_2016.out&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;w&amp;quot;&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;stdout&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d&amp;quot;&lt;/span&gt;, &amp;amp;n, &amp;amp;m);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; m; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; u, v;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d&amp;quot;&lt;/span&gt;, &amp;amp;u, &amp;amp;v), u--, v--;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        addEdge(u, v);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    toposort();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; ans = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (N[i].outDegree == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &amp;amp;&amp;amp; N[i].originInDegree != &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) ans += N[i].cnt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d\n&amp;quot;&lt;/span&gt;, ans);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    fclose(&lt;span class=&quot;built_in&quot;&gt;stdin&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    fclose(&lt;span class=&quot;built_in&quot;&gt;stdout&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x7ED9; $ n $ &amp;#x4E2A;&amp;#x7269;&amp;#x79CD;&amp;#x548C; $ m $ &amp;#x6761;&amp;#x80FD;&amp;#x91CF;&amp;#x6D41;&amp;#x52A8;&amp;#x5173;&amp;#x7CFB;&amp;#xFF0C;&amp;#x6C42;&amp;#x5176;&amp;#x4E2D;&amp;#x7684;&amp;#x98DF;&amp;#x7269;&amp;#x94FE;&amp;#x6761;&amp;#x6570;&amp;#x3002;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="BZOJ" scheme="https://blog.menci.moe/tag/bzoj/"/>
    
      <category term="COGS" scheme="https://blog.menci.moe/tag/cogs/"/>
    
      <category term="DP" scheme="https://blog.menci.moe/tag/dp/"/>
    
      <category term="HAOI" scheme="https://blog.menci.moe/tag/haoi/"/>
    
      <category term="拓扑排序" scheme="https://blog.menci.moe/tag/%E6%8B%93%E6%89%91%E6%8E%92%E5%BA%8F/"/>
    
  </entry>
  
  <entry>
    <title>「JSOI2009」游戏 - 博弈 + 二分图匹配</title>
    <link href="https://blog.menci.moe/jsoi2009-game/"/>
    <id>https://blog.menci.moe/jsoi2009-game/</id>
    <published>2016-04-28T14:10:42.000Z</published>
    <updated>2016-05-11T09:33:24.440Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x5728; $ N \times M $ &amp;#x7684;&amp;#x8FF7;&amp;#x5BAB;&amp;#x4E2D;&amp;#x6709;&amp;#x4E00;&amp;#x4E2A;&amp;#x68CB;&amp;#x5B50;&amp;#xFF0C;AA &amp;#x9996;&amp;#x5148;&amp;#x4EFB;&amp;#x610F;&amp;#x9009;&amp;#x62E9;&amp;#x68CB;&amp;#x5B50;&amp;#x653E;&amp;#x7F6E;&amp;#x7684;&amp;#x4F4D;&amp;#x7F6E;&amp;#x3002;&amp;#x7136;&amp;#x540E;&amp;#xFF0C;YY &amp;#x548C; AA &amp;#x8F6E;&amp;#x6D41;&amp;#x5C06;&amp;#x68CB;&amp;#x5B50;&amp;#x79FB;&amp;#x52A8;&amp;#x5230;&amp;#x76F8;&amp;#x90BB;&amp;#x7684;&amp;#x683C;&amp;#x5B50;&amp;#x91CC;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x6E38;&amp;#x620F;&amp;#x7684;&amp;#x89C4;&amp;#x5219;&amp;#x89C4;&amp;#x5B9A;&amp;#xFF0C;&amp;#x5728;&amp;#x4E00;&amp;#x6B21;&amp;#x6E38;&amp;#x620F;&amp;#x4E2D;&amp;#xFF0C;&amp;#x540C;&amp;#x4E00;&amp;#x4E2A;&amp;#x683C;&amp;#x5B50;&amp;#x4E0D;&amp;#x80FD;&amp;#x8FDB;&amp;#x5165;&amp;#x4E24;&amp;#x6B21;&amp;#xFF0C;&amp;#x4E14;&amp;#x4E0D;&amp;#x80FD;&amp;#x5C06;&amp;#x68CB;&amp;#x5B50;&amp;#x79FB;&amp;#x52A8;&amp;#x5230;&amp;#x67D0;&amp;#x4E9B;&amp;#x683C;&amp;#x5B50;&amp;#x4E2D;&amp;#x53BB;&amp;#x3002;&amp;#x5F53;&amp;#x73A9;&amp;#x5BB6;&amp;#x65E0;&amp;#x6CD5;&amp;#x7EE7;&amp;#x7EED;&amp;#x79FB;&amp;#x52A8;&amp;#x68CB;&amp;#x5B50;&amp;#x65F6;&amp;#xFF0C;&amp;#x6E38;&amp;#x620F;&amp;#x7ED3;&amp;#x675F;&amp;#xFF0C;&amp;#x6700;&amp;#x540E;&amp;#x4E00;&amp;#x4E2A;&amp;#x79FB;&amp;#x52A8;&amp;#x68CB;&amp;#x5B50;&amp;#x7684;&amp;#x73A9;&amp;#x5BB6;&amp;#x8D62;&amp;#x5F97;&amp;#x4E86;&amp;#x6E38;&amp;#x620F;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x6C42; AA &amp;#x521D;&amp;#x59CB;&amp;#x5C06;&amp;#x68CB;&amp;#x5B50;&amp;#x653E;&amp;#x5728;&amp;#x54EA;&amp;#x4E9B;&amp;#x683C;&amp;#x5B50;&amp;#x4F1A;&amp;#x6709;&amp;#x5FC5;&amp;#x80DC;&amp;#x7B56;&amp;#x7565;&amp;#x3002;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;&amp;#x94FE;&amp;#x63A5;&quot;&gt;&amp;#x94FE;&amp;#x63A5;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://www.lydsy.com/JudgeOnline/problem.php?id=1443&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;BZOJ 1443&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x9898;&amp;#x89E3;&quot;&gt;&amp;#x9898;&amp;#x89E3;&lt;/h3&gt;
&lt;p&gt;&amp;#x9898;&amp;#x76EE;&amp;#x8981;&amp;#x6C42; AA &amp;#x521D;&amp;#x59CB;&amp;#x653E;&amp;#x7F6E;&amp;#x68CB;&amp;#x5B50;&amp;#x7684;&amp;#x4F4D;&amp;#x7F6E;&amp;#xFF0C;&amp;#x4F7F;&amp;#x5F97; AA &amp;#x6709;&amp;#x5FC5;&amp;#x80DC;&amp;#x7B56;&amp;#x7565;&amp;#xFF0C;&amp;#x5373;&amp;#x4E3A;&amp;#x6C42;&amp;#x5FC5;&amp;#x8D25;&amp;#x6001;&amp;#xFF08;&amp;#x56E0;&amp;#x4E3A; AA &amp;#x662F;&amp;#x540E;&amp;#x624B;&amp;#xFF09;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x5BF9;&amp;#x7F51;&amp;#x683C;&amp;#x56FE;&amp;#x8FDB;&amp;#x884C;&amp;#x5947;&amp;#x5076;&amp;#x67D3;&amp;#x8272;&amp;#xFF0C;&amp;#x5EFA;&amp;#x7ACB;&amp;#x4E8C;&amp;#x5206;&amp;#x56FE;&amp;#xFF0C;&amp;#x6C42;&amp;#x51FA;&amp;#x6709;&amp;#x6548;&amp;#x683C;&amp;#x5B50;&amp;#x7684;&amp;#x6700;&amp;#x5927;&amp;#x5339;&amp;#x914D;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x8003;&amp;#x8651;&amp;#x5C06;&amp;#x521D;&amp;#x59CB;&amp;#x70B9;&amp;#x653E;&amp;#x7F6E;&amp;#x5728;&amp;#x975E;&amp;#x5339;&amp;#x914D;&amp;#x70B9;&amp;#x4E0A;&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x6B64;&amp;#x65F6;&amp;#x6CA1;&amp;#x6709;&amp;#x4EFB;&amp;#x4F55;&amp;#x8FB9;&amp;#x4E0E;&amp;#x5176;&amp;#x76F8;&amp;#x8FDE;&amp;#xFF0C;&amp;#x5219; YY &amp;#x8D1F;&amp;#xFF0C;&amp;#x5426;&amp;#x5219; YY &amp;#x4E00;&amp;#x5B9A;&amp;#x4F1A;&amp;#x6CBF;&amp;#x7740;&amp;#x4E00;&amp;#x6761;&lt;strong&gt;&amp;#x975E;&amp;#x5339;&amp;#x914D;&lt;/strong&gt;&amp;#x8FB9;&amp;#x8D70;&amp;#x5411;&amp;#x53E6;&amp;#x4E00;&amp;#x4E2A;&lt;strong&gt;&amp;#x5339;&amp;#x914D;&lt;/strong&gt;&amp;#x70B9;&amp;#xFF08;&amp;#x5982;&amp;#x679C;&amp;#x8FD9;&amp;#x4E2A;&amp;#x70B9;&amp;#x662F;&amp;#x975E;&amp;#x5339;&amp;#x914D;&amp;#x70B9;&amp;#xFF0C;&amp;#x5219;&amp;#x5339;&amp;#x914D;&amp;#x8FD9;&amp;#x6761;&amp;#x8FB9;&amp;#x540E;&amp;#xFF0C;&amp;#x603B;&amp;#x5339;&amp;#x914D;&amp;#x6570;&amp;#x53EF;&amp;#x4EE5;&amp;#x589E;&amp;#x52A0;&amp;#xFF0C;&amp;#x663E;&amp;#x7136;&amp;#x4E0E;&amp;#x6700;&amp;#x5927;&amp;#x5339;&amp;#x914D;&amp;#x76F8;&amp;#x77DB;&amp;#x76FE;&amp;#xFF09;&amp;#xFF0C;&amp;#x6B64;&amp;#x65F6; AA &amp;#x4E00;&amp;#x5B9A;&amp;#x53EF;&amp;#x4EE5;&amp;#x6CBF;&amp;#x7740;&amp;#x4E00;&amp;#x6761;&amp;#x5339;&amp;#x914D;&amp;#x8FB9;&amp;#x8D70;&amp;#x56DE;&amp;#x6765;&amp;#xFF0C;&amp;#x72B6;&amp;#x6001;&amp;#x6062;&amp;#x590D;&amp;#x5230;&amp;#x521D;&amp;#x59CB;&amp;#x72B6;&amp;#x6001;&amp;#xFF0C;&amp;#x6700;&amp;#x7EC8; YY &amp;#x627E;&amp;#x4E0D;&amp;#x5230;&amp;#x4E00;&amp;#x6761;&amp;#x975E;&amp;#x5339;&amp;#x914D;&amp;#x8FB9;&amp;#xFF0C;&amp;#x8D1F;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x6211;&amp;#x4EEC;&amp;#x5F97;&amp;#x5230;&amp;#x7ED3;&amp;#x8BBA;&amp;#xFF1A;&amp;#x4E0D;&amp;#x5728;&amp;#x6700;&amp;#x5927;&amp;#x5339;&amp;#x914D;&amp;#x4E0A;&amp;#x7684;&amp;#x70B9;&amp;#xFF0C;&amp;#x4E00;&amp;#x5B9A;&amp;#x662F;&amp;#x5148;&amp;#x624B;&amp;#x5FC5;&amp;#x8D25;&amp;#x70B9;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x800C;&amp;#x5982;&amp;#x679C;&amp;#x4E00;&amp;#x4E2A;&amp;#x70B9;&amp;#x5728;&amp;#x6700;&amp;#x5927;&amp;#x5339;&amp;#x914D;&amp;#x4E0A;&amp;#xFF0C;&amp;#x6211;&amp;#x4EEC;&amp;#x8003;&amp;#x8651;&amp;#x8FD9;&amp;#x6837;&amp;#x4E00;&amp;#x6761;&amp;#x8DEF;&amp;#x5F84;&amp;#xFF0C;&amp;#x4ECE;&amp;#x8BE5;&amp;#x70B9;&amp;#x5F00;&amp;#x59CB;&amp;#x6CBF;&amp;#x7740;&amp;#x5339;&amp;#x914D;&amp;#x8FB9; - &amp;#x975E;&amp;#x5339;&amp;#x914D;&amp;#x8FB9; - &amp;#x5339;&amp;#x914D;&amp;#x8FB9; - &amp;#x975E;&amp;#x5339;&amp;#x914D;&amp;#x8FB9; &amp;#x2026;&amp;#x2026; &amp;#x8D70;&amp;#x4E0B;&amp;#x53BB;&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x8FD9;&amp;#x6761;&amp;#x8DEF;&amp;#x5F84;&amp;#x7684;&amp;#x957F;&amp;#x5EA6;&amp;#xFF08;&amp;#x8FB9;&amp;#x7684;&amp;#x6570;&amp;#x91CF;&amp;#xFF09;&amp;#x4E3A;&amp;#x5076;&amp;#x6570;&amp;#xFF0C;&amp;#x5219;&amp;#x7EC8;&amp;#x70B9;&amp;#x548C;&amp;#x8D77;&amp;#x70B9;&amp;#x5728;&amp;#xFF08;&amp;#x4E8C;&amp;#x5206;&amp;#x56FE;&amp;#x5212;&amp;#x5206;&amp;#x4E2D;&amp;#x7684;&amp;#xFF09;&amp;#x540C;&amp;#x4E00;&amp;#x96C6;&amp;#x5408;&amp;#x4E2D;&amp;#x3002;&amp;#x6B64;&amp;#x65F6;&amp;#x5C06;&amp;#x6574;&amp;#x4E2A;&amp;#x8DEF;&amp;#x5F84;&amp;#x4E2D;&amp;#x6BCF;&amp;#x6761;&amp;#x8FB9;&amp;#x65F6;&amp;#x5019;&amp;#x5339;&amp;#x914D;&amp;#x53D6;&amp;#x53CD;&amp;#xFF0C;&amp;#x5219;&amp;#x6574;&amp;#x5F20;&amp;#x56FE;&amp;#x4ECD;&amp;#x7136;&amp;#x662F;&amp;#x4E00;&amp;#x4E2A;&amp;#x6700;&amp;#x5927;&amp;#x5339;&amp;#x914D;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x53E6;&amp;#x4E00;&amp;#x4E2A;&amp;#x7ED3;&amp;#x8BBA;&amp;#xFF1A;&amp;#x5982;&amp;#x679C;&amp;#x4E00;&amp;#x4E2A;&amp;#x70B9;&lt;strong&gt;&amp;#x4E0D;&amp;#x4E00;&amp;#x5B9A;&lt;/strong&gt;&amp;#x5728;&amp;#x6700;&amp;#x5927;&amp;#x5339;&amp;#x914D;&amp;#x4E0A;&amp;#xFF0C;&amp;#x5219;&amp;#x5B83;&amp;#x4E00;&amp;#x5B9A;&amp;#x662F;&amp;#x5148;&amp;#x624B;&amp;#x5FC5;&amp;#x8D25;&amp;#x70B9;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x4F7F;&amp;#x7528; Dinic &amp;#x7B97;&amp;#x6CD5;&amp;#x6C42;&amp;#x51FA;&amp;#x4E8C;&amp;#x5206;&amp;#x56FE;&amp;#x6700;&amp;#x5927;&amp;#x5339;&amp;#x914D;&amp;#x540E;&amp;#xFF0C;&amp;#x5728;&amp;#x6B8B;&amp;#x91CF;&amp;#x7F51;&amp;#x7EDC;&amp;#x4E0A;&amp;#x8FDB;&amp;#x884C; BFS&amp;#xFF0C;&amp;#x4ECE;&amp;#x6E90;&amp;#x70B9;&amp;#x5F00;&amp;#x59CB;&amp;#xFF0C;&amp;#x59CB;&amp;#x7EC8;&amp;#x6CBF;&amp;#x7740;&lt;strong&gt;&amp;#x4E0D;&amp;#x6EE1;&amp;#x6D41;&lt;/strong&gt;&amp;#x7684;&amp;#x8FB9;&amp;#x8D70;&amp;#xFF0C;&amp;#x6240;&amp;#x6709;&amp;#x7ECF;&amp;#x8FC7;&amp;#x7684;&amp;#x4E14;&amp;#x5728;&amp;#x5DE6;&amp;#x4FA7;&amp;#x7684;&amp;#x70B9;&amp;#x5747;&lt;strong&gt;&amp;#x4E0D;&amp;#x4E00;&amp;#x5B9A;&amp;#x5728;&amp;#x6700;&amp;#x5927;&amp;#x5339;&amp;#x914D;&amp;#x4E0A;&lt;/strong&gt;&amp;#xFF0C;&amp;#x53F3;&amp;#x8FB9;&amp;#x540C;&amp;#x7406;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x8003;&amp;#x8651;&amp;#x4E0A;&amp;#x8FF0;&amp;#x7B97;&amp;#x6CD5;&amp;#x7684;&amp;#x6B63;&amp;#x786E;&amp;#x6027;&amp;#xFF0C;&amp;#x4ECE;&amp;#x6E90;&amp;#x70B9;&amp;#x8D70;&amp;#x5411;&amp;#x7684;&amp;#x7B2C;&amp;#x4E00;&amp;#x4E2A;&amp;#x70B9;&amp;#x4E00;&amp;#x5B9A;&amp;#x662F;&lt;strong&gt;&amp;#x975E;&amp;#x5339;&amp;#x914D;&amp;#x70B9;&lt;/strong&gt;&amp;#xFF0C;&amp;#x7EE7;&amp;#x7EED;&amp;#x8D70;&amp;#x4E00;&amp;#x6B65;&amp;#xFF0C;&amp;#x4E00;&amp;#x5B9A;&amp;#x662F;&amp;#x6CBF;&amp;#x7740;&lt;strong&gt;&amp;#x975E;&amp;#x5339;&amp;#x914D;&amp;#x8FB9;&lt;/strong&gt;&amp;#x4F1A;&amp;#x8D70;&amp;#x5230;&amp;#x53F3;&amp;#x4FA7;&amp;#x70B9;&amp;#xFF0C;&amp;#x518D;&amp;#x8D70;&amp;#x4E00;&amp;#x6B65;&amp;#xFF0C;&amp;#x4E00;&amp;#x5B9A;&amp;#x662F;&amp;#x6CBF;&amp;#x7740;&lt;strong&gt;&amp;#x5339;&amp;#x914D;&amp;#x8FB9;&amp;#x7684;&amp;#x53CD;&amp;#x5411;&amp;#x8FB9;&lt;/strong&gt;&amp;#x8D70;&amp;#x56DE;&amp;#x5DE6;&amp;#x4FA7;&amp;#x3002;&amp;#x663E;&amp;#x7136;&amp;#xFF0C;&amp;#x6BCF;&amp;#x6B21;&amp;#x8D70;&amp;#x5230;&amp;#x5DE6;&amp;#x4FA7;&amp;#x7684;&amp;#x70B9;&amp;#x65F6;&amp;#xFF0C;&amp;#x8DEF;&amp;#x5F84;&amp;#x957F;&amp;#x5EA6;&amp;#x5747;&amp;#x4E3A;&amp;#x5076;&amp;#x6570;&amp;#xFF0C;&amp;#x4E14;&amp;#x6CBF;&amp;#x7740;&amp;#x4E8C;&amp;#x5206;&amp;#x56FE;&amp;#x4E2D;&amp;#x7684;&amp;#x5339;&amp;#x914D;&amp;#x8FB9; - &amp;#x975E;&amp;#x5339;&amp;#x914D;&amp;#x8FB9; - &amp;#x5339;&amp;#x914D;&amp;#x8FB9; - &amp;#x975E;&amp;#x5339;&amp;#x914D;&amp;#x8FB9; &amp;#x2026;&amp;#x2026; &amp;#x5F97;&amp;#x8BC1;&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x4EE3;&amp;#x7801;&quot;&gt;&amp;#x4EE3;&amp;#x7801;&lt;/h3&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;93&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;94&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;95&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;96&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;97&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;98&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;99&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;100&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;101&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;102&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;103&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;104&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;105&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;106&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;107&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;108&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;109&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;110&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;111&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;112&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;113&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;114&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;115&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;116&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;117&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;118&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;119&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;120&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;121&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;122&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;123&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;124&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;125&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;126&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;127&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;128&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;129&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;130&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;131&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;132&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;133&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;134&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;135&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;136&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;137&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;138&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;139&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;140&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;141&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;142&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;143&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;144&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;145&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;146&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;147&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;148&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;149&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;150&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;151&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;152&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;153&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;154&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;155&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;156&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;157&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;158&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;159&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;160&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;161&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;162&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;163&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;164&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;165&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;166&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;167&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;168&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;169&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;170&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;171&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;172&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;173&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;174&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;175&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;176&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;177&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;climits&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;queue&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;algorithm&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXN = &lt;span class=&quot;number&quot;&gt;100&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; DX[&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;] = { &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, -&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; };&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; DY[&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;] = { &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, -&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; };&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Node;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Edge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Node {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Edge *e, *c;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; l;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; fs, ft;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} N[MAXN * MAXN + &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Edge {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Node *s, *t;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; f, c;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Edge *next, *r;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Edge(Node *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; s, Node *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; t, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; c) : s(s), t(t), f(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;), c(c), next(s-&amp;gt;e) {}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;};&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;addEdge&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; s, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; t, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; c)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    N[s].e = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Edge(&amp;amp;N[s], &amp;amp;N[t], c);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    N[t].e = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Edge(&amp;amp;N[t], &amp;amp;N[s], &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    (N[s].e-&amp;gt;r = N[t].e)-&amp;gt;r = N[s].e;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Dinic {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;makeLevelGraph&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Node *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; s, Node *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; t, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) N[i].l = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, N[i].c = N[i].e;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;queue&lt;/span&gt;&amp;lt;Node *&amp;gt; q;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        q.push(s);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        s-&amp;gt;l = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (!q.empty()) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Node *v = q.front();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            q.pop();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (Edge *e = v-&amp;gt;e; e; e = e-&amp;gt;next) &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (e-&amp;gt;t-&amp;gt;l == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &amp;amp;&amp;amp; e-&amp;gt;f &amp;lt; e-&amp;gt;c) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                e-&amp;gt;t-&amp;gt;l = v-&amp;gt;l + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (e-&amp;gt;t == t) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; q.push(e-&amp;gt;t);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;findPath&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Node *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; s, Node *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; t, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; limit = INT_MAX)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (s == t) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; limit;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (Edge *&amp;amp;e = s-&amp;gt;c; e; e = e-&amp;gt;next) &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (e-&amp;gt;t-&amp;gt;l == s-&amp;gt;l + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &amp;amp;&amp;amp; e-&amp;gt;f &amp;lt; e-&amp;gt;c) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; f = findPath(e-&amp;gt;t, t, &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::min(limit, e-&amp;gt;c - e-&amp;gt;f));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (f &amp;gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                e-&amp;gt;f += f, e-&amp;gt;r-&amp;gt;f -= f;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; f;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;operator&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; s, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; t, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; ans = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (makeLevelGraph(&amp;amp;N[s], &amp;amp;N[t], n)) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; f;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; ((f = findPath(&amp;amp;N[s], &amp;amp;N[t])) &amp;gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) ans += f;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; ans;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} dinic;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, m;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt; invalid[MAXN][MAXN];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Point {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i, j;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Point(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; j) : i(i), j(j) {}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;operator&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;/span&gt;{ &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; i * m + j + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;valid&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;/span&gt;{ &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; i &amp;gt;= &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &amp;amp;&amp;amp; i &amp;lt; n &amp;amp;&amp;amp; j &amp;gt;= &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &amp;amp;&amp;amp; j &amp;lt; m &amp;amp;&amp;amp; !invalid[i][j]; }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;Point &lt;span class=&quot;title&quot;&gt;offset&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; dx, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; dy)&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;/span&gt;{ &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; Point(i + dx, j + dy); }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;};&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;bfs&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; s, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; t)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;queue&lt;/span&gt;&amp;lt;Node *&amp;gt; q;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    q.push(&amp;amp;N[s]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    N[s].fs = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (!q.empty()) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Node *v = q.front();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        q.pop();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (Edge *e = v-&amp;gt;e; e; e = e-&amp;gt;next) &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (e-&amp;gt;f &amp;lt; e-&amp;gt;c &amp;amp;&amp;amp; !e-&amp;gt;t-&amp;gt;fs) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            e-&amp;gt;t-&amp;gt;fs = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            q.push(e-&amp;gt;t);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    q.push(&amp;amp;N[t]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    N[t].ft = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (!q.empty()) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Node *v = q.front();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        q.pop();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (Edge *e = v-&amp;gt;e; e; e = e-&amp;gt;next) &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (e-&amp;gt;r-&amp;gt;f &amp;lt; e-&amp;gt;r-&amp;gt;c &amp;amp;&amp;amp; !e-&amp;gt;t-&amp;gt;ft) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;// printf(&amp;quot;%ld to %ld\n&amp;quot;, v - N + 1, e-&amp;gt;t - N + 1);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            e-&amp;gt;t-&amp;gt;ft = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            q.push(e-&amp;gt;t);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d&amp;quot;&lt;/span&gt;, &amp;amp;n, &amp;amp;m);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt; s[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%s&amp;quot;&lt;/span&gt;, s);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; j = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; j &amp;lt; m; j++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            invalid[i][j] = (s[j] == &lt;span class=&quot;string&quot;&gt;&amp;apos;#&amp;apos;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; s = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, t = n * m + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; j = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; j &amp;lt; m; j++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;function&quot;&gt;Point &lt;span class=&quot;title&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(i, j)&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!p.valid()) &lt;span class=&quot;keyword&quot;&gt;continue&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ((i + j) % &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; k = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; k &amp;lt; &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;; k++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    Point p2 = p.offset(DX[k], DY[k]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (p2.valid()) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        addEdge(p, p2, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!invalid[i][j]) addEdge(s, p, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            } &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!invalid[i][j]) addEdge(p, t, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; maxFlow = dinic(s, t, n * m + &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (maxFlow == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) &lt;span class=&quot;built_in&quot;&gt;puts&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;LOSE&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;puts&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;WIN&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        bfs(s, t);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; j = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; j &amp;lt; m; j++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ((i + j) % &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (N[Point(i, j)].fs) &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d\n&amp;quot;&lt;/span&gt;, i + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, j + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            } &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (N[Point(i, j)].ft) &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d\n&amp;quot;&lt;/span&gt;, i + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, j + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// printf(&amp;quot;%d\n&amp;quot;, maxFlow);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;/*&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    for (int i = 0; i &amp;lt; n * m + 2; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        for (Edge *e = N[i].e; e; e = e-&amp;gt;next) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            if (e-&amp;gt;c &amp;gt; 0) printf(&amp;quot;E(%ld, %ld, %d, [%d])\n&amp;quot;, e-&amp;gt;s - N, e-&amp;gt;t - N, e-&amp;gt;c, e-&amp;gt;f);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x5728; $ N \times M $ &amp;#x7684;&amp;#x8FF7;&amp;#x5BAB;&amp;#x4E2D;&amp;#x6709;&amp;#x4E00;&amp;#x4E2A;&amp;#x68CB;&amp;#x5B50;&amp;#xFF0C;AA &amp;#x9996;&amp;#x5148;&amp;#x4EFB;&amp;#x610F;&amp;#x9009;&amp;#x62E9;&amp;#x68CB;&amp;#x5B50;&amp;#x653E;&amp;#x7F6E;&amp;#x7684;&amp;#x4F4D;&amp;#x7F6E;&amp;#x3002;&amp;#x7136;&amp;#x540E;&amp;#xFF0C;YY &amp;#x548C; AA &amp;#x8F6E;&amp;#x6D41;&amp;#x5C06;&amp;#x68CB;&amp;#x5B50;&amp;#x79FB;&amp;#x52A8;&amp;#x5230;&amp;#x76F8;&amp;#x90BB;&amp;#x7684;&amp;#x683C;&amp;#x5B50;&amp;#x91CC;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x6E38;&amp;#x620F;&amp;#x7684;&amp;#x89C4;&amp;#x5219;&amp;#x89C4;&amp;#x5B9A;&amp;#xFF0C;&amp;#x5728;&amp;#x4E00;&amp;#x6B21;&amp;#x6E38;&amp;#x620F;&amp;#x4E2D;&amp;#xFF0C;&amp;#x540C;&amp;#x4E00;&amp;#x4E2A;&amp;#x683C;&amp;#x5B50;&amp;#x4E0D;&amp;#x80FD;&amp;#x8FDB;&amp;#x5165;&amp;#x4E24;&amp;#x6B21;&amp;#xFF0C;&amp;#x4E14;&amp;#x4E0D;&amp;#x80FD;&amp;#x5C06;&amp;#x68CB;&amp;#x5B50;&amp;#x79FB;&amp;#x52A8;&amp;#x5230;&amp;#x67D0;&amp;#x4E9B;&amp;#x683C;&amp;#x5B50;&amp;#x4E2D;&amp;#x53BB;&amp;#x3002;&amp;#x5F53;&amp;#x73A9;&amp;#x5BB6;&amp;#x65E0;&amp;#x6CD5;&amp;#x7EE7;&amp;#x7EED;&amp;#x79FB;&amp;#x52A8;&amp;#x68CB;&amp;#x5B50;&amp;#x65F6;&amp;#xFF0C;&amp;#x6E38;&amp;#x620F;&amp;#x7ED3;&amp;#x675F;&amp;#xFF0C;&amp;#x6700;&amp;#x540E;&amp;#x4E00;&amp;#x4E2A;&amp;#x79FB;&amp;#x52A8;&amp;#x68CB;&amp;#x5B50;&amp;#x7684;&amp;#x73A9;&amp;#x5BB6;&amp;#x8D62;&amp;#x5F97;&amp;#x4E86;&amp;#x6E38;&amp;#x620F;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x6C42; AA &amp;#x521D;&amp;#x59CB;&amp;#x5C06;&amp;#x68CB;&amp;#x5B50;&amp;#x653E;&amp;#x5728;&amp;#x54EA;&amp;#x4E9B;&amp;#x683C;&amp;#x5B50;&amp;#x4F1A;&amp;#x6709;&amp;#x5FC5;&amp;#x80DC;&amp;#x7B56;&amp;#x7565;&amp;#x3002;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="BZOJ" scheme="https://blog.menci.moe/tag/bzoj/"/>
    
      <category term="Dinic" scheme="https://blog.menci.moe/tag/dinic/"/>
    
      <category term="JSOI" scheme="https://blog.menci.moe/tag/jsoi/"/>
    
      <category term="二分图匹配" scheme="https://blog.menci.moe/tag/%E4%BA%8C%E5%88%86%E5%9B%BE%E5%8C%B9%E9%85%8D/"/>
    
      <category term="博弈" scheme="https://blog.menci.moe/tag/%E5%8D%9A%E5%BC%88/"/>
    
      <category term="网络流" scheme="https://blog.menci.moe/tag/%E7%BD%91%E7%BB%9C%E6%B5%81/"/>
    
  </entry>
  
  <entry>
    <title>「HNOI2008」玩具装箱 - 斜率优化DP</title>
    <link href="https://blog.menci.moe/hnoi2008-toy/"/>
    <id>https://blog.menci.moe/hnoi2008-toy/</id>
    <published>2016-04-24T03:23:41.000Z</published>
    <updated>2016-05-11T09:33:24.440Z</updated>
    
    <content type="html">&lt;p&gt;P &amp;#x6559;&amp;#x6388;&amp;#x6709;&amp;#x7F16;&amp;#x53F7;&amp;#x4E3A; $ 1 $ ~ $ N $ &amp;#x7684; $ N $ &amp;#x4EF6;&amp;#x73A9;&amp;#x5177;&amp;#xFF0C;&amp;#x7B2C; $ i $ &amp;#x4EF6;&amp;#x73A9;&amp;#x5177;&amp;#x7ECF;&amp;#x8FC7;&amp;#x538B;&amp;#x7F29;&amp;#x540E;&amp;#x53D8;&amp;#x6210;&amp;#x4E00;&amp;#x7EF4;&amp;#x957F;&amp;#x5EA6;&amp;#x4E3A; $ C_i $&amp;#x3002;&amp;#x4E3A;&amp;#x4E86;&amp;#x65B9;&amp;#x4FBF;&amp;#x6574;&amp;#x7406;&amp;#xFF0C;P &amp;#x6559;&amp;#x6388;&amp;#x8981;&amp;#x6C42;&amp;#x5728;&amp;#x4E00;&amp;#x4E2A;&amp;#x4E00;&amp;#x7EF4;&amp;#x5BB9;&amp;#x5668;&amp;#x4E2D;&amp;#x7684;&amp;#x73A9;&amp;#x5177;&amp;#x7F16;&amp;#x53F7;&amp;#x662F;&amp;#x8FDE;&amp;#x7EED;&amp;#x7684;&amp;#x3002;&amp;#x5982;&amp;#x679C;&amp;#x5C06;&amp;#x7B2C; $ i $ &amp;#x4EF6;&amp;#x73A9;&amp;#x5177;&amp;#x5230;&amp;#x7B2C; $ j $ &amp;#x4E2A;&amp;#x73A9;&amp;#x5177;&amp;#x653E;&amp;#x5230;&amp;#x4E00;&amp;#x4E2A;&amp;#x5BB9;&amp;#x5668;&amp;#x4E2D;&amp;#xFF0C;&amp;#x90A3;&amp;#x4E48;&amp;#x5BB9;&amp;#x5668;&amp;#x7684;&amp;#x957F;&amp;#x5EA6;&amp;#x5C06;&amp;#x4E3A; $ x = j - i + \sum\limits_{k = i} ^ j C_k $&amp;#x3002;&amp;#x5982;&amp;#x679C;&amp;#x5BB9;&amp;#x5668;&amp;#x957F;&amp;#x5EA6;&amp;#x4E3A; $ x $&amp;#x3002;&amp;#x5176;&amp;#x5236;&amp;#x4F5C;&amp;#x8D39;&amp;#x7528;&amp;#x4E3A; $ (x - L) ^ 2 $&amp;#x3002;&amp;#x5176;&amp;#x4E2D; $ L $ &amp;#x662F;&amp;#x4E00;&amp;#x4E2A;&amp;#x5E38;&amp;#x91CF;&amp;#x3002;P &amp;#x6559;&amp;#x6388;&amp;#x4E0D;&amp;#x5173;&amp;#x5FC3;&amp;#x5BB9;&amp;#x5668;&amp;#x7684;&amp;#x6570;&amp;#x76EE;&amp;#xFF0C;&amp;#x4ED6;&amp;#x53EF;&amp;#x4EE5;&amp;#x5236;&amp;#x4F5C;&amp;#x51FA;&amp;#x4EFB;&amp;#x610F;&amp;#x957F;&amp;#x5EA6;&amp;#x7684;&amp;#x5BB9; &amp;#x5668;&amp;#xFF0C;&amp;#x751A;&amp;#x81F3;&amp;#x8D85;&amp;#x8FC7; $ L $&amp;#x3002;&amp;#x4F46;&amp;#x4ED6;&amp;#x5E0C;&amp;#x671B;&amp;#x8D39;&amp;#x7528;&amp;#x6700;&amp;#x5C0F;&amp;#x3002;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;&amp;#x94FE;&amp;#x63A5;&quot;&gt;&amp;#x94FE;&amp;#x63A5;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://www.lydsy.com/JudgeOnline/problem.php?id=1010&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;BZOJ 1010&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://codevs.cn/problem/1319/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;CodeVS 1319&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://cogs.top/cogs/problem/problem.php?pid=1330&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;COGS 1330&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x9898;&amp;#x89E3;&quot;&gt;&amp;#x9898;&amp;#x89E3;&lt;/h3&gt;
&lt;p&gt;&amp;#x52A8;&amp;#x6001;&amp;#x89C4;&amp;#x5212;&amp;#xFF0C;&amp;#x8BBE; $ f[i] $ &amp;#x8868;&amp;#x793A;&amp;#x524D; i &amp;#x4EF6;&amp;#x73A9;&amp;#x5177;&amp;#x653E;&amp;#x8FDB;&amp;#x82E5;&amp;#x5E72;&amp;#x4E2A;&amp;#x5BB9;&amp;#x5668;&amp;#x4E2D;&amp;#x7684;&amp;#x6700;&amp;#x5C0F;&amp;#x8D39;&amp;#x7528;&amp;#xFF0C;&amp;#x524D;&amp;#x7F00;&amp;#x548C; $ s(n) = \sum\limits_{i = 1} ^ {n} C[i] $&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x8F6C;&amp;#x79FB;&amp;#x65F6;&amp;#x679A;&amp;#x4E3E;&amp;#x524D;&amp;#x9762;&amp;#x591A;&amp;#x5C11;&amp;#x4E2A;&amp;#x88C5;&amp;#x5728;&amp;#x540C;&amp;#x4E00;&amp;#x4E2A;&amp;#x7BB1;&amp;#x5B50;&amp;#x91CC;&amp;#xFF0C;&amp;#x8BBE;&amp;#x5B83;&amp;#x4E3A; $ j $&amp;#xFF0C;&amp;#x5219;&amp;#x7B2C; $ j + 1 $ ~ $ i $ &amp;#x4E2A;&amp;#x88C5;&amp;#x5728;&amp;#x540C;&amp;#x4E00;&amp;#x4E2A;&amp;#x7BB1;&amp;#x5B50;&amp;#x91CC;&amp;#xFF0C;&amp;#x957F;&amp;#x5EA6;&amp;#x4E3A; $ i - j - 1 + s(i) - s(j) $&amp;#xFF0C;&amp;#x5373;&lt;/p&gt;
&lt;p&gt;$$ f[i] = \min\limits_{j = 0} ^ {i - 1} \big \{ f[j] + (i - j - 1 + s(i) - s(j) - L) ^ 2 \big \} $$&lt;/p&gt;
&lt;p&gt;&amp;#x76F4;&amp;#x63A5;&amp;#x8BA1;&amp;#x7B97;&amp;#x7684;&amp;#x590D;&amp;#x6742;&amp;#x5EA6;&amp;#x4E3A; $ O(n ^ 2) $&amp;#xFF0C;&amp;#x8D85;&amp;#x65F6;&amp;#xFF0C;&amp;#x8003;&amp;#x8651;&amp;#x4F18;&amp;#x5316;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x8BBE; $ g(i) = s(i) + i - L - 1 $&amp;#xFF0C;$ h(j) = s(j) + j $&amp;#xFF0C;&amp;#x4E0A;&amp;#x9762;&amp;#x7684;&amp;#x65B9;&amp;#x7A0B;&amp;#x53EF;&amp;#x4EE5;&amp;#x8F6C;&amp;#x5316;&amp;#x4E3A;&lt;/p&gt;
&lt;p&gt;$$ f[i] = \min\limits_{j = 0} ^ {i - 1} \big \{ f[j] + \big [ g(i) - h(j) \big ] ^ 2 \big \} $$&lt;/p&gt;
&lt;p&gt;&amp;#x8003;&amp;#x8651;&amp;#x4E24;&amp;#x4E2A;&amp;#x51B3;&amp;#x7B56; $ j = a $ &amp;#x548C; $ j = b $&amp;#xFF08;$ a &amp;gt; b $&amp;#xFF09;&amp;#xFF0C;&amp;#x82E5; a &amp;#x6BD4; b &amp;#x4F18;&amp;#xFF0C;&amp;#x5F53;&amp;#x4E14;&amp;#x4EC5;&amp;#x5F53;&lt;/p&gt;
&lt;p&gt;$$ \begin{align*} f[a] + \big [ g(i) - h(a) \big ] ^ 2 &amp;amp; &amp;lt; f[b] + \big [ g(i) - h(b) \big ] ^ 2 \\ f[a] + g(i) ^ 2 + h(a) ^ 2 - 2g(i)h(a) &amp;amp; &amp;lt; f[b] + g(i) ^ 2 + h(b) ^ 2 - 2g(i)h(b) \\ f[a] + h(a) ^ 2 - 2g(i)h(a) &amp;amp; &amp;lt; f[b] + h(b) ^ 2 - 2g(i)h(b) \\ (f[a] + h(a) ^ 2) - (f[b] + h(b) ^ 2) &amp;amp; &amp;lt; 2g(i)h(a) - 2g(i)h(b) \\ (f[a] + h(a) ^ 2) - (f[b] + h(b) ^ 2) &amp;amp; &amp;lt; 2g(i) \big [h(a) - h(b) \big ] \\ \frac{(f[a] + h(a) ^ 2) - (f[b] + h(b) ^ 2)}{h(a) - h(b)} &amp;amp; &amp;lt; 2g(i) \\ \end{align*} $$&lt;/p&gt;
&lt;p&gt;&amp;#x5DE6;&amp;#x8FB9;&amp;#x6210;&amp;#x4E3A;&amp;#x4E86;&amp;#x659C;&amp;#x7387;&amp;#x7684;&amp;#x5F62;&amp;#x5F0F;&amp;#xFF0C;&amp;#x4E09;&amp;#x4E2A;&amp;#x5F0F;&amp;#x5B50;&amp;#x90FD;&amp;#x662F;&amp;#x5355;&amp;#x8C03;&amp;#x7684;&amp;#xFF0C;&amp;#x56E0;&amp;#x6B64;&amp;#x53EF;&amp;#x4EE5;&amp;#x7528;&amp;#x4E00;&amp;#x4E2A;&amp;#x5355;&amp;#x8C03;&amp;#x961F;&amp;#x5217;&amp;#x7EF4;&amp;#x62A4;&amp;#x6BCF;&amp;#x4E2A;&amp;#x51B3;&amp;#x7B56;&amp;#xFF0C;&amp;#x4FDD;&amp;#x8BC1;&amp;#x6700;&amp;#x4F18;&amp;#x51B3;&amp;#x7B56;&amp;#x5728;&amp;#x961F;&amp;#x9996;&amp;#xFF0C;&amp;#x4E24;&amp;#x4E24;&amp;#x51B3;&amp;#x7B56;&amp;#x70B9;&amp;#x5F62;&amp;#x6210;&amp;#x7684;&amp;#x659C;&amp;#x7387;&amp;#x9012;&amp;#x589E;&amp;#xFF0C;&amp;#x6BCF;&amp;#x6B21;&amp;#x72B6;&amp;#x6001;&amp;#x8F6C;&amp;#x79FB;&amp;#x590D;&amp;#x6742;&amp;#x5EA6;&amp;#x964D;&amp;#x4E3A; $ O(1) $&amp;#xFF0C;&amp;#x603B;&amp;#x65F6;&amp;#x95F4;&amp;#x590D;&amp;#x6742;&amp;#x5EA6;&amp;#x4E3A; $ O(n) $&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x4EE3;&amp;#x7801;&quot;&gt;&amp;#x4EE3;&amp;#x7801;&lt;/h3&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXN = &lt;span class=&quot;number&quot;&gt;50000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, L, a[MAXN];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; s[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;], f[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;template&lt;/span&gt; &amp;lt;&lt;span class=&quot;keyword&quot;&gt;typename&lt;/span&gt; T&amp;gt; &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; T &lt;span class=&quot;title&quot;&gt;sqr&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; T &amp;amp;x)&lt;/span&gt; &lt;/span&gt;{ &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; x * x; }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i)&lt;/span&gt; &lt;/span&gt;{ &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; s[i] + i - L - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;h&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; j)&lt;/span&gt; &lt;/span&gt;{ &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; s[j] + j; }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;slope&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; a, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; b)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt;((f[a] + sqr(h(a))) - (f[b] + sqr(h(b)))) / &lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt;(h(a) - h(b));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d&amp;quot;&lt;/span&gt;, &amp;amp;n, &amp;amp;L);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;a[i]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= n; i++) s[i] = s[i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;] + a[i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; q[MAXN];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; *l = q, *r = q - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    *++r = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (l &amp;lt; &lt;span class=&quot;function&quot;&gt;r &amp;amp;&amp;amp; &lt;span class=&quot;title&quot;&gt;slope&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(*(l + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&lt;/span&gt;, *l) &amp;lt;&lt;/span&gt;= &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; * g(i)) l++;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        f[i] = f[*l] + sqr(g(i) - h(*l));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (l &amp;lt; &lt;span class=&quot;function&quot;&gt;r &amp;amp;&amp;amp; &lt;span class=&quot;title&quot;&gt;slope&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(*r, *(r - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&lt;/span&gt;) &amp;gt; &lt;span class=&quot;title&quot;&gt;slope&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(i, *r)&lt;/span&gt;) r--&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        *++r = i;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%lld\n&amp;quot;&lt;/span&gt;, f[n]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;P &amp;#x6559;&amp;#x6388;&amp;#x6709;&amp;#x7F16;&amp;#x53F7;&amp;#x4E3A; $ 1 $ ~ $ N $ &amp;#x7684; $ N $ &amp;#x4EF6;&amp;#x73A9;&amp;#x5177;&amp;#xFF0C;&amp;#x7B2C; $ i $ &amp;#x4EF6;&amp;#x73A9;&amp;#x5177;&amp;#x7ECF;&amp;#x8FC7;&amp;#x538B;&amp;#x7F29;&amp;#x540E;&amp;#x53D8;&amp;#x6210;&amp;#x4E00;&amp;#x7EF4;&amp;#x957F;&amp;#x5EA6;&amp;#x4E3A; $ C_i $&amp;#x3002;&amp;#x4E3A;&amp;#x4E86;&amp;#x65B9;&amp;#x4FBF;&amp;#x6574;&amp;#x7406;&amp;#xFF0C;P &amp;#x6559;&amp;#x6388;&amp;#x8981;&amp;#x6C42;&amp;#x5728;&amp;#x4E00;&amp;#x4E2A;&amp;#x4E00;&amp;#x7EF4;&amp;#x5BB9;&amp;#x5668;&amp;#x4E2D;&amp;#x7684;&amp;#x73A9;&amp;#x5177;&amp;#x7F16;&amp;#x53F7;&amp;#x662F;&amp;#x8FDE;&amp;#x7EED;&amp;#x7684;&amp;#x3002;&amp;#x5982;&amp;#x679C;&amp;#x5C06;&amp;#x7B2C; $ i $ &amp;#x4EF6;&amp;#x73A9;&amp;#x5177;&amp;#x5230;&amp;#x7B2C; $ j $ &amp;#x4E2A;&amp;#x73A9;&amp;#x5177;&amp;#x653E;&amp;#x5230;&amp;#x4E00;&amp;#x4E2A;&amp;#x5BB9;&amp;#x5668;&amp;#x4E2D;&amp;#xFF0C;&amp;#x90A3;&amp;#x4E48;&amp;#x5BB9;&amp;#x5668;&amp;#x7684;&amp;#x957F;&amp;#x5EA6;&amp;#x5C06;&amp;#x4E3A; $ x = j - i + \sum\limits_{k = i} ^ j C_k $&amp;#x3002;&amp;#x5982;&amp;#x679C;&amp;#x5BB9;&amp;#x5668;&amp;#x957F;&amp;#x5EA6;&amp;#x4E3A; $ x $&amp;#x3002;&amp;#x5176;&amp;#x5236;&amp;#x4F5C;&amp;#x8D39;&amp;#x7528;&amp;#x4E3A; $ (x - L) ^ 2 $&amp;#x3002;&amp;#x5176;&amp;#x4E2D; $ L $ &amp;#x662F;&amp;#x4E00;&amp;#x4E2A;&amp;#x5E38;&amp;#x91CF;&amp;#x3002;P &amp;#x6559;&amp;#x6388;&amp;#x4E0D;&amp;#x5173;&amp;#x5FC3;&amp;#x5BB9;&amp;#x5668;&amp;#x7684;&amp;#x6570;&amp;#x76EE;&amp;#xFF0C;&amp;#x4ED6;&amp;#x53EF;&amp;#x4EE5;&amp;#x5236;&amp;#x4F5C;&amp;#x51FA;&amp;#x4EFB;&amp;#x610F;&amp;#x957F;&amp;#x5EA6;&amp;#x7684;&amp;#x5BB9; &amp;#x5668;&amp;#xFF0C;&amp;#x751A;&amp;#x81F3;&amp;#x8D85;&amp;#x8FC7; $ L $&amp;#x3002;&amp;#x4F46;&amp;#x4ED6;&amp;#x5E0C;&amp;#x671B;&amp;#x8D39;&amp;#x7528;&amp;#x6700;&amp;#x5C0F;&amp;#x3002;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="BZOJ" scheme="https://blog.menci.moe/tag/bzoj/"/>
    
      <category term="COGS" scheme="https://blog.menci.moe/tag/cogs/"/>
    
      <category term="CodeVS" scheme="https://blog.menci.moe/tag/codevs/"/>
    
      <category term="DP" scheme="https://blog.menci.moe/tag/dp/"/>
    
      <category term="HNOI" scheme="https://blog.menci.moe/tag/hnoi/"/>
    
      <category term="单调队列" scheme="https://blog.menci.moe/tag/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97/"/>
    
      <category term="斜率优化" scheme="https://blog.menci.moe/tag/%E6%96%9C%E7%8E%87%E4%BC%98%E5%8C%96/"/>
    
  </entry>
  
</feed>
