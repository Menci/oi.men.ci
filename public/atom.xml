<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Menci</title>
  <subtitle>眉眼如初，岁月如故</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://blog.menci.moe/"/>
  <updated>2016-06-04T01:42:43.000Z</updated>
  <id>https://blog.menci.moe/</id>
  
  <author>
    <name>Menci</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>FFT 学习笔记</title>
    <link href="https://blog.menci.moe/fft-notes/"/>
    <id>https://blog.menci.moe/fft-notes/</id>
    <published>2016-06-03T11:41:00.000Z</published>
    <updated>2016-06-04T01:42:43.000Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x5FEB;&amp;#x901F;&amp;#x5085;&amp;#x91CC;&amp;#x53F6;&amp;#x53D8;&amp;#x6362;&amp;#xFF08;Fast Fourier Transform&amp;#xFF0C;FFT&amp;#xFF09;&amp;#x662F;&amp;#x4E00;&amp;#x79CD;&amp;#x53EF;&amp;#x5728; $ O(n \log n) $ &amp;#x65F6;&amp;#x95F4;&amp;#x5185;&amp;#x5B8C;&amp;#x6210;&amp;#x7684;&amp;#x79BB;&amp;#x6563;&amp;#x5085;&amp;#x91CC;&amp;#x53F6;&amp;#x53D8;&amp;#x6362;&amp;#xFF08;Discrete Fourier transform&amp;#xFF0C;DFT&amp;#xFF09;&amp;#x7B97;&amp;#x6CD5;&amp;#xFF0C;&amp;#x5728; OI &amp;#x4E2D;&amp;#x7684;&amp;#x4E3B;&amp;#x8981;&amp;#x5E94;&amp;#x7528;&amp;#x4E4B;&amp;#x4E00;&amp;#x662F;&amp;#x52A0;&amp;#x901F;&amp;#x591A;&amp;#x9879;&amp;#x5F0F;&amp;#x4E58;&amp;#x6CD5;&amp;#x7684;&amp;#x8BA1;&amp;#x7B97;&amp;#x3002;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;&amp;#x5B9A;&amp;#x4E49;&quot;&gt;&amp;#x5B9A;&amp;#x4E49;&lt;/h3&gt;
&lt;h4 id=&quot;&amp;#x591A;&amp;#x9879;&amp;#x5F0F;&quot;&gt;&amp;#x591A;&amp;#x9879;&amp;#x5F0F;&lt;/h4&gt;
&lt;h5 id=&quot;&amp;#x7CFB;&amp;#x6570;&amp;#x8868;&amp;#x793A;&amp;#x4E0E;&amp;#x70B9;&amp;#x503C;&amp;#x8868;&amp;#x793A;&quot;&gt;&amp;#x7CFB;&amp;#x6570;&amp;#x8868;&amp;#x793A;&amp;#x4E0E;&amp;#x70B9;&amp;#x503C;&amp;#x8868;&amp;#x793A;&lt;/h5&gt;
&lt;p&gt;&amp;#x591A;&amp;#x9879;&amp;#x5F0F;&amp;#x7684;&amp;#x7CFB;&amp;#x6570;&amp;#x8868;&amp;#x793A;&amp;#xFF0C;&amp;#x8BBE; $ A(x) $ &amp;#x8868;&amp;#x793A;&amp;#x4E00;&amp;#x4E2A; $ n - 1 $ &amp;#x6B21;&amp;#x591A;&amp;#x9879;&amp;#x5F0F;&amp;#xFF0C;&amp;#x6240;&amp;#x6709;&amp;#x9879;&amp;#x7684;&amp;#x7CFB;&amp;#x6570;&amp;#x7EC4;&amp;#x6210;&amp;#x7684; $ n $ &amp;#x7EF4;&amp;#x5411;&amp;#x91CF; $ ( a_0,\ a_1,\ a_2,\ \dots,\ a_{n - 1} ) $ &amp;#x552F;&amp;#x4E00;&amp;#x786E;&amp;#x5B9A;&amp;#x4E86;&amp;#x8FD9;&amp;#x4E2A;&amp;#x591A;&amp;#x9879;&amp;#x5F0F;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;$$ \begin{align*} A(x) &amp;amp;= \sum\limits_{i = 0} ^ {n - 1} a_i x ^ i \\ &amp;amp;= a_0 + a_1 x + a_2 x ^ 2 + \dots + a_{n - 1} x ^ {n - 1} \end{align*} $$&lt;/p&gt;
&lt;p&gt;&amp;#x591A;&amp;#x9879;&amp;#x5F0F;&amp;#x7684;&amp;#x70B9;&amp;#x503C;&amp;#x8868;&amp;#x793A;&amp;#xFF0C;&amp;#x5C06;&amp;#x4E00;&amp;#x7EC4;&lt;strong&gt;&amp;#x4E92;&amp;#x4E0D;&amp;#x76F8;&amp;#x540C;&lt;/strong&gt;&amp;#x7684; $ n $ &amp;#x4E2A; $ x $ &amp;#x5E26;&amp;#x5165;&amp;#x591A;&amp;#x9879;&amp;#x5F0F;&amp;#xFF0C;&amp;#x5F97;&amp;#x5230;&amp;#x7684; $ n $ &amp;#x4E2A;&amp;#x503C;&amp;#x3002;&amp;#x8BBE;&amp;#x5B83;&amp;#x4EEC;&amp;#x7EC4;&amp;#x6210;&amp;#x7684; $ n $ &amp;#x7EF4;&amp;#x5411;&amp;#x91CF;&amp;#x5206;&amp;#x522B;&amp;#x4E3A; $ ( x_0,\ x_1,\ x_2,\ \dots,\ x_{n - 1} ) $&amp;#x3001;$ ( y_0,\ y_1,\ y_2,\ \dots,\ y_{n - 1} ) $&amp;#x3002;&lt;/p&gt;
&lt;p&gt;$$ \begin{align*} y_i &amp;amp;= A(x_i) \\ &amp;amp;= \sum\limits_{j = 0} ^ {n - 1} a_j x_i \end{align*} $$&lt;/p&gt;
&lt;h5 id=&quot;&amp;#x6C42;&amp;#x503C;&amp;#x4E0E;&amp;#x63D2;&amp;#x503C;&quot;&gt;&amp;#x6C42;&amp;#x503C;&amp;#x4E0E;&amp;#x63D2;&amp;#x503C;&lt;/h5&gt;
&lt;blockquote&gt;
&lt;p&gt;&amp;#x5B9A;&amp;#x7406;&amp;#xFF1A;&amp;#x4E00;&amp;#x4E2A; $ n - 1 $ &amp;#x6B21;&amp;#x591A;&amp;#x9879;&amp;#x5F0F;&amp;#x5728; $ n $ &amp;#x4E2A;&amp;#x4E0D;&amp;#x540C;&amp;#x70B9;&amp;#x7684;&amp;#x53D6;&amp;#x503C;&amp;#x552F;&amp;#x4E00;&amp;#x786E;&amp;#x5B9A;&amp;#x4E86;&amp;#x8BE5;&amp;#x591A;&amp;#x9879;&amp;#x5F0F;&amp;#x3002;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&amp;#x8BC1;&amp;#x660E;&amp;#xFF1A;&amp;#x5047;&amp;#x8BBE;&amp;#x547D;&amp;#x9898;&amp;#x4E0D;&amp;#x6210;&amp;#x7ACB;&amp;#xFF0C;&amp;#x5B58;&amp;#x5728;&amp;#x4E24;&amp;#x4E2A;&amp;#x4E0D;&amp;#x540C;&amp;#x7684; $ n - 1 $ &amp;#x6B21;&amp;#x591A;&amp;#x9879;&amp;#x5F0F; $ A(x) $&amp;#x3001;$ B(x) $&amp;#xFF0C;&amp;#x6EE1;&amp;#x8DB3;&amp;#x5BF9;&amp;#x4E8E;&amp;#x4EFB;&amp;#x4F55; $ i \in [0,\ n - 1] $&amp;#xFF0C;&amp;#x6709; $ A(x_i) = B(x_i) $&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x4EE4; $ C(x) = A(x) - B(x) $&amp;#xFF0C;&amp;#x5219; $ C(x) $ &amp;#x4E5F;&amp;#x662F;&amp;#x4E00;&amp;#x4E2A; $ n - 1 $ &amp;#x6B21;&amp;#x591A;&amp;#x9879;&amp;#x5F0F;&amp;#x3002;&amp;#x5BF9;&amp;#x4E8E;&amp;#x4EFB;&amp;#x4F55; $ i \in [0,\ n - 1] $&amp;#xFF0C;&amp;#x6709; $ C(x_i) = 0 $&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x5373; $ C(x) $ &amp;#x6709; $ n $ &amp;#x4E2A;&amp;#x6839;&amp;#xFF0C;&amp;#x8FD9;&amp;#x4E0E;&amp;#x4EE3;&amp;#x6570;&amp;#x57FA;&amp;#x672C;&amp;#x5B9A;&amp;#x7406;&amp;#xFF08;&amp;#x4E00;&amp;#x4E2A; $ n - 1 $ &amp;#x6B21;&amp;#x591A;&amp;#x9879;&amp;#x5F0F;&amp;#x5728;&amp;#x590D;&amp;#x6570;&amp;#x57DF;&amp;#x4E0A;&amp;#x6709;&amp;#x4E14;&amp;#x4EC5;&amp;#x6709; $ n - 1 $ &amp;#x4E2A;&amp;#x6839;&amp;#xFF09;&amp;#x76F8;&amp;#x77DB;&amp;#x76FE;&amp;#xFF0C;&amp;#x6545; $ C(x) $ &amp;#x5E76;&amp;#x4E0D;&amp;#x662F;&amp;#x4E00;&amp;#x4E2A; $ n - 1 $ &amp;#x6B21;&amp;#x591A;&amp;#x9879;&amp;#x5F0F;&amp;#xFF0C;&amp;#x539F;&amp;#x547D;&amp;#x9898;&amp;#x6210;&amp;#x7ACB;&amp;#xFF0C;&amp;#x8BC1;&amp;#x6BD5;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x5982;&amp;#x679C;&amp;#x6211;&amp;#x4EEC;&amp;#x6309;&amp;#x7167;&amp;#x5B9A;&amp;#x4E49;&amp;#x6C42;&amp;#x4E00;&amp;#x4E2A;&amp;#x591A;&amp;#x9879;&amp;#x5F0F;&amp;#x7684;&amp;#x70B9;&amp;#x503C;&amp;#x8868;&amp;#x793A;&amp;#xFF0C;&amp;#x65F6;&amp;#x95F4;&amp;#x590D;&amp;#x6742;&amp;#x5EA6;&amp;#x4E3A; $ O(n ^ 2) $&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x5DF2;&amp;#x77E5;&amp;#x591A;&amp;#x9879;&amp;#x5F0F;&amp;#x7684;&amp;#x70B9;&amp;#x503C;&amp;#x8868;&amp;#x793A;&amp;#xFF0C;&amp;#x6C42;&amp;#x5176;&amp;#x7CFB;&amp;#x6570;&amp;#x8868;&amp;#x793A;&amp;#xFF0C;&amp;#x53EF;&amp;#x4EE5;&amp;#x4F7F;&amp;#x7528;&lt;strong&gt;&amp;#x63D2;&amp;#x503C;&lt;/strong&gt;&amp;#x3002;&amp;#x6734;&amp;#x7D20;&amp;#x7684;&amp;#x63D2;&amp;#x503C;&amp;#x7B97;&amp;#x6CD5;&amp;#x65F6;&amp;#x95F4;&amp;#x590D;&amp;#x6742;&amp;#x5EA6;&amp;#x4E3A; $ O(n ^ 2) $&amp;#x3002;&lt;/p&gt;
&lt;h5 id=&quot;&amp;#x591A;&amp;#x9879;&amp;#x5F0F;&amp;#x4E58;&amp;#x6CD5;&quot;&gt;&amp;#x591A;&amp;#x9879;&amp;#x5F0F;&amp;#x4E58;&amp;#x6CD5;&lt;/h5&gt;
&lt;p&gt;&amp;#x6211;&amp;#x4EEC;&amp;#x5B9A;&amp;#x4E49;&amp;#x4E24;&amp;#x4E2A;&amp;#x591A;&amp;#x9879;&amp;#x5F0F; $ A(x) = \sum\limits_{i = 0} ^ {n - 1} a_i x ^ i $ &amp;#x4E0E; $ B(x) = \sum\limits_{i = 0} ^ {n - 1} b_i x ^ i $ &amp;#x76F8;&amp;#x4E58;&amp;#x7684;&amp;#x7ED3;&amp;#x679C;&amp;#x4E3A; $ C(x) $&amp;#xFF08;&amp;#x5047;&amp;#x8BBE;&amp;#x4E24;&amp;#x4E2A;&amp;#x591A;&amp;#x9879;&amp;#x5F0F;&amp;#x6B21;&amp;#x6570;&amp;#x76F8;&amp;#x540C;&amp;#xFF0C;&amp;#x82E5;&amp;#x4E0D;&amp;#x540C;&amp;#x53EF;&amp;#x5728;&amp;#x540E;&amp;#x9762;&amp;#x8865;&amp;#x96F6;&amp;#xFF09;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;$$ C(x) = A(x) \times B(x) = \sum\limits_{k = 0} ^ {2n - 2} (\sum\limits_{k = i + j} a_i b_j) x_k $$&lt;/p&gt;
&lt;p&gt;&amp;#x4E24;&amp;#x4E2A; $ n - 1 $ &amp;#x6B21;&amp;#x591A;&amp;#x9879;&amp;#x5F0F;&amp;#x76F8;&amp;#x4E58;&amp;#xFF0C;&amp;#x5F97;&amp;#x5230;&amp;#x7684;&amp;#x662F;&amp;#x4E00;&amp;#x4E2A; $ 2n - 2 $ &amp;#x6B21;&amp;#x591A;&amp;#x9879;&amp;#x5F0F;&amp;#xFF0C;&amp;#x65F6;&amp;#x95F4;&amp;#x590D;&amp;#x6742;&amp;#x5EA6;&amp;#x4E3A; $ O(n ^ 2) $&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x5982;&amp;#x679C;&amp;#x4F7F;&amp;#x7528;&amp;#x4E24;&amp;#x4E2A;&amp;#x591A;&amp;#x9879;&amp;#x5F0F;&amp;#x5728; $ 2n - 1 $ &amp;#x4E2A;&amp;#x70B9;&amp;#x5904;&amp;#x53D6;&amp;#x5F97;&amp;#x7684;&amp;#x70B9;&amp;#x503C;&amp;#x8868;&amp;#x793A;&amp;#xFF0C;&amp;#x90A3;&amp;#x4E48;&lt;/p&gt;
&lt;p&gt;$$ {y_3}_i = (\sum\limits_{j = 0} ^ {2n - 1} a_j x_i) \times (\sum\limits_{j = 0} ^ {2n - 1} b_j x_i) = {y_1}_i \times {y_2}_i $$&lt;/p&gt;
&lt;p&gt;&amp;#x65F6;&amp;#x95F4;&amp;#x590D;&amp;#x6742;&amp;#x5EA6;&amp;#x4E3A; $ O(n) $&amp;#x3002;&lt;/p&gt;
&lt;h4 id=&quot;&amp;#x590D;&amp;#x6570;&quot;&gt;&amp;#x590D;&amp;#x6570;&lt;/h4&gt;
&lt;p&gt;&amp;#x8BBE; $ a $&amp;#x3001;$ b $ &amp;#x4E3A;&amp;#x5B9E;&amp;#x6570;&amp;#xFF0C;$ i ^ 2 = -1 $&amp;#xFF0C;&amp;#x5F62;&amp;#x5982; $ a + bi $ &amp;#x7684;&amp;#x6570;&amp;#x53EB;&amp;#x505A;&lt;strong&gt;&amp;#x590D;&amp;#x6570;&lt;/strong&gt;&amp;#xFF0C;&amp;#x5176;&amp;#x4E2D; $ i $ &amp;#x88AB;&amp;#x79F0;&amp;#x4E3A;&lt;strong&gt;&amp;#x865A;&amp;#x6570;&amp;#x5355;&amp;#x4F4D;&lt;/strong&gt;&amp;#x3002;&amp;#x590D;&amp;#x6570;&amp;#x57DF;&amp;#x662F;&amp;#x5DF2;&amp;#x77E5;&amp;#x6700;&amp;#x5927;&amp;#x7684;&amp;#x57DF;&amp;#x3002;&lt;/p&gt;
&lt;h5 id=&quot;&amp;#x590D;&amp;#x5E73;&amp;#x9762;&quot;&gt;&amp;#x590D;&amp;#x5E73;&amp;#x9762;&lt;/h5&gt;
&lt;p&gt;&amp;#x5728;&amp;#x590D;&amp;#x5E73;&amp;#x9762;&amp;#x4E2D;&amp;#xFF0C;$ x $ &amp;#x8F74;&amp;#x4EE3;&amp;#x8868;&amp;#x5B9E;&amp;#x6570;&amp;#x3001;$ y $ &amp;#x8F74;&amp;#xFF08;&amp;#x9664;&amp;#x539F;&amp;#x70B9;&amp;#x5916;&amp;#x7684;&amp;#x6240;&amp;#x6709;&amp;#x70B9;&amp;#xFF09;&amp;#x4EE3;&amp;#x8868;&amp;#x865A;&amp;#x6570;&amp;#x3002;&amp;#x6BCF;&amp;#x4E00;&amp;#x4E2A;&amp;#x590D;&amp;#x6570; $ a + bi $ &amp;#x5BF9;&amp;#x5E94;&amp;#x590D;&amp;#x5E73;&amp;#x9762;&amp;#x4E0A;&amp;#x4E00;&amp;#x4E2A;&amp;#x4ECE; $ (0,\ 0) $ &amp;#x6307;&amp;#x5411; $ (a,\ b) $ &amp;#x7684;&amp;#x5411;&amp;#x91CF;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x8BE5;&amp;#x5411;&amp;#x91CF;&amp;#x7684;&amp;#x957F;&amp;#x5EA6; $ \sqrt {a ^ 2 + b ^ 2} $ &amp;#x53EB;&amp;#x505A;&amp;#x6A21;&amp;#x957F;&amp;#x3002;&amp;#x8868;&amp;#x793A;&amp;#x4ECE; $ x $ &amp;#x8F74;&amp;#x6B63;&amp;#x534A;&amp;#x8F74;&amp;#x5230;&amp;#x8BE5;&amp;#x5411;&amp;#x91CF;&amp;#x7684;&amp;#x8F6C;&amp;#x89D2;&amp;#x7684;&amp;#x6709;&amp;#x5411;&amp;#xFF08;&amp;#x4EE5;&amp;#x9006;&amp;#x65F6;&amp;#x9488;&amp;#x4E3A;&amp;#x6B63;&amp;#x65B9;&amp;#x5411;&amp;#xFF09;&amp;#x89D2;&amp;#x53EB;&amp;#x505A;&amp;#x5E45;&amp;#x89D2;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x590D;&amp;#x6570;&amp;#x76F8;&amp;#x52A0;&amp;#x9075;&amp;#x5FAA;&amp;#x5E73;&amp;#x884C;&amp;#x56DB;&amp;#x8FB9;&amp;#x5F62;&amp;#x5B9A;&amp;#x5219;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x590D;&amp;#x6570;&amp;#x76F8;&amp;#x4E58;&amp;#x65F6;&amp;#xFF0C;&amp;#x6A21;&amp;#x957F;&amp;#x76F8;&amp;#x4E58;&amp;#xFF0C;&amp;#x5E45;&amp;#x89D2;&amp;#x76F8;&amp;#x52A0;&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x5355;&amp;#x4F4D;&amp;#x6839;&quot;&gt;&amp;#x5355;&amp;#x4F4D;&amp;#x6839;&lt;/h3&gt;
&lt;p&gt;&amp;#x4E0B;&amp;#x6587;&amp;#x4E2D;&amp;#xFF0C;&amp;#x5982;&amp;#x4E0D;&amp;#x7279;&amp;#x6B8A;&amp;#x6307;&amp;#x660E;&amp;#xFF0C;&amp;#x5747;&amp;#x8BBE; $ n $ &amp;#x4E3A; $ 2 $ &amp;#x7684;&amp;#x6B63;&amp;#x6574;&amp;#x6570;&amp;#x6B21;&amp;#x5E42;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x5728;&amp;#x590D;&amp;#x5E73;&amp;#x9762;&amp;#x4E0A;&amp;#xFF0C;&amp;#x4EE5;&amp;#x539F;&amp;#x70B9;&amp;#x4E3A;&amp;#x5706;&amp;#x5FC3;&amp;#xFF0C;$ 1 $ &amp;#x4E3A;&amp;#x534A;&amp;#x5F84;&amp;#x4F5C;&amp;#x5706;&amp;#xFF0C;&amp;#x6240;&amp;#x5F97;&amp;#x7684;&amp;#x5706;&amp;#x53EB;&amp;#x505A;&amp;#x5355;&amp;#x4F4D;&amp;#x5706;&amp;#x3002;&amp;#x4EE5;&amp;#x539F;&amp;#x70B9;&amp;#x4E3A;&amp;#x8D77;&amp;#x70B9;&amp;#xFF0C;&amp;#x5355;&amp;#x4F4D;&amp;#x5706;&amp;#x7684; $ n $ &amp;#x7B49;&amp;#x5206;&amp;#x70B9;&amp;#x4E3A;&amp;#x7EC8;&amp;#x70B9;&amp;#xFF0C;&amp;#x4F5C; $ n $ &amp;#x4E2A;&amp;#x5411;&amp;#x91CF;&amp;#x3002;&amp;#x8BBE;&amp;#x6240;&amp;#x5F97;&amp;#x7684;&lt;strong&gt;&amp;#x5E45;&amp;#x89D2;&amp;#x4E3A;&amp;#x6B63;&amp;#x4E14;&amp;#x6700;&amp;#x5C0F;&lt;/strong&gt;&amp;#x7684;&amp;#x5411;&amp;#x91CF;&amp;#x5BF9;&amp;#x5E94;&amp;#x7684;&amp;#x590D;&amp;#x6570;&amp;#x4E3A; $ \omega_n $&amp;#xFF0C;&amp;#x79F0;&amp;#x4E3A; $ n $ &amp;#x6B21;&amp;#x5355;&amp;#x4F4D;&amp;#x6839;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x7531;&amp;#x590D;&amp;#x6570;&amp;#x4E58;&amp;#x6CD5;&amp;#x7684;&amp;#x5B9A;&amp;#x4E49;&amp;#xFF08;&amp;#x6A21;&amp;#x957F;&amp;#x76F8;&amp;#x4E58;&amp;#xFF0C;&amp;#x5E45;&amp;#x89D2;&amp;#x76F8;&amp;#x52A0;&amp;#xFF09;&amp;#x53EF;&amp;#x77E5;&amp;#xFF0C;&amp;#x5176;&amp;#x4E0E;&amp;#x7684; $ n - 1 $ &amp;#x4E2A;&amp;#x5411;&amp;#x91CF;&amp;#x5BF9;&amp;#x5E94;&amp;#x7684;&amp;#x590D;&amp;#x6570;&amp;#x5206;&amp;#x522B;&amp;#x4E3A; $ \omega_n ^ 2,\ \omega_n ^ 3,\ \dots,\ \omega_n ^ n $&amp;#xFF0C;&amp;#x5176;&amp;#x4E2D; $ \omega_n ^ n = \omega_n ^ 0 = 1 $&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x5355;&amp;#x4F4D;&amp;#x6839;&amp;#x7684;&amp;#x5E45;&amp;#x89D2;&amp;#x4E3A;&amp;#x5468;&amp;#x89D2;&amp;#x7684; $ 1 \over n $&amp;#xFF0C;&amp;#x8FD9;&amp;#x4E3A;&amp;#x6211;&amp;#x4EEC;&amp;#x63D0;&amp;#x4F9B;&amp;#x4E86;&amp;#x4E00;&amp;#x4E2A;&amp;#x8BA1;&amp;#x7B97;&amp;#x5355;&amp;#x4F4D;&amp;#x6839;&amp;#x53CA;&amp;#x5176;&amp;#x5E42;&amp;#x7684;&amp;#x516C;&amp;#x5F0F;&lt;/p&gt;
&lt;p&gt;$$ \omega_n ^ k = \cos k \frac{2 \pi}{n} + i\sin k \frac{2 \pi}{n} $$&lt;/p&gt;
&lt;h4 id=&quot;&amp;#x5355;&amp;#x4F4D;&amp;#x6839;&amp;#x7684;&amp;#x6027;&amp;#x8D28;&quot;&gt;&amp;#x5355;&amp;#x4F4D;&amp;#x6839;&amp;#x7684;&amp;#x6027;&amp;#x8D28;&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;&amp;#x6027;&amp;#x8D28;&amp;#x4E00;&amp;#xFF1A;$ \omega_{2n} ^ {2k} = \omega_n ^ k $&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&amp;#x4ECE;&amp;#x51E0;&amp;#x4F55;&amp;#x610F;&amp;#x4E49;&amp;#x4E0A;&amp;#x770B;&amp;#xFF0C;&amp;#x5728;&amp;#x590D;&amp;#x5E73;&amp;#x9762;&amp;#x4E0A;&amp;#xFF0C;&amp;#x4E8C;&amp;#x8005;&amp;#x8868;&amp;#x793A;&amp;#x7684;&amp;#x5411;&amp;#x91CF;&amp;#x7EC8;&amp;#x70B9;&amp;#x76F8;&amp;#x540C;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x66F4;&amp;#x5177;&amp;#x4F53;&amp;#x7684;&amp;#xFF0C;&amp;#x6709;&lt;/p&gt;
&lt;p&gt;$$ \cos 2k \frac{2 \pi}{2n} + i\sin 2k \frac{2 \pi}{2n} = \cos k \frac{2 \pi}{n} + i\sin k \frac{2 \pi}{n} $$&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&amp;#x6027;&amp;#x8D28;&amp;#x4E8C;&amp;#xFF1A;$ \omega_n ^ { k + \frac{n}{2} } = -\omega_n ^ k $&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&amp;#x7B49;&amp;#x5F0F;&amp;#x5DE6;&amp;#x8FB9;&amp;#x76F8;&amp;#x5F53;&amp;#x4E8E; $ \omega_n ^ k $ &amp;#x4E58;&amp;#x4E0A; $ \omega_n ^ { \frac{n}{2} } $&amp;#xFF0C;&amp;#x8003;&amp;#x8651;&amp;#x5176;&amp;#x503C;&lt;/p&gt;
&lt;p&gt;$$ \begin{align*} \omega_n ^ { \frac{n}{2} } &amp;amp;= \cos \frac{n}{2} \cdot \frac{2 \pi}{n} + i\sin \frac{n}{2} \cdot \frac{2 \pi}{n} \\ &amp;amp;= \cos \pi + i\sin \pi \\ &amp;amp;= -1 \end{align*} $$&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x5FEB;&amp;#x901F;&amp;#x5085;&amp;#x91CC;&amp;#x53F6;&amp;#x53D8;&amp;#x6362;&quot;&gt;&amp;#x5FEB;&amp;#x901F;&amp;#x5085;&amp;#x91CC;&amp;#x53F6;&amp;#x53D8;&amp;#x6362;&lt;/h3&gt;
&lt;p&gt;&amp;#x8003;&amp;#x8651;&amp;#x591A;&amp;#x9879;&amp;#x5F0F; $ A(x) $ &amp;#x7684;&amp;#x8868;&amp;#x793A;&amp;#x3002;&amp;#x5C06; $ n $ &amp;#x6B21;&amp;#x5355;&amp;#x4F4D;&amp;#x6839;&amp;#x7684; $ 0 $ &amp;#x5230; $ n - 1 $ &amp;#x6B21;&amp;#x5E42;&amp;#x5E26;&amp;#x5165;&amp;#x591A;&amp;#x9879;&amp;#x5F0F;&amp;#x7684;&amp;#x7CFB;&amp;#x6570;&amp;#x8868;&amp;#x793A;&amp;#xFF0C;&amp;#x6240;&amp;#x5F97;&amp;#x70B9;&amp;#x503C;&amp;#x5411;&amp;#x91CF; $ (A(\omega_n ^ 0),\ A(\omega_n ^ 1),\ \dots,\ A(\omega_n ^ {n - 1})) $ &amp;#x79F0;&amp;#x4E3A;&amp;#x5176;&amp;#x7CFB;&amp;#x6570;&amp;#x5411;&amp;#x91CF; $ (a_0,\ a_1,\ \dots,\ a_{n - 1}) $ &amp;#x7684;&lt;strong&gt;&amp;#x79BB;&amp;#x6563;&amp;#x5085;&amp;#x91CC;&amp;#x53F6;&amp;#x53D8;&amp;#x6362;&lt;/strong&gt;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x6309;&amp;#x7167;&amp;#x6734;&amp;#x7D20;&amp;#x7B97;&amp;#x6CD5;&amp;#x6765;&amp;#x6C42;&amp;#x79BB;&amp;#x6563;&amp;#x5085;&amp;#x91CC;&amp;#x53F6;&amp;#x53D8;&amp;#x6362;&amp;#xFF0C;&amp;#x65F6;&amp;#x95F4;&amp;#x590D;&amp;#x6742;&amp;#x5EA6;&amp;#x4ECD;&amp;#x7136;&amp;#x4E3A; $ O(n ^ 2) $&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x8003;&amp;#x8651;&amp;#x5C06;&amp;#x591A;&amp;#x9879;&amp;#x5F0F;&amp;#x6309;&amp;#x7167;&amp;#x7CFB;&amp;#x6570;&amp;#x4E0B;&amp;#x6807;&amp;#x7684;&amp;#x5947;&amp;#x5076;&amp;#x5206;&amp;#x4E3A;&amp;#x4E24;&amp;#x90E8;&amp;#x5206;&lt;/p&gt;
&lt;p&gt;$$ A(x) = (a_0 + a_2 x ^ 2 + a_4 x ^ 4 + \dots + a_{n - 2} x ^ {n - 2}) + (a_1 x + a_3 x ^ 3 + a_5 x ^ 5 + \dots + a_{n - 1} x ^ {n - 1}) $$&lt;/p&gt;
&lt;p&gt;&amp;#x4EE4;&lt;/p&gt;
&lt;p&gt;$$ \begin{align*} A_1(x) &amp;amp;= a_0 + a_2 x + a_4 x ^ 2 + \dots + a_{n - 2} x ^ {\frac{n}{2} - 1} \\ A_2(x) &amp;amp;= a_1 + a_3 x + a_5 x ^ 2 + \dots + a_{n - 1} x ^ {\frac{n}{2} - 1} \end{align*} $$&lt;/p&gt;
&lt;p&gt;&amp;#x5219;&amp;#x6709;&lt;/p&gt;
&lt;p&gt;$$ A(x) = A_1(x ^ 2) + x A_2(x ^ 2) $$&lt;/p&gt;
&lt;p&gt;&amp;#x5047;&amp;#x8BBE; $ k &amp;lt; \frac{n}{2} $&amp;#xFF0C;&amp;#x73B0;&amp;#x5728;&amp;#x8981;&amp;#x6C42; $ A(\omega_n ^ k) $&lt;/p&gt;
&lt;p&gt;$$ \begin{align*} A(\omega_n ^ k) &amp;amp;= A_1(\omega_n ^ {2k}) + \omega_n ^ {k} A_2(\omega_n ^ {2k}) \\ &amp;amp;= A_1(\omega_{\frac{n}{2}} ^ {k}) + \omega_n ^ {k} A_2(\omega_{\frac{n}{2}} ^ {k}) \\ \end{align*} $$&lt;/p&gt;
&lt;p&gt;&amp;#x8FD9;&amp;#x4E00;&amp;#x6B65;&amp;#x8F6C;&amp;#x5316;&amp;#x5229;&amp;#x7528;&amp;#x4E86;&amp;#x5355;&amp;#x4F4D;&amp;#x6839;&amp;#x7684;&amp;#x6027;&amp;#x8D28;&amp;#x4E00;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x5BF9;&amp;#x4E8E; $ A(\omega_n ^ {k + \frac{n}{2}}) $&lt;/p&gt;
&lt;p&gt;$$ \begin{align*} A(\omega_n ^ {k + \frac{n}{2}}) &amp;amp;= A_1(\omega_n ^ {2k + n}) + \omega_n ^ {k + \frac{n}{2}} A_2(\omega_n ^ {2k + n}) \\ &amp;amp;= A_1(\omega_n ^ {2k} \times \omega_n ^ n) - \omega_n ^ {k} A_2(\omega_n ^ {2k} \times \omega_n ^ n) \\ &amp;amp;= A_1(\omega_n ^ {2k}) - \omega_n ^ {k} A_2(\omega_n ^ {2k}) \\ &amp;amp;= A_1(\omega_{\frac{n}{2}} ^ {k}) - \omega_n ^ {k} A_2(\omega_{\frac{n}{2}} ^ {k}) \\ \end{align*} $$&lt;/p&gt;
&lt;p&gt;&amp;#x8FD9;&amp;#x4E00;&amp;#x6B65;&amp;#x8F6C;&amp;#x5316;&amp;#x9664;&amp;#x6027;&amp;#x8D28;&amp;#x4E00;&amp;#x5916;&amp;#xFF0C;&amp;#x8FD8;&amp;#x5229;&amp;#x7528;&amp;#x5230;&amp;#x4E86;&amp;#x6027;&amp;#x8D28;&amp;#x4E8C;&amp;#x548C; $ \omega_n ^ n = 1 $ &amp;#x8FD9;&amp;#x4E00;&amp;#x663E;&amp;#x7136;&amp;#x7684;&amp;#x7ED3;&amp;#x8BBA;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x6CE8;&amp;#x610F;&amp;#x5230;&amp;#xFF0C;&amp;#x5F53; $ k $ &amp;#x53D6;&amp;#x904D; $ [0,\ \frac{n}{2} - 1] $ &amp;#x65F6;&amp;#xFF0C;$ k $ &amp;#x548C; $ k + \frac{n}{2} $ &amp;#x53D6;&amp;#x904D;&amp;#x4E86; $ [0,\ n - 1] $&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x4E5F;&amp;#x5C31;&amp;#x662F;&amp;#x8BF4;&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x5DF2;&amp;#x77E5; $ A_1(x) $ &amp;#x548C; $ A_2(x) $ &amp;#x5728; $ \omega_{ \frac{n}{2} } ^ 0,\ \omega_{ \frac{n}{2} } ^ 1,\ \dots,\ \omega_{ \frac{n}{2} } ^ { \frac{n}{2} - 1 } $ &amp;#x5904;&amp;#x7684;&amp;#x70B9;&amp;#x503C;&amp;#xFF0C;&amp;#x5C31;&amp;#x53EF;&amp;#x4EE5;&amp;#x5728; $ O(n) $ &amp;#x7684;&amp;#x65F6;&amp;#x95F4;&amp;#x5185;&amp;#x6C42;&amp;#x5F97; $ A(x) $ &amp;#x5728; $ \omega_n ^ 0,\ \omega_n ^ 1,\ \dots,\ \omega_n ^ {n - 1} $ &amp;#x5904;&amp;#x7684;&amp;#x53D6;&amp;#x503C;&amp;#x3002;&amp;#x800C;&amp;#x5173;&amp;#x4E8E; $ A_1(x) $ &amp;#x548C; $ A_2(x) $ &amp;#x7684;&amp;#x95EE;&amp;#x9898;&amp;#x90FD;&amp;#x662F;&amp;#x76F8;&amp;#x5BF9;&amp;#x4E8E;&amp;#x539F;&amp;#x95EE;&amp;#x9898;&amp;#x89C4;&amp;#x6A21;&amp;#x7F29;&amp;#x5C0F;&amp;#x4E86;&amp;#x4E00;&amp;#x534A;&amp;#x7684;&amp;#x5B50;&amp;#x95EE;&amp;#x9898;&amp;#xFF0C;&amp;#x5206;&amp;#x6CBB;&amp;#x7684;&amp;#x8FB9;&amp;#x754C;&amp;#x4E3A;&amp;#x4E00;&amp;#x4E2A;&amp;#x5E38;&amp;#x6570;&amp;#x9879; $ a_0 $&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x6839;&amp;#x636E;&amp;#x4E3B;&amp;#x5B9A;&amp;#x7406;&amp;#xFF0C;&amp;#x8BE5;&amp;#x5206;&amp;#x6CBB;&amp;#x7B97;&amp;#x6CD5;&amp;#x7684;&amp;#x65F6;&amp;#x95F4;&amp;#x590D;&amp;#x6742;&amp;#x5EA6;&amp;#x4E3A;&lt;/p&gt;
&lt;p&gt;$$ T(n) = 2T( \frac{n}{2} ) + O(n) = O(n \log n) $$&lt;/p&gt;
&lt;p&gt;&amp;#x8FD9;&amp;#x5C31;&amp;#x662F;&amp;#x6700;&amp;#x5E38;&amp;#x7528;&amp;#x7684; FFT &amp;#x7B97;&amp;#x6CD5; &amp;#x2014;&amp;#x2014; Cooley-Tukey &amp;#x7B97;&amp;#x6CD5;&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x5085;&amp;#x91CC;&amp;#x53F6;&amp;#x9006;&amp;#x53D8;&amp;#x6362;&quot;&gt;&amp;#x5085;&amp;#x91CC;&amp;#x53F6;&amp;#x9006;&amp;#x53D8;&amp;#x6362;&lt;/h3&gt;
&lt;p&gt;&amp;#x5C06;&amp;#x70B9;&amp;#x503C;&amp;#x8868;&amp;#x793A;&amp;#x7684;&amp;#x591A;&amp;#x9879;&amp;#x5F0F;&amp;#x8F6C;&amp;#x5316;&amp;#x4E3A;&amp;#x7CFB;&amp;#x6570;&amp;#x8868;&amp;#x793A;&amp;#xFF0C;&amp;#x540C;&amp;#x6837;&amp;#x53EF;&amp;#x4EE5;&amp;#x4F7F;&amp;#x7528;&amp;#x5FEB;&amp;#x901F;&amp;#x5085;&amp;#x91CC;&amp;#x53F6;&amp;#x53D8;&amp;#x6362;&amp;#xFF0C;&amp;#x8FD9;&amp;#x4E2A;&amp;#x8FC7;&amp;#x7A0B;&amp;#x53EB;&amp;#x505A;&lt;strong&gt;&amp;#x5085;&amp;#x91CC;&amp;#x53F6;&amp;#x9006;&amp;#x53D8;&amp;#x6362;&lt;/strong&gt;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x8BBE; $ (y_0,\ y_1,\ y_2,\ \dots,\ y_{n - 1}) $ &amp;#x4E3A; $ (a_0,\ a_1,\ a_2,\ \dots,\ a_{n - 1}) $ &amp;#x7684;&amp;#x5085;&amp;#x91CC;&amp;#x53F6;&amp;#x53D8;&amp;#x6362;&amp;#x3002;&amp;#x8003;&amp;#x8651;&amp;#x53E6;&amp;#x4E00;&amp;#x4E2A;&amp;#x5411;&amp;#x91CF; $ (c_0,\ c_1,\ c_2,\ \dots,\ c_{n - 1}) $ &amp;#x6EE1;&amp;#x8DB3;&lt;/p&gt;
&lt;p&gt;$$ c_k = \sum\limits_{i = 0} ^ {n - 1} y_i (\omega_n ^ {-k}) ^ i $$&lt;/p&gt;
&lt;p&gt;&amp;#x5373;&amp;#x591A;&amp;#x9879;&amp;#x5F0F; $ B(x) = y_0 + y_1 x + y_2 x ^ 2 + \dots + y_{n - 1} x ^ {n - 1} $ &amp;#x5728; $ \omega_n ^ 0,\ \omega_n ^ {-1},\ \omega_n ^ {-2},\ \dots,\ \omega_n ^ {-(n - 1)} $ &amp;#x5904;&amp;#x7684;&amp;#x70B9;&amp;#x503C;&amp;#x8868;&amp;#x793A;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x5C06;&amp;#x4E0A;&amp;#x5F0F;&amp;#x5C55;&amp;#x5F00;&amp;#xFF0C;&amp;#x5F97;&lt;/p&gt;
&lt;p&gt;$$ \begin{align*} c_k &amp;amp;= \sum\limits_{i = 0} ^ {n - 1} y_i (\omega_n ^ {-k}) ^ i \\ &amp;amp;= \sum\limits_{i = 0} ^ {n - 1} (\sum\limits_{j = 0} ^ {n - 1} a_j (\omega_n ^ i) ^ j) (\omega_n ^ {-k}) ^ i \\ &amp;amp;= \sum\limits_{i = 0} ^ {n - 1} (\sum\limits_{j = 0} ^ {n - 1} a_j (\omega_n ^ j) ^ i (\omega_n ^ {-k}) ^ i) \\ &amp;amp;= \sum\limits_{i = 0} ^ {n - 1} (\sum\limits_{j = 0} ^ {n - 1} a_j (\omega_n ^ j) ^ i) (\omega_n ^ {-k}) ^ i \\ &amp;amp;= \sum\limits_{i = 0} ^ {n - 1} \sum\limits_{j = 0} ^ {n - 1} a_j (\omega_n ^ {j - k}) ^ i \\ &amp;amp;= \sum\limits_{j = 0} ^ {n - 1} a_j (\sum\limits_{i = 0} ^ {n - 1} (\omega_n ^ {j - k}) ^ i) \end{align*} $$&lt;/p&gt;
&lt;p&gt;&amp;#x8003;&amp;#x8651;&amp;#x4E00;&amp;#x4E2A;&amp;#x5F0F;&amp;#x5B50;&lt;/p&gt;
&lt;p&gt;$$ S(\omega_n ^ k) = 1 + \omega_n ^ k + (\omega_n ^ k) ^ 2 + \dots + (\omega_n ^ k) ^ {n - 1} $$&lt;/p&gt;
&lt;p&gt;&amp;#x5F53; $ k \neq 0 $ &amp;#x65F6;&amp;#xFF0C;&amp;#x4E24;&amp;#x8FB9;&amp;#x540C;&amp;#x65F6;&amp;#x4E58;&amp;#x4E0A; $ \omega_n ^ k $ &amp;#x5F97;&lt;/p&gt;
&lt;p&gt;$$ \omega_n ^ k S(\omega_n ^ k) = \omega_n ^ k + (\omega_n ^ k) ^ 2 + (\omega_n ^ k) ^ 3 + \dots + (\omega_n ^ k) ^ n $$&lt;/p&gt;
&lt;p&gt;&amp;#x4E24;&amp;#x5F0F;&amp;#x76F8;&amp;#x51CF;&amp;#xFF0C;&amp;#x6574;&amp;#x7406;&amp;#x540E;&amp;#x5F97;&lt;/p&gt;
&lt;p&gt;$$ \begin{align*} \omega_n ^ k S(\omega_n ^ k) - S(\omega_n ^ k) &amp;amp;= (\omega_n ^ k) ^ n - 1 \\ S(\omega_n ^ k) &amp;amp;= \frac{(\omega_n ^ k) ^ n - 1}{\omega_n ^ k - 1} \end{align*} $$&lt;/p&gt;
&lt;p&gt;&amp;#x5206;&amp;#x5B50;&amp;#x4E3A;&amp;#x96F6;&amp;#xFF0C;&amp;#x5206;&amp;#x6BCD;&amp;#x4E0D;&amp;#x4E3A;&amp;#x96F6;&amp;#xFF0C;&amp;#x6240;&amp;#x4EE5;&lt;/p&gt;
&lt;p&gt;$$ S(\omega_n ^ k) = 0 $$&lt;/p&gt;
&lt;p&gt;&amp;#x5F53; $ k = 0 $ &amp;#x65F6;&amp;#xFF0C;&amp;#x663E;&amp;#x7136; $ S(\omega_n ^ k) = n $&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x7EE7;&amp;#x7EED;&amp;#x8003;&amp;#x8651;&amp;#x4E0A;&amp;#x5F0F;&lt;/p&gt;
&lt;p&gt;$$ \begin{align*} c_k &amp;amp;= \sum\limits_{j = 0} ^ {n - 1} a_j (\sum\limits_{i = 0} ^ {n - 1} (\omega_n ^ {j - k}) ^ i) \\ &amp;amp;= \sum\limits_{j = 0} ^ {n - 1} a_j S(\omega_n ^ {j - k}) \end{align*} $$&lt;/p&gt;
&lt;p&gt;&amp;#x5F53; $ j = k $ &amp;#x65F6;&amp;#xFF0C;$ S(\omega_n ^ {j - k}) = n $&amp;#xFF0C;&amp;#x5426;&amp;#x5219; $ S(\omega_n ^ {j - k}) = 0 $&amp;#xFF0C;&amp;#x5373;&lt;/p&gt;
&lt;p&gt;$$ \begin{align*} c_i &amp;amp;= n a_i \\ a_i &amp;amp;= \frac{1}{n} c_i \end{align*} $$&lt;/p&gt;
&lt;p&gt;&amp;#x6240;&amp;#x4EE5;&amp;#xFF0C;&amp;#x4F7F;&amp;#x7528;&amp;#x5355;&amp;#x4F4D;&amp;#x6839;&amp;#x7684;&amp;#x5012;&amp;#x6570;&amp;#x4EE3;&amp;#x66FF;&amp;#x5355;&amp;#x4F4D;&amp;#x6839;&amp;#xFF0C;&amp;#x505A;&amp;#x4E00;&amp;#x6B21;&amp;#x7C7B;&amp;#x4F3C;&amp;#x5FEB;&amp;#x901F;&amp;#x5085;&amp;#x91CC;&amp;#x53F6;&amp;#x53D8;&amp;#x6362;&amp;#x7684;&amp;#x8FC7;&amp;#x7A0B;&amp;#xFF0C;&amp;#x518D;&amp;#x5C06;&amp;#x7ED3;&amp;#x679C;&amp;#x6BCF;&amp;#x4E2A;&amp;#x6570;&amp;#x9664;&amp;#x4EE5; $ n $&amp;#xFF0C;&amp;#x5373;&amp;#x4E3A;&amp;#x5085;&amp;#x91CC;&amp;#x53F6;&amp;#x9006;&amp;#x53D8;&amp;#x6362;&amp;#x7684;&amp;#x7ED3;&amp;#x679C;&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x5B9E;&amp;#x73B0;&quot;&gt;&amp;#x5B9E;&amp;#x73B0;&lt;/h3&gt;
&lt;p&gt;C++ &amp;#x7684; STL &amp;#x5728;&amp;#x5934;&amp;#x6587;&amp;#x4EF6; &lt;code&gt;complex&lt;/code&gt; &amp;#x4E2D;&amp;#x63D0;&amp;#x4F9B;&amp;#x4E00;&amp;#x4E2A;&amp;#x590D;&amp;#x6570;&amp;#x7684;&amp;#x6A21;&amp;#x677F;&amp;#x5B9E;&amp;#x73B0; &lt;code&gt;std::complex&amp;lt;T&amp;gt;&lt;/code&gt;&amp;#xFF0C;&amp;#x5176;&amp;#x4E2D; &lt;code&gt;T&lt;/code&gt; &amp;#x4E3A;&amp;#x5B9E;&amp;#x6570;&amp;#x7C7B;&amp;#x578B;&amp;#xFF0C;&amp;#x4E00;&amp;#x822C;&amp;#x53D6; &lt;code&gt;double&lt;/code&gt;&amp;#xFF0C;&amp;#x5728;&amp;#x5BF9;&amp;#x7CBE;&amp;#x5EA6;&amp;#x8981;&amp;#x6C42;&amp;#x8F83;&amp;#x9AD8;&amp;#x7684;&amp;#x65F6;&amp;#x5019;&amp;#x53EF;&amp;#x4EE5;&amp;#x4F7F;&amp;#x7528; &lt;code&gt;long double&lt;/code&gt; &amp;#x6216; &lt;code&gt;__float128&lt;/code&gt;&amp;#xFF08;&amp;#x4E0D;&amp;#x5E38;&amp;#x7528;&amp;#xFF09;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x8003;&amp;#x8651;&amp;#x5230;&amp;#x5355;&amp;#x4F4D;&amp;#x6839;&amp;#x7684;&amp;#x5012;&amp;#x6570;&amp;#x7B49;&amp;#x4E8E;&amp;#x5176;&amp;#x5171;&amp;#x8F6D;&amp;#x590D;&amp;#x6570;&amp;#xFF0C;&amp;#x5728;&amp;#x7A0B;&amp;#x5E8F;&amp;#x5B9E;&amp;#x73B0;&amp;#x4E2D;&amp;#xFF0C;&amp;#x4E3A;&amp;#x4E86;&amp;#x51CF;&amp;#x5C0F;&amp;#x8BEF;&amp;#x5DEE;&amp;#xFF0C;&amp;#x901A;&amp;#x5E38;&amp;#x4F7F;&amp;#x7528; &lt;code&gt;std::conj()&lt;/code&gt; &amp;#x53D6;&amp;#x5F97; IDFT &amp;#x6240;&amp;#x9700;&amp;#x7684;&amp;#x300C;&amp;#x5355;&amp;#x4F4D;&amp;#x6839;&amp;#x7684;&amp;#x5012;&amp;#x6570;&amp;#x300D;&amp;#x3002;&lt;/p&gt;
&lt;h4 id=&quot;&amp;#x9012;&amp;#x5F52;&amp;#x5B9E;&amp;#x73B0;&quot;&gt;&amp;#x9012;&amp;#x5F52;&amp;#x5B9E;&amp;#x73B0;&lt;/h4&gt;
&lt;p&gt;&amp;#x76F4;&amp;#x63A5;&amp;#x6309;&amp;#x7167;&amp;#x4E0A;&amp;#x9762;&amp;#x5F97;&amp;#x5230;&amp;#x7684;&amp;#x7ED3;&amp;#x8BBA;&amp;#x6765;&amp;#x5B9E;&amp;#x73B0;&amp;#x5373;&amp;#x53EF;&amp;#xFF0C;&amp;#x6BD4;&amp;#x8F83;&amp;#x76F4;&amp;#x89C2;&amp;#x3002;&lt;/p&gt;
&lt;h5 id=&quot;&amp;#x4EE3;&amp;#x7801;&quot;&gt;&amp;#x4EE3;&amp;#x7801;&lt;/h5&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt; PI = &lt;span class=&quot;built_in&quot;&gt;acos&lt;/span&gt;(-&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; inversed = &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;keyword&quot;&gt;complex&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt;&amp;gt; omega(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; k) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!inversed) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;keyword&quot;&gt;complex&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt;&amp;gt;(&lt;span class=&quot;built_in&quot;&gt;cos&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; * PI / n * k), &lt;span class=&quot;built_in&quot;&gt;sin&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; * PI / n * k));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::conj(&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;keyword&quot;&gt;complex&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt;&amp;gt;(&lt;span class=&quot;built_in&quot;&gt;cos&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; * PI / n * k), &lt;span class=&quot;built_in&quot;&gt;sin&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; * PI / n * k)));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;keyword&quot;&gt;complex&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt;&amp;gt; *a, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (n == &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;keyword&quot;&gt;complex&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt;&amp;gt; buf[MAXN];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; m = n / &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// &amp;#x6309;&amp;#x7167;&amp;#x7CFB;&amp;#x6570;&amp;#x5947;&amp;#x5076;&amp;#x5212;&amp;#x5206;&amp;#x4E3A;&amp;#x4E24;&amp;#x534A;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; m; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        buf[i] = a[i * &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        buf[i + m] = a[i * &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::copy(buf, buf + n, a);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// &amp;#x5206;&amp;#x6CBB;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;keyword&quot;&gt;complex&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt;&amp;gt; *a1 = a, *a2 = a + m;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    fft(a1, m);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    fft(a2, m);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// &amp;#x5408;&amp;#x5E76;&amp;#x4E24;&amp;#x4E2A;&amp;#x5B50;&amp;#x95EE;&amp;#x9898;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; m; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;keyword&quot;&gt;complex&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt;&amp;gt; x = omega(n, i);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        buf[i] = a1[i] + x * a2[i];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        buf[i + m] = a1[i] - x * a2[i];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::copy(buf, buf + n, a);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;&amp;#x8FED;&amp;#x4EE3;&amp;#x5B9E;&amp;#x73B0;&quot;&gt;&amp;#x8FED;&amp;#x4EE3;&amp;#x5B9E;&amp;#x73B0;&lt;/h4&gt;
&lt;p&gt;&amp;#x9012;&amp;#x5F52;&amp;#x5B9E;&amp;#x73B0;&amp;#x7684; FFT &amp;#x6548;&amp;#x7387;&amp;#x4E0D;&amp;#x9AD8;&amp;#xFF0C;&amp;#x5B9E;&amp;#x9645;&amp;#x4E2D;&amp;#x4E00;&amp;#x822C;&amp;#x91C7;&amp;#x7528;&amp;#x8FED;&amp;#x4EE3;&amp;#x5B9E;&amp;#x73B0;&amp;#x3002;&lt;/p&gt;
&lt;h5 id=&quot;&amp;#x4E8C;&amp;#x8FDB;&amp;#x5236;&amp;#x4F4D;&amp;#x7FFB;&amp;#x8F6C;&quot;&gt;&amp;#x4E8C;&amp;#x8FDB;&amp;#x5236;&amp;#x4F4D;&amp;#x7FFB;&amp;#x8F6C;&lt;/h5&gt;
&lt;p&gt;&amp;#x8003;&amp;#x8651;&amp;#x9012;&amp;#x5F52; FFT &amp;#x5206;&amp;#x6CBB;&amp;#x5230;&amp;#x8FB9;&amp;#x754C;&amp;#x65F6;&amp;#xFF0C;&amp;#x6BCF;&amp;#x4E2A;&amp;#x6570;&amp;#x7684;&amp;#x987A;&amp;#x5E8F;&amp;#xFF0C;&amp;#x53CA;&amp;#x5176;&amp;#x4E8C;&amp;#x8FDB;&amp;#x5236;&amp;#x4F4D;&amp;#x3002;&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;000 001 010 011 100 101 110 111
 0   1   2   3   4   5   6   7
 0   2   4   6 - 1   3   5   7
 0   4 - 2   6 - 1   5 - 3   7
 0 - 4 - 2 - 6 - 1 - 5 - 3 - 7
000 100 010 110 001 101 011 111&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&amp;#x53D1;&amp;#x73B0;&amp;#x89C4;&amp;#x5F8B;&amp;#xFF0C;&amp;#x5206;&amp;#x6CBB;&amp;#x5230;&amp;#x8FB9;&amp;#x754C;&amp;#x540E;&amp;#x7684;&amp;#x4E0B;&amp;#x6807;&amp;#x7B49;&amp;#x4E8E;&amp;#x539F;&amp;#x4E0B;&amp;#x6807;&amp;#x7684;&amp;#x4E8C;&amp;#x8FDB;&amp;#x5236;&amp;#x4F4D;&amp;#x7FFB;&amp;#x8F6C;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x4EE3;&amp;#x7801;&amp;#x5B9E;&amp;#x73B0;&amp;#xFF0C;&amp;#x679A;&amp;#x4E3E;&amp;#x6BCF;&amp;#x4E2A;&amp;#x4E8C;&amp;#x8FDB;&amp;#x5236;&amp;#x4F4D;&amp;#x5373;&amp;#x53EF;&amp;#x3002;&lt;/p&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; k = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; ((&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; k) &amp;lt; n) k++;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; t = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; j = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; j &amp;lt; k; j++) &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (i &amp;amp; (&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; j)) t |= (&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; (k - j - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (i &amp;lt; t) &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::swap(a[i], a[t]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h5 id=&quot;&amp;#x8774;&amp;#x8776;&amp;#x64CD;&amp;#x4F5C;&quot;&gt;&amp;#x8774;&amp;#x8776;&amp;#x64CD;&amp;#x4F5C;&lt;/h5&gt;
&lt;p&gt;&amp;#x8003;&amp;#x8651;&amp;#x5408;&amp;#x5E76;&amp;#x4E24;&amp;#x4E2A;&amp;#x5B50;&amp;#x95EE;&amp;#x9898;&amp;#x7684;&amp;#x8FC7;&amp;#x7A0B;&amp;#xFF0C;&amp;#x5047;&amp;#x8BBE; $ A_1(\omega_{ \frac{n}{2} } ^ k) $ &amp;#x548C; $ A_2(\omega_{ \frac{n}{2} } ^ k) $ &amp;#x5206;&amp;#x522B;&amp;#x5B58;&amp;#x5728; $ a(k) $ &amp;#x548C; $ a(\frac{n}{2} + k) $ &amp;#x4E2D;&amp;#xFF0C;$ A(\omega_n ^ {k}) $ &amp;#x548C; $ A(\omega_n ^ {k + \frac{n}{2} }) $ &amp;#x5C06;&amp;#x8981;&amp;#x88AB;&amp;#x5B58;&amp;#x653E;&amp;#x5728; $ b(k) $ &amp;#x548C; $ b(\frac{n}{2} + k) $ &amp;#x4E2D;&amp;#xFF0C;&amp;#x5408;&amp;#x5E76;&amp;#x7684;&amp;#x5355;&amp;#x4F4D;&amp;#x64CD;&amp;#x4F5C;&amp;#x53EF;&amp;#x8868;&amp;#x793A;&amp;#x4E3A;&lt;/p&gt;
&lt;p&gt;$$ \begin{align*} b(k) &amp;amp; \leftarrow a(k) + \omega_n ^ k \times a(\frac{n}{2} + k) \\ b(\frac{n}{2} + k) &amp;amp; \leftarrow a(k) - \omega_n ^ k \times a(\frac{n}{2} + k) \\ \end{align*} $$&lt;/p&gt;
&lt;p&gt;&amp;#x8003;&amp;#x8651;&amp;#x52A0;&amp;#x5165;&amp;#x4E00;&amp;#x4E2A;&amp;#x4E34;&amp;#x65F6;&amp;#x53D8;&amp;#x91CF; $ t $&amp;#xFF0C;&amp;#x4F7F;&amp;#x5F97;&amp;#x8FD9;&amp;#x4E2A;&amp;#x8FC7;&amp;#x7A0B;&amp;#x53EF;&amp;#x4EE5;&amp;#x5728;&amp;#x539F;&amp;#x5730;&amp;#x5B8C;&amp;#x6210;&amp;#xFF0C;&amp;#x4E0D;&amp;#x9700;&amp;#x8981;&amp;#x53E6;&amp;#x4E00;&amp;#x4E2A;&amp;#x6570;&amp;#x7EC4; $ b $&amp;#xFF0C;&amp;#x4E5F;&amp;#x5C31;&amp;#x662F;&amp;#x8BF4;&amp;#xFF0C;&amp;#x5C06; $ A(\omega_n ^ {k}) $ &amp;#x548C; $ A(\omega_n ^ {k + \frac{n}{2} }) $ &amp;#x5B58;&amp;#x653E;&amp;#x5728; $ a(k) $ &amp;#x548C; $ a(\frac{n}{2} + k) $ &amp;#x4E2D;&amp;#xFF0C;&amp;#x8986;&amp;#x76D6;&amp;#x539F;&amp;#x6765;&amp;#x7684;&amp;#x503C;&lt;/p&gt;
&lt;p&gt;$$ \begin{align*} t &amp;amp; \leftarrow \omega_n ^ k \times a(\frac{n}{2} + k) \\ a(\frac{n}{2} + k) &amp;amp; \leftarrow a(k) - t \\ a(k) &amp;amp; \leftarrow a(k) + t \\ \end{align*} $$&lt;/p&gt;
&lt;p&gt;&amp;#x8FD9;&amp;#x4E00;&amp;#x8FC7;&amp;#x7A0B;&amp;#x88AB;&amp;#x79F0;&amp;#x4E3A;&lt;strong&gt;&amp;#x8774;&amp;#x8776;&amp;#x64CD;&amp;#x4F5C;&lt;/strong&gt;&amp;#x3002;&lt;/p&gt;
&lt;h5 id=&quot;&amp;#x4EE3;&amp;#x7801;-1&quot;&gt;&amp;#x4EE3;&amp;#x7801;&lt;/h5&gt;
&lt;p&gt;&lt;code&gt;omega[k]&lt;/code&gt; &amp;#x4E2D;&amp;#x4FDD;&amp;#x5B58; $ \omega_n ^ k $&amp;#xFF08;IDFT &amp;#x65F6;&amp;#x4FDD;&amp;#x5B58; $ \omega_n ^ {-k} $&amp;#xFF09;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x679A;&amp;#x4E3E; $ l $&amp;#xFF0C;&amp;#x8868;&amp;#x793A;&amp;#x4E00;&amp;#x6B21;&amp;#x8981;&amp;#x5C06; $ \frac{l}{2} $ &amp;#x957F;&amp;#x5EA6;&amp;#x7684;&amp;#x5E8F;&amp;#x5217;&amp;#x7B54;&amp;#x6848;&amp;#x5408;&amp;#x5E76;&amp;#x4E3A;&amp;#x957F;&amp;#x5EA6;&amp;#x4E3A; $ l $ &amp;#x7684;&amp;#xFF0C;&amp;#x6839;&amp;#x636E;&amp;#x5355;&amp;#x4F4D;&amp;#x6839;&amp;#x7684;&amp;#x6027;&amp;#x8D28;&amp;#x4E00;&amp;#xFF0C;&amp;#x6709; $ \omega_l ^ k = \omega_n ^ { \frac{n}{l} k } $&amp;#x3002;&lt;/p&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;keyword&quot;&gt;complex&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt;&amp;gt; *a, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;keyword&quot;&gt;complex&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt;&amp;gt; *omega)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// &amp;#x6B64;&amp;#x5904;&amp;#x7701;&amp;#x7565;&amp;#x4E8C;&amp;#x8FDB;&amp;#x5236;&amp;#x4F4D;&amp;#x7FFB;&amp;#x8F6C;&amp;#x7684;&amp;#x4EE3;&amp;#x7801;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; l = &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;; l &amp;lt;= n; l *= &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; m = l / &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// &amp;#x5C06;&amp;#x4E24;&amp;#x4E2A;&amp;#x957F;&amp;#x5EA6;&amp;#x4E3A; m &amp;#x7684;&amp;#x5E8F;&amp;#x5217;&amp;#x7684;&amp;#x7B54;&amp;#x6848;&amp;#x5408;&amp;#x5E76;&amp;#x4E3A;&amp;#x957F;&amp;#x5EA6;&amp;#x4E3A; l &amp;#x7684;&amp;#x5E8F;&amp;#x5217;&amp;#x7684;&amp;#x7B54;&amp;#x6848;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;keyword&quot;&gt;complex&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt;&amp;gt; *p = a; p != a + n; p += l) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; m; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;comment&quot;&gt;// &amp;#x8774;&amp;#x8776;&amp;#x64CD;&amp;#x4F5C;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;keyword&quot;&gt;complex&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt;&amp;gt; t = omega[n / l * i] * p[m + i];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                p[m + i] = p[i] - t;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                p[i] += t;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;&amp;#x6A21;&amp;#x677F;&quot;&gt;&amp;#x6A21;&amp;#x677F;&lt;/h3&gt;
&lt;p&gt;&amp;#x9700;&amp;#x8981;&amp;#x6CE8;&amp;#x610F;&amp;#x7684;&amp;#x662F;&amp;#xFF0C;&amp;#x5728;&amp;#x6C42;&amp;#x4E24;&amp;#x4E2A;&amp;#x6B21;&amp;#x6570;&amp;#x5206;&amp;#x522B;&amp;#x4E3A; $ n_1 - 1 $ &amp;#x548C; $ n_2 - 1 $ &amp;#x7684;&amp;#x591A;&amp;#x9879;&amp;#x5F0F;&amp;#x7684;&amp;#x4E58;&amp;#x79EF;&amp;#x65F6;&amp;#xFF0C;&amp;#x9700;&amp;#x8981;&amp;#x5206;&amp;#x522B;&amp;#x6C42;&amp;#x51FA;&amp;#x5176;&amp;#x5728;&lt;strong&gt;&amp;#x81F3;&amp;#x5C11;&lt;/strong&gt; $ n_1 + n_2 - 1 $ &amp;#x4E2A;&amp;#x70B9;&amp;#x5904;&amp;#x7684;&amp;#x70B9;&amp;#x503C;&amp;#xFF0C;&amp;#x56E0;&amp;#x4E3A;&amp;#x8FD9;&amp;#x6837;&amp;#x624D;&amp;#x80FD;&amp;#x4FDD;&amp;#x8BC1;&amp;#x76F8;&amp;#x4E58;&amp;#x540E;&amp;#x7684;&amp;#x70B9;&amp;#x503C;&amp;#x80FD;&amp;#x552F;&amp;#x4E00;&amp;#x786E;&amp;#x5B9A;&amp;#x4E00;&amp;#x4E2A; $ n_1 + n_2 - 2 $ &amp;#x6B21;&amp;#x591A;&amp;#x9879;&amp;#x5F0F;&amp;#x3002;&lt;/p&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; FastFourierTransform {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;keyword&quot;&gt;complex&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt;&amp;gt; omega[MAXN], omegaInverse[MAXN];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            omega[i] = &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;keyword&quot;&gt;complex&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt;&amp;gt;(&lt;span class=&quot;built_in&quot;&gt;cos&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; * PI / n * i), &lt;span class=&quot;built_in&quot;&gt;sin&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; * PI / n * i));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            omegaInverse[i] = &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::conj(omega[i]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;keyword&quot;&gt;complex&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt;&amp;gt; *a, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;keyword&quot;&gt;complex&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt;&amp;gt; *omega)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; k = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; ((&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; k) &amp;lt; n) k++;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; t = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; j = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; j &amp;lt; k; j++) &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (i &amp;amp; (&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; j)) t |= (&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; (k - j - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (i &amp;lt; t) &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::swap(a[i], a[t]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; l = &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;; l &amp;lt;= n; l *= &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; m = l / &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;keyword&quot;&gt;complex&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt;&amp;gt; *p = a; p != a + n; p += l) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; m; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;keyword&quot;&gt;complex&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt;&amp;gt; t = omega[n / l * i] * p[m + i];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    p[m + i] = p[i] - t;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    p[i] += t;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;dft&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;keyword&quot;&gt;complex&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt;&amp;gt; *a, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        transform(a, n, omega);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;idft&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;keyword&quot;&gt;complex&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt;&amp;gt; *a, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        transform(a, n, omegaInverse);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) a[i] /= n;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} fft;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;multiply&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; *a1, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n1, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; *a2, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n2, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; *res)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (n &amp;lt; n1 + n2) n *= &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;keyword&quot;&gt;complex&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt;&amp;gt; c1[MAXN], c2[MAXN];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n1; i++) c1[i].real(a1[i]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n2; i++) c2[i].real(a2[i]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    fft.init(n);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    fft.dft(c1, n), fft.dft(c2, n);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) c1[i] *= c2[i];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    fft.idft(c1, n);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n1 + n2 - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i++) res[i] = &lt;span class=&quot;keyword&quot;&gt;static_cast&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;&amp;gt;(&lt;span class=&quot;built_in&quot;&gt;floor&lt;/span&gt;(c1[i].real() + &lt;span class=&quot;number&quot;&gt;0.5&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;&amp;#x53C2;&amp;#x8003;&amp;#x8D44;&amp;#x6599;&quot;&gt;&amp;#x53C2;&amp;#x8003;&amp;#x8D44;&amp;#x6599;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://zh.wikipedia.org/zh/%E5%A4%9A%E9%A0%85%E5%BC%8F&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;&amp;#x591A;&amp;#x9805;&amp;#x5F0F; - &amp;#x7EF4;&amp;#x57FA;&amp;#x767E;&amp;#x79D1;&amp;#xFF0C;&amp;#x81EA;&amp;#x7531;&amp;#x7684;&amp;#x767E;&amp;#x79D1;&amp;#x5168;&amp;#x4E66;&lt;/a&gt;&amp;#xFF0C;Wikipedia&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://zh.wikipedia.org/wiki/%E5%A4%8D%E5%B9%B3%E9%9D%A2&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;&amp;#x590D;&amp;#x5E73;&amp;#x9762; - &amp;#x7EF4;&amp;#x57FA;&amp;#x767E;&amp;#x79D1;&amp;#xFF0C;&amp;#x81EA;&amp;#x7531;&amp;#x7684;&amp;#x767E;&amp;#x79D1;&amp;#x5168;&amp;#x4E66;&lt;/a&gt;&amp;#xFF0C;Wikipedia&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://zh.wikipedia.org/wiki/%E5%A4%8D%E6%95%B0_(%E6%95%B0%E5%AD%A6)&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;&amp;#x590D;&amp;#x6570; (&amp;#x6570;&amp;#x5B66;) - &amp;#x7EF4;&amp;#x57FA;&amp;#x767E;&amp;#x79D1;&amp;#xFF0C;&amp;#x81EA;&amp;#x7531;&amp;#x7684;&amp;#x767E;&amp;#x79D1;&amp;#x5168;&amp;#x4E66;&lt;/a&gt;&amp;#xFF0C;Wikipedia&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://zh.wikipedia.org/wiki/%E5%BF%AB%E9%80%9F%E5%82%85%E9%87%8C%E5%8F%B6%E5%8F%98%E6%8D%A2&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;&amp;#x5FEB;&amp;#x901F;&amp;#x5085;&amp;#x91CC;&amp;#x53F6;&amp;#x53D8;&amp;#x6362; - &amp;#x7EF4;&amp;#x57FA;&amp;#x767E;&amp;#x79D1;&amp;#xFF0C;&amp;#x81EA;&amp;#x7531;&amp;#x7684;&amp;#x767E;&amp;#x79D1;&amp;#x5168;&amp;#x4E66;&lt;/a&gt;&amp;#xFF0C;Wikipedia&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://zyk1997.github.io/2015/06/08/FFT/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;FFT &amp;amp; NTT | ZYK1997&lt;/a&gt;&amp;#xFF0C;ZYK1997&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://blog.csdn.net/fuxey/article/details/50840881&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;BZOJ 3992 SDOI2015 &amp;#x5E8F;&amp;#x5217;&amp;#x7EDF;&amp;#x8BA1; - Fuxey - &amp;#x535A;&amp;#x5BA2;&amp;#x9891;&amp;#x9053; - CSDN.NET&lt;/a&gt;&amp;#xFF0C;Fuxey&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://blog.miskcoo.com/2015/04/polynomial-multiplication-and-fast-fourier-transform&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;&amp;#x4ECE;&amp;#x591A;&amp;#x9879;&amp;#x5F0F;&amp;#x4E58;&amp;#x6CD5;&amp;#x5230;&amp;#x5FEB;&amp;#x901F;&amp;#x5085;&amp;#x91CC;&amp;#x53F6;&amp;#x53D8;&amp;#x6362; - Miskcoo&amp;#x2019;s Space&lt;/a&gt;&amp;#xFF0C;Miskcoo&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.cnblogs.com/tmzbot/p/4320955.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;OI &amp;#x4E2D;&amp;#x7684; FFT - zball - &amp;#x535A;&amp;#x5BA2;&amp;#x56ED;&lt;/a&gt;&amp;#xFF0C;zball&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://pan.baidu.com/wap/album/file?uk=3325080974&amp;amp;album_id=2474841267539644259&amp;amp;fsid=845742707277510&amp;amp;adapt=pc&amp;amp;fr=ftw&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Fourier transform&lt;/a&gt;&amp;#xFF0C;&amp;#x90ED;&amp;#x6653;&amp;#x65ED;&lt;/li&gt;
&lt;/ul&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x5FEB;&amp;#x901F;&amp;#x5085;&amp;#x91CC;&amp;#x53F6;&amp;#x53D8;&amp;#x6362;&amp;#xFF08;Fast Fourier Transform&amp;#xFF0C;FFT&amp;#xFF09;&amp;#x662F;&amp;#x4E00;&amp;#x79CD;&amp;#x53EF;&amp;#x5728; $ O(n \log n) $ &amp;#x65F6;&amp;#x95F4;&amp;#x5185;&amp;#x5B8C;&amp;#x6210;&amp;#x7684;&amp;#x79BB;&amp;#x6563;&amp;#x5085;&amp;#x91CC;&amp;#x53F6;&amp;#x53D8;&amp;#x6362;&amp;#xFF08;Discrete Fourier transform&amp;#xFF0C;DFT&amp;#xFF09;&amp;#x7B97;&amp;#x6CD5;&amp;#xFF0C;&amp;#x5728; OI &amp;#x4E2D;&amp;#x7684;&amp;#x4E3B;&amp;#x8981;&amp;#x5E94;&amp;#x7528;&amp;#x4E4B;&amp;#x4E00;&amp;#x662F;&amp;#x52A0;&amp;#x901F;&amp;#x591A;&amp;#x9879;&amp;#x5F0F;&amp;#x4E58;&amp;#x6CD5;&amp;#x7684;&amp;#x8BA1;&amp;#x7B97;&amp;#x3002;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="多项式" scheme="https://blog.menci.moe/tag/%E5%A4%9A%E9%A1%B9%E5%BC%8F/"/>
    
      <category term="学习笔记" scheme="https://blog.menci.moe/tag/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
      <category term="快速傅里叶变换" scheme="https://blog.menci.moe/tag/%E5%BF%AB%E9%80%9F%E5%82%85%E9%87%8C%E5%8F%B6%E5%8F%98%E6%8D%A2/"/>
    
      <category term="数学" scheme="https://blog.menci.moe/tag/%E6%95%B0%E5%AD%A6/"/>
    
      <category term="算法模板" scheme="https://blog.menci.moe/tag/%E7%AE%97%E6%B3%95%E6%A8%A1%E6%9D%BF/"/>
    
  </entry>
  
  <entry>
    <title>「UVa 11021」Tribles - 概率与期望</title>
    <link href="https://blog.menci.moe/uva-11021/"/>
    <id>https://blog.menci.moe/uva-11021/</id>
    <published>2016-05-31T12:05:00.000Z</published>
    <updated>2016-06-02T14:23:15.000Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x6709; $ k $ &amp;#x4E2A; Tribles&amp;#xFF0C;&amp;#x6BCF;&amp;#x4E2A; Trible &amp;#x53EA;&amp;#x80FD;&amp;#x5B58;&amp;#x6D3B;&amp;#x4E00;&amp;#x5929;&amp;#xFF0C;&amp;#x4F46;&amp;#x5728;&amp;#x6B7B;&amp;#x4EA1;&amp;#x4E4B;&amp;#x524D;&amp;#xFF0C;&amp;#x6BCF;&amp;#x4E2A; Trible &amp;#x6709; $ p_i $ &amp;#x7684;&amp;#x6982;&amp;#x7387;&amp;#x7E41;&amp;#x884D;&amp;#x51FA; $ i $ &amp;#x4E2A; Tribles&amp;#x3002;&amp;#x6C42; $ m $ &amp;#x5929;&amp;#x4E4B;&amp;#x540E;&amp;#x6240;&amp;#x6709; Tribles &amp;#x5168;&amp;#x90E8;&amp;#x6B7B;&amp;#x4EA1;&amp;#x7684;&amp;#x6982;&amp;#x7387;&amp;#x3002;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;&amp;#x94FE;&amp;#x63A5;&quot;&gt;&amp;#x94FE;&amp;#x63A5;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;https://uva.onlinejudge.org/index.php?option=com_onlinejudge&amp;amp;Itemid=8&amp;amp;category=481&amp;amp;page=show_problem&amp;amp;problem=1962&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;UVa 11021&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://cogs.top/cogs/problem/problem.php?pid=1487&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;COGS 1487&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x9898;&amp;#x89E3;&quot;&gt;&amp;#x9898;&amp;#x89E3;&lt;/h3&gt;
&lt;p&gt;&amp;#x8BBE; $ f(i) $ &amp;#x4E3A;&amp;#x4E00;&amp;#x4E2A; Trible &amp;#x7ECF;&amp;#x8FC7; $ i $ &amp;#x5929;&amp;#x540E;&amp;#x5168;&amp;#x90E8;&amp;#x6B7B;&amp;#x4EA1;&amp;#x7684;&amp;#x6982;&amp;#x7387;&amp;#xFF0C;&amp;#x5219; $ x $ &amp;#x4E2A; Trible &amp;#x7ECF;&amp;#x8FC7; $ i $ &amp;#x5929;&amp;#x540E;&amp;#x5168;&amp;#x90E8;&amp;#x6B7B;&amp;#x4EA1;&amp;#x7684;&amp;#x6982;&amp;#x7387;&amp;#x4E3A; $ f(i) ^ x $&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x6839;&amp;#x636E;&amp;#x9898;&amp;#x610F;&amp;#xFF0C;&amp;#x6BCF;&amp;#x4E2A; Trible &amp;#x6BCF;&amp;#x5929;&amp;#x7684;&amp;#x7E41;&amp;#x884D;&amp;#x884C;&amp;#x4E3A;&amp;#x5171;&amp;#x5206;&amp;#x4E3A; $ n $ &amp;#x79CD;&amp;#x60C5;&amp;#x51B5;&amp;#xFF0C;&amp;#x6BCF;&amp;#x4E00;&amp;#x79CD;&amp;#x60C5;&amp;#x51B5;&amp;#x53D1;&amp;#x751F;&amp;#x7684;&amp;#x6982;&amp;#x7387;&amp;#x4E58;&amp;#x4EE5;&amp;#x7E41;&amp;#x884D;&amp;#x51FA;&amp;#x7684; Tribles &amp;#x5728;&amp;#x5269;&amp;#x4F59;&amp;#x7684; $ i - 1 $ &amp;#x5929;&amp;#x5168;&amp;#x90E8;&amp;#x6B7B;&amp;#x4EA1;&amp;#x7684;&amp;#x6982;&amp;#x7387;&amp;#x7684;&amp;#x603B;&amp;#x548C;&amp;#x5373;&amp;#x4E3A;&amp;#x7ED3;&amp;#x679C;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x8FB9;&amp;#x754C;&amp;#x6761;&amp;#x4EF6;&amp;#x4E3A; $ f(0) = 1 $&amp;#x3002;&lt;/p&gt;
&lt;p&gt;$$ f(i) = \sum\limits_{j = 0} ^ {n - 1} f(i - 1) ^ j \times p(j) $$&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x4EE3;&amp;#x7801;&quot;&gt;&amp;#x4EE3;&amp;#x7801;&lt;/h3&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cmath&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;algorithm&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXN = &lt;span class=&quot;number&quot;&gt;1000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXK = &lt;span class=&quot;number&quot;&gt;1000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXM = &lt;span class=&quot;number&quot;&gt;1000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; t, n, k, m;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;t);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= t; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d %d&amp;quot;&lt;/span&gt;, &amp;amp;n, &amp;amp;k, &amp;amp;m);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt; p[MAXN], f[MAXK + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%lf&amp;quot;&lt;/span&gt;, &amp;amp;p[i]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::fill(f, f + m + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        f[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;] = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= m; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; j = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; j &amp;lt; n; j++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                f[i] += p[j] * &lt;span class=&quot;built_in&quot;&gt;pow&lt;/span&gt;(f[i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;], j);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;Case #%d: %.7lf\n&amp;quot;&lt;/span&gt;, i, &lt;span class=&quot;built_in&quot;&gt;pow&lt;/span&gt;(f[m], k));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x6709; $ k $ &amp;#x4E2A; Tribles&amp;#xFF0C;&amp;#x6BCF;&amp;#x4E2A; Trible &amp;#x53EA;&amp;#x80FD;&amp;#x5B58;&amp;#x6D3B;&amp;#x4E00;&amp;#x5929;&amp;#xFF0C;&amp;#x4F46;&amp;#x5728;&amp;#x6B7B;&amp;#x4EA1;&amp;#x4E4B;&amp;#x524D;&amp;#xFF0C;&amp;#x6BCF;&amp;#x4E2A; Trible &amp;#x6709; $ p_i $ &amp;#x7684;&amp;#x6982;&amp;#x7387;&amp;#x7E41;&amp;#x884D;&amp;#x51FA; $ i $ &amp;#x4E2A; Tribles&amp;#x3002;&amp;#x6C42; $ m $ &amp;#x5929;&amp;#x4E4B;&amp;#x540E;&amp;#x6240;&amp;#x6709; Tribles &amp;#x5168;&amp;#x90E8;&amp;#x6B7B;&amp;#x4EA1;&amp;#x7684;&amp;#x6982;&amp;#x7387;&amp;#x3002;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="COGS" scheme="https://blog.menci.moe/tag/cogs/"/>
    
      <category term="DP" scheme="https://blog.menci.moe/tag/dp/"/>
    
      <category term="UVa" scheme="https://blog.menci.moe/tag/uva/"/>
    
      <category term="数学" scheme="https://blog.menci.moe/tag/%E6%95%B0%E5%AD%A6/"/>
    
      <category term="概率与期望" scheme="https://blog.menci.moe/tag/%E6%A6%82%E7%8E%87%E4%B8%8E%E6%9C%9F%E6%9C%9B/"/>
    
  </entry>
  
  <entry>
    <title>「BZOJ 4318」OSU! - 概率与期望</title>
    <link href="https://blog.menci.moe/bzoj-4318/"/>
    <id>https://blog.menci.moe/bzoj-4318/</id>
    <published>2016-05-31T09:32:00.000Z</published>
    <updated>2016-06-02T14:23:15.000Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x6211;&amp;#x4EEC;&amp;#x53EF;&amp;#x4EE5;&amp;#x628A; osu! &amp;#x7684;&amp;#x89C4;&amp;#x5219;&amp;#x7B80;&amp;#x5316;&amp;#x4E0E;&amp;#x6539;&amp;#x7F16;&amp;#x6210;&amp;#x4EE5;&amp;#x4E0B;&amp;#x7684;&amp;#x6837;&amp;#x5B50;:&lt;/p&gt;
&lt;p&gt;&amp;#x4E00;&amp;#x5171;&amp;#x6709; $ n $ &amp;#x6B21;&amp;#x64CD;&amp;#x4F5C;&amp;#xFF0C;&amp;#x6BCF;&amp;#x6B21;&amp;#x64CD;&amp;#x4F5C;&amp;#x53EA;&amp;#x6709;&amp;#x6210;&amp;#x529F;&amp;#x4E0E;&amp;#x5931;&amp;#x8D25;&amp;#x4E4B;&amp;#x5206;&amp;#xFF0C;&amp;#x6210;&amp;#x529F;&amp;#x5BF9;&amp;#x5E94; $ 1 $&amp;#xFF0C;&amp;#x5931;&amp;#x8D25;&amp;#x5BF9;&amp;#x5E94; $ 0 $&amp;#xFF0C;$ n $ &amp;#x6B21;&amp;#x64CD;&amp;#x4F5C;&amp;#x5BF9;&amp;#x5E94;&amp;#x4E3A; $ 1 $ &amp;#x4E2A;&amp;#x957F;&amp;#x5EA6;&amp;#x4E3A; $ n $ &amp;#x7684; 01 &amp;#x4E32;&amp;#x3002;&amp;#x5728;&amp;#x8FD9;&amp;#x4E2A;&amp;#x4E32;&amp;#x4E2D;&amp;#x8FDE;&amp;#x7EED;&amp;#x7684; $ x $ &amp;#x4E2A; $ 1 $ &amp;#x53EF;&amp;#x4EE5;&amp;#x8D21;&amp;#x732E; $ x ^ 3 $ &amp;#x7684;&amp;#x5206;&amp;#x6570;&amp;#xFF0C;&amp;#x8FD9; $ x $ &amp;#x4E2A; $ 1 $ &amp;#x4E0D;&amp;#x80FD;&amp;#x88AB;&amp;#x5176;&amp;#x4ED6;&amp;#x8FDE;&amp;#x7EED;&amp;#x7684; $ 1 $ &amp;#x6240;&amp;#x5305;&amp;#x542B;&amp;#xFF08;&amp;#x4E5F;&amp;#x5C31;&amp;#x662F;&amp;#x6781;&amp;#x957F;&amp;#x7684;&amp;#x4E00;&amp;#x4E32; $ 1 $&amp;#xFF09;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x73B0;&amp;#x5728;&amp;#x7ED9;&amp;#x51FA; $ n $&amp;#xFF0C;&amp;#x4EE5;&amp;#x53CA;&amp;#x6BCF;&amp;#x4E2A;&amp;#x64CD;&amp;#x4F5C;&amp;#x7684;&amp;#x6210;&amp;#x529F;&amp;#x7387;&amp;#xFF0C;&amp;#x8BF7;&amp;#x4F60;&amp;#x8F93;&amp;#x51FA;&amp;#x671F;&amp;#x671B;&amp;#x5206;&amp;#x6570;&amp;#x3002;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;&amp;#x94FE;&amp;#x63A5;&quot;&gt;&amp;#x94FE;&amp;#x63A5;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://www.lydsy.com/JudgeOnline/problem.php?id=4318&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;BZOJ 4318&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x9898;&amp;#x89E3;&quot;&gt;&amp;#x9898;&amp;#x89E3;&lt;/h3&gt;
&lt;p&gt;&amp;#x8BBE; $ f(i) $ &amp;#x8868;&amp;#x793A;&amp;#x524D; $ i $ &amp;#x6B21;&amp;#x64CD;&amp;#x4F5C;&amp;#x540E;&amp;#x7684;&amp;#x671F;&amp;#x671B;&amp;#x5F97;&amp;#x5206;&amp;#xFF0C;$ p(i) $ &amp;#x8868;&amp;#x793A;&amp;#x7B2C; $ i $ &amp;#x6B21;&amp;#x64CD;&amp;#x4F5C;&amp;#x6210;&amp;#x529F;&amp;#x7684;&amp;#x6982;&amp;#x7387;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x8003;&amp;#x8651;&amp;#x8FDE;&amp;#x7EED; $ 1 $ &amp;#x7684;&amp;#x957F;&amp;#x5EA6; $ x $ &amp;#x7684;&amp;#x53D8;&amp;#x5316;&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x7B2C; $ i $ &amp;#x6B21;&amp;#x6210;&amp;#x529F;&amp;#xFF0C;&amp;#x5219; $ x_i = x_{i - 1} + 1 $&amp;#xFF0C;&amp;#x8003;&amp;#x8651;&amp;#x5176;&amp;#x5BF9;&amp;#x5F97;&amp;#x5206; $ x ^ 3 $ &amp;#x7684;&amp;#x5F71;&amp;#x54CD;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;$$ (x + 1) ^ 3 - x ^ 3 = 3x ^ 2 + 3x + 1 $$&lt;/p&gt;
&lt;p&gt;&amp;#x6839;&amp;#x636E;&amp;#x671F;&amp;#x671B;&amp;#x7684;&amp;#x7EBF;&amp;#x6027;&amp;#x6027;&amp;#xFF0C;&amp;#x6211;&amp;#x4EEC;&amp;#x53EA;&amp;#x9700;&amp;#x8981;&amp;#x6C42;&amp;#x51FA; $ E_{x ^ 2} $ &amp;#x548C; $ E_x $&amp;#xFF0C;&amp;#x5373;&amp;#x53EF;&amp;#x5F97;&amp;#x5230;&lt;/p&gt;
&lt;p&gt;$$ E_{(x + 1) ^ 3 - x ^ 3} = 3E_{x ^ 2} + 3E_x + 1 $$&lt;/p&gt;
&lt;p&gt;&amp;#x4E58;&amp;#x4E0A;&amp;#x6210;&amp;#x529F;&amp;#x7684;&amp;#x6982;&amp;#x7387;&amp;#xFF0C;&amp;#x5373;&amp;#x4E3A;&amp;#x8BE5;&amp;#x6B21;&amp;#x64CD;&amp;#x4F5C;&amp;#x7684;&amp;#x671F;&amp;#x671B;&amp;#x5206;&amp;#x6570;&amp;#x589E;&amp;#x91CF;&amp;#xFF08;&amp;#x76F8;&amp;#x5BF9;&amp;#x4E8E;&amp;#x7B2C; $ i - 1 $ &amp;#x6B21;&amp;#xFF09;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;$$ f(i) = f(i - 1) + (3E_{x ^ 2}(i) + 3E_x(i) + 1) \times p(i) $$&lt;/p&gt;
&lt;p&gt;&amp;#x8003;&amp;#x8651;&amp;#x5982;&amp;#x4F55;&amp;#x7EF4;&amp;#x62A4; $ E_{x ^ 2}(i) $ &amp;#x4E0E; $ E_x(i) $&amp;#xFF0C;&amp;#x4ECD;&amp;#x65E7;&amp;#x662F;&amp;#x8003;&amp;#x8651;&amp;#x671F;&amp;#x671B;&amp;#x7684;&amp;#x7EBF;&amp;#x6027;&amp;#x6027;&amp;#xFF0C;&amp;#x5C06;&amp;#x5F0F;&amp;#x5B50;&amp;#x5C55;&amp;#x5F00;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x9996;&amp;#x5148;&amp;#xFF0C;&amp;#x663E;&amp;#x7136;&lt;/p&gt;
&lt;p&gt;$$ E_{x + 1} = E_x + 1 $$&lt;/p&gt;
&lt;p&gt;&amp;#x6709; $ p(i) $ &amp;#x7684;&amp;#x6982;&amp;#x7387;&amp;#x6BD4;&amp;#x4E0A;&amp;#x4E00;&amp;#x6B21;&amp;#x64CD;&amp;#x4F5C;&amp;#x591A; $ 1 $ &amp;#x6B21;&amp;#xFF0C;&amp;#x6709; $ 1 - p(i) $ &amp;#x7684;&amp;#x6982;&amp;#x7387;&amp;#x76F4;&amp;#x63A5;&amp;#x6210;&amp;#x4E3A; $ 0 $&amp;#xFF0C;&amp;#x5373;&lt;/p&gt;
&lt;p&gt;$$ E_x(i) = (E_x(i - 1) + 1) \times p(i) $$&lt;/p&gt;
&lt;p&gt;&amp;#x7C7B;&amp;#x4F3C;&amp;#x7684;&amp;#xFF0C;&amp;#x6709;&lt;/p&gt;
&lt;p&gt;$$ E_{(x + 1) ^ 2} = E_{x ^ 2} + 2E_{x} + 1 $$&lt;/p&gt;
&lt;p&gt;&amp;#x5373;&lt;/p&gt;
&lt;p&gt;$$ E_{x ^ 2}(i) = E_{x ^ 2}(i - 1) + 2E_{x}(i - 1) + 1 $$&lt;/p&gt;
&lt;p&gt;&amp;#x81F3;&amp;#x6B64;&amp;#xFF0C;$ E_{x ^ 2}(i) $&amp;#x3001;$ E_{x}(i) $&amp;#x3001;$ f(i) $ &amp;#x5747;&amp;#x53EF;&amp;#x5728;&amp;#x7EBF;&amp;#x6027;&amp;#x65F6;&amp;#x95F4;&amp;#x5185;&amp;#x9012;&amp;#x63A8;&amp;#x5F97;&amp;#x5230;&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x4EE3;&amp;#x7801;&quot;&gt;&amp;#x4EE3;&amp;#x7801;&lt;/h3&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cmath&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXN = &lt;span class=&quot;number&quot;&gt;100000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt; p[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;], f[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt; ex1[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;], ex2[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;dp&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    f[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;] = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ex1[i] = (ex1[i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;] + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) * p[i];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ex2[i] = (ex2[i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;] + &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; * ex1[i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;] + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) * p[i];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt; t = (&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt; * ex2[i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;] + &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt; * ex1[i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;] + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) * p[i];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        f[i] = f[i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;] + t;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;n);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= n; i++) &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%lf&amp;quot;&lt;/span&gt;, &amp;amp;p[i]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    dp();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%.1lf\n&amp;quot;&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;floor&lt;/span&gt;(f[n] * &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt; + &lt;span class=&quot;number&quot;&gt;0.5&lt;/span&gt;) / &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x6211;&amp;#x4EEC;&amp;#x53EF;&amp;#x4EE5;&amp;#x628A; osu! &amp;#x7684;&amp;#x89C4;&amp;#x5219;&amp;#x7B80;&amp;#x5316;&amp;#x4E0E;&amp;#x6539;&amp;#x7F16;&amp;#x6210;&amp;#x4EE5;&amp;#x4E0B;&amp;#x7684;&amp;#x6837;&amp;#x5B50;:&lt;/p&gt;
&lt;p&gt;&amp;#x4E00;&amp;#x5171;&amp;#x6709; $ n $ &amp;#x6B21;&amp;#x64CD;&amp;#x4F5C;&amp;#xFF0C;&amp;#x6BCF;&amp;#x6B21;&amp;#x64CD;&amp;#x4F5C;&amp;#x53EA;&amp;#x6709;&amp;#x6210;&amp;#x529F;&amp;#x4E0E;&amp;#x5931;&amp;#x8D25;&amp;#x4E4B;&amp;#x5206;&amp;#xFF0C;&amp;#x6210;&amp;#x529F;&amp;#x5BF9;&amp;#x5E94; $ 1 $&amp;#xFF0C;&amp;#x5931;&amp;#x8D25;&amp;#x5BF9;&amp;#x5E94; $ 0 $&amp;#xFF0C;$ n $ &amp;#x6B21;&amp;#x64CD;&amp;#x4F5C;&amp;#x5BF9;&amp;#x5E94;&amp;#x4E3A; $ 1 $ &amp;#x4E2A;&amp;#x957F;&amp;#x5EA6;&amp;#x4E3A; $ n $ &amp;#x7684; 01 &amp;#x4E32;&amp;#x3002;&amp;#x5728;&amp;#x8FD9;&amp;#x4E2A;&amp;#x4E32;&amp;#x4E2D;&amp;#x8FDE;&amp;#x7EED;&amp;#x7684; $ x $ &amp;#x4E2A; $ 1 $ &amp;#x53EF;&amp;#x4EE5;&amp;#x8D21;&amp;#x732E; $ x ^ 3 $ &amp;#x7684;&amp;#x5206;&amp;#x6570;&amp;#xFF0C;&amp;#x8FD9; $ x $ &amp;#x4E2A; $ 1 $ &amp;#x4E0D;&amp;#x80FD;&amp;#x88AB;&amp;#x5176;&amp;#x4ED6;&amp;#x8FDE;&amp;#x7EED;&amp;#x7684; $ 1 $ &amp;#x6240;&amp;#x5305;&amp;#x542B;&amp;#xFF08;&amp;#x4E5F;&amp;#x5C31;&amp;#x662F;&amp;#x6781;&amp;#x957F;&amp;#x7684;&amp;#x4E00;&amp;#x4E32; $ 1 $&amp;#xFF09;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x73B0;&amp;#x5728;&amp;#x7ED9;&amp;#x51FA; $ n $&amp;#xFF0C;&amp;#x4EE5;&amp;#x53CA;&amp;#x6BCF;&amp;#x4E2A;&amp;#x64CD;&amp;#x4F5C;&amp;#x7684;&amp;#x6210;&amp;#x529F;&amp;#x7387;&amp;#xFF0C;&amp;#x8BF7;&amp;#x4F60;&amp;#x8F93;&amp;#x51FA;&amp;#x671F;&amp;#x671B;&amp;#x5206;&amp;#x6570;&amp;#x3002;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="BZOJ" scheme="https://blog.menci.moe/tag/bzoj/"/>
    
      <category term="DP" scheme="https://blog.menci.moe/tag/dp/"/>
    
      <category term="数学" scheme="https://blog.menci.moe/tag/%E6%95%B0%E5%AD%A6/"/>
    
      <category term="概率与期望" scheme="https://blog.menci.moe/tag/%E6%A6%82%E7%8E%87%E4%B8%8E%E6%9C%9F%E6%9C%9B/"/>
    
  </entry>
  
  <entry>
    <title>「省队集训 2016」Play with array - 块状链表</title>
    <link href="https://blog.menci.moe/20160527-array/"/>
    <id>https://blog.menci.moe/20160527-array/</id>
    <published>2016-05-27T15:55:00.000Z</published>
    <updated>2016-06-02T14:23:15.000Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x6709;&amp;#x4E00;&amp;#x4E2A;&amp;#x957F;&amp;#x5EA6;&amp;#x4E3A; $ n $ &amp;#x7684;&amp;#x6570;&amp;#x5217;&amp;#xFF0C;&amp;#x652F;&amp;#x6301;&amp;#x4EE5;&amp;#x4E0B;&amp;#x4E24;&amp;#x79CD;&amp;#x64CD;&amp;#x4F5C;&amp;#xFF1A;&lt;/p&gt;
&lt;ol style=&quot;list-style-type: decimal&quot;&gt;
&lt;li&gt;&amp;#x5C06; $ a_r $ &amp;#x79FB;&amp;#x52A8;&amp;#x5230; $ a_l $ &amp;#x7684;&amp;#x524D;&amp;#x9762;&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x67E5;&amp;#x8BE2; $ [l,\ r] $ &amp;#x4E2D; $ k $ &amp;#x7684;&amp;#x51FA;&amp;#x73B0;&amp;#x6B21;&amp;#x6570;&amp;#x3002;&lt;/li&gt;
&lt;/ol&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;&amp;#x9898;&amp;#x89E3;&quot;&gt;&amp;#x9898;&amp;#x89E3;&lt;/h3&gt;
&lt;p&gt;&amp;#x5C06;&amp;#x5E8F;&amp;#x5217;&amp;#x6309;&amp;#x7167; $ O(\sqrt n) $ &amp;#x5206;&amp;#x5757;&amp;#xFF0C;&amp;#x7EF4;&amp;#x62A4;&amp;#x5757;&amp;#x72B6;&amp;#x94FE;&amp;#x8868;&amp;#xFF0C;&amp;#x5C06;&amp;#x6BCF;&amp;#x6B21;&amp;#x4FEE;&amp;#x6539;&amp;#x8F6C;&amp;#x5316;&amp;#x4E3A;&amp;#x4E00;&amp;#x6B21;&amp;#x63D2;&amp;#x5165;&amp;#x4E00;&amp;#x6B21;&amp;#x5220;&amp;#x9664;&amp;#xFF0C;&amp;#x6BCF;&amp;#x4E2A;&amp;#x5757;&amp;#x8BB0;&amp;#x5F55;&amp;#x6BCF;&amp;#x4E2A;&amp;#x6570;&amp;#x51FA;&amp;#x73B0;&amp;#x6B21;&amp;#x6570;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x6BCF;&amp;#x6B21;&amp;#x67E5;&amp;#x8BE2;&amp;#x65F6;&amp;#xFF0C;&amp;#x5C06; $ [l,\ r] $ &amp;#x7684;&amp;#x7B54;&amp;#x6848;&amp;#x8F6C;&amp;#x5316;&amp;#x4E3A; $ [1,\ r] $ &amp;#x7684;&amp;#x7B54;&amp;#x6848;&amp;#x51CF;&amp;#x53BB; $ [1,\ l - 1] $ &amp;#x7684;&amp;#x7B54;&amp;#x6848;&amp;#x3002;&amp;#x5BF9;&amp;#x4E8E;&amp;#x5757;&amp;#x5185;&amp;#x90E8;&amp;#x5206;&amp;#x76F4;&amp;#x63A5;&amp;#x67E5;&amp;#x8BE2;&amp;#xFF0C;&amp;#x5757;&amp;#x5916;&amp;#x90E8;&amp;#x5206;&amp;#x66B4;&amp;#x529B;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x65F6;&amp;#x95F4;&amp;#x590D;&amp;#x6742;&amp;#x5EA6;&amp;#x3001;&amp;#x7A7A;&amp;#x95F4;&amp;#x590D;&amp;#x6742;&amp;#x5EA6;&amp;#x5747;&amp;#x4E3A; $ O(n \sqrt n) $&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x4EE3;&amp;#x7801;&quot;&gt;&amp;#x4EE3;&amp;#x7801;&lt;/h3&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;93&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;94&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;95&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;96&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;97&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;98&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;99&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;100&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;101&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;102&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;103&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;104&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;105&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;106&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;107&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;108&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;109&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;110&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;111&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;112&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;113&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;114&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;115&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;116&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;117&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;118&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;119&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;120&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;121&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;122&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;123&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;124&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;125&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;126&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;127&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;128&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;129&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;130&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;131&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;132&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;133&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;134&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;135&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;136&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;137&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;138&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;139&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;140&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;141&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;142&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;143&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;144&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;145&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;146&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;147&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;148&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;149&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;150&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;151&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;152&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;153&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;154&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;155&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;156&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;157&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;158&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;159&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;160&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;161&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;162&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;163&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;164&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;165&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;166&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;167&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;168&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;169&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;170&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cmath&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstring&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;list&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;vector&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;algorithm&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;stack&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;define&lt;/span&gt; dprintf(format, ...) fprintf(stderr, format, __VA_ARGS__)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXN = &lt;span class=&quot;number&quot;&gt;100000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXN_SQRT = &lt;span class=&quot;number&quot;&gt;316&lt;/span&gt; + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXM = &lt;span class=&quot;number&quot;&gt;100000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, m, a[MAXN];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; BlockList {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Block {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;list&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;&amp;gt; l;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;vector&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;&amp;gt; sum;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Block() : sum(n) {}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;left&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; k, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; pos)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; res = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;list&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;&amp;gt;::const_iterator it = l.begin();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt;= pos; i++) &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (*it++ == k) res++;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; res;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    };&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;list&lt;/span&gt;&amp;lt;Block&amp;gt; blocks;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; blockCount, blockSize;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; *a, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        blockCount = &lt;span class=&quot;built_in&quot;&gt;floor&lt;/span&gt;(&lt;span class=&quot;built_in&quot;&gt;sqrt&lt;/span&gt;(n) + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;), blockSize = &lt;span class=&quot;built_in&quot;&gt;ceil&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;static_cast&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt;&amp;gt;(n) / blockCount);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// dprintf(&amp;quot;BlockList::build(): blockCount = %d, blockSize = %d\n&amp;quot;, blockCount, blockSize);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        blocks.resize(blockCount);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;list&lt;/span&gt;&amp;lt;Block&amp;gt;::iterator b = blocks.begin();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, j = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; blockCount; i++, b++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; k = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; k &amp;lt;= blockSize &amp;amp;&amp;amp; j &amp;lt; n; k++, j++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                b-&amp;gt;sum[a[j]]++;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                b-&amp;gt;l.push_back(a[j]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;erase&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; pos)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;list&lt;/span&gt;&amp;lt;Block&amp;gt;::iterator b = blocks.begin(); b != blocks.end(); b++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (pos &amp;lt; b-&amp;gt;l.size()) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;list&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;&amp;gt;::iterator it = b-&amp;gt;l.begin();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::advance(it, pos);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; x = *it;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                b-&amp;gt;sum[*it]--;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                b-&amp;gt;l.erase(it);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; x;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            } &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; pos -= b-&amp;gt;l.size();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;throw&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;insert&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; pos, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; x)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;list&lt;/span&gt;&amp;lt;Block&amp;gt;::iterator b = blocks.begin(); b != blocks.end(); b++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (pos &amp;lt; b-&amp;gt;l.size()) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;list&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;&amp;gt;::iterator it = b-&amp;gt;l.begin();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::advance(it, pos);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                b-&amp;gt;sum[x]++;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                b-&amp;gt;l.insert(it, x);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            } &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; pos -= b-&amp;gt;l.size();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;throw&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; pos, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; k)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; ans = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;list&lt;/span&gt;&amp;lt;Block&amp;gt;::iterator b = blocks.begin(); b != blocks.end(); b++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (pos &amp;lt; b-&amp;gt;l.size()) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                ans += b-&amp;gt;left(k, pos);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            } &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                pos -= b-&amp;gt;l.size();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                ans += b-&amp;gt;sum[k];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; ans;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;mergeNext&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;list&lt;/span&gt;&amp;lt;Block&amp;gt;::iterator b)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;list&lt;/span&gt;&amp;lt;Block&amp;gt;::iterator next = b;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        next++;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (next == blocks.end()) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;list&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;&amp;gt;::const_iterator it = next-&amp;gt;l.begin(); it != next-&amp;gt;l.end(); it++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            b-&amp;gt;l.push_back(*it);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            b-&amp;gt;sum[*it]++;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        blocks.erase(next);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;list&lt;/span&gt;&amp;lt;Block&amp;gt;::iterator b)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;list&lt;/span&gt;&amp;lt;Block&amp;gt;::iterator newBlock = blocks.insert(b, Block());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; b-&amp;gt;l.size() / &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &amp;amp;x = b-&amp;gt;l.front();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            newBlock-&amp;gt;l.push_back(x);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            newBlock-&amp;gt;sum[x]++;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            b-&amp;gt;sum[x]--;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            b-&amp;gt;l.pop_front();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;maintain&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;list&lt;/span&gt;&amp;lt;Block&amp;gt;::iterator b = blocks.begin(); b != blocks.end(); b++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (b-&amp;gt;l.size() &amp;lt;= blockSize / &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;) mergeNext(b);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (b-&amp;gt;l.size() &amp;gt;= blockSize * &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;) split(b);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;list&lt;/span&gt;&amp;lt;Block&amp;gt;::const_iterator b = blocks.begin(); b != blocks.end(); b++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            dprintf(&lt;span class=&quot;string&quot;&gt;&amp;quot;blockSize = %d\n&amp;quot;&lt;/span&gt;, b-&amp;gt;l.size());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;list&lt;/span&gt;&amp;lt;Block&amp;gt;::const_iterator b = blocks.begin(); b != blocks.end(); b++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;list&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;&amp;gt;::const_iterator it = b-&amp;gt;l.begin(); it != b-&amp;gt;l.end(); it++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                dprintf(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d &amp;quot;&lt;/span&gt;, *it + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        dprintf(&lt;span class=&quot;string&quot;&gt;&amp;quot;%c&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;apos;\n&amp;apos;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} &lt;span class=&quot;built_in&quot;&gt;list&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// freopen(&amp;quot;array.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// freopen(&amp;quot;array.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;n);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;a[i]), a[i]--;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;list&lt;/span&gt;.build(a, n);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// list.print();&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;m);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; m; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; t, l, r;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d %d&amp;quot;&lt;/span&gt;, &amp;amp;t, &amp;amp;l, &amp;amp;r), l--, r--;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (t == &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; x = &lt;span class=&quot;built_in&quot;&gt;list&lt;/span&gt;.erase(r);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;built_in&quot;&gt;list&lt;/span&gt;.insert(l, x);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;// list.print();&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;built_in&quot;&gt;list&lt;/span&gt;.maintain();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;// list.print();&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;// dprintf(&amp;quot;%c&amp;quot;, &amp;apos;\n&amp;apos;);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        } &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; k;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;k), k--;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; R = &lt;span class=&quot;built_in&quot;&gt;list&lt;/span&gt;.query(r, k), L = l == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; ? &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; : &lt;span class=&quot;built_in&quot;&gt;list&lt;/span&gt;.query(l - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, k);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d\n&amp;quot;&lt;/span&gt;, R - L);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    fclose(&lt;span class=&quot;built_in&quot;&gt;stdin&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    fclose(&lt;span class=&quot;built_in&quot;&gt;stdout&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// list.print();&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x6709;&amp;#x4E00;&amp;#x4E2A;&amp;#x957F;&amp;#x5EA6;&amp;#x4E3A; $ n $ &amp;#x7684;&amp;#x6570;&amp;#x5217;&amp;#xFF0C;&amp;#x652F;&amp;#x6301;&amp;#x4EE5;&amp;#x4E0B;&amp;#x4E24;&amp;#x79CD;&amp;#x64CD;&amp;#x4F5C;&amp;#xFF1A;&lt;/p&gt;
&lt;ol style=&quot;list-style-type: decimal&quot;&gt;
&lt;li&gt;&amp;#x5C06; $ a_r $ &amp;#x79FB;&amp;#x52A8;&amp;#x5230; $ a_l $ &amp;#x7684;&amp;#x524D;&amp;#x9762;&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x67E5;&amp;#x8BE2; $ [l,\ r] $ &amp;#x4E2D; $ k $ &amp;#x7684;&amp;#x51FA;&amp;#x73B0;&amp;#x6B21;&amp;#x6570;&amp;#x3002;&lt;/li&gt;
&lt;/ol&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="分块" scheme="https://blog.menci.moe/tag/%E5%88%86%E5%9D%97/"/>
    
      <category term="块状链表" scheme="https://blog.menci.moe/tag/%E5%9D%97%E7%8A%B6%E9%93%BE%E8%A1%A8/"/>
    
      <category term="数据结构" scheme="https://blog.menci.moe/tag/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
      <category term="省队集训" scheme="https://blog.menci.moe/tag/%E7%9C%81%E9%98%9F%E9%9B%86%E8%AE%AD/"/>
    
  </entry>
  
  <entry>
    <title>「BZOJ 3275」Number - 最小割</title>
    <link href="https://blog.menci.moe/bzoj-3275/"/>
    <id>https://blog.menci.moe/bzoj-3275/</id>
    <published>2016-05-23T13:50:00.000Z</published>
    <updated>2016-06-02T14:23:15.000Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x6709; $ N $ &amp;#x4E2A;&amp;#x6B63;&amp;#x6574;&amp;#x6570;&amp;#xFF0C;&amp;#x9700;&amp;#x8981;&amp;#x4ECE;&amp;#x4E2D;&amp;#x9009;&amp;#x51FA;&amp;#x4E00;&amp;#x4E9B;&amp;#x6570;&amp;#xFF0C;&amp;#x4F7F;&amp;#x8FD9;&amp;#x4E9B;&amp;#x6570;&amp;#x7684;&amp;#x548C;&amp;#x6700;&amp;#x5927;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x82E5;&amp;#x4E24;&amp;#x4E2A;&amp;#x6570; $ a,\ b $ &amp;#x540C;&amp;#x65F6;&amp;#x6EE1;&amp;#x8DB3;&amp;#x4EE5;&amp;#x4E0B;&amp;#x6761;&amp;#x4EF6;&amp;#xFF0C;&amp;#x5219; $ a,\ b $ &amp;#x4E0D;&amp;#x80FD;&amp;#x540C;&amp;#x65F6;&amp;#x88AB;&amp;#x9009;&amp;#x3002;&lt;/p&gt;
&lt;ol style=&quot;list-style-type: decimal&quot;&gt;
&lt;li&gt;&amp;#x5B58;&amp;#x5728;&amp;#x6B63;&amp;#x6574;&amp;#x6570; $ c $&amp;#xFF0C;&amp;#x4F7F; $ a ^ 2 + b ^ 2 = c ^ 2 $&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;$ \gcd(a,\ b) = 1 $&amp;#x3002;&lt;/li&gt;
&lt;/ol&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;&amp;#x94FE;&amp;#x63A5;&quot;&gt;&amp;#x94FE;&amp;#x63A5;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://www.lydsy.com/JudgeOnline/problem.php?id=3275&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;BZOJ 3275&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://cogs.top/cogs/problem/problem.php?pid=1389&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;COGS 1389&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x9898;&amp;#x89E3;&quot;&gt;&amp;#x9898;&amp;#x89E3;&lt;/h3&gt;
&lt;p&gt;&amp;#x5EFA;&amp;#x56FE;&amp;#xFF0C;&amp;#x628A;&amp;#x4E0D;&amp;#x80FD;&amp;#x540C;&amp;#x65F6;&amp;#x9009;&amp;#x62E9;&amp;#x7684;&amp;#x6570;&amp;#x5B57;&amp;#x8FDE;&amp;#x8FB9;&amp;#xFF0C;&amp;#x67D3;&amp;#x8272;&amp;#x540E;&amp;#x53D1;&amp;#x73B0;&amp;#x662F;&amp;#x4E8C;&amp;#x5206;&amp;#x56FE;&amp;#xFF0C;&amp;#x95EE;&amp;#x9898;&amp;#x8F6C;&amp;#x5316;&amp;#x4E3A;&amp;#x4E8C;&amp;#x5206;&amp;#x56FE;&amp;#x6700;&amp;#x5927;&amp;#x70B9;&amp;#x6743;&amp;#x72EC;&amp;#x7ACB;&amp;#x96C6;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x4ECE;&amp;#x6E90;&amp;#x70B9;&amp;#x5230;&amp;#x6240;&amp;#x6709; $ X $ &amp;#x70B9;&amp;#x8FDE;&amp;#x8FB9;&amp;#xFF0C;&amp;#x5BB9;&amp;#x91CF;&amp;#x4E3A;&amp;#x6570;&amp;#x5B57;&amp;#xFF0C;&amp;#x4ECE;&amp;#x6240;&amp;#x6709; $ Y $ &amp;#x70B9;&amp;#x5411;&amp;#x6C47;&amp;#x70B9;&amp;#x8FDE;&amp;#x8FB9;&amp;#xFF0C;&amp;#x5BB9;&amp;#x91CF;&amp;#x4E3A;&amp;#x6570;&amp;#x5B57;&amp;#xFF0C;&amp;#x4E0D;&amp;#x80FD;&amp;#x6210;&amp;#x5BF9;&amp;#x9009;&amp;#x62E9;&amp;#x6570;&amp;#x5B57;&amp;#xFF0C;&amp;#x4ECE; $ X $ &amp;#x70B9;&amp;#x5230; $ Y $ &amp;#x70B9;&amp;#x8FDE;&amp;#x8FB9;&amp;#xFF0C;&amp;#x5BB9;&amp;#x91CF;&amp;#x4E3A;&amp;#x6B63;&amp;#x65E0;&amp;#x7A77;&amp;#xFF0C;&amp;#x6C42;&amp;#x51FA;&amp;#x6700;&amp;#x5C0F;&amp;#x5272;&amp;#x5373;&amp;#x4E3A;&amp;#x635F;&amp;#x5931;&amp;#xFF0C;&amp;#x603B;&amp;#x548C;&amp;#x51CF;&amp;#x53BB;&amp;#x635F;&amp;#x5931;&amp;#x5373;&amp;#x4E3A;&amp;#x7B54;&amp;#x6848;&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x4EE3;&amp;#x7801;&quot;&gt;&amp;#x4EE3;&amp;#x7801;&lt;/h3&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;93&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;94&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;95&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;96&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;97&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;98&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;99&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;100&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;101&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;102&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;103&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;104&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;105&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;106&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;107&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;108&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;109&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;110&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;111&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;112&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;113&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;114&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;115&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;116&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;117&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;118&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;119&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;120&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;121&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;122&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;123&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;124&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;125&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;126&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;127&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;128&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;129&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;130&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;131&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;132&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;133&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;134&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;135&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;136&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;137&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;138&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;139&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;140&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;141&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;142&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;143&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;144&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;145&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;146&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;147&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;148&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;149&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;150&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;151&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;152&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;153&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;154&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;155&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;156&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;157&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;158&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;159&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;160&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;161&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;162&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;163&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;164&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;165&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;166&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;167&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;168&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;169&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;170&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cassert&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;climits&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cmath&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;algorithm&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;queue&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXN = &lt;span class=&quot;number&quot;&gt;3000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Node;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Edge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Node {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Edge *e, *c;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; l;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; x;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; color, v;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} N[MAXN + &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Edge {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Node *s, *t;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; f, c;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Edge *next, *r;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Edge(Node *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; s, Node *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; t, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; c) : s(s), t(t), f(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;), c(c), next(s-&amp;gt;e) {}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;};&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;addEdge&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; u, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; v, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; c)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    N[u].e = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Edge(&amp;amp;N[u], &amp;amp;N[v], c);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    N[v].e = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Edge(&amp;amp;N[v], &amp;amp;N[u], &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    (N[u].e-&amp;gt;r = N[v].e)-&amp;gt;r = N[u].e;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Dinic {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;makeLevelGraph&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Node *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; s, Node *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; t, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) N[i].l = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, N[i].c = N[i].e;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;queue&lt;/span&gt;&amp;lt;Node *&amp;gt; q;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        q.push(s);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        s-&amp;gt;l = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (!q.empty()) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Node *v = q.front();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            q.pop();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (Edge *e = v-&amp;gt;e; e; e = e-&amp;gt;next) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (e-&amp;gt;f &amp;lt; e-&amp;gt;c &amp;amp;&amp;amp; e-&amp;gt;t-&amp;gt;l == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    e-&amp;gt;t-&amp;gt;l = v-&amp;gt;l + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (e-&amp;gt;t == t) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; q.push(e-&amp;gt;t);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;findPath&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Node *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; s, Node *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; t, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; limit = LLONG_MAX)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (s == t) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; limit;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (Edge *&amp;amp;e = s-&amp;gt;c; e; e = e-&amp;gt;next) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (e-&amp;gt;f &amp;lt; e-&amp;gt;c &amp;amp;&amp;amp; e-&amp;gt;t-&amp;gt;l == s-&amp;gt;l + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; flow = findPath(e-&amp;gt;t, t, &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::min(limit, e-&amp;gt;c - e-&amp;gt;f));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (flow &amp;gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    e-&amp;gt;f += flow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    e-&amp;gt;r-&amp;gt;f -= flow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; flow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;operator&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; s, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; t, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; res = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (makeLevelGraph(&amp;amp;N[s], &amp;amp;N[t], n)) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; flow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; ((flow = findPath(&amp;amp;N[s], &amp;amp;N[t])) &amp;gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) res += flow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; res;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} dinic;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; flag[MAXN][MAXN];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;template&lt;/span&gt; &amp;lt;&lt;span class=&quot;keyword&quot;&gt;typename&lt;/span&gt; T&amp;gt; &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; T &lt;span class=&quot;title&quot;&gt;sqr&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; T x)&lt;/span&gt; &lt;/span&gt;{ &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; x * x; }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;template&lt;/span&gt; &amp;lt;&lt;span class=&quot;keyword&quot;&gt;typename&lt;/span&gt; T&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;isSquare&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; T x)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    T t = &lt;span class=&quot;keyword&quot;&gt;static_cast&lt;/span&gt;&amp;lt;T&amp;gt;(&lt;span class=&quot;built_in&quot;&gt;sqrt&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;static_cast&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt;&amp;gt;(x)));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; t * t == x;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;template&lt;/span&gt; &amp;lt;&lt;span class=&quot;keyword&quot;&gt;typename&lt;/span&gt; T&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; T &lt;span class=&quot;title&quot;&gt;gcd&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; T a, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; T b)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; !b ? a : gcd(b, a % b);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (N[i].v) &lt;span class=&quot;keyword&quot;&gt;continue&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;queue&lt;/span&gt;&amp;lt;Node *&amp;gt; q;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        q.push(&amp;amp;N[i]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        N[i].color = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        N[i].v = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (!q.empty()) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Node *v = q.front();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            q.pop();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (Edge *e = v-&amp;gt;e; e; e = e-&amp;gt;next) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!e-&amp;gt;t-&amp;gt;v) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    e-&amp;gt;t-&amp;gt;v = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    e-&amp;gt;t-&amp;gt;color = !v-&amp;gt;color;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    q.push(e-&amp;gt;t);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                } &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; assert(e-&amp;gt;t-&amp;gt;color != v-&amp;gt;color);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;clean&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Edge *next;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (Edge *&amp;amp;e = N[i].e; e; next = e-&amp;gt;next, &lt;span class=&quot;keyword&quot;&gt;delete&lt;/span&gt; e, e = next);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;n);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; sum = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%lld&amp;quot;&lt;/span&gt;, &amp;amp;N[i].x);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        sum += N[i].x;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; j = i + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; j &amp;lt;= n; j++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (isSquare(sqr(N[i].x) + sqr(N[j].x)) &amp;amp;&amp;amp; gcd(N[i].x, N[j].x) == &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                flag[i][j] = flag[j][i] = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                addEdge(i, j, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    color();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    clean();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; s = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, t = n + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (N[i].color) addEdge(s, i, N[i].x);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; addEdge(i, t, N[i].x);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; j = i + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; j &amp;lt;= n; j++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (flag[i][j]) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (N[i].color) addEdge(i, j, LLONG_MAX);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; addEdge(j, i, LLONG_MAX);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; maxFlow = dinic(s, t, n + &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%lld\n&amp;quot;&lt;/span&gt;, sum - maxFlow);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x6709; $ N $ &amp;#x4E2A;&amp;#x6B63;&amp;#x6574;&amp;#x6570;&amp;#xFF0C;&amp;#x9700;&amp;#x8981;&amp;#x4ECE;&amp;#x4E2D;&amp;#x9009;&amp;#x51FA;&amp;#x4E00;&amp;#x4E9B;&amp;#x6570;&amp;#xFF0C;&amp;#x4F7F;&amp;#x8FD9;&amp;#x4E9B;&amp;#x6570;&amp;#x7684;&amp;#x548C;&amp;#x6700;&amp;#x5927;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x82E5;&amp;#x4E24;&amp;#x4E2A;&amp;#x6570; $ a,\ b $ &amp;#x540C;&amp;#x65F6;&amp;#x6EE1;&amp;#x8DB3;&amp;#x4EE5;&amp;#x4E0B;&amp;#x6761;&amp;#x4EF6;&amp;#xFF0C;&amp;#x5219; $ a,\ b $ &amp;#x4E0D;&amp;#x80FD;&amp;#x540C;&amp;#x65F6;&amp;#x88AB;&amp;#x9009;&amp;#x3002;&lt;/p&gt;
&lt;ol style=&quot;list-style-type: decimal&quot;&gt;
&lt;li&gt;&amp;#x5B58;&amp;#x5728;&amp;#x6B63;&amp;#x6574;&amp;#x6570; $ c $&amp;#xFF0C;&amp;#x4F7F; $ a ^ 2 + b ^ 2 = c ^ 2 $&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;$ \gcd(a,\ b) = 1 $&amp;#x3002;&lt;/li&gt;
&lt;/ol&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="BZOJ" scheme="https://blog.menci.moe/tag/bzoj/"/>
    
      <category term="Dinic" scheme="https://blog.menci.moe/tag/dinic/"/>
    
      <category term="二分图染色" scheme="https://blog.menci.moe/tag/%E4%BA%8C%E5%88%86%E5%9B%BE%E6%9F%93%E8%89%B2/"/>
    
      <category term="最小割" scheme="https://blog.menci.moe/tag/%E6%9C%80%E5%B0%8F%E5%89%B2/"/>
    
      <category term="网络流" scheme="https://blog.menci.moe/tag/%E7%BD%91%E7%BB%9C%E6%B5%81/"/>
    
  </entry>
  
  <entry>
    <title>「ZJOI2006」物流运输 - 最短路 + DP</title>
    <link href="https://blog.menci.moe/zjoi2006-trans/"/>
    <id>https://blog.menci.moe/zjoi2006-trans/</id>
    <published>2016-05-23T13:41:00.000Z</published>
    <updated>2016-06-02T14:23:15.000Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x7269;&amp;#x6D41;&amp;#x516C;&amp;#x53F8;&amp;#x8981;&amp;#x628A;&amp;#x4E00;&amp;#x6279;&amp;#x8D27;&amp;#x7269;&amp;#x4ECE;&amp;#x7801;&amp;#x5934; $ A $ &amp;#x8FD0;&amp;#x5230;&amp;#x7801;&amp;#x5934; $ B $&amp;#x3002;&amp;#x7531;&amp;#x4E8E;&amp;#x8D27;&amp;#x7269;&amp;#x91CF;&amp;#x6BD4;&amp;#x8F83;&amp;#x5927;&amp;#xFF0C;&amp;#x9700;&amp;#x8981; $ n $ &amp;#x5929;&amp;#x624D;&amp;#x80FD;&amp;#x8FD0;&amp;#x5B8C;&amp;#x3002;&amp;#x8D27;&amp;#x7269;&amp;#x8FD0;&amp;#x8F93;&amp;#x8FC7;&amp;#x7A0B;&amp;#x4E2D;&amp;#x4E00;&amp;#x822C;&amp;#x8981;&amp;#x8F6C;&amp;#x505C;&amp;#x597D;&amp;#x51E0;&amp;#x4E2A;&amp;#x7801;&amp;#x5934;&amp;#x3002;&amp;#x7269;&amp;#x6D41;&amp;#x516C;&amp;#x53F8;&amp;#x901A;&amp;#x5E38;&amp;#x4F1A;&amp;#x8BBE;&amp;#x8BA1;&amp;#x4E00;&amp;#x6761;&amp;#x56FA;&amp;#x5B9A;&amp;#x7684;&amp;#x8FD0;&amp;#x8F93;&amp;#x8DEF;&amp;#x7EBF;&amp;#xFF0C;&amp;#x4EE5;&amp;#x4FBF;&amp;#x5BF9;&amp;#x6574;&amp;#x4E2A;&amp;#x8FD0;&amp;#x8F93;&amp;#x8FC7;&amp;#x7A0B;&amp;#x5B9E;&amp;#x65BD;&amp;#x4E25;&amp;#x683C;&amp;#x7684;&amp;#x7BA1;&amp;#x7406;&amp;#x548C;&amp;#x8DDF;&amp;#x8E2A;&amp;#x3002;&amp;#x7531;&amp;#x4E8E;&amp;#x5404;&amp;#x79CD;&amp;#x56E0;&amp;#x7D20;&amp;#x7684;&amp;#x5B58;&amp;#x5728;&amp;#xFF0C;&amp;#x6709;&amp;#x7684;&amp;#x65F6;&amp;#x5019;&amp;#x67D0;&amp;#x4E2A;&amp;#x7801;&amp;#x5934;&amp;#x4F1A;&amp;#x65E0;&amp;#x6CD5;&amp;#x88C5;&amp;#x5378;&amp;#x8D27;&amp;#x7269;&amp;#x3002;&amp;#x8FD9;&amp;#x65F6;&amp;#x5019;&amp;#x5C31;&amp;#x5FC5;&amp;#x987B;&amp;#x4FEE;&amp;#x6539;&amp;#x8FD0;&amp;#x8F93;&amp;#x8DEF;&amp;#x7EBF;&amp;#xFF0C;&amp;#x8BA9;&amp;#x8D27;&amp;#x7269;&amp;#x80FD;&amp;#x591F;&amp;#x6309;&amp;#x65F6;&amp;#x5230;&amp;#x8FBE;&amp;#x76EE;&amp;#x7684;&amp;#x5730;&amp;#x3002;&amp;#x4F46;&amp;#x662F;&amp;#x4FEE;&amp;#x6539;&amp;#x8DEF;&amp;#x7EBF;&amp;#x662F;&amp;#x4E00;&amp;#x4EF6;&amp;#x5341;&amp;#x5206;&amp;#x9EBB;&amp;#x70E6;&amp;#x7684;&amp;#x4E8B;&amp;#x60C5;&amp;#xFF0C;&amp;#x4F1A;&amp;#x5E26;&amp;#x6765;&amp;#x989D;&amp;#x5916;&amp;#x7684;&amp;#x6210;&amp;#x672C;&amp;#x3002;&amp;#x56E0;&amp;#x6B64;&amp;#x7269;&amp;#x6D41;&amp;#x516C;&amp;#x53F8;&amp;#x5E0C;&amp;#x671B;&amp;#x80FD;&amp;#x591F;&amp;#x8BA2;&amp;#x4E00;&amp;#x4E2A; $ n $ &amp;#x5929;&amp;#x7684;&amp;#x8FD0;&amp;#x8F93;&amp;#x8BA1;&amp;#x5212;&amp;#xFF0C;&amp;#x4F7F;&amp;#x5F97;&amp;#x603B;&amp;#x6210;&amp;#x672C;&amp;#x5C3D;&amp;#x53EF;&amp;#x80FD;&amp;#x5730;&amp;#x5C0F;&amp;#x3002;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;&amp;#x94FE;&amp;#x63A5;&quot;&gt;&amp;#x94FE;&amp;#x63A5;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://www.lydsy.com/JudgeOnline/problem.php?id=1003&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;BZOJ 1003&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://cogs.top/cogs/problem/problem.php?pid=1824&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;COGS 1824&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x9898;&amp;#x89E3;&quot;&gt;&amp;#x9898;&amp;#x89E3;&lt;/h3&gt;
&lt;p&gt;&amp;#x9996;&amp;#x5148;&amp;#xFF0C;&amp;#x5BF9;&amp;#x65F6;&amp;#x95F4;&amp;#x66B4;&amp;#x529B;&amp;#x679A;&amp;#x4E3E;&amp;#x4E00;&amp;#x6BB5;&amp;#x533A;&amp;#x95F4;&amp;#xFF0C;&amp;#x5BF9;&amp;#x8FD9;&amp;#x4E9B;&amp;#x5929;&amp;#x5185;&amp;#x4EFB;&amp;#x610F;&amp;#x4E00;&amp;#x5929;&amp;#x4E0D;&amp;#x80FD;&amp;#x4F7F;&amp;#x7528;&amp;#x7684;&amp;#x70B9;&amp;#x6807;&amp;#x8BB0;&amp;#xFF0C;&amp;#x5728;&amp;#x5269;&amp;#x4F59;&amp;#x7684;&amp;#x70B9;&amp;#x4E2D;&amp;#x6C42;&amp;#x51FA;&amp;#x6700;&amp;#x77ED;&amp;#x8DEF;&amp;#xFF0C;&amp;#x4EE5;&amp;#x5F97;&amp;#x5230;&amp;#x4EFB;&amp;#x610F;&amp;#x51E0;&amp;#x5929;&amp;#x8D70;&amp;#x76F8;&amp;#x540C;&amp;#x8DEF;&amp;#x7EBF;&amp;#x7684;&amp;#x6700;&amp;#x5C11;&amp;#x82B1;&amp;#x8D39;&amp;#xFF08;&amp;#x6700;&amp;#x77ED;&amp;#x8DEF;&amp;#x4E58;&amp;#x4EE5;&amp;#x5929;&amp;#x6570;&amp;#xFF09;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x8BBE; $ c(l,\ r) $ &amp;#x8868;&amp;#x793A;&amp;#x7B2C; $ l $ &amp;#x5929;&amp;#x5230;&amp;#x7B2C; $ r $ &amp;#x5929;&amp;#x8D70;&amp;#x76F8;&amp;#x540C;&amp;#x8DEF;&amp;#x7EBF;&amp;#x7684;&amp;#x6700;&amp;#x5C11;&amp;#x82B1;&amp;#x8D39;&amp;#xFF0C;&amp;#x8BBE; $ f(i) $ &amp;#x8868;&amp;#x793A;&amp;#x5B8C;&amp;#x6210;&amp;#x524D; $ i $ &amp;#x5929;&amp;#x7684;&amp;#x8FD0;&amp;#x8F93;&amp;#x8BA1;&amp;#x5212;&amp;#x5E76;&amp;#x4FEE;&amp;#x6539;&amp;#x8DEF;&amp;#x7EBF;&amp;#x7684;&amp;#x6700;&amp;#x5C11;&amp;#x82B1;&amp;#x8D39;&amp;#xFF0C;&amp;#x5219;&lt;/p&gt;
&lt;p&gt;$$ f(i) = \min\limits_{j = 0} ^ {i - 1} \{ f(j) + k + c(j + 1,\ i) \} $$&lt;/p&gt;
&lt;p&gt;&amp;#x6CE8;&amp;#x610F;&amp;#xFF0C;&amp;#x5F53; $ c(j + 1,\ i) $ &amp;#x65E0;&amp;#x6548;&amp;#xFF0C;&amp;#x5373;&amp;#x7B2C; $ j + 1 $ &amp;#x5929;&amp;#x5230;&amp;#x7B2C; $ i $ &amp;#x5929;&amp;#x65E0;&amp;#x6CD5;&amp;#x8D70;&amp;#x540C;&amp;#x4E00;&amp;#x6761;&amp;#x8DEF;&amp;#x7EBF;&amp;#x65F6;&amp;#x4E0D;&amp;#x53EF;&amp;#x8F6C;&amp;#x79FB;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x6700;&amp;#x7EC8;&amp;#x7B54;&amp;#x6848;&amp;#x4E3A; $ f(n) - k $&amp;#xFF0C;&amp;#x65F6;&amp;#x95F4;&amp;#x590D;&amp;#x6742;&amp;#x5EA6;&amp;#x4E3A; $ O(n ^ 2 m \log m) $&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x4EE3;&amp;#x7801;&quot;&gt;&amp;#x4EE3;&amp;#x7801;&lt;/h3&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;93&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;94&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;95&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;96&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;97&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;98&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;99&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;100&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;101&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;102&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;103&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;104&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;105&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;106&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;107&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;108&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;109&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;110&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;111&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;112&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;113&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;climits&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;queue&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;utility&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;functional&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Node;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Edge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXN = &lt;span class=&quot;number&quot;&gt;20&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXD = &lt;span class=&quot;number&quot;&gt;100&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Node {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Edge *e;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; d;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; flag[MAXD], invalid;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} N[MAXN];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Edge {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Node *s, *t;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; w;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Edge *next;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Edge(Node *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; s, Node *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; t, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; w) : s(s), t(t), w(w), next(s-&amp;gt;e) {}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;};&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;addEdge&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; u, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; v, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; w)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    N[u].e = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Edge(&amp;amp;N[u], &amp;amp;N[v], w);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    N[v].e = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Edge(&amp;amp;N[v], &amp;amp;N[u], w);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; d, n, k, m, c[MAXD + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;][MAXD + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; f[MAXD + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;dijkstra&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; s, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; t)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) N[i].d = INT_MAX;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::priority_queue&amp;lt; &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::pair&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;, Node *&amp;gt;, &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;vector&lt;/span&gt;&amp;lt; &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::pair&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;, Node *&amp;gt; &amp;gt;, &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::greater&amp;lt; &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::pair&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;, Node *&amp;gt; &amp;gt; &amp;gt; q;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    N[s].d = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    q.push(&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::make_pair(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &amp;amp;N[s]));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (!q.empty()) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::pair&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;, Node *&amp;gt; p = q.top();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        q.pop();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Node *v = p.second;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (v-&amp;gt;d != p.first) &lt;span class=&quot;keyword&quot;&gt;continue&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (v-&amp;gt;d &amp;gt; N[t].d) &lt;span class=&quot;keyword&quot;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (Edge *e = v-&amp;gt;e; e; e = e-&amp;gt;next) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (e-&amp;gt;t-&amp;gt;invalid) &lt;span class=&quot;keyword&quot;&gt;continue&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (e-&amp;gt;t-&amp;gt;d &amp;gt; v-&amp;gt;d + e-&amp;gt;w) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                e-&amp;gt;t-&amp;gt;d = v-&amp;gt;d + e-&amp;gt;w;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                q.push(&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::make_pair(e-&amp;gt;t-&amp;gt;d, e-&amp;gt;t));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; N[t].d;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d %d %d&amp;quot;&lt;/span&gt;, &amp;amp;d, &amp;amp;n, &amp;amp;k, &amp;amp;m);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; m; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; u, v, w;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d %d&amp;quot;&lt;/span&gt;, &amp;amp;u, &amp;amp;v, &amp;amp;w), u--, v--;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        addEdge(u, v, w);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; t;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;t);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (t--) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; u, l, r;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d %d&amp;quot;&lt;/span&gt;, &amp;amp;u, &amp;amp;l, &amp;amp;r), u--, l--, r--;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::fill(N[u].flag + l, N[u].flag + r + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= d; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; j = i; j &amp;lt;= d; j++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; k = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; k &amp;lt; n; k++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                N[k].invalid = &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; l = i; l &amp;lt;= j; l++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (N[k].flag[l - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        N[k].invalid = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        &lt;span class=&quot;keyword&quot;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            c[i][j] = dijkstra(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (c[i][j] != INT_MAX) c[i][j] *= (j - i + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;// printf(&amp;quot;%d\n&amp;quot;, c[i][j]);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::fill(f, f + d + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, INT_MAX);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    f[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;] = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= d; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; j = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; j &amp;lt; i; j++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (c[j + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;][i] != INT_MAX) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                f[i] = &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::min(f[i], f[j] + k + c[j + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;][i]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d\n&amp;quot;&lt;/span&gt;, f[d] - k);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x7269;&amp;#x6D41;&amp;#x516C;&amp;#x53F8;&amp;#x8981;&amp;#x628A;&amp;#x4E00;&amp;#x6279;&amp;#x8D27;&amp;#x7269;&amp;#x4ECE;&amp;#x7801;&amp;#x5934; $ A $ &amp;#x8FD0;&amp;#x5230;&amp;#x7801;&amp;#x5934; $ B $&amp;#x3002;&amp;#x7531;&amp;#x4E8E;&amp;#x8D27;&amp;#x7269;&amp;#x91CF;&amp;#x6BD4;&amp;#x8F83;&amp;#x5927;&amp;#xFF0C;&amp;#x9700;&amp;#x8981; $ n $ &amp;#x5929;&amp;#x624D;&amp;#x80FD;&amp;#x8FD0;&amp;#x5B8C;&amp;#x3002;&amp;#x8D27;&amp;#x7269;&amp;#x8FD0;&amp;#x8F93;&amp;#x8FC7;&amp;#x7A0B;&amp;#x4E2D;&amp;#x4E00;&amp;#x822C;&amp;#x8981;&amp;#x8F6C;&amp;#x505C;&amp;#x597D;&amp;#x51E0;&amp;#x4E2A;&amp;#x7801;&amp;#x5934;&amp;#x3002;&amp;#x7269;&amp;#x6D41;&amp;#x516C;&amp;#x53F8;&amp;#x901A;&amp;#x5E38;&amp;#x4F1A;&amp;#x8BBE;&amp;#x8BA1;&amp;#x4E00;&amp;#x6761;&amp;#x56FA;&amp;#x5B9A;&amp;#x7684;&amp;#x8FD0;&amp;#x8F93;&amp;#x8DEF;&amp;#x7EBF;&amp;#xFF0C;&amp;#x4EE5;&amp;#x4FBF;&amp;#x5BF9;&amp;#x6574;&amp;#x4E2A;&amp;#x8FD0;&amp;#x8F93;&amp;#x8FC7;&amp;#x7A0B;&amp;#x5B9E;&amp;#x65BD;&amp;#x4E25;&amp;#x683C;&amp;#x7684;&amp;#x7BA1;&amp;#x7406;&amp;#x548C;&amp;#x8DDF;&amp;#x8E2A;&amp;#x3002;&amp;#x7531;&amp;#x4E8E;&amp;#x5404;&amp;#x79CD;&amp;#x56E0;&amp;#x7D20;&amp;#x7684;&amp;#x5B58;&amp;#x5728;&amp;#xFF0C;&amp;#x6709;&amp;#x7684;&amp;#x65F6;&amp;#x5019;&amp;#x67D0;&amp;#x4E2A;&amp;#x7801;&amp;#x5934;&amp;#x4F1A;&amp;#x65E0;&amp;#x6CD5;&amp;#x88C5;&amp;#x5378;&amp;#x8D27;&amp;#x7269;&amp;#x3002;&amp;#x8FD9;&amp;#x65F6;&amp;#x5019;&amp;#x5C31;&amp;#x5FC5;&amp;#x987B;&amp;#x4FEE;&amp;#x6539;&amp;#x8FD0;&amp;#x8F93;&amp;#x8DEF;&amp;#x7EBF;&amp;#xFF0C;&amp;#x8BA9;&amp;#x8D27;&amp;#x7269;&amp;#x80FD;&amp;#x591F;&amp;#x6309;&amp;#x65F6;&amp;#x5230;&amp;#x8FBE;&amp;#x76EE;&amp;#x7684;&amp;#x5730;&amp;#x3002;&amp;#x4F46;&amp;#x662F;&amp;#x4FEE;&amp;#x6539;&amp;#x8DEF;&amp;#x7EBF;&amp;#x662F;&amp;#x4E00;&amp;#x4EF6;&amp;#x5341;&amp;#x5206;&amp;#x9EBB;&amp;#x70E6;&amp;#x7684;&amp;#x4E8B;&amp;#x60C5;&amp;#xFF0C;&amp;#x4F1A;&amp;#x5E26;&amp;#x6765;&amp;#x989D;&amp;#x5916;&amp;#x7684;&amp;#x6210;&amp;#x672C;&amp;#x3002;&amp;#x56E0;&amp;#x6B64;&amp;#x7269;&amp;#x6D41;&amp;#x516C;&amp;#x53F8;&amp;#x5E0C;&amp;#x671B;&amp;#x80FD;&amp;#x591F;&amp;#x8BA2;&amp;#x4E00;&amp;#x4E2A; $ n $ &amp;#x5929;&amp;#x7684;&amp;#x8FD0;&amp;#x8F93;&amp;#x8BA1;&amp;#x5212;&amp;#xFF0C;&amp;#x4F7F;&amp;#x5F97;&amp;#x603B;&amp;#x6210;&amp;#x672C;&amp;#x5C3D;&amp;#x53EF;&amp;#x80FD;&amp;#x5730;&amp;#x5C0F;&amp;#x3002;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="BZOJ" scheme="https://blog.menci.moe/tag/bzoj/"/>
    
      <category term="COGS" scheme="https://blog.menci.moe/tag/cogs/"/>
    
      <category term="DP" scheme="https://blog.menci.moe/tag/dp/"/>
    
      <category term="ZJOI" scheme="https://blog.menci.moe/tag/zjoi/"/>
    
      <category term="最短路" scheme="https://blog.menci.moe/tag/%E6%9C%80%E7%9F%AD%E8%B7%AF/"/>
    
  </entry>
  
  <entry>
    <title>「ZJOI2008」杀蚂蚁 - 模拟 + 几何</title>
    <link href="https://blog.menci.moe/zjoi2008-antbuster/"/>
    <id>https://blog.menci.moe/zjoi2008-antbuster/</id>
    <published>2016-05-23T13:26:00.000Z</published>
    <updated>2016-06-02T14:23:15.000Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x9898;&amp;#x9762;&amp;#x89C1;&lt;a href=&quot;https://www.zybuluo.com/Jerusalem/note/221811&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;&amp;#x6740;&amp;#x8682;&amp;#x8681;&amp;#x7684;&amp;#x53EF;&amp;#x8BFB;&amp;#x7248;&amp;#x672C;&lt;/a&gt;&amp;#x3002;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;&amp;#x94FE;&amp;#x63A5;&quot;&gt;&amp;#x94FE;&amp;#x63A5;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://www.lydsy.com/JudgeOnline/problem.php?id=1033&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;BZOJ 1033&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://cogs.top/cogs/problem/problem.php?pid=2048&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;COGS 2048&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x9898;&amp;#x89E3;&quot;&gt;&amp;#x9898;&amp;#x89E3;&lt;/h3&gt;
&lt;p&gt;&amp;#x6839;&amp;#x636E;&amp;#x9898;&amp;#x610F;&amp;#x6A21;&amp;#x62DF;&amp;#x5373;&amp;#x53EF; &amp;#x2026;&amp;#x2026;&lt;/p&gt;
&lt;p&gt;&amp;#x552F;&amp;#x4E00;&amp;#x7684;&amp;#x96BE;&amp;#x70B9;&amp;#x662F;&amp;#x5224;&amp;#x65AD;&amp;#x7EBF;&amp;#x6BB5;&amp;#x548C;&amp;#x5706;&amp;#x7684;&amp;#x4EA4;&amp;#x70B9;&amp;#x3002;&amp;#x5148;&amp;#x8FC7;&amp;#x5706;&amp;#x5FC3;&amp;#x505A;&amp;#x7EBF;&amp;#x6BB5;&amp;#x7684;&amp;#x5782;&amp;#x7EBF;&amp;#xFF0C;&amp;#x5224;&amp;#x65AD;&amp;#x4E0E;&amp;#x7EBF;&amp;#x6BB5;&amp;#x662F;&amp;#x5426;&amp;#x6709;&amp;#x4EA4;&amp;#x70B9;&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x6709;&amp;#xFF0C;&amp;#x5219;&amp;#x8BBE;&amp;#x70B9;&amp;#x5230;&amp;#x7EBF;&amp;#x6BB5;&amp;#x8DDD;&amp;#x79BB;&amp;#x4E3A; $ a $&amp;#xFF0C;&amp;#x5706;&amp;#x5FC3;&amp;#x4E0E;&amp;#x7EBF;&amp;#x6BB5;&amp;#x7AEF;&amp;#x70B9;&amp;#x8DDD;&amp;#x79BB;&amp;#x7684;&amp;#x8F83;&amp;#x5927;&amp;#x503C;&amp;#x4E3A; $ b $&amp;#xFF1B;&amp;#x5426;&amp;#x5219;&amp;#x8BBE;&amp;#x5706;&amp;#x5FC3;&amp;#x4E0E;&amp;#x7EBF;&amp;#x6BB5;&amp;#x8DDD;&amp;#x79BB;&amp;#x8F83;&amp;#x5C0F;&amp;#x503C;&amp;#x4E3A; $ a $&amp;#xFF0C;&amp;#x8F83;&amp;#x5927;&amp;#x503C;&amp;#x4E3A; $ b $&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x6EE1;&amp;#x8DB3;&lt;/p&gt;
&lt;p&gt;$$ \begin{cases} a \leq r \\ b \gt r \end{cases} $$&lt;/p&gt;
&lt;p&gt;&amp;#x5373;&amp;#x53EF;&lt;/p&gt;
&lt;p&gt;&amp;#x4FDD;&amp;#x5B58;&amp;#x76F4;&amp;#x7EBF;&amp;#x7684;&amp;#x65F6;&amp;#x5019;&amp;#x53EF;&amp;#x4EE5;&amp;#x7528;&amp;#x659C;&amp;#x622A;&amp;#x5F0F;&amp;#xFF0C;&amp;#x4F46;&amp;#x6CE8;&amp;#x610F;&amp;#x659C;&amp;#x7387;&amp;#x4E0D;&amp;#x5B58;&amp;#x5728;&amp;#x548C;&amp;#x659C;&amp;#x7387;&amp;#x4E3A;&amp;#x96F6;&amp;#x7684;&amp;#x7279;&amp;#x5224;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x8FD8;&amp;#x6709;&amp;#x5C31;&amp;#x662F;&amp;#x4E0D;&amp;#x8981;&lt;strong&gt;&amp;#x5199;&amp;#x9519;&amp;#x53D8;&amp;#x91CF;&amp;#x540D;&lt;/strong&gt; &amp;#x2026;&amp;#x2026;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x4EE3;&amp;#x7801;&quot;&gt;&amp;#x4EE3;&amp;#x7801;&lt;/h3&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;93&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;94&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;95&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;96&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;97&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;98&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;99&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;100&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;101&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;102&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;103&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;104&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;105&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;106&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;107&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;108&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;109&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;110&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;111&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;112&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;113&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;114&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;115&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;116&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;117&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;118&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;119&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;120&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;121&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;122&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;123&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;124&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;125&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;126&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;127&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;128&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;129&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;130&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;131&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;132&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;133&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;134&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;135&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;136&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;137&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;138&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;139&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;140&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;141&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;142&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;143&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;144&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;145&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;146&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;147&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;148&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;149&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;150&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;151&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;152&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;153&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;154&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;155&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;156&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;157&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;158&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;159&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;160&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;161&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;162&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;163&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;164&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;165&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;166&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;167&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;168&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;169&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;170&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;171&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;172&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;173&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;174&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;175&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;176&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;177&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;178&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;179&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;180&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;181&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;182&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;183&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;184&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;185&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;186&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;187&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;188&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;189&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;190&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;191&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;192&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;193&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;194&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;195&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;196&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;197&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;198&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;199&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;200&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;201&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;202&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;203&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;204&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;205&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;206&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;207&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;208&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;209&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;210&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;211&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;212&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;213&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;214&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;215&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;216&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;217&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;218&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;219&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;220&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;221&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;222&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;223&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;224&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;225&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;226&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;227&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;228&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;229&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;230&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;231&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;232&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;233&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;234&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;235&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;236&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;237&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;238&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;239&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;240&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;241&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;242&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;243&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;244&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;245&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;246&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;247&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;248&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;249&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;250&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;251&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;252&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;253&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;254&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;255&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;256&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;257&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;258&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;259&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;260&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;261&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;262&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;263&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;264&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;265&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;266&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;267&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;268&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;269&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;270&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;271&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;272&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;273&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;274&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;275&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;276&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;277&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;278&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;279&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;280&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;281&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;282&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;283&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;284&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;285&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;286&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;287&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;288&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;289&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;290&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;291&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;292&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;293&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;294&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;295&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;296&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;297&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;298&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;299&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;300&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;301&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;302&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;303&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;304&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;305&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;306&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;307&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;308&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;309&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;310&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;311&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;312&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;313&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;314&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;315&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;316&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;317&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;318&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;319&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;320&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;321&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;322&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;323&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;324&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cmath&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;list&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;algorithm&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;typedef&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt; real;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXN = &lt;span class=&quot;number&quot;&gt;8&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXM = &lt;span class=&quot;number&quot;&gt;8&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXS = &lt;span class=&quot;number&quot;&gt;20&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXT = &lt;span class=&quot;number&quot;&gt;200000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; real EPS = &lt;span class=&quot;number&quot;&gt;1e-6&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, m, s, d, r, t, time;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Map {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; message;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; reachable;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Map() : message(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;), reachable(&lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;) {}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} &lt;span class=&quot;built_in&quot;&gt;map&lt;/span&gt;[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;][MAXM + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;template&lt;/span&gt; &amp;lt;&lt;span class=&quot;keyword&quot;&gt;typename&lt;/span&gt; T&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Point {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    T x, y;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Point(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; T x = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; T y = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) : x(x), y(y) {}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Map *&lt;span class=&quot;keyword&quot;&gt;operator&lt;/span&gt;-&amp;gt;() &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; { &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &amp;amp;&lt;span class=&quot;built_in&quot;&gt;map&lt;/span&gt;[&lt;span class=&quot;keyword&quot;&gt;static_cast&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;&amp;gt;(x)][&lt;span class=&quot;keyword&quot;&gt;static_cast&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;&amp;gt;(y)]; }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;Point &lt;span class=&quot;title&quot;&gt;offset&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; id)&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;switch&lt;/span&gt; (id) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;: &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; Point(x, y + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;: &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; Point(x + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, y);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;: &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; Point(x, y - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;: &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; Point(x - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, y);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;default&lt;/span&gt;: &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; *&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;valid&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;/span&gt;{ &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; x &amp;gt;= &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &amp;amp;&amp;amp; x &amp;lt;= n &amp;amp;&amp;amp; y &amp;gt;= &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &amp;amp;&amp;amp; y &amp;lt;= m; }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;operator&lt;/span&gt;==(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; Point &amp;amp;p) &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; { &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; x == p.x &amp;amp;&amp;amp; y == p.y; }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;};&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;dcmp&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; real a)&lt;/span&gt; &lt;/span&gt;{ &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;fabs&lt;/span&gt;(a) &amp;lt;= EPS; }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;dcmp&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; real a, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; real b)&lt;/span&gt; &lt;/span&gt;{ &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; dcmp(a - b); }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;isnan&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; real x)&lt;/span&gt; &lt;/span&gt;{ &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; x != x; }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;isinf&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; real x)&lt;/span&gt; &lt;/span&gt;{ &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; !isnan(x) &amp;amp;&amp;amp; isnan(x - x); }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;template&lt;/span&gt; &amp;lt;&lt;span class=&quot;keyword&quot;&gt;typename&lt;/span&gt; T&amp;gt; &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; T &lt;span class=&quot;title&quot;&gt;sqr&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; T &amp;amp;x)&lt;/span&gt; &lt;/span&gt;{ &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; x * x; }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;template&lt;/span&gt; &amp;lt;&lt;span class=&quot;keyword&quot;&gt;typename&lt;/span&gt; Ta, &lt;span class=&quot;keyword&quot;&gt;typename&lt;/span&gt; Tb&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; real &lt;span class=&quot;title&quot;&gt;distance&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; Point&amp;lt;Ta&amp;gt; a, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; Point&amp;lt;Tb&amp;gt; b)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;sqrt&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;static_cast&lt;/span&gt;&amp;lt;real&amp;gt;(sqr(a.x - b.x) + sqr(a.y - b.y)));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Ant {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Point&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;&amp;gt; position, lastPosition;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; level;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; hpLimit, hp;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; hasCake;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; spawnTime;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Ant(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; level) : position(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;), lastPosition(-&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, -&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;), level(level), hpLimit(&lt;span class=&quot;built_in&quot;&gt;floor&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt; * &lt;span class=&quot;built_in&quot;&gt;pow&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;1.1&lt;/span&gt;, level))), hp(hpLimit), hasCake(&lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;), spawnTime(time) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// printf(&amp;quot;spawn Ant(%d)\n&amp;quot;, level);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        position-&amp;gt;reachable = &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;moveTo&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; Point&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;&amp;gt; &amp;amp;nextPosition)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        lastPosition = position;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        position = nextPosition;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (lastPosition == position) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// printf(&amp;quot;moveTo(): from [%d, %d] to [%d, %d]\n&amp;quot;, lastPosition.x, lastPosition.y, position.x, position.y);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        lastPosition-&amp;gt;reachable = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        position-&amp;gt;reachable = &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;age&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; time - spawnTime;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;attackable&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; Point&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;&amp;gt; &amp;amp;p)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; real dist = distance(position, p);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; dist &amp;lt; r || dcmp(dist, r);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;};&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Line {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    real k, b;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;/*&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     * k != nan: y = kx + b&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     * k == nan: x = b&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Line(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; Point&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;&amp;gt; &amp;amp;p1, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; Point&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;&amp;gt; &amp;amp;p2) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; real x1 = p1.x, y1 = p1.y, x2 = p2.x, y2 = p2.y;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (x1 == x2) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            k = NAN;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            b = x1;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        } &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            k = (y2 - y1) / (x2 - x1);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            b = y1 - k * x1;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Line(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; real k, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; Point&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;&amp;gt; &amp;amp;p1) : k(isinf(k) ? NAN : k), b(isinf(k) ? p1.x : (p1.y - k * p1.x)) {}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Line(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; real k, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; real b) : k(k), b(b) {}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;Line &lt;span class=&quot;title&quot;&gt;perpendicular&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; Point&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;&amp;gt; &amp;amp;p1)&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (isnan(k)) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; Line(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, p1.y);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; Line(-&lt;span class=&quot;number&quot;&gt;1.0&lt;/span&gt; / k, p1);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;};&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Segment {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Point&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;&amp;gt; p1, p2;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Line line;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    real length;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Segment(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; Point&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;&amp;gt; &amp;amp;p1, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; Point&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;&amp;gt; &amp;amp;p2) : p1(p1), p2(p2), line(p1, p2) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        length = distance(p1, p2);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;};&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Point&amp;lt;real&amp;gt; lineIntersection(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; Line &amp;amp;a, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; Line &amp;amp;b) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (isnan(a.k) &amp;amp;&amp;amp; isnan(b.k) || a.k == b.k) &lt;span class=&quot;keyword&quot;&gt;throw&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (isnan(a.k)) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; Point&amp;lt;real&amp;gt;(a.b, a.b * b.k + b.b);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (isnan(b.k)) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; Point&amp;lt;real&amp;gt;(b.b, b.b * a.k + a.b);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; real x = (b.b - a.b) / (a.k - b.k);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; real y = a.k * x + a.b;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; Point&amp;lt;real&amp;gt;(x, y);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;pointOnSegment&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; Point&amp;lt;real&amp;gt; &amp;amp;p, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; Segment &amp;amp;s)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; dcmp(distance(p, s.p1) + distance(p, s.p2) - s.length);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;segmentCircleIntersection&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; Segment &amp;amp;s, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; Point&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;&amp;gt; &amp;amp;p, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; real r)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Line v = s.line.perpendicular(p);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Point&amp;lt;real&amp;gt; is = lineIntersection(v, s.line);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    real min, max;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (pointOnSegment(is, s)) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        min = distance(is, p);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        max = &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::max(distance(is, s.p1), distance(is, s.p2));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    } &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        min = distance(p, s.p1);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        max = distance(p, s.p2);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (min &amp;gt; max) &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::swap(min, max);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; (min &amp;lt; r || dcmp(min, r)) &amp;amp;&amp;amp; (max &amp;gt; r || dcmp(max, r));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;list&lt;/span&gt;&amp;lt;Ant&amp;gt; ants;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;list&lt;/span&gt;&amp;lt;Ant&amp;gt;::iterator cakeOwner = ants.end();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Point&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;&amp;gt; towers[MAXS];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;spawn&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (ants.size() &amp;lt; &lt;span class=&quot;number&quot;&gt;6&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;built_in&quot;&gt;map&lt;/span&gt;[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;][&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;].reachable == &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; cnt = -&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        cnt++;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ants.push_back(Ant(cnt / &lt;span class=&quot;number&quot;&gt;6&lt;/span&gt; + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;incMessage&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;list&lt;/span&gt;&amp;lt;Ant&amp;gt;::const_iterator it = ants.begin(); it != ants.end(); it++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        it-&amp;gt;position-&amp;gt;message += it-&amp;gt;hasCake ? &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt; : &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;move&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;list&lt;/span&gt;&amp;lt;Ant&amp;gt;::iterator it = ants.begin(); it != ants.end(); it++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// static int _cnt = 0;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// _cnt++;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// printf(&amp;quot;move(): _cnt = %d\n&amp;quot;, _cnt);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; id = -&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// printf(&amp;quot;move(): lastPosition = [%d, %d]\n&amp;quot;, it-&amp;gt;lastPosition.x, it-&amp;gt;lastPosition.y);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Point&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;&amp;gt; newPosition = it-&amp;gt;position.offset(i);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!newPosition.valid()) &lt;span class=&quot;keyword&quot;&gt;continue&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (newPosition == it-&amp;gt;lastPosition) &lt;span class=&quot;keyword&quot;&gt;continue&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!newPosition-&amp;gt;reachable) &lt;span class=&quot;keyword&quot;&gt;continue&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (id == -&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; || newPosition-&amp;gt;message &amp;gt; it-&amp;gt;position.offset(id)-&amp;gt;message) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                id = i;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// if (id != -1) printf(&amp;quot;move(): checking moving to [%d, %d]\n&amp;quot;, it-&amp;gt;position.offset(id).x, it-&amp;gt;position.offset(id).y);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (id != -&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &amp;amp;&amp;amp; (it-&amp;gt;age() + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) % &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt; == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;// printf(&amp;quot;move(): special, before = [%d, %d]\n&amp;quot;, it-&amp;gt;position.offset(id).x, it-&amp;gt;position.offset(id).y);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Point&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;&amp;gt; newPosition;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;do&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                id = (id - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; + &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;) % &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                newPosition = it-&amp;gt;position.offset(id);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            } &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (!newPosition.valid() || !newPosition-&amp;gt;reachable || newPosition == it-&amp;gt;lastPosition);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;// printf(&amp;quot;move(): special, after = [%d, %d]\n&amp;quot;, it-&amp;gt;position.offset(id).x, it-&amp;gt;position.offset(id).y);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        it-&amp;gt;moveTo(it-&amp;gt;position.offset(id));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;getCake&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (cakeOwner != ants.end()) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;list&lt;/span&gt;&amp;lt;Ant&amp;gt;::iterator it = ants.begin(); it != ants.end(); it++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (it-&amp;gt;position == Point&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;&amp;gt;(n, m)) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            cakeOwner = it;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            it-&amp;gt;hasCake = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            it-&amp;gt;hp = &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::min(it-&amp;gt;hpLimit, it-&amp;gt;hp + it-&amp;gt;hpLimit / &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;// puts(&amp;quot;getCake(): got&amp;quot;);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;attack&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; s; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// static int _cnt = 0;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// _cnt++;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// printf(&amp;quot;attack(): _cnt = %d\n&amp;quot;, _cnt);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;list&lt;/span&gt;&amp;lt;Ant&amp;gt;::iterator target = ants.end();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (cakeOwner != ants.end() &amp;amp;&amp;amp; cakeOwner-&amp;gt;attackable(towers[i])) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            target = cakeOwner;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (target == ants.end()) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;list&lt;/span&gt;&amp;lt;Ant&amp;gt;::iterator it = ants.begin(); it != ants.end(); it++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                real d = distance(it-&amp;gt;position, towers[i]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ((d &amp;lt; r || dcmp(d, r)) &amp;amp;&amp;amp; (target == ants.end() || distance(it-&amp;gt;position, towers[i]) &amp;lt; distance(target-&amp;gt;position, towers[i]))) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    target = it;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (target != ants.end()) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            target-&amp;gt;hp -= d;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;function&quot;&gt;Segment &lt;span class=&quot;title&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(towers[i], target-&amp;gt;position)&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;list&lt;/span&gt;&amp;lt;Ant&amp;gt;::iterator it = ants.begin(); it != ants.end(); it++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (it != &lt;span class=&quot;function&quot;&gt;target &amp;amp;&amp;amp; &lt;span class=&quot;title&quot;&gt;segmentCircleIntersection&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(s, it-&amp;gt;position, &lt;span class=&quot;number&quot;&gt;0.5&lt;/span&gt;)&lt;/span&gt;) &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &lt;span class=&quot;comment&quot;&gt;// printf(&amp;quot;attack(): _cnt = %d, through [%d, %d]\n&amp;quot;, _cnt, it-&amp;gt;position.x, it-&amp;gt;position.y);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    it-&amp;gt;hp -= d;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;comment&quot;&gt;// if (it == target) printf(&amp;quot;attack(): _cnt = %d, target [%d, %d]\n&amp;quot;, _cnt, target-&amp;gt;position.x, target-&amp;gt;position.y);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;kill&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;list&lt;/span&gt;&amp;lt;Ant&amp;gt;::iterator it = ants.begin(); it != ants.end(); ) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (it-&amp;gt;hp &amp;lt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            it-&amp;gt;position-&amp;gt;reachable = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (it == cakeOwner) cakeOwner = ants.end();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            it = ants.erase(it);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        } &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; it++;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;check&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;list&lt;/span&gt;&amp;lt;Ant&amp;gt;::const_iterator it = ants.begin(); it != ants.end(); it++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (it-&amp;gt;position == Point&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;&amp;gt;(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) &amp;amp;&amp;amp; it-&amp;gt;hasCake) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;decMessage&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt;= n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; j = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; j &amp;lt;= m; j++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;built_in&quot;&gt;map&lt;/span&gt;[i][j].message &amp;gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) &lt;span class=&quot;built_in&quot;&gt;map&lt;/span&gt;[i][j].message--;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    freopen(&lt;span class=&quot;string&quot;&gt;&amp;quot;data.in&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;r&amp;quot;&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;stdin&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d\n%d %d %d&amp;quot;&lt;/span&gt;, &amp;amp;n, &amp;amp;m, &amp;amp;s, &amp;amp;d, &amp;amp;r);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; s; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d&amp;quot;&lt;/span&gt;, &amp;amp;towers[i].x, &amp;amp;towers[i].y);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        towers[i]-&amp;gt;reachable = &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;t);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    time = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (; time &amp;lt;= t; time++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// printf(&amp;quot;main(): time = %d\n&amp;quot;, time);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        spawn();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        incMessage();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        move();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        getCake();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        attack();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        kill();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!check()) &lt;span class=&quot;keyword&quot;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        decMessage();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// for (std::list&amp;lt;Ant&amp;gt;::const_iterator it = ants.begin(); it != ants.end(); it++) printf(&amp;quot;%d %d %d %d %d\n&amp;quot;, it-&amp;gt;age(), it-&amp;gt;level, it-&amp;gt;hp, it-&amp;gt;position.y, it-&amp;gt;position.x);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// putchar(&amp;apos;\n&amp;apos;);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (time &amp;gt; t) &lt;span class=&quot;built_in&quot;&gt;puts&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;The game is going on&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;Game over after %d seconds\n&amp;quot;&lt;/span&gt;, time);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d\n&amp;quot;&lt;/span&gt;, ants.size());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;list&lt;/span&gt;&amp;lt;Ant&amp;gt;::const_iterator it = ants.begin(); it != ants.end(); it++) &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d %d %d %d\n&amp;quot;&lt;/span&gt;, it-&amp;gt;age(), it-&amp;gt;level, it-&amp;gt;hp, it-&amp;gt;position.x, it-&amp;gt;position.y);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    fclose(&lt;span class=&quot;built_in&quot;&gt;stdin&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x9898;&amp;#x9762;&amp;#x89C1;&lt;a href=&quot;https://www.zybuluo.com/Jerusalem/note/221811&quot;&gt;&amp;#x6740;&amp;#x8682;&amp;#x8681;&amp;#x7684;&amp;#x53EF;&amp;#x8BFB;&amp;#x7248;&amp;#x672C;&lt;/a&gt;&amp;#x3002;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="BZOJ" scheme="https://blog.menci.moe/tag/bzoj/"/>
    
      <category term="COGS" scheme="https://blog.menci.moe/tag/cogs/"/>
    
      <category term="ZJOI" scheme="https://blog.menci.moe/tag/zjoi/"/>
    
      <category term="几何" scheme="https://blog.menci.moe/tag/%E5%87%A0%E4%BD%95/"/>
    
      <category term="数学" scheme="https://blog.menci.moe/tag/%E6%95%B0%E5%AD%A6/"/>
    
      <category term="模拟" scheme="https://blog.menci.moe/tag/%E6%A8%A1%E6%8B%9F/"/>
    
  </entry>
  
  <entry>
    <title>「BZOJ 3156」防御准备 - 斜率优化DP</title>
    <link href="https://blog.menci.moe/bzoj-3156/"/>
    <id>https://blog.menci.moe/bzoj-3156/</id>
    <published>2016-05-19T03:58:00.000Z</published>
    <updated>2016-05-21T13:56:08.000Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x6211;&amp;#x4EEC;&amp;#x5B9A;&amp;#x4E49;&amp;#x6218;&amp;#x7EBF;&amp;#x4E3A;&amp;#x4E00;&amp;#x6761;&amp;#x957F;&amp;#x5EA6;&amp;#x4E3A; $ n $ &amp;#x7684;&amp;#x5E8F;&amp;#x5217;&amp;#xFF0C;&amp;#x5728;&amp;#x8FD9;&amp;#x6761;&amp;#x6218;&amp;#x7EBF;&amp;#x4E0A;&amp;#x5171;&amp;#x8BBE;&amp;#x6709; $ n $ &amp;#x4E2A;&amp;#x68C0;&amp;#x67E5;&amp;#x70B9;&amp;#xFF0C;&amp;#x4ECE;&amp;#x5DE6;&amp;#x5230;&amp;#x53F3;&amp;#x4F9D;&amp;#x6B21;&amp;#x6807;&amp;#x53F7;&amp;#x4E3A; $ 1 $ &amp;#x5230; $ n $&amp;#x3002;&amp;#x4E00;&amp;#x4E2A;&amp;#x6218;&amp;#x7EBF;&amp;#x4E3A;&amp;#x5408;&amp;#x6CD5;&amp;#x6218;&amp;#x7EBF;&amp;#x5F53;&amp;#x4E14;&amp;#x4EC5;&amp;#x5F53;&amp;#x4EFB;&amp;#x610F;&amp;#x4E00;&amp;#x4E2A;&amp;#x68C0;&amp;#x67E5;&amp;#x70B9;&amp;#x53EF;&amp;#x4EE5;&amp;#x901A;&amp;#x8FC7;&amp;#x5B89;&amp;#x5168;&amp;#x68C0;&amp;#x67E5;&amp;#x3002;&amp;#x5BF9;&amp;#x4E8E;&amp;#x7B2C; $ i $ &amp;#x4E2A;&amp;#x70B9;&amp;#xFF0C;&amp;#x901A;&amp;#x8FC7;&amp;#x5B89;&amp;#x5168;&amp;#x68C0;&amp;#x67E5;&amp;#x7684;&amp;#x65B9;&amp;#x6CD5;&amp;#x6709;&amp;#x4E24;&amp;#x79CD;&amp;#xFF0C;&amp;#x7B2C;&amp;#x4E00;&amp;#x79CD;&amp;#x662F;&amp;#x653E;&amp;#x7F6E;&amp;#x4E00;&amp;#x4E2A;&amp;#x5B88;&amp;#x536B;&amp;#x5854;&amp;#xFF0C;&amp;#x8FD9;&amp;#x5C06;&amp;#x82B1;&amp;#x8D39; $ c(i) $ &amp;#x7684;&amp;#x8D39;&amp;#x7528;&amp;#xFF0C;&amp;#x7B2C;&amp;#x4E8C;&amp;#x79CD;&amp;#x65B9;&amp;#x5F0F;&amp;#x662F;&amp;#x653E;&amp;#x7F6E;&amp;#x4E00;&amp;#x4E2A;&amp;#x6728;&amp;#x5076;&amp;#xFF0C;&amp;#x653E;&amp;#x7F6E;&amp;#x6728;&amp;#x5076;&amp;#x7684;&amp;#x82B1;&amp;#x8D39;&amp;#x7B49;&amp;#x4E8E;&amp;#x8FD9;&amp;#x4E2A;&amp;#x68C0;&amp;#x67E5;&amp;#x70B9;&amp;#x53F3;&amp;#x4FA7;&amp;#x7684;&amp;#x7B2C;&amp;#x4E00;&amp;#x4E2A;&amp;#x5B88;&amp;#x536B;&amp;#x5854;&amp;#x5230;&amp;#x5B83;&amp;#x7684;&amp;#x8DDD;&amp;#x79BB;&amp;#x3002;&amp;#x7B2C; $ n $ &amp;#x4E2A;&amp;#x70B9;&amp;#x53EA;&amp;#x80FD;&amp;#x653E;&amp;#x7F6E;&amp;#x5B88;&amp;#x536B;&amp;#x5854;&amp;#x3002;&amp;#x6C42;&amp;#x6700;&amp;#x5C0F;&amp;#x7684;&amp;#x6218;&amp;#x7EBF;&amp;#x82B1;&amp;#x8D39;&amp;#x503C;&amp;#x3002;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;&amp;#x94FE;&amp;#x63A5;&quot;&gt;&amp;#x94FE;&amp;#x63A5;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://www.lydsy.com/JudgeOnline/problem.php?id=3156&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;BZOJ 3156&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x9898;&amp;#x89E3;&quot;&gt;&amp;#x9898;&amp;#x89E3;&lt;/h3&gt;
&lt;p&gt;&amp;#x5C06;&amp;#x6574;&amp;#x4E2A;&amp;#x5E8F;&amp;#x5217;&amp;#x53CD;&amp;#x8F6C;&amp;#xFF0C;&amp;#x653E;&amp;#x7F6E;&amp;#x6728;&amp;#x5076;&amp;#x7684;&amp;#x82B1;&amp;#x8D39;&amp;#x7B49;&amp;#x4E8E;&amp;#x8FD9;&amp;#x4E2A;&amp;#x68C0;&amp;#x67E5;&amp;#x70B9;&lt;strong&gt;&amp;#x5DE6;&amp;#x4FA7;&lt;/strong&gt;&amp;#x7684;&amp;#x7B2C;&amp;#x4E00;&amp;#x4E2A;&amp;#x5B88;&amp;#x536B;&amp;#x5854;&amp;#x5230;&amp;#x5B83;&amp;#x7684;&amp;#x8DDD;&amp;#x79BB;&amp;#xFF0C;&amp;#x4E00;&amp;#x53F7;&amp;#x68C0;&amp;#x67E5;&amp;#x70B9;&amp;#x5FC5;&amp;#x987B;&amp;#x653E;&amp;#x7F6E;&amp;#x5B88;&amp;#x536B;&amp;#x5854;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x8BBE; $ f(i) $ &amp;#x8868;&amp;#x793A;&amp;#x524D; $ i $ &amp;#x4E2A;&amp;#x68C0;&amp;#x67E5;&amp;#x70B9;&amp;#x901A;&amp;#x8FC7;&amp;#x68C0;&amp;#x67E5;&amp;#x7684;&amp;#x6700;&amp;#x5C0F;&amp;#x4EE3;&amp;#x4EF7;&amp;#xFF0C;&amp;#x679A;&amp;#x4E3E; $ j $&amp;#xFF0C;&amp;#x5728; $ j + 1 $ &amp;#x4F4D;&amp;#x7F6E;&amp;#x653E;&amp;#x7F6E;&amp;#x4E00;&amp;#x4E2A;&amp;#x5B88;&amp;#x536B;&amp;#x5854;&amp;#xFF0C;&amp;#x4E4B;&amp;#x540E;&amp;#x4E00;&amp;#x76F4;&amp;#x5230; $ i $ &amp;#x7684;&amp;#x4F4D;&amp;#x7F6E;&amp;#x5168;&amp;#x90E8;&amp;#x653E;&amp;#x7F6E;&amp;#x6728;&amp;#x5076;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;$$ f(i) = \min\limits_{j = 0} ^ {i - 1} \{ f(j) + c(j + 1) + \frac{(i - j - 1)(i - j)}{2} \} $$&lt;/p&gt;
&lt;p&gt;&amp;#x659C;&amp;#x7387;&amp;#x4F18;&amp;#x5316;&amp;#xFF0C;&amp;#x8003;&amp;#x8651;&amp;#x4E24;&amp;#x4E2A;&amp;#x51B3;&amp;#x7B56; $ a $&amp;#x3001;$ b $&amp;#xFF08;$ a &amp;gt; b $&amp;#xFF09;&amp;#xFF0C;&amp;#x82E5; $ a $ &amp;#x6BD4; $ b $ &amp;#x4F18;&amp;#xFF0C;&amp;#x5219;&amp;#x6709;&lt;/p&gt;
&lt;p&gt;$$ \begin{align*} f(a) + c(a + 1) + \frac{(i - a - 1)(i - a)}{2} &amp;amp;&amp;lt; f(b) + c(b + 1) + \frac{(i - b - 1)(i - b)}{2} \\ f(a) + c(a + 1) + \frac{i ^ 2}{2} + \frac{a ^ 2}{2} - ia - \frac{i}{2} + \frac{a}{2} &amp;amp;&amp;lt; f(b) + c(b + 1) + \frac{i ^ 2}{2} + \frac{b ^ 2}{2} - ib - \frac{i}{2} + \frac{b}{2} \\ { (f(a) + c(a + 1) + \frac{a ^ 2}{2} + \frac{a}{2}) - (f(b) + c(b + 1) + \frac{b ^ 2}{2} + \frac{b}{2}) \over a - b } &amp;amp;&amp;lt; i \\ \end{align*} $$&lt;/p&gt;
&lt;p&gt;&amp;#x7EF4;&amp;#x62A4;&amp;#x51B3;&amp;#x7B56;&amp;#x70B9;&amp;#xFF0C;&amp;#x4F7F;&amp;#x659C;&amp;#x7387;&amp;#x9012;&amp;#x589E;&amp;#xFF0C;&amp;#x6700;&amp;#x4F18;&amp;#x51B3;&amp;#x7B56;&amp;#x53D6;&amp;#x961F;&amp;#x9996;&amp;#x3002;&amp;#x65F6;&amp;#x95F4;&amp;#x590D;&amp;#x6742;&amp;#x5EA6;&amp;#x4E3A; $ O(n) $&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x4EE3;&amp;#x7801;&quot;&gt;&amp;#x4EE3;&amp;#x7801;&lt;/h3&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;climits&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;algorithm&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXN = &lt;span class=&quot;number&quot;&gt;1000000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; c[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;], f[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;prepare&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::reverse(c + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, c + n + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;/*&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;inline void force() {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    std::fill(f, f + n + 1, LLONG_MAX);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    f[0] = 0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    for (int i = 1; i &amp;lt;= n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        int _j = -1;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        for (int j = 0; j &amp;lt; i; j++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            if (f[i] &amp;gt; f[j] + c[j + 1] + (i - j - 1) * (i - j) / 2) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                f[i] = f[j] + c[j + 1] + (i - j - 1) * (i - j) / 2;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                _j = j;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        printf(&amp;quot;%d --&amp;gt; %d\n&amp;quot;, i, _j);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;*/&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;template&lt;/span&gt; &amp;lt;&lt;span class=&quot;keyword&quot;&gt;typename&lt;/span&gt; T&amp;gt; &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; T &lt;span class=&quot;title&quot;&gt;sqr&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; T &amp;amp;x)&lt;/span&gt; &lt;/span&gt;{ &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; x * x; }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i)&lt;/span&gt; &lt;/span&gt;{ &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; f[i] + c[i + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;] + sqr(&lt;span class=&quot;keyword&quot;&gt;static_cast&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt;&amp;gt;(i)) * &lt;span class=&quot;number&quot;&gt;0.5&lt;/span&gt; + i * &lt;span class=&quot;number&quot;&gt;0.5&lt;/span&gt;; }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;slope&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; a, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; b)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt;(x(a) - x(b))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;         / &lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt;(a - b);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;dp&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::fill(f, f + n + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, LLONG_MAX);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    f[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;] = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; q[MAXN];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; *l = q, *r = q;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    *r = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (l &amp;lt; &lt;span class=&quot;function&quot;&gt;r &amp;amp;&amp;amp; &lt;span class=&quot;title&quot;&gt;slope&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(*(l + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&lt;/span&gt;, *l) &amp;lt; i) l++&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &amp;amp;j = *l;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        f[i] = f[j] + c[j + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;] + (i - j - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) * (i - j) / &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// printf(&amp;quot;%d --&amp;gt; %d\n&amp;quot;, i, j);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (i &amp;lt; n) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (l &amp;lt; &lt;span class=&quot;function&quot;&gt;r &amp;amp;&amp;amp; &lt;span class=&quot;title&quot;&gt;slope&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(*r, *(r - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&lt;/span&gt;) &amp;gt; &lt;span class=&quot;title&quot;&gt;slope&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(i, *r)&lt;/span&gt;) r--&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            *++r = i;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;n);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= n; i++) &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%lld&amp;quot;&lt;/span&gt;, &amp;amp;c[i]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    prepare();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// force();&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    dp();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%lld\n&amp;quot;&lt;/span&gt;, f[n]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x6211;&amp;#x4EEC;&amp;#x5B9A;&amp;#x4E49;&amp;#x6218;&amp;#x7EBF;&amp;#x4E3A;&amp;#x4E00;&amp;#x6761;&amp;#x957F;&amp;#x5EA6;&amp;#x4E3A; $ n $ &amp;#x7684;&amp;#x5E8F;&amp;#x5217;&amp;#xFF0C;&amp;#x5728;&amp;#x8FD9;&amp;#x6761;&amp;#x6218;&amp;#x7EBF;&amp;#x4E0A;&amp;#x5171;&amp;#x8BBE;&amp;#x6709; $ n $ &amp;#x4E2A;&amp;#x68C0;&amp;#x67E5;&amp;#x70B9;&amp;#xFF0C;&amp;#x4ECE;&amp;#x5DE6;&amp;#x5230;&amp;#x53F3;&amp;#x4F9D;&amp;#x6B21;&amp;#x6807;&amp;#x53F7;&amp;#x4E3A; $ 1 $ &amp;#x5230; $ n $&amp;#x3002;&amp;#x4E00;&amp;#x4E2A;&amp;#x6218;&amp;#x7EBF;&amp;#x4E3A;&amp;#x5408;&amp;#x6CD5;&amp;#x6218;&amp;#x7EBF;&amp;#x5F53;&amp;#x4E14;&amp;#x4EC5;&amp;#x5F53;&amp;#x4EFB;&amp;#x610F;&amp;#x4E00;&amp;#x4E2A;&amp;#x68C0;&amp;#x67E5;&amp;#x70B9;&amp;#x53EF;&amp;#x4EE5;&amp;#x901A;&amp;#x8FC7;&amp;#x5B89;&amp;#x5168;&amp;#x68C0;&amp;#x67E5;&amp;#x3002;&amp;#x5BF9;&amp;#x4E8E;&amp;#x7B2C; $ i $ &amp;#x4E2A;&amp;#x70B9;&amp;#xFF0C;&amp;#x901A;&amp;#x8FC7;&amp;#x5B89;&amp;#x5168;&amp;#x68C0;&amp;#x67E5;&amp;#x7684;&amp;#x65B9;&amp;#x6CD5;&amp;#x6709;&amp;#x4E24;&amp;#x79CD;&amp;#xFF0C;&amp;#x7B2C;&amp;#x4E00;&amp;#x79CD;&amp;#x662F;&amp;#x653E;&amp;#x7F6E;&amp;#x4E00;&amp;#x4E2A;&amp;#x5B88;&amp;#x536B;&amp;#x5854;&amp;#xFF0C;&amp;#x8FD9;&amp;#x5C06;&amp;#x82B1;&amp;#x8D39; $ c(i) $ &amp;#x7684;&amp;#x8D39;&amp;#x7528;&amp;#xFF0C;&amp;#x7B2C;&amp;#x4E8C;&amp;#x79CD;&amp;#x65B9;&amp;#x5F0F;&amp;#x662F;&amp;#x653E;&amp;#x7F6E;&amp;#x4E00;&amp;#x4E2A;&amp;#x6728;&amp;#x5076;&amp;#xFF0C;&amp;#x653E;&amp;#x7F6E;&amp;#x6728;&amp;#x5076;&amp;#x7684;&amp;#x82B1;&amp;#x8D39;&amp;#x7B49;&amp;#x4E8E;&amp;#x8FD9;&amp;#x4E2A;&amp;#x68C0;&amp;#x67E5;&amp;#x70B9;&amp;#x53F3;&amp;#x4FA7;&amp;#x7684;&amp;#x7B2C;&amp;#x4E00;&amp;#x4E2A;&amp;#x5B88;&amp;#x536B;&amp;#x5854;&amp;#x5230;&amp;#x5B83;&amp;#x7684;&amp;#x8DDD;&amp;#x79BB;&amp;#x3002;&amp;#x7B2C; $ n $ &amp;#x4E2A;&amp;#x70B9;&amp;#x53EA;&amp;#x80FD;&amp;#x653E;&amp;#x7F6E;&amp;#x5B88;&amp;#x536B;&amp;#x5854;&amp;#x3002;&amp;#x6C42;&amp;#x6700;&amp;#x5C0F;&amp;#x7684;&amp;#x6218;&amp;#x7EBF;&amp;#x82B1;&amp;#x8D39;&amp;#x503C;&amp;#x3002;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="BZOJ" scheme="https://blog.menci.moe/tag/bzoj/"/>
    
      <category term="DP" scheme="https://blog.menci.moe/tag/dp/"/>
    
      <category term="单调队列" scheme="https://blog.menci.moe/tag/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97/"/>
    
      <category term="斜率优化" scheme="https://blog.menci.moe/tag/%E6%96%9C%E7%8E%87%E4%BC%98%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>「CEOI2004」锯木厂选址 - 斜率优化DP</title>
    <link href="https://blog.menci.moe/ceoi2004-two/"/>
    <id>https://blog.menci.moe/ceoi2004-two/</id>
    <published>2016-05-18T10:03:00.000Z</published>
    <updated>2016-05-21T13:56:08.000Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x4ECE;&amp;#x5C71;&amp;#x9876;&amp;#x4E0A;&amp;#x5230;&amp;#x5C71;&amp;#x5E95;&amp;#x4E0B;&amp;#x6CBF;&amp;#x7740;&amp;#x4E00;&amp;#x6761;&amp;#x76F4;&amp;#x7EBF;&amp;#x79CD;&amp;#x690D;&amp;#x4E86; $ n $ &amp;#x68F5;&amp;#x8001;&amp;#x6811;&amp;#x3002;&amp;#x5F53;&amp;#x5730;&amp;#x7684;&amp;#x653F;&amp;#x5E9C;&amp;#x51B3;&amp;#x5B9A;&amp;#x628A;&amp;#x4ED6;&amp;#x4EEC;&amp;#x780D;&amp;#x4E0B;&amp;#x6765;&amp;#x3002;&amp;#x4E3A;&amp;#x4E86;&amp;#x4E0D;&amp;#x6D6A;&amp;#x8D39;&amp;#x4EFB;&amp;#x4F55;&amp;#x4E00;&amp;#x68F5;&amp;#x6728;&amp;#x6750;&amp;#xFF0C;&amp;#x6811;&amp;#x88AB;&amp;#x780D;&amp;#x5012;&amp;#x540E;&amp;#x8981;&amp;#x8FD0;&amp;#x9001;&amp;#x5230;&amp;#x952F;&amp;#x6728;&amp;#x5382;&amp;#x3002; &amp;#x6728;&amp;#x6750;&amp;#x53EA;&amp;#x80FD;&amp;#x6309;&amp;#x7167;&amp;#x4E00;&amp;#x4E2A;&amp;#x65B9;&amp;#x5411;&amp;#x8FD0;&amp;#x8F93;&amp;#xFF1A;&amp;#x671D;&amp;#x5C71;&amp;#x4E0B;&amp;#x8FD0;&amp;#x3002;&amp;#x5C71;&amp;#x811A;&amp;#x4E0B;&amp;#x6709;&amp;#x4E00;&amp;#x4E2A;&amp;#x952F;&amp;#x6728;&amp;#x5382;&amp;#x3002;&amp;#x53E6;&amp;#x5916;&amp;#x4E24;&amp;#x4E2A;&amp;#x952F;&amp;#x6728;&amp;#x5382;&amp;#x5C06;&amp;#x65B0;&amp;#x4FEE;&amp;#x5EFA;&amp;#x5728;&amp;#x5C71;&amp;#x8DEF;&amp;#x4E0A;&amp;#x3002;&amp;#x4F60;&amp;#x5FC5;&amp;#x987B;&amp;#x51B3;&amp;#x5B9A;&amp;#x5728;&amp;#x54EA;&amp;#x91CC;&amp;#x4FEE;&amp;#x5EFA;&amp;#x4E24;&amp;#x4E2A;&amp;#x952F;&amp;#x6728;&amp;#x5382;&amp;#xFF0C;&amp;#x4F7F;&amp;#x5F97;&amp;#x4F20;&amp;#x8F93;&amp;#x7684;&amp;#x8D39;&amp;#x7528;&amp;#x603B;&amp;#x548C;&amp;#x6700;&amp;#x5C0F;&amp;#x3002;&amp;#x5047;&amp;#x5B9A;&amp;#x8FD0;&amp;#x8F93;&amp;#x6BCF;&amp;#x516C;&amp;#x65A4;&amp;#x6728;&amp;#x6750;&amp;#x6BCF;&amp;#x7C73;&amp;#x9700;&amp;#x8981;&amp;#x4E00;&amp;#x5206;&amp;#x94B1;&amp;#x3002;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;&amp;#x94FE;&amp;#x63A5;&quot;&gt;&amp;#x94FE;&amp;#x63A5;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://cogs.top/cogs/problem/problem.php?pid=362&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;COGS 362&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x9898;&amp;#x89E3;&quot;&gt;&amp;#x9898;&amp;#x89E3;&lt;/h3&gt;
&lt;p&gt;&amp;#x5C06;&amp;#x6574;&amp;#x4E2A;&amp;#x5E8F;&amp;#x5217;&amp;#x53CD;&amp;#x8F6C;&amp;#xFF0C;&amp;#x76EE;&amp;#x6807;&amp;#x53D8;&amp;#x4E3A;&amp;#x5C06;&amp;#x6240;&amp;#x6709;&amp;#x6811;&amp;#x8FD0;&amp;#x5230; $ 0 $ &amp;#x53F7;&amp;#x70B9;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x8BBE; $ f[i][j] $ &amp;#x8868;&amp;#x793A;&amp;#x524D; $ i $ &amp;#x68F5;&amp;#x6811;&amp;#xFF0C;&amp;#x4FEE;&amp;#x5EFA; $ j $ &amp;#x4E2A;&amp;#x952F;&amp;#x6728;&amp;#x5382;&amp;#x7684;&amp;#x6700;&amp;#x5C0F;&amp;#x82B1;&amp;#x8D39;&amp;#x3002;&amp;#x4F7F;&amp;#x7528;&amp;#x6EDA;&amp;#x52A8;&amp;#x6570;&amp;#x7EC4;&amp;#x53BB;&amp;#x6389;&amp;#x7B2C;&amp;#x4E8C;&amp;#x7EF4;&amp;#xFF0C;&amp;#x8BBE; $ f(i) $ &amp;#x4E3A;&amp;#x539F;&amp;#x6709;&amp;#x7684; $ f[i][j] $&amp;#xFF0C;$ g(i) $ &amp;#x4E3A;&amp;#x539F;&amp;#x6709;&amp;#x7684; $ f[i][j - 1] $&amp;#x3002;$ S(i) $ &amp;#x8868;&amp;#x793A;&amp;#x524D; $ i $ &amp;#x68F5;&amp;#x6811;&amp;#x5168;&amp;#x90E8;&amp;#x8FD0;&amp;#x5230; $ 0 $ &amp;#x53F7;&amp;#x70B9;&amp;#x7684;&amp;#x82B1;&amp;#x8D39;&amp;#xFF0C;$ s(i) $ &amp;#x8868;&amp;#x793A;&amp;#x524D; $ i $ &amp;#x68F5;&amp;#x6811;&amp;#x7684;&amp;#x603B;&amp;#x8D28;&amp;#x91CF;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;$$ f(i) = \min\limits_{j = 0} ^ {i} \{ g(j) + S(i) - S(j) - (s(i) - s(j)) \times d(j + 1) \} $$&lt;/p&gt;
&lt;p&gt;&amp;#x659C;&amp;#x7387;&amp;#x4F18;&amp;#x5316;&amp;#xFF0C;&amp;#x8003;&amp;#x8651;&amp;#x4E24;&amp;#x4E2A;&amp;#x51B3;&amp;#x7B56;&amp;#x70B9; $ a $&amp;#x3001;$ b $&amp;#xFF0C;&amp;#x82E5; $ a $ &amp;#x6BD4; $ b $ &amp;#x4F18;&amp;#xFF0C;&amp;#x5219;&amp;#x6709;&lt;/p&gt;
&lt;p&gt;$$ {(g(a) - S(a) + s(a) \times d(a + 1)) - (g(b) - S(b) + s(b) \times d(b + 1)) \over d(a + 1) - d(b + 1)} &amp;lt; s(i) $$&lt;/p&gt;
&lt;p&gt;&amp;#x7EF4;&amp;#x62A4;&amp;#x51B3;&amp;#x7B56;&amp;#x70B9;&amp;#xFF0C;&amp;#x4F7F;&amp;#x659C;&amp;#x7387;&amp;#x9012;&amp;#x589E;&amp;#xFF0C;&amp;#x6700;&amp;#x4F18;&amp;#x51B3;&amp;#x7B56;&amp;#x53D6;&amp;#x961F;&amp;#x9996;&amp;#x3002;&amp;#x65F6;&amp;#x95F4;&amp;#x590D;&amp;#x6742;&amp;#x5EA6;&amp;#x4E3A; $ O(n) $&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x4EE3;&amp;#x7801;&quot;&gt;&amp;#x4EE3;&amp;#x7801;&lt;/h3&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;93&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;94&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;95&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;96&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;97&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;climits&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;algorithm&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXN = &lt;span class=&quot;number&quot;&gt;20000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXM = &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; w[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;], d[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;], s[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;], S[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; g[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;], f[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;prepare&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::reverse(w + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, w + n + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::reverse(d + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, d + n + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        d[i] += d[i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        s[i] = s[i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;] + w[i];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        S[i] = S[i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;] + w[i] * d[i];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;/*&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;inline void force() {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    std::copy(S, S + n + 1, f);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    for (int k = 1; k &amp;lt; MAXM; k++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        std::copy(f, f + n + 1, g);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        std::fill(f, f + n + 1, LLONG_MAX);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        f[0] = 0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        for (int i = 1; i &amp;lt;= n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            int _j = -1;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            for (int j = 0; j &amp;lt; i; j++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                if (f[i] &amp;gt; g[j] + S[i] - S[j] - (s[i] - s[j]) * d[j + 1]) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    f[i] = g[j] + S[i] - S[j] - (s[i] - s[j]) * d[j + 1];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    _j = j;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            printf(&amp;quot;%d --&amp;gt; %d\n&amp;quot;, i, _j);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;*/&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i)&lt;/span&gt; &lt;/span&gt;{ &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; g[i] - S[i] + s[i] * d[i + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]; }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;slope&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; a, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; b)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt;(x(a) - x(b))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;         / &lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt;(d[a + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;] - d[b + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;dp&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::copy(S, S + n + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, f);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; k = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; k &amp;lt; MAXM; k++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::copy(f, f + n + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, g);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::fill(f, f + n + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, LLONG_MAX);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        f[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;] = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; q[MAXN];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; *l = q, *r = q;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        *r = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (l &amp;lt; &lt;span class=&quot;function&quot;&gt;r &amp;amp;&amp;amp; &lt;span class=&quot;title&quot;&gt;slope&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(*(l + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&lt;/span&gt;, *l) &amp;lt; s[i]) l++&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &amp;amp;j = *l;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            f[i] = g[j] + S[i] - S[j] - (s[i] - s[j]) * d[j + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;// printf(&amp;quot;%d --&amp;gt; %d\n&amp;quot;, i, j);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (i &amp;lt; n) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (l &amp;lt; &lt;span class=&quot;function&quot;&gt;r &amp;amp;&amp;amp; &lt;span class=&quot;title&quot;&gt;slope&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(*r, *(r - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&lt;/span&gt;) &amp;gt; &lt;span class=&quot;title&quot;&gt;slope&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(i, *r)&lt;/span&gt;) r--&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                *++r = i;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    freopen(&lt;span class=&quot;string&quot;&gt;&amp;quot;two.in&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;r&amp;quot;&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;stdin&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    freopen(&lt;span class=&quot;string&quot;&gt;&amp;quot;two.out&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;w&amp;quot;&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;stdout&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;n);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%lld %lld&amp;quot;&lt;/span&gt;, &amp;amp;w[i], &amp;amp;d[i]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    prepare();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// force();&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    dp();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%lld\n&amp;quot;&lt;/span&gt;, f[n]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    fclose(&lt;span class=&quot;built_in&quot;&gt;stdin&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    fclose(&lt;span class=&quot;built_in&quot;&gt;stdout&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x4ECE;&amp;#x5C71;&amp;#x9876;&amp;#x4E0A;&amp;#x5230;&amp;#x5C71;&amp;#x5E95;&amp;#x4E0B;&amp;#x6CBF;&amp;#x7740;&amp;#x4E00;&amp;#x6761;&amp;#x76F4;&amp;#x7EBF;&amp;#x79CD;&amp;#x690D;&amp;#x4E86; $ n $ &amp;#x68F5;&amp;#x8001;&amp;#x6811;&amp;#x3002;&amp;#x5F53;&amp;#x5730;&amp;#x7684;&amp;#x653F;&amp;#x5E9C;&amp;#x51B3;&amp;#x5B9A;&amp;#x628A;&amp;#x4ED6;&amp;#x4EEC;&amp;#x780D;&amp;#x4E0B;&amp;#x6765;&amp;#x3002;&amp;#x4E3A;&amp;#x4E86;&amp;#x4E0D;&amp;#x6D6A;&amp;#x8D39;&amp;#x4EFB;&amp;#x4F55;&amp;#x4E00;&amp;#x68F5;&amp;#x6728;&amp;#x6750;&amp;#xFF0C;&amp;#x6811;&amp;#x88AB;&amp;#x780D;&amp;#x5012;&amp;#x540E;&amp;#x8981;&amp;#x8FD0;&amp;#x9001;&amp;#x5230;&amp;#x952F;&amp;#x6728;&amp;#x5382;&amp;#x3002; &amp;#x6728;&amp;#x6750;&amp;#x53EA;&amp;#x80FD;&amp;#x6309;&amp;#x7167;&amp;#x4E00;&amp;#x4E2A;&amp;#x65B9;&amp;#x5411;&amp;#x8FD0;&amp;#x8F93;&amp;#xFF1A;&amp;#x671D;&amp;#x5C71;&amp;#x4E0B;&amp;#x8FD0;&amp;#x3002;&amp;#x5C71;&amp;#x811A;&amp;#x4E0B;&amp;#x6709;&amp;#x4E00;&amp;#x4E2A;&amp;#x952F;&amp;#x6728;&amp;#x5382;&amp;#x3002;&amp;#x53E6;&amp;#x5916;&amp;#x4E24;&amp;#x4E2A;&amp;#x952F;&amp;#x6728;&amp;#x5382;&amp;#x5C06;&amp;#x65B0;&amp;#x4FEE;&amp;#x5EFA;&amp;#x5728;&amp;#x5C71;&amp;#x8DEF;&amp;#x4E0A;&amp;#x3002;&amp;#x4F60;&amp;#x5FC5;&amp;#x987B;&amp;#x51B3;&amp;#x5B9A;&amp;#x5728;&amp;#x54EA;&amp;#x91CC;&amp;#x4FEE;&amp;#x5EFA;&amp;#x4E24;&amp;#x4E2A;&amp;#x952F;&amp;#x6728;&amp;#x5382;&amp;#xFF0C;&amp;#x4F7F;&amp;#x5F97;&amp;#x4F20;&amp;#x8F93;&amp;#x7684;&amp;#x8D39;&amp;#x7528;&amp;#x603B;&amp;#x548C;&amp;#x6700;&amp;#x5C0F;&amp;#x3002;&amp;#x5047;&amp;#x5B9A;&amp;#x8FD0;&amp;#x8F93;&amp;#x6BCF;&amp;#x516C;&amp;#x65A4;&amp;#x6728;&amp;#x6750;&amp;#x6BCF;&amp;#x7C73;&amp;#x9700;&amp;#x8981;&amp;#x4E00;&amp;#x5206;&amp;#x94B1;&amp;#x3002;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="CEOI" scheme="https://blog.menci.moe/tag/ceoi/"/>
    
      <category term="COGS" scheme="https://blog.menci.moe/tag/cogs/"/>
    
      <category term="DP" scheme="https://blog.menci.moe/tag/dp/"/>
    
      <category term="单调队列" scheme="https://blog.menci.moe/tag/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97/"/>
    
      <category term="斜率优化" scheme="https://blog.menci.moe/tag/%E6%96%9C%E7%8E%87%E4%BC%98%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>「BZOJ 1597」土地购买 - 斜率优化DP</title>
    <link href="https://blog.menci.moe/bzoj-1597/"/>
    <id>https://blog.menci.moe/bzoj-1597/</id>
    <published>2016-05-18T09:04:00.000Z</published>
    <updated>2016-05-21T13:56:08.000Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x519C;&amp;#x592B; John &amp;#x51C6;&amp;#x5907;&amp;#x6269;&amp;#x5927;&amp;#x4ED6;&amp;#x7684;&amp;#x519C;&amp;#x573A;&amp;#xFF0C;&amp;#x4ED6;&amp;#x6B63;&amp;#x5728;&amp;#x8003;&amp;#x8651; $ N $&amp;#xFF08;$ 1 \leq N \leq 50000 $&amp;#xFF09;&amp;#x5757;&amp;#x957F;&amp;#x65B9;&amp;#x5F62;&amp;#x7684;&amp;#x571F;&amp;#x5730;&amp;#x3002;&amp;#x6BCF;&amp;#x5757;&amp;#x571F;&amp;#x5730;&amp;#x7684;&amp;#x957F;&amp;#x5BBD;&amp;#x6EE1;&amp;#x8DB3;&amp;#xFF08;$ 1 \leq $ &amp;#x957F;&amp;#x3001;&amp;#x5BBD; $ \leq 1000000 $&amp;#xFF09;&amp;#x3002;&amp;#x6BCF;&amp;#x5757;&amp;#x571F;&amp;#x5730;&amp;#x7684;&amp;#x4EF7;&amp;#x683C;&amp;#x662F;&amp;#x5B83;&amp;#x7684;&amp;#x9762;&amp;#x79EF;&amp;#xFF0C;&amp;#x4F46; FJ &amp;#x53EF;&amp;#x4EE5;&amp;#x540C;&amp;#x65F6;&amp;#x8D2D;&amp;#x4E70;&amp;#x591A;&amp;#x5FEB;&amp;#x571F;&amp;#x5730;&amp;#x3002;&amp;#x8FD9;&amp;#x4E9B;&amp;#x571F;&amp;#x5730;&amp;#x7684;&amp;#x4EF7;&amp;#x683C;&amp;#x662F;&amp;#x5B83;&amp;#x4EEC;&amp;#x6700;&amp;#x5927;&amp;#x7684;&amp;#x957F;&amp;#x4E58;&amp;#x4EE5;&amp;#x5B83;&amp;#x4EEC;&amp;#x6700;&amp;#x5927;&amp;#x7684;&amp;#x5BBD;&amp;#xFF0C;&amp;#x4F46;&amp;#x662F;&amp;#x571F;&amp;#x5730;&amp;#x7684;&amp;#x957F;&amp;#x5BBD;&amp;#x4E0D;&amp;#x80FD;&amp;#x4EA4;&amp;#x6362;&amp;#x3002;&amp;#x5982;&amp;#x679C; FJ &amp;#x4E70;&amp;#x4E00;&amp;#x5757; $ 3 \times 5 $ &amp;#x7684;&amp;#x5730;&amp;#x548C;&amp;#x4E00;&amp;#x5757; $ 5 \times 3 $ &amp;#x7684;&amp;#x5730;&amp;#xFF0C;&amp;#x5219;&amp;#x4ED6;&amp;#x9700;&amp;#x8981;&amp;#x4ED8; $ 5 \times 5 = 25 $&amp;#x3002;FJ &amp;#x5E0C;&amp;#x671B;&amp;#x4E70;&amp;#x4E0B;&amp;#x6240;&amp;#x6709;&amp;#x7684;&amp;#x571F;&amp;#x5730;&amp;#xFF0C;&amp;#x4F46;&amp;#x662F;&amp;#x4ED6;&amp;#x53D1;&amp;#x73B0;&amp;#x5206;&amp;#x7EC4;&amp;#x6765;&amp;#x4E70;&amp;#x8FD9;&amp;#x4E9B;&amp;#x571F;&amp;#x5730;&amp;#x53EF;&amp;#x4EE5;&amp;#x8282;&amp;#x7701;&amp;#x7ECF;&amp;#x8D39;&amp;#xFF0C;&amp;#x4ED6;&amp;#x9700;&amp;#x8981;&amp;#x4F60;&amp;#x5E2E;&amp;#x52A9;&amp;#x4ED6;&amp;#x627E;&amp;#x5230;&amp;#x6700;&amp;#x5C0F;&amp;#x7684;&amp;#x7ECF;&amp;#x8D39;&amp;#x3002;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;&amp;#x94FE;&amp;#x63A5;&quot;&gt;&amp;#x94FE;&amp;#x63A5;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://www.lydsy.com/JudgeOnline/problem.php?id=1597&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;BZOJ 1597&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x9898;&amp;#x89E3;&quot;&gt;&amp;#x9898;&amp;#x89E3;&lt;/h3&gt;
&lt;p&gt;&amp;#x8003;&amp;#x8651;&amp;#x4E24;&amp;#x5757;&amp;#x571F;&amp;#x5730;&amp;#xFF0C;&amp;#x82E5;&amp;#x5176;&amp;#x4E2D;&amp;#x4E00;&amp;#x5757;&amp;#x53EF;&amp;#x5C06;&amp;#x53E6;&amp;#x4E00;&amp;#x5757;&amp;#x5B8C;&amp;#x5168;&amp;#x5305;&amp;#x542B;&amp;#xFF0C;&amp;#x5219;&amp;#x53EF;&amp;#x4EE5;&amp;#x5C06;&amp;#x8F83;&amp;#x5C0F;&amp;#x7684;&amp;#x4E00;&amp;#x5757;&amp;#x5FFD;&amp;#x7565;&amp;#xFF0C;&amp;#x56E0;&amp;#x4E3A;&amp;#x5B83;&amp;#x603B;&amp;#x662F;&amp;#x53EF;&amp;#x4EE5;&amp;#x88AB;&amp;#x548C;&amp;#x53E6;&amp;#x4E00;&amp;#x5757;&amp;#x540C;&amp;#x65F6;&amp;#x8D2D;&amp;#x4E70;&amp;#xFF0C;&amp;#x800C;&amp;#x4E0D;&amp;#x589E;&amp;#x52A0;&amp;#x82B1;&amp;#x8D39;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x6392;&amp;#x5E8F;&amp;#x5C06;&amp;#x4E0A;&amp;#x8FF0;&amp;#x60C5;&amp;#x51B5;&amp;#x7B5B;&amp;#x9664;&amp;#x540E;&amp;#xFF0C;&amp;#x6574;&amp;#x4E2A;&amp;#x5E8F;&amp;#x5217;&amp;#x4EE5;&amp;#x4E00;&amp;#x4E2A;&amp;#x5173;&amp;#x952E;&amp;#x5B57;&amp;#x5347;&amp;#x5E8F;&amp;#xFF0C;&amp;#x53E6;&amp;#x4E00;&amp;#x4E2A;&amp;#x5173;&amp;#x952E;&amp;#x5B57;&amp;#x964D;&amp;#x5E8F;&amp;#x3002;&amp;#x5047;&amp;#x8BBE;&amp;#x5BBD;&amp;#x5EA6; $ w(i) $ &amp;#x964D;&amp;#x5E8F;&amp;#xFF0C;&amp;#x9AD8;&amp;#x5EA6; $ h(i) $ &amp;#x5347;&amp;#x5E8F;&amp;#x3002;&amp;#x8BBE; $ f(i) $ &amp;#x8868;&amp;#x793A;&amp;#x8D2D;&amp;#x4E70;&amp;#x524D; $ i $ &amp;#x5757;&amp;#x571F;&amp;#x5730;&amp;#x7684;&amp;#x6700;&amp;#x5C0F;&amp;#x82B1;&amp;#x8D39;&amp;#xFF0C;&amp;#x8003;&amp;#x8651;&amp;#x54EA;&amp;#x4E9B;&amp;#x4E0D;&amp;#x548C; $ i $ &amp;#x5728;&amp;#x4E00;&amp;#x8D77;&amp;#x8D2D;&amp;#x4E70;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;$$ f(i) = \min\limits_{j = 0} ^ {i - 1} \{ f(j) + w(j + 1) \times h(i) \} $$&lt;/p&gt;
&lt;p&gt;&amp;#x659C;&amp;#x7387;&amp;#x4F18;&amp;#x5316;&amp;#xFF0C;&amp;#x8003;&amp;#x8651;&amp;#x4E24;&amp;#x4E2A;&amp;#x51B3;&amp;#x7B56; $ a $&amp;#x3001;$ b $&amp;#xFF0C;&amp;#x82E5; $ a $ &amp;#x6BD4; $ b $ &amp;#x4F18;&amp;#xFF0C;&amp;#x5219;&amp;#x6709;&lt;/p&gt;
&lt;p&gt;$$ \begin{align*} f(a) + w(a + 1) \times h(i) &amp;amp; &amp;lt; f(b) + w(b + 1) \times h(i) \\ f(a) + f(b) &amp;amp; &amp;lt; (w(b + 1) - w(a + 1)) \times h(i) \\ f(a) + f(b) \over w(b + 1) - w(a + 1) &amp;amp; &amp;lt; h(i) \\ \end{align*} $$&lt;/p&gt;
&lt;p&gt;&amp;#x7EF4;&amp;#x62A4;&amp;#x51B3;&amp;#x7B56;&amp;#x70B9;&amp;#xFF0C;&amp;#x4F7F;&amp;#x659C;&amp;#x7387;&amp;#x9012;&amp;#x589E;&amp;#xFF0C;&amp;#x6700;&amp;#x4F18;&amp;#x51B3;&amp;#x7B56;&amp;#x53D6;&amp;#x961F;&amp;#x9996;&amp;#x3002;&amp;#x65F6;&amp;#x95F4;&amp;#x590D;&amp;#x6742;&amp;#x5EA6;&amp;#x4E3A; $ O(n) $&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x4EE3;&amp;#x7801;&quot;&gt;&amp;#x4EE3;&amp;#x7801;&lt;/h3&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;87&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;climits&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;utility&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;functional&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;algorithm&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;vector&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXN = &lt;span class=&quot;number&quot;&gt;50000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::pair&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;&amp;gt; A[MAXN];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;vector&lt;/span&gt;&amp;lt; &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::pair&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;&amp;gt;* &amp;gt; vec;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; f[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;prepare&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::sort(A, A + n, &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::greater&amp;lt; &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::pair&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;&amp;gt; &amp;gt;());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::pair&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;&amp;gt; *last = &lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!last || A[i].second &amp;gt; last-&amp;gt;second) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            vec.push_back(&amp;amp;A[i]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            last = &amp;amp;A[i];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    n = vec.size();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i)&lt;/span&gt; &lt;/span&gt;{ &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static_cast&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt;&amp;gt;(vec[i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]-&amp;gt;first); }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;h&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i)&lt;/span&gt; &lt;/span&gt;{ &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static_cast&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt;&amp;gt;(vec[i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]-&amp;gt;second); }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;force&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    f[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;] = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::fill(f + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, f + n + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, LLONG_MAX);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; _j = -&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; j = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; j &amp;lt; i; j++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (f[i] &amp;gt; f[j] + w(j + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) * h(i)) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                f[i] = f[j] + w(j + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) * h(i);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                _j = j;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// printf(&amp;quot;%d --&amp;gt; %d\n&amp;quot;, i, _j);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;slope&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; a, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; b)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt;(f[a] - f[b])&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;         / &lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt;(w(b + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) - w(a + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;dp&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    f[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;] = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::fill(f + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, f + n + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, LLONG_MAX);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; q[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; *l = &amp;amp;q[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;], *r = &amp;amp;q[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    *r = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (l &amp;lt; &lt;span class=&quot;function&quot;&gt;r &amp;amp;&amp;amp; &lt;span class=&quot;title&quot;&gt;slope&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(*(l + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&lt;/span&gt;, *l) &amp;lt; &lt;span class=&quot;title&quot;&gt;h&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(i)&lt;/span&gt;) l++&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; tmp = *l;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        f[i] = f[tmp] + w(tmp + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) * h(i);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// printf(&amp;quot;%d --&amp;gt; %d\n&amp;quot;, i, tmp);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (i != n) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (l &amp;lt; &lt;span class=&quot;function&quot;&gt;r &amp;amp;&amp;amp; &lt;span class=&quot;title&quot;&gt;slope&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(*r, *(r - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&lt;/span&gt;) &amp;gt; &lt;span class=&quot;title&quot;&gt;slope&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(*r, i)&lt;/span&gt;) r--&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            *++r = i;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;n);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d&amp;quot;&lt;/span&gt;, &amp;amp;A[i].first, &amp;amp;A[i].second);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    prepare();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// for (int i = 0; i &amp;lt; n; i++) printf(&amp;quot;%d %d\n&amp;quot;, vec[i]-&amp;gt;first, vec[i]-&amp;gt;second);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// force();&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    dp();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%lld\n&amp;quot;&lt;/span&gt;, f[n]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x519C;&amp;#x592B; John &amp;#x51C6;&amp;#x5907;&amp;#x6269;&amp;#x5927;&amp;#x4ED6;&amp;#x7684;&amp;#x519C;&amp;#x573A;&amp;#xFF0C;&amp;#x4ED6;&amp;#x6B63;&amp;#x5728;&amp;#x8003;&amp;#x8651; $ N $&amp;#xFF08;$ 1 \leq N \leq 50000 $&amp;#xFF09;&amp;#x5757;&amp;#x957F;&amp;#x65B9;&amp;#x5F62;&amp;#x7684;&amp;#x571F;&amp;#x5730;&amp;#x3002;&amp;#x6BCF;&amp;#x5757;&amp;#x571F;&amp;#x5730;&amp;#x7684;&amp;#x957F;&amp;#x5BBD;&amp;#x6EE1;&amp;#x8DB3;&amp;#xFF08;$ 1 \leq $ &amp;#x957F;&amp;#x3001;&amp;#x5BBD; $ \leq 1000000 $&amp;#xFF09;&amp;#x3002;&amp;#x6BCF;&amp;#x5757;&amp;#x571F;&amp;#x5730;&amp;#x7684;&amp;#x4EF7;&amp;#x683C;&amp;#x662F;&amp;#x5B83;&amp;#x7684;&amp;#x9762;&amp;#x79EF;&amp;#xFF0C;&amp;#x4F46; FJ &amp;#x53EF;&amp;#x4EE5;&amp;#x540C;&amp;#x65F6;&amp;#x8D2D;&amp;#x4E70;&amp;#x591A;&amp;#x5FEB;&amp;#x571F;&amp;#x5730;&amp;#x3002;&amp;#x8FD9;&amp;#x4E9B;&amp;#x571F;&amp;#x5730;&amp;#x7684;&amp;#x4EF7;&amp;#x683C;&amp;#x662F;&amp;#x5B83;&amp;#x4EEC;&amp;#x6700;&amp;#x5927;&amp;#x7684;&amp;#x957F;&amp;#x4E58;&amp;#x4EE5;&amp;#x5B83;&amp;#x4EEC;&amp;#x6700;&amp;#x5927;&amp;#x7684;&amp;#x5BBD;&amp;#xFF0C;&amp;#x4F46;&amp;#x662F;&amp;#x571F;&amp;#x5730;&amp;#x7684;&amp;#x957F;&amp;#x5BBD;&amp;#x4E0D;&amp;#x80FD;&amp;#x4EA4;&amp;#x6362;&amp;#x3002;&amp;#x5982;&amp;#x679C; FJ &amp;#x4E70;&amp;#x4E00;&amp;#x5757; $ 3 \times 5 $ &amp;#x7684;&amp;#x5730;&amp;#x548C;&amp;#x4E00;&amp;#x5757; $ 5 \times 3 $ &amp;#x7684;&amp;#x5730;&amp;#xFF0C;&amp;#x5219;&amp;#x4ED6;&amp;#x9700;&amp;#x8981;&amp;#x4ED8; $ 5 \times 5 = 25 $&amp;#x3002;FJ &amp;#x5E0C;&amp;#x671B;&amp;#x4E70;&amp;#x4E0B;&amp;#x6240;&amp;#x6709;&amp;#x7684;&amp;#x571F;&amp;#x5730;&amp;#xFF0C;&amp;#x4F46;&amp;#x662F;&amp;#x4ED6;&amp;#x53D1;&amp;#x73B0;&amp;#x5206;&amp;#x7EC4;&amp;#x6765;&amp;#x4E70;&amp;#x8FD9;&amp;#x4E9B;&amp;#x571F;&amp;#x5730;&amp;#x53EF;&amp;#x4EE5;&amp;#x8282;&amp;#x7701;&amp;#x7ECF;&amp;#x8D39;&amp;#xFF0C;&amp;#x4ED6;&amp;#x9700;&amp;#x8981;&amp;#x4F60;&amp;#x5E2E;&amp;#x52A9;&amp;#x4ED6;&amp;#x627E;&amp;#x5230;&amp;#x6700;&amp;#x5C0F;&amp;#x7684;&amp;#x7ECF;&amp;#x8D39;&amp;#x3002;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="BZOJ" scheme="https://blog.menci.moe/tag/bzoj/"/>
    
      <category term="DP" scheme="https://blog.menci.moe/tag/dp/"/>
    
      <category term="单调队列" scheme="https://blog.menci.moe/tag/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97/"/>
    
      <category term="斜率优化" scheme="https://blog.menci.moe/tag/%E6%96%9C%E7%8E%87%E4%BC%98%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>「ZJOI2007」仓库建设 - 斜率优化DP</title>
    <link href="https://blog.menci.moe/zjoi2007-storage/"/>
    <id>https://blog.menci.moe/zjoi2007-storage/</id>
    <published>2016-05-18T03:58:00.000Z</published>
    <updated>2016-05-18T09:11:22.000Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x7B2C; $ i $ &amp;#x4E2A;&amp;#x5DE5;&amp;#x5382;&amp;#x76EE;&amp;#x524D;&amp;#x5DF2;&amp;#x6709;&amp;#x6210;&amp;#x54C1; $ P_i $ &amp;#x4EF6;&amp;#xFF0C;&amp;#x5728;&amp;#x7B2C; $ i $ &amp;#x4E2A;&amp;#x4F4D;&amp;#x7F6E;&amp;#x5EFA;&amp;#x7ACB;&amp;#x4ED3;&amp;#x5E93;&amp;#x7684;&amp;#x8D39;&amp;#x7528;&amp;#x662F; $ C_i $&amp;#x3002;&amp;#x5BF9;&amp;#x4E8E;&amp;#x6CA1;&amp;#x6709;&amp;#x5EFA;&amp;#x7ACB;&amp;#x4ED3;&amp;#x5E93;&amp;#x7684;&amp;#x5DE5;&amp;#x5382;&amp;#xFF0C;&amp;#x5176;&amp;#x4EA7;&amp;#x54C1;&amp;#x5E94;&amp;#x88AB;&amp;#x8FD0;&amp;#x5F80;&amp;#x5176;&amp;#x4ED6;&amp;#x7684;&amp;#x4ED3;&amp;#x5E93;&amp;#x8FDB;&amp;#x884C;&amp;#x50A8;&amp;#x85CF;&amp;#xFF0C;&amp;#x800C;&amp;#x7531;&amp;#x4E8E;&amp;#x516C;&amp;#x53F8;&amp;#x4EA7;&amp;#x54C1;&amp;#x7684;&amp;#x5BF9;&amp;#x5916;&amp;#x9500;&amp;#x552E;&amp;#x5904;&amp;#x8BBE;&amp;#x7F6E;&amp;#x5728;&amp;#x5C71;&amp;#x811A;&amp;#x7684;&amp;#x5DE5;&amp;#x5382; $ N $&amp;#xFF0C;&amp;#x6545;&amp;#x4EA7;&amp;#x54C1;&amp;#x53EA;&amp;#x80FD;&amp;#x5F80;&amp;#x5C71;&amp;#x4E0B;&amp;#x8FD0;&amp;#xFF08;&amp;#x5373;&amp;#x53EA;&amp;#x80FD;&amp;#x8FD0;&amp;#x5F80;&amp;#x7F16;&amp;#x53F7;&amp;#x66F4;&amp;#x5927;&amp;#x7684;&amp;#x5DE5;&amp;#x5382;&amp;#x7684;&amp;#x4ED3;&amp;#x5E93;&amp;#xFF09;&amp;#xFF0C;&amp;#x5F53;&amp;#x7136;&amp;#x8FD0;&amp;#x9001;&amp;#x4EA7;&amp;#x54C1;&amp;#x4E5F;&amp;#x662F;&amp;#x9700;&amp;#x8981;&amp;#x8D39;&amp;#x7528;&amp;#x7684;&amp;#xFF0C;&amp;#x5047;&amp;#x8BBE;&amp;#x4E00;&amp;#x4EF6;&amp;#x4EA7;&amp;#x54C1;&amp;#x8FD0;&amp;#x9001; $ 1 $ &amp;#x4E2A;&amp;#x5355;&amp;#x4F4D;&amp;#x8DDD;&amp;#x79BB;&amp;#x7684;&amp;#x8D39;&amp;#x7528;&amp;#x662F; $ 1 $&amp;#x3002;&amp;#x5047;&amp;#x8BBE;&amp;#x5EFA;&amp;#x7ACB;&amp;#x7684;&amp;#x4ED3;&amp;#x5E93;&amp;#x5BB9;&amp;#x91CF;&amp;#x90FD;&amp;#x90FD;&amp;#x662F;&amp;#x8DB3;&amp;#x591F;&amp;#x5927;&amp;#x7684;&amp;#xFF0C;&amp;#x53EF;&amp;#x4EE5;&amp;#x5BB9;&amp;#x4E0B;&amp;#x6240;&amp;#x6709;&amp;#x7684;&amp;#x4EA7;&amp;#x54C1;&amp;#x3002;&amp;#x4F60;&amp;#x5C06;&amp;#x5F97;&amp;#x5230;&amp;#x4EE5;&amp;#x4E0B;&amp;#x6570;&amp;#x636E;&amp;#xFF1A;&lt;/p&gt;
&lt;ol style=&quot;list-style-type: decimal&quot;&gt;
&lt;li&gt;&amp;#x5DE5;&amp;#x5382; $ i $ &amp;#x8DDD;&amp;#x79BB;&amp;#x5DE5;&amp;#x5382; $ 1 $ &amp;#x7684;&amp;#x8DDD;&amp;#x79BB; $ x_i $&amp;#xFF08;&amp;#x5176;&amp;#x4E2D; $ x_1 = 0 $&amp;#xFF09;&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x5DE5;&amp;#x5382; $ i $ &amp;#x76EE;&amp;#x524D;&amp;#x5DF2;&amp;#x6709;&amp;#x6210;&amp;#x54C1;&amp;#x6570;&amp;#x91CF; $ p_i $&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x5728;&amp;#x5DE5;&amp;#x5382; $ i $ &amp;#x5EFA;&amp;#x7ACB;&amp;#x4ED3;&amp;#x5E93;&amp;#x7684;&amp;#x8D39;&amp;#x7528; $ c_i $&amp;#x3002;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&amp;#x8BF7;&amp;#x4F60;&amp;#x5E2E;&amp;#x52A9;&amp;#x516C;&amp;#x53F8;&amp;#x5BFB;&amp;#x627E;&amp;#x4E00;&amp;#x4E2A;&amp;#x4ED3;&amp;#x5E93;&amp;#x5EFA;&amp;#x8BBE;&amp;#x7684;&amp;#x65B9;&amp;#x6848;&amp;#xFF0C;&amp;#x4F7F;&amp;#x5F97;&amp;#x603B;&amp;#x7684;&amp;#x8D39;&amp;#x7528;&amp;#xFF08;&amp;#x5EFA;&amp;#x9020;&amp;#x8D39;&amp;#x7528; + &amp;#x8FD0;&amp;#x8F93;&amp;#x8D39;&amp;#x7528;&amp;#xFF09;&amp;#x6700;&amp;#x5C0F;&amp;#x3002;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;&amp;#x94FE;&amp;#x63A5;&quot;&gt;&amp;#x94FE;&amp;#x63A5;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://www.lydsy.com/JudgeOnline/problem.php?id=1096&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;BZOJ 1096&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://cogs.top/cogs/problem/problem.php?pid=367&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;COGS 367&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x9898;&amp;#x89E3;&quot;&gt;&amp;#x9898;&amp;#x89E3;&lt;/h3&gt;
&lt;p&gt;&amp;#x5C06;&amp;#x6574;&amp;#x4E2A;&amp;#x5E8F;&amp;#x5217;&amp;#x7FFB;&amp;#x8F6C;&amp;#xFF0C;&amp;#x53D8;&amp;#x4E3A;&amp;#x4ECE;&amp;#x7F16;&amp;#x53F7;&amp;#x5927;&amp;#x7684;&amp;#x8FD0;&amp;#x5F80;&amp;#x7F16;&amp;#x53F7;&amp;#x5C0F;&amp;#x7684;&amp;#xFF0C;&amp;#x8BBE; $ S(i) $ &amp;#x8868;&amp;#x793A;&amp;#x524D; $ i $ &amp;#x4E2A;&amp;#x5DE5;&amp;#x5382;&amp;#x5168;&amp;#x90E8;&amp;#x8FD0;&amp;#x5230; $ 1 $ &amp;#x53F7;&amp;#x5DE5;&amp;#x5382;&amp;#x7684;&amp;#x8D39;&amp;#x7528;&amp;#xFF0C;$ s(i) $ &amp;#x8868;&amp;#x793A;&amp;#x524D; $ i $ &amp;#x4E2A;&amp;#x5DE5;&amp;#x5382;&amp;#x7684;&amp;#x6210;&amp;#x54C1;&amp;#x603B;&amp;#x6570;&amp;#x91CF;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x8BBE; $ f(i) $ &amp;#x8868;&amp;#x793A;&amp;#x524D; i &amp;#x4E2A;&amp;#x5DE5;&amp;#x5382;&amp;#x5904;&amp;#x7406;&amp;#x5B8C;&amp;#x6210;&amp;#x7684;&amp;#x6700;&amp;#x5C0F;&amp;#x82B1;&amp;#x8D39;&amp;#xFF0C;&amp;#x5219;&lt;/p&gt;
&lt;p&gt;$$ f(i) = \min\limits_{j = 0} ^ {i - 1} \{ f(j) + c(j + 1) + S(i) - S(j) - (s(i) - s(j)) \times d(j + 1) \} $$&lt;/p&gt;
&lt;p&gt;&amp;#x659C;&amp;#x7387;&amp;#x4F18;&amp;#x5316;&amp;#xFF0C;&amp;#x8003;&amp;#x8651;&amp;#x4E24;&amp;#x4E2A;&amp;#x51B3;&amp;#x7B56; $ a $&amp;#x3001;$ b $&amp;#xFF08;$ a &amp;gt; b $&amp;#xFF09;&amp;#xFF0C;&amp;#x82E5; $ a $ &amp;#x6BD4; $ b $ &amp;#x4F18;&amp;#xFF0C;&amp;#x5219;&amp;#x6709;&lt;/p&gt;
&lt;p&gt;$$ \begin{align*} f(a) + c(a + 1) + S(i) - S(a) - (s(i) - s(a)) \times d(a + 1) &amp;amp; &amp;lt; f(b) + c(b + 1) + S(i) - S(b) - (s(i) - s(b)) \times d(b + 1) \\ f(a) + c(a + 1) - S(a) - (s(i) - s(a)) \times d(a + 1) &amp;amp; &amp;lt; f(b) + c(b + 1) - S(b) - (s(i) - s(b)) \times d(b + 1) \\ f(a) + c(a + 1) - S(a) - s(i) \times d(a + 1) - s(a) \times d(a + 1) &amp;amp; &amp;lt; f(b) + c(b + 1) - S(b) - s(i) \times d(b + 1) - s(b) \times d(b + 1) \\ (f(a) + c(a + 1) - S(a) - s(a) \times d(a + 1)) - (f(b) + c(b + 1) - S(b) - s(b) \times d(b + 1)) &amp;amp; &amp;lt; s(i) \times d(a + 1) - s(i) \times d(b + 1) \\ (f(a) + c(a + 1) - S(a) - s(a) \times d(a + 1)) - (f(b) + c(b + 1) - S(b) - s(b) \times d(b + 1)) \over d(a + 1) - d(b + 1) &amp;amp; &amp;lt; s(i) \\ \end{align*} $$&lt;/p&gt;
&lt;p&gt;&amp;#x7EF4;&amp;#x62A4;&amp;#x51B3;&amp;#x7B56;&amp;#x70B9;&amp;#xFF0C;&amp;#x4F7F;&amp;#x659C;&amp;#x7387;&amp;#x9012;&amp;#x589E;&amp;#xFF0C;&amp;#x6700;&amp;#x4F18;&amp;#x51B3;&amp;#x7B56;&amp;#x53D6;&amp;#x961F;&amp;#x9996;&amp;#x3002;&amp;#x65F6;&amp;#x95F4;&amp;#x590D;&amp;#x6742;&amp;#x5EA6;&amp;#x4E3A; $ O(n) $&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x4EE3;&amp;#x7801;&quot;&gt;&amp;#x4EE3;&amp;#x7801;&lt;/h3&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;90&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;climits&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;algorithm&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXN = &lt;span class=&quot;number&quot;&gt;1000000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; d[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;], p[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;], c[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; s[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;], S[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; f[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;prepare&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::reverse(p + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, p + n + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::reverse(c + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, c + n + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = n; i &amp;gt;= &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i--) d[i] -= d[i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::reverse(d + &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, d + n + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= n; i++) d[i] += d[i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        s[i] = s[i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;] + p[i];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        S[i] = S[i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;] + p[i] * d[i];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;/*&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;inline void force() {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    std::fill(f, f + n + 1, LLONG_MAX);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    f[0] = 0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    for (int i = 1; i &amp;lt;= n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        int _j = -1;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        for (int j = 0; j &amp;lt; i; j++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            if (f[i] &amp;gt; f[j] + c[j + 1] + S[i] - S[j] - (s[i] - s[j]) * d[j + 1]) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                f[i] = f[j] + c[j + 1] + S[i] - S[j] - (s[i] - s[j]) * d[j + 1];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                _j = j;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        // printf(&amp;quot;%d --&amp;gt; %d\n&amp;quot;, i, _j);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;*/&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i)&lt;/span&gt; &lt;/span&gt;{ &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; f[i] + c[i + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;] - S[i] + s[i] * d[i + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]; }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;slope&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; a, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; b)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// printf(&amp;quot;slope(%d, %d) = %.4lf\n&amp;quot;, a, b, double(x(a) - x(b)) / double(d[a + 1] - d[b + 1]));&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt;(x(a) - x(b))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;         / &lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt;(d[a + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;] - d[b + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;dp&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::fill(f, f + n + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, LLONG_MAX);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    f[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;] = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; q[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; *l = q, *r = q;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    *r = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (l &amp;lt; &lt;span class=&quot;function&quot;&gt;r &amp;amp;&amp;amp; &lt;span class=&quot;title&quot;&gt;slope&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(*(l + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&lt;/span&gt;, *l) &amp;lt; s[i]) l++&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// if (l &amp;lt; r) {&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;//     printf(&amp;quot;%lld %lld\n&amp;quot;, f[*l] + c[*l + 1] + S[i] - S[*l] - (s[i] - s[*l]) * d[*l + 1], f[*(l + 1)] + c[*(l + 1) + 1] + S[i] - S[*(l + 1)] - (s[i] - s[*(l + 1)]) * d[*(l + 1) + 1]);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// }&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &amp;amp;j = *l;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        f[i] = f[j] + c[j + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;] + S[i] - S[j] - (s[i] - s[j]) * d[j + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// printf(&amp;quot;%d --&amp;gt; %d\n&amp;quot;, i, j);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (i &amp;lt; n) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (l &amp;lt; &lt;span class=&quot;function&quot;&gt;r &amp;amp;&amp;amp; &lt;span class=&quot;title&quot;&gt;slope&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(*r, *(r - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&lt;/span&gt;) &amp;gt; &lt;span class=&quot;title&quot;&gt;slope&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(i, *r)&lt;/span&gt;) r--&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            *++r = i;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;n);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%lld %lld %lld&amp;quot;&lt;/span&gt;, &amp;amp;d[i], &amp;amp;p[i], &amp;amp;c[i]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    prepare();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// force();&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    dp();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%lld\n&amp;quot;&lt;/span&gt;, f[n]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x7B2C; $ i $ &amp;#x4E2A;&amp;#x5DE5;&amp;#x5382;&amp;#x76EE;&amp;#x524D;&amp;#x5DF2;&amp;#x6709;&amp;#x6210;&amp;#x54C1; $ P_i $ &amp;#x4EF6;&amp;#xFF0C;&amp;#x5728;&amp;#x7B2C; $ i $ &amp;#x4E2A;&amp;#x4F4D;&amp;#x7F6E;&amp;#x5EFA;&amp;#x7ACB;&amp;#x4ED3;&amp;#x5E93;&amp;#x7684;&amp;#x8D39;&amp;#x7528;&amp;#x662F; $ C_i $&amp;#x3002;&amp;#x5BF9;&amp;#x4E8E;&amp;#x6CA1;&amp;#x6709;&amp;#x5EFA;&amp;#x7ACB;&amp;#x4ED3;&amp;#x5E93;&amp;#x7684;&amp;#x5DE5;&amp;#x5382;&amp;#xFF0C;&amp;#x5176;&amp;#x4EA7;&amp;#x54C1;&amp;#x5E94;&amp;#x88AB;&amp;#x8FD0;&amp;#x5F80;&amp;#x5176;&amp;#x4ED6;&amp;#x7684;&amp;#x4ED3;&amp;#x5E93;&amp;#x8FDB;&amp;#x884C;&amp;#x50A8;&amp;#x85CF;&amp;#xFF0C;&amp;#x800C;&amp;#x7531;&amp;#x4E8E;&amp;#x516C;&amp;#x53F8;&amp;#x4EA7;&amp;#x54C1;&amp;#x7684;&amp;#x5BF9;&amp;#x5916;&amp;#x9500;&amp;#x552E;&amp;#x5904;&amp;#x8BBE;&amp;#x7F6E;&amp;#x5728;&amp;#x5C71;&amp;#x811A;&amp;#x7684;&amp;#x5DE5;&amp;#x5382; $ N $&amp;#xFF0C;&amp;#x6545;&amp;#x4EA7;&amp;#x54C1;&amp;#x53EA;&amp;#x80FD;&amp;#x5F80;&amp;#x5C71;&amp;#x4E0B;&amp;#x8FD0;&amp;#xFF08;&amp;#x5373;&amp;#x53EA;&amp;#x80FD;&amp;#x8FD0;&amp;#x5F80;&amp;#x7F16;&amp;#x53F7;&amp;#x66F4;&amp;#x5927;&amp;#x7684;&amp;#x5DE5;&amp;#x5382;&amp;#x7684;&amp;#x4ED3;&amp;#x5E93;&amp;#xFF09;&amp;#xFF0C;&amp;#x5F53;&amp;#x7136;&amp;#x8FD0;&amp;#x9001;&amp;#x4EA7;&amp;#x54C1;&amp;#x4E5F;&amp;#x662F;&amp;#x9700;&amp;#x8981;&amp;#x8D39;&amp;#x7528;&amp;#x7684;&amp;#xFF0C;&amp;#x5047;&amp;#x8BBE;&amp;#x4E00;&amp;#x4EF6;&amp;#x4EA7;&amp;#x54C1;&amp;#x8FD0;&amp;#x9001; $ 1 $ &amp;#x4E2A;&amp;#x5355;&amp;#x4F4D;&amp;#x8DDD;&amp;#x79BB;&amp;#x7684;&amp;#x8D39;&amp;#x7528;&amp;#x662F; $ 1 $&amp;#x3002;&amp;#x5047;&amp;#x8BBE;&amp;#x5EFA;&amp;#x7ACB;&amp;#x7684;&amp;#x4ED3;&amp;#x5E93;&amp;#x5BB9;&amp;#x91CF;&amp;#x90FD;&amp;#x90FD;&amp;#x662F;&amp;#x8DB3;&amp;#x591F;&amp;#x5927;&amp;#x7684;&amp;#xFF0C;&amp;#x53EF;&amp;#x4EE5;&amp;#x5BB9;&amp;#x4E0B;&amp;#x6240;&amp;#x6709;&amp;#x7684;&amp;#x4EA7;&amp;#x54C1;&amp;#x3002;&amp;#x4F60;&amp;#x5C06;&amp;#x5F97;&amp;#x5230;&amp;#x4EE5;&amp;#x4E0B;&amp;#x6570;&amp;#x636E;&amp;#xFF1A;&lt;/p&gt;
&lt;ol style=&quot;list-style-type: decimal&quot;&gt;
&lt;li&gt;&amp;#x5DE5;&amp;#x5382; $ i $ &amp;#x8DDD;&amp;#x79BB;&amp;#x5DE5;&amp;#x5382; $ 1 $ &amp;#x7684;&amp;#x8DDD;&amp;#x79BB; $ x_i $&amp;#xFF08;&amp;#x5176;&amp;#x4E2D; $ x_1 = 0 $&amp;#xFF09;&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x5DE5;&amp;#x5382; $ i $ &amp;#x76EE;&amp;#x524D;&amp;#x5DF2;&amp;#x6709;&amp;#x6210;&amp;#x54C1;&amp;#x6570;&amp;#x91CF; $ p_i $&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x5728;&amp;#x5DE5;&amp;#x5382; $ i $ &amp;#x5EFA;&amp;#x7ACB;&amp;#x4ED3;&amp;#x5E93;&amp;#x7684;&amp;#x8D39;&amp;#x7528; $ c_i $&amp;#x3002;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&amp;#x8BF7;&amp;#x4F60;&amp;#x5E2E;&amp;#x52A9;&amp;#x516C;&amp;#x53F8;&amp;#x5BFB;&amp;#x627E;&amp;#x4E00;&amp;#x4E2A;&amp;#x4ED3;&amp;#x5E93;&amp;#x5EFA;&amp;#x8BBE;&amp;#x7684;&amp;#x65B9;&amp;#x6848;&amp;#xFF0C;&amp;#x4F7F;&amp;#x5F97;&amp;#x603B;&amp;#x7684;&amp;#x8D39;&amp;#x7528;&amp;#xFF08;&amp;#x5EFA;&amp;#x9020;&amp;#x8D39;&amp;#x7528; + &amp;#x8FD0;&amp;#x8F93;&amp;#x8D39;&amp;#x7528;&amp;#xFF09;&amp;#x6700;&amp;#x5C0F;&amp;#x3002;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="BZOJ" scheme="https://blog.menci.moe/tag/bzoj/"/>
    
      <category term="COGS" scheme="https://blog.menci.moe/tag/cogs/"/>
    
      <category term="DP" scheme="https://blog.menci.moe/tag/dp/"/>
    
      <category term="ZJOI" scheme="https://blog.menci.moe/tag/zjoi/"/>
    
      <category term="单调队列" scheme="https://blog.menci.moe/tag/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97/"/>
    
      <category term="斜率优化" scheme="https://blog.menci.moe/tag/%E6%96%9C%E7%8E%87%E4%BC%98%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>「APIO2010」特别行动队 - 斜率优化DP</title>
    <link href="https://blog.menci.moe/apio2010-commando/"/>
    <id>https://blog.menci.moe/apio2010-commando/</id>
    <published>2016-05-13T12:16:00.000Z</published>
    <updated>2016-05-13T12:17:36.000Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x4E00;&amp;#x652F;&amp;#x90E8;&amp;#x961F;&amp;#x7531; $ n $ &amp;#x540D;&amp;#x9884;&amp;#x5907;&amp;#x5F79;&amp;#x58EB;&amp;#x5175;&amp;#x7EC4;&amp;#x6210;&amp;#xFF0C;&amp;#x58EB;&amp;#x5175;&amp;#x4ECE; $ 1 $ &amp;#x5230; $ n $ &amp;#x7F16;&amp;#x53F7;&amp;#xFF0C;&amp;#x8981;&amp;#x5C06;&amp;#x4ED6;&amp;#x4EEC;&amp;#x62C6;&amp;#x5206;&amp;#x6210;&amp;#x82E5;&amp;#x5E72;&amp;#x7279;&amp;#x522B;&amp;#x884C;&amp;#x52A8;&amp;#x961F;&amp;#xFF0C;&amp;#x540C;&amp;#x4E00;&amp;#x961F;&amp;#x4E2D;&amp;#x961F;&amp;#x5458;&amp;#x7684;&amp;#x7F16;&amp;#x53F7;&amp;#x5E94;&amp;#x8BE5;&amp;#x8FDE;&amp;#x7EED;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x58EB;&amp;#x5175; $ i $ &amp;#x7684;&amp;#x521D;&amp;#x59CB;&amp;#x6218;&amp;#x6597;&amp;#x529B;&amp;#x4E3A; $ x_i $ &amp;#x4E00;&amp;#x652F;&amp;#x7279;&amp;#x522B;&amp;#x884C;&amp;#x52A8;&amp;#x961F;&amp;#x7684;&amp;#x521D;&amp;#x59CB;&amp;#x6218;&amp;#x6597;&amp;#x529B; $ x $ &amp;#x4E3A;&amp;#x5404;&amp;#x58EB;&amp;#x5175;&amp;#x521D;&amp;#x59CB;&amp;#x6218;&amp;#x6597;&amp;#x529B;&amp;#x4E4B;&amp;#x548C;&amp;#x3002;&amp;#x4E00;&amp;#x652F;&amp;#x7279;&amp;#x522B;&amp;#x884C;&amp;#x52A8;&amp;#x961F;&amp;#x7684;&amp;#x6218;&amp;#x6597;&amp;#x529B;&amp;#x4F1A;&amp;#x88AB;&amp;#x4FEE;&amp;#x6B63;&amp;#x4E3A; $ x&amp;#x2019; = Ax ^ 2 + Bx + C $&amp;#xFF0C;&amp;#x5176;&amp;#x4E2D; $ A $&amp;#x3001;$ B $&amp;#x3001;$ C $ &amp;#x5DF2;&amp;#x77E5;&amp;#xFF0C;$ A &amp;lt; 0 $&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x6C42;&amp;#x51FA;&amp;#x5C06;&amp;#x6240;&amp;#x6709;&amp;#x58EB;&amp;#x5175;&amp;#x7EC4;&amp;#x6210;&amp;#x82E5;&amp;#x5E72;&amp;#x7279;&amp;#x522B;&amp;#x884C;&amp;#x52A8;&amp;#x961F;&amp;#x7684;&amp;#x6700;&amp;#x5927;&amp;#x603B;&amp;#x6218;&amp;#x6597;&amp;#x529B;&amp;#x3002;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;&amp;#x94FE;&amp;#x63A5;&quot;&gt;&amp;#x94FE;&amp;#x63A5;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://www.lydsy.com/JudgeOnline/problem.php?id=1911&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;BZOJ 1911&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x9898;&amp;#x89E3;&quot;&gt;&amp;#x9898;&amp;#x89E3;&lt;/h3&gt;
&lt;p&gt;&amp;#x8BBE; $ f[i] $ &amp;#x8868;&amp;#x793A;&amp;#x524D; $ i $ &amp;#x540D;&amp;#x58EB;&amp;#x5175;&amp;#x5206;&amp;#x6210;&amp;#x82E5;&amp;#x5E72;&amp;#x7279;&amp;#x522B;&amp;#x884C;&amp;#x52A8;&amp;#x961F;&amp;#x7684;&amp;#x6700;&amp;#x5927;&amp;#x6218;&amp;#x6597;&amp;#x529B;&amp;#xFF0C;$ s_i $ &amp;#x8868;&amp;#x793A;&amp;#x524D;&amp;#x7F00;&amp;#x548C;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x679A;&amp;#x4E3E; $ j $&amp;#xFF0C;&amp;#x5C06;&amp;#x7B2C; $ j + 1 $ &amp;#x5230; $ i $ &amp;#x4E2A;&amp;#x5206;&amp;#x5728;&amp;#x540C;&amp;#x4E00;&amp;#x961F;&amp;#x91CC;&amp;#xFF0C;&amp;#x72B6;&amp;#x6001;&amp;#x8F6C;&amp;#x79FB;&amp;#x65B9;&amp;#x7A0B;&amp;#x4E3A;&lt;/p&gt;
&lt;p&gt;$$ f[i] = \max\limits_{j = 0} ^ {i - 1} \{ f[j] + A(s_i - s_j) ^ 2 + B(s_i - s_j) + C \} $$&lt;/p&gt;
&lt;p&gt;&amp;#x65F6;&amp;#x95F4;&amp;#x590D;&amp;#x6742;&amp;#x5EA6;&amp;#x4E3A; $ O(n ^ 2) $&amp;#xFF0C;&amp;#x8D85;&amp;#x65F6;&amp;#xFF0C;&amp;#x9700;&amp;#x8981;&amp;#x4F18;&amp;#x5316;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x8003;&amp;#x8651;&amp;#x4E24;&amp;#x4E2A;&amp;#x51B3;&amp;#x7B56;&amp;#x70B9; $ j = a $&amp;#x3001;$ j = b $&amp;#xFF08;$ a &amp;gt; b $&amp;#xFF09;&amp;#xFF0C;&amp;#x82E5; $ a $ &amp;#x6BD4; $ b $ &amp;#x4F18;&amp;#xFF0C;&amp;#x5219;&amp;#x6709;&lt;/p&gt;
&lt;p&gt;$$ f[a] + A(s_i - s_a) ^ 2 + B(s_i - s_a) + C &amp;gt; f[b] + A(s_i - s_b) ^ 2 + B(s_i - s_b) + C \\ f[a] + A(s_i ^ 2 + s_a ^ 2 - 2 s_i s_a) + B(s_i - s_a) + C &amp;gt; f[b] + A(s_i ^ 2 + s_b ^ 2 - 2 s_i s_b) + B(s_i - s_b) + C \\ f[a] + A s_i ^ 2 + A s_a ^ 2 - 2 A s_i s_a + B s_i - B s_a + C &amp;gt; f[b] + A s_i ^ 2 + A s_b ^ 2 - 2 A s_i s_b + B s_i - B s_b + C \\ f[a] + A s_a ^ 2 - 2 A s_i s_a - B s_a &amp;gt; f[b] + A s_b ^ 2 - 2 A s_i s_b - B s_b \\ f[a] - f[b] + A s_a ^ 2 - A s_b ^ 2 - B s_a + B s_b &amp;gt; 2 A s_a s_i + 2 A s_b s_i \\ (f[a] + A s_a ^ 2 - B s_a) - (f[b] + A s_b ^ 2 - B s_b) &amp;gt; 2 A s_i(s_a - s_b) \\ { {(f[a] + A s_a ^ 2 - B s_a) - (f[b] + A s_b ^ 2 - B s_b)} \over {s_a - s_b} } &amp;gt; 2 A s_i \\ $$&lt;/p&gt;
&lt;p&gt;&amp;#x4E0D;&amp;#x7B49;&amp;#x5F0F;&amp;#x53F3;&amp;#x8FB9;&amp;#x5355;&amp;#x8C03;&amp;#x9012;&amp;#x51CF;&amp;#xFF0C;&amp;#x5DE6;&amp;#x8FB9;&amp;#x5206;&amp;#x6BCD;&amp;#x4E0A;&amp;#x7684;&amp;#x524D;&amp;#x7F00;&amp;#x548C;&amp;#x5355;&amp;#x8C03;&amp;#x9012;&amp;#x589E;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x7528;&amp;#x5355;&amp;#x8C03;&amp;#x961F;&amp;#x5217;&amp;#x5B58;&amp;#x50A8;&amp;#x6240;&amp;#x6709;&amp;#x51B3;&amp;#x7B56;&amp;#x70B9;&amp;#xFF0C;&amp;#x7EF4;&amp;#x62A4;&amp;#x4E00;&amp;#x4E2A;&amp;#x4E0A;&amp;#x51F8;&amp;#x58F3;&amp;#xFF0C;&amp;#x4ECE;&amp;#x5DE6;&amp;#x5230;&amp;#x540E;&amp;#x4E24;&amp;#x4E24;&amp;#x4E4B;&amp;#x95F4;&amp;#x7684;&amp;#x659C;&amp;#x7387;&amp;#x9012;&amp;#x51CF;&amp;#xFF0C;&amp;#x4E14;&amp;#x5747;&amp;#x5C0F;&amp;#x4E8E;&amp;#x5F53;&amp;#x524D;&amp;#x7684; $ 2 A s_i $&amp;#xFF0C;&amp;#x6BCF;&amp;#x6B21;&amp;#x6700;&amp;#x4F18;&amp;#x51B3;&amp;#x7B56;&amp;#x4ECE;&amp;#x6700;&amp;#x5DE6;&amp;#x8FB9;&amp;#x53D6;&amp;#x5F97;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x65F6;&amp;#x95F4;&amp;#x590D;&amp;#x6742;&amp;#x5EA6;&amp;#x4E3A; $ O(n) $&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x4EE3;&amp;#x7801;&quot;&gt;&amp;#x4EE3;&amp;#x7801;&lt;/h3&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXN = &lt;span class=&quot;number&quot;&gt;1000000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; a[MAXN], A, B, C;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; s[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;], f[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;template&lt;/span&gt; &amp;lt;&lt;span class=&quot;keyword&quot;&gt;typename&lt;/span&gt; T&amp;gt; &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; T &lt;span class=&quot;title&quot;&gt;sqr&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; T &amp;amp;x)&lt;/span&gt; &lt;/span&gt;{ &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; x * x; }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; a)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; f[a] + &lt;span class=&quot;function&quot;&gt;A * &lt;span class=&quot;title&quot;&gt;sqr&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(s[a])&lt;/span&gt; - B * s[a]&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; a)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; s[a];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; * A * s[i];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;slope&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; a, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; b)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static_cast&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt;&amp;gt;(y(a) - y(b))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;         / &lt;span class=&quot;keyword&quot;&gt;static_cast&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt;&amp;gt;(x(a) - x(b));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;n);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%lld %lld %lld&amp;quot;&lt;/span&gt;, &amp;amp;A, &amp;amp;B, &amp;amp;C);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%lld&amp;quot;&lt;/span&gt;, &amp;amp;a[i]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= n; i++) s[i] = s[i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;] + a[i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; q[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; *l = q, *r = q;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    *r = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (l &amp;lt; &lt;span class=&quot;function&quot;&gt;r &amp;amp;&amp;amp; &lt;span class=&quot;title&quot;&gt;slope&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(*(l + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&lt;/span&gt;, *l) &amp;gt; &lt;span class=&quot;title&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(i)&lt;/span&gt;) l++&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; j = *l;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// int _j = -1;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// for (int j = 0; j &amp;lt; i; j++) {&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;//     if (_j == -1 || f[j] + A * sqr(s[i] - s[j]) + B * (s[i] - s[j]) + C &amp;gt; f[_j] + A * sqr(s[i] - s[_j]) + B * (s[i] - s[_j]) + C) _j = j;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// }&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// j = _j;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// printf(&amp;quot;i = %d, j = %d\n&amp;quot;, i, j);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        f[i] = f[j] + &lt;span class=&quot;function&quot;&gt;A * &lt;span class=&quot;title&quot;&gt;sqr&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(s[i] - s[j])&lt;/span&gt; + B * &lt;span class=&quot;params&quot;&gt;(s[i] - s[j])&lt;/span&gt; + C&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// printf(&amp;quot;i = %d, _j = %d\n&amp;quot;, i, _j);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (l &amp;lt; &lt;span class=&quot;function&quot;&gt;r &amp;amp;&amp;amp; &lt;span class=&quot;title&quot;&gt;slope&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(*r, *(r - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&lt;/span&gt;) &amp;lt; &lt;span class=&quot;title&quot;&gt;slope&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(i, *r)&lt;/span&gt;) r--&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        *++r = i;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%lld\n&amp;quot;&lt;/span&gt;, f[n]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x4E00;&amp;#x652F;&amp;#x90E8;&amp;#x961F;&amp;#x7531; $ n $ &amp;#x540D;&amp;#x9884;&amp;#x5907;&amp;#x5F79;&amp;#x58EB;&amp;#x5175;&amp;#x7EC4;&amp;#x6210;&amp;#xFF0C;&amp;#x58EB;&amp;#x5175;&amp;#x4ECE; $ 1 $ &amp;#x5230; $ n $ &amp;#x7F16;&amp;#x53F7;&amp;#xFF0C;&amp;#x8981;&amp;#x5C06;&amp;#x4ED6;&amp;#x4EEC;&amp;#x62C6;&amp;#x5206;&amp;#x6210;&amp;#x82E5;&amp;#x5E72;&amp;#x7279;&amp;#x522B;&amp;#x884C;&amp;#x52A8;&amp;#x961F;&amp;#xFF0C;&amp;#x540C;&amp;#x4E00;&amp;#x961F;&amp;#x4E2D;&amp;#x961F;&amp;#x5458;&amp;#x7684;&amp;#x7F16;&amp;#x53F7;&amp;#x5E94;&amp;#x8BE5;&amp;#x8FDE;&amp;#x7EED;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x58EB;&amp;#x5175; $ i $ &amp;#x7684;&amp;#x521D;&amp;#x59CB;&amp;#x6218;&amp;#x6597;&amp;#x529B;&amp;#x4E3A; $ x_i $ &amp;#x4E00;&amp;#x652F;&amp;#x7279;&amp;#x522B;&amp;#x884C;&amp;#x52A8;&amp;#x961F;&amp;#x7684;&amp;#x521D;&amp;#x59CB;&amp;#x6218;&amp;#x6597;&amp;#x529B; $ x $ &amp;#x4E3A;&amp;#x5404;&amp;#x58EB;&amp;#x5175;&amp;#x521D;&amp;#x59CB;&amp;#x6218;&amp;#x6597;&amp;#x529B;&amp;#x4E4B;&amp;#x548C;&amp;#x3002;&amp;#x4E00;&amp;#x652F;&amp;#x7279;&amp;#x522B;&amp;#x884C;&amp;#x52A8;&amp;#x961F;&amp;#x7684;&amp;#x6218;&amp;#x6597;&amp;#x529B;&amp;#x4F1A;&amp;#x88AB;&amp;#x4FEE;&amp;#x6B63;&amp;#x4E3A; $ x&amp;#x2019; = Ax ^ 2 + Bx + C $&amp;#xFF0C;&amp;#x5176;&amp;#x4E2D; $ A $&amp;#x3001;$ B $&amp;#x3001;$ C $ &amp;#x5DF2;&amp;#x77E5;&amp;#xFF0C;$ A &amp;lt; 0 $&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x6C42;&amp;#x51FA;&amp;#x5C06;&amp;#x6240;&amp;#x6709;&amp;#x58EB;&amp;#x5175;&amp;#x7EC4;&amp;#x6210;&amp;#x82E5;&amp;#x5E72;&amp;#x7279;&amp;#x522B;&amp;#x884C;&amp;#x52A8;&amp;#x961F;&amp;#x7684;&amp;#x6700;&amp;#x5927;&amp;#x603B;&amp;#x6218;&amp;#x6597;&amp;#x529B;&amp;#x3002;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="APIO" scheme="https://blog.menci.moe/tag/apio/"/>
    
      <category term="BZOJ" scheme="https://blog.menci.moe/tag/bzoj/"/>
    
      <category term="DP" scheme="https://blog.menci.moe/tag/dp/"/>
    
      <category term="单调队列" scheme="https://blog.menci.moe/tag/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97/"/>
    
      <category term="斜率优化" scheme="https://blog.menci.moe/tag/%E6%96%9C%E7%8E%87%E4%BC%98%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>「HDU 632」Rikka with Array - 数位DP</title>
    <link href="https://blog.menci.moe/hdu-5632/"/>
    <id>https://blog.menci.moe/hdu-5632/</id>
    <published>2016-05-12T14:11:00.000Z</published>
    <updated>2016-05-13T11:12:50.000Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x8BBE; $ A(x) $ &amp;#x8868;&amp;#x793A; $ x $ &amp;#x7684;&amp;#x4E8C;&amp;#x8FDB;&amp;#x5236;&amp;#x8868;&amp;#x793A;&amp;#x4E2D; $ 1 $ &amp;#x7684;&amp;#x6570;&amp;#x91CF;&amp;#xFF0C;&amp;#x6C42;&amp;#x6EE1;&amp;#x8DB3; $ 1 \leq i \lt j \leq n,\ A(i) \gt A(j) $ &amp;#x7684;&amp;#x6570;&amp;#x5BF9; $ [i, j] $ &amp;#x7684;&amp;#x6570;&amp;#x91CF;&amp;#x3002;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;&amp;#x94FE;&amp;#x63A5;&quot;&gt;&amp;#x94FE;&amp;#x63A5;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://acm.hdu.edu.cn/showproblem.php?pid=5632&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;HDU 5632&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x9898;&amp;#x89E3;&quot;&gt;&amp;#x9898;&amp;#x89E3;&lt;/h3&gt;
&lt;p&gt;&amp;#x6570;&amp;#x4F4D; DP&amp;#xFF0C;&amp;#x8BBE;&lt;/p&gt;
&lt;p&gt;$$ f[n][gap][iLessThanJ][lim1][lim2] $$&lt;/p&gt;
&lt;p&gt;&amp;#x8868;&amp;#x793A;&amp;#x4E8C;&amp;#x8FDB;&amp;#x5236;&amp;#x8868;&amp;#x793A;&amp;#x7684;&amp;#x6700;&amp;#x540E; $ n $ &amp;#x4F4D;&amp;#xFF0C;&amp;#x4E4B;&amp;#x524D;&amp;#x5404;&amp;#x4F4D;&amp;#x7EC4;&amp;#x6210;&amp;#x7684;&amp;#x6570;&amp;#x7684;&amp;#x5DEE;&amp;#xFF08;$ j - i $&amp;#xFF09;&amp;#x4E3A; $ gap $&amp;#xFF0C;&amp;#x662F;&amp;#x5426; $ i \lt j $ &amp;#x6216; $ i = j $&amp;#xFF0C;$ i $&amp;#x3001;$ j $ &amp;#x7684;&amp;#x4E4B;&amp;#x524D;&amp;#x6240;&amp;#x6709;&amp;#x4F4D;&amp;#x662F;&amp;#x5426;&amp;#x5747;&amp;#x8FBE;&amp;#x5230;&amp;#x4E0A;&amp;#x754C;&amp;#x7684;&amp;#x5408;&amp;#x6CD5;&amp;#x6570;&amp;#x5BF9;&amp;#x6570;&amp;#x91CF;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x8F6C;&amp;#x79FB;&amp;#x65F6;&amp;#x679A;&amp;#x4E3E; $ i $&amp;#x3001;$ j $ &amp;#x7684;&amp;#x4E0B;&amp;#x4E00;&amp;#x4F4D;&amp;#x5206;&amp;#x522B;&amp;#x662F; $ 0 $ &amp;#x6216;&amp;#x8005; $ 1 $ &amp;#x5373;&amp;#x53EF;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x6CE8;&amp;#x610F;&amp;#xFF0C;&amp;#x4E0D;&amp;#x9700;&amp;#x8981;&amp;#x8003;&amp;#x8651; $ i \gt j $ &amp;#x7684;&amp;#x60C5;&amp;#x51B5;&amp;#xFF0C;&amp;#x56E0;&amp;#x4E3A;&amp;#x786E;&amp;#x5B9A;&amp;#x4E86;&amp;#x4E8C;&amp;#x8FDB;&amp;#x5236;&amp;#x8F83;&amp;#x9AD8;&amp;#x4F4D;&amp;#x6EE1;&amp;#x8DB3;&amp;#x4E00;&amp;#x5927;&amp;#x4E00;&amp;#x5C0F;&amp;#x540E;&amp;#xFF0C;&amp;#x8F83;&amp;#x4F4E;&amp;#x4F4D;&amp;#x4E0D;&amp;#x4F1A;&amp;#x4F7F;&amp;#x5176;&amp;#x5927;&amp;#x5C0F;&amp;#x5173;&amp;#x7CFB;&amp;#x66F4;&amp;#x6539;&amp;#xFF0C;&amp;#x5373;&amp;#x8FD9;&amp;#x79CD;&amp;#x72B6;&amp;#x6001;&amp;#x4E0D;&amp;#x53EF;&amp;#x80FD;&amp;#x5408;&amp;#x6CD5;&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x4EE3;&amp;#x7801;&quot;&gt;&amp;#x4EE3;&amp;#x7801;&lt;/h3&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;93&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;94&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;95&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;96&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;97&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;98&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;99&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;100&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;101&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;102&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;103&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;104&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;105&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;106&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;107&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;108&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;109&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;110&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;111&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;112&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;113&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;114&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;115&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;116&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;117&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;118&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;119&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;120&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;121&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;122&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;123&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;124&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;125&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;126&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;127&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;128&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;129&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;130&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;131&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;132&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;133&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;134&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;135&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;136&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;137&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;138&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;139&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;140&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;141&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;142&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;143&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;144&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;145&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;146&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;147&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;148&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;149&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;150&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;151&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;152&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;153&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;154&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;155&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;156&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;157&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;158&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;159&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;160&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;161&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;162&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;163&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;164&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;165&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;166&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;167&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;168&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;169&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;170&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;171&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;172&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;173&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;174&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;175&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;176&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;177&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;178&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;179&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;180&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;181&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;182&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;183&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;184&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;185&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;186&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;187&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;188&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;189&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstring&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;algorithm&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXT = &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXN = &lt;span class=&quot;number&quot;&gt;300&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXN_BIT = &lt;span class=&quot;number&quot;&gt;997&lt;/span&gt;; &lt;span class=&quot;comment&quot;&gt;// 996.5784284662087&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MOD = &lt;span class=&quot;number&quot;&gt;998244353&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; FLAG = &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; a[MAXN_BIT];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; mem[MAXN_BIT][(MAXN_BIT + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) * &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;][FLAG][FLAG][FLAG];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// bool calced[MAXN_BIT][(MAXN_BIT + 1) * 2][FLAG][FLAG][FLAG];&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; i[MAXN_BIT], j[MAXN_BIT];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;/*&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;inline void _set(const int n, const bool i, const bool j) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    ::i[::n - n] = i;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    ::j[::n - n] = j;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;inline void _print() {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    for (int i = 0; i &amp;lt; n; i++) putchar(::i[i] ? &amp;apos;1&amp;apos; : &amp;apos;0&amp;apos;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    putchar(&amp;apos;\n&amp;apos;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    for (int i = 0; i &amp;lt; n; i++) putchar(::j[i] ? &amp;apos;1&amp;apos; : &amp;apos;0&amp;apos;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    putchar(&amp;apos;\n&amp;apos;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    putchar(&amp;apos;\n&amp;apos;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;*/&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;dp&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; gap, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; iLessThanJ, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; limited1, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; limited2)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// gap : (A[i] - A[j])&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &amp;amp;ans = mem[n][gap + MAXN_BIT][iLessThanJ][limited1][limited2];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (ans != -&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; ans;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (n == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (iLessThanJ &amp;amp;&amp;amp; gap &amp;gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) ans = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; &lt;span class=&quot;comment&quot;&gt;// , _print();&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; ans = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    } &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ans = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; limit1, limit2;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; &amp;amp;next = a[::n - n];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (limited1) limit1 = next;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; limit1 = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (limited2) limit2 = next;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; limit2 = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// printf(&amp;quot;next = %d\n&amp;quot;, next);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// 0 0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// _set(n, 0, 0);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ans += dp(n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                  gap,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                  iLessThanJ,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                  limited1 &amp;amp;&amp;amp; next == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                  limited2 &amp;amp;&amp;amp; next == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ans %= MOD;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// 0 1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (limit2 == &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;// _set(n, 0, 1);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            ans += dp(n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                      gap - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                      &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                      limited1 &amp;amp;&amp;amp; next == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                      limited2 &amp;amp;&amp;amp; next == &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            ans %= MOD;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// 1 0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (limit1 == &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &amp;amp;&amp;amp; iLessThanJ) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;// _set(n, 1, 0);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            ans += dp(n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                      gap + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                      &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                      limited1 &amp;amp;&amp;amp; next == &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                      limited2 &amp;amp;&amp;amp; next == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            ans %= MOD;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// 1 1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (limit1 == &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &amp;amp;&amp;amp; limit2 == &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;// _set(n, 1, 1);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            ans += dp(n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                      gap,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                      iLessThanJ,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                      limited1 &amp;amp;&amp;amp; next == &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                      limited2 &amp;amp;&amp;amp; next == &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            ans %= MOD;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// if (n == ::n - 1) printf(&amp;quot;f[%d][%d][%s][%s][%s] = %d\n&amp;quot;, n, gap, iLessThanJ ? &amp;quot;&amp;lt;&amp;quot; : &amp;quot;=&amp;quot;, limited1 ? &amp;quot;*&amp;quot; : &amp;quot; &amp;quot;, limited2 ? &amp;quot;*&amp;quot; : &amp;quot; &amp;quot;, ans);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; ans;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;solve&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt; *s)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;memset&lt;/span&gt;(mem, &lt;span class=&quot;number&quot;&gt;0xff&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;sizeof&lt;/span&gt;(mem));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// memset(calced, 0, sizeof(calced));&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    n = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; len = &lt;span class=&quot;built_in&quot;&gt;strlen&lt;/span&gt;(s);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; num[MAXN];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; len; i++) num[i] = s[i] - &lt;span class=&quot;string&quot;&gt;&amp;apos;0&amp;apos;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; r = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; allZero = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; len; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (num[i] != &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) allZero = &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            r = r * &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt; + num[i];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            num[i] = r / &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            r %= &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (allZero) &lt;span class=&quot;keyword&quot;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        a[n++] = r;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::reverse(a, a + n);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (n == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; ans = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 0 0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// _set(n, 0, 0);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    ans += dp(&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    ans %= MOD;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 0 1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// _set(n, 0, 1);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    ans += dp(&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        -&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    ans %= MOD;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 1 1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// _set(n, 1, 1);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    ans += dp(&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    ans %= MOD;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; ans;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; t;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;t);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (t--) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt; s[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%s&amp;quot;&lt;/span&gt;, s);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d\n&amp;quot;&lt;/span&gt;, solve(s));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x8BBE; $ A(x) $ &amp;#x8868;&amp;#x793A; $ x $ &amp;#x7684;&amp;#x4E8C;&amp;#x8FDB;&amp;#x5236;&amp;#x8868;&amp;#x793A;&amp;#x4E2D; $ 1 $ &amp;#x7684;&amp;#x6570;&amp;#x91CF;&amp;#xFF0C;&amp;#x6C42;&amp;#x6EE1;&amp;#x8DB3; $ 1 \leq i \lt j \leq n,\ A(i) \gt A(j) $ &amp;#x7684;&amp;#x6570;&amp;#x5BF9; $ [i, j] $ &amp;#x7684;&amp;#x6570;&amp;#x91CF;&amp;#x3002;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="DP" scheme="https://blog.menci.moe/tag/dp/"/>
    
      <category term="HDU" scheme="https://blog.menci.moe/tag/hdu/"/>
    
      <category term="数位DP" scheme="https://blog.menci.moe/tag/%E6%95%B0%E4%BD%8Ddp/"/>
    
  </entry>
  
  <entry>
    <title>「SCOI2009」windy 数 - 数位DP</title>
    <link href="https://blog.menci.moe/scoi2009-windy/"/>
    <id>https://blog.menci.moe/scoi2009-windy/</id>
    <published>2016-05-12T09:25:00.000Z</published>
    <updated>2016-05-13T11:12:50.000Z</updated>
    
    <content type="html">&lt;p&gt;windy &amp;#x5B9A;&amp;#x4E49;&amp;#x4E86;&amp;#x4E00;&amp;#x79CD; windy &amp;#x6570;&amp;#x3002;&amp;#x4E0D;&amp;#x542B;&amp;#x524D;&amp;#x5BFC;&amp;#x96F6;&amp;#x4E14;&amp;#x76F8;&amp;#x90BB;&amp;#x4E24;&amp;#x4E2A;&amp;#x6570;&amp;#x5B57;&amp;#x4E4B;&amp;#x5DEE;&amp;#x81F3;&amp;#x5C11;&amp;#x4E3A; $ 2 $ &amp;#x7684;&amp;#x6B63;&amp;#x6574;&amp;#x6570;&amp;#x88AB;&amp;#x79F0;&amp;#x4E3A; windy &amp;#x6570;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;windy &amp;#x60F3;&amp;#x77E5;&amp;#x9053;&amp;#xFF0C;&amp;#x5728; $ A $ &amp;#x548C; $ B $ &amp;#x4E4B;&amp;#x95F4;&amp;#xFF0C;&amp;#x5305;&amp;#x62EC; $ A $ &amp;#x548C; $ B $&amp;#xFF0C;&amp;#x603B;&amp;#x5171;&amp;#x6709;&amp;#x591A;&amp;#x5C11;&amp;#x4E2A; windy &amp;#x6570;&amp;#xFF1F;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;&amp;#x94FE;&amp;#x63A5;&quot;&gt;&amp;#x94FE;&amp;#x63A5;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://www.lydsy.com/JudgeOnline/problem.php?id=1026&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;BZOJ 1026&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x9898;&amp;#x89E3;&quot;&gt;&amp;#x9898;&amp;#x89E3;&lt;/h3&gt;
&lt;p&gt;&amp;#x6570;&amp;#x4F4D; DP&amp;#xFF0C;&amp;#x8BBE;&lt;/p&gt;
&lt;p&gt;$$ f[n][last][notZero][limited] $$&lt;/p&gt;
&lt;p&gt;&amp;#x8868;&amp;#x793A;&amp;#x6700;&amp;#x540E; $ n $ &amp;#x4F4D;&amp;#x6570;&amp;#xFF0C;&amp;#x8FD9; $ n $ &amp;#x4F4D;&amp;#x6570;&amp;#x7684;&amp;#x524D;&amp;#x4E00;&amp;#x4F4D;&amp;#x6570;&amp;#x662F; $ last $&amp;#xFF0C;&amp;#x4E4B;&amp;#x524D;&amp;#x662F;&amp;#x5426;&amp;#x6709;&amp;#x975E;&amp;#x96F6;&amp;#x6570;&amp;#xFF08;&amp;#x5982;&amp;#x679C;&amp;#x524D;&amp;#x9762;&amp;#x5168;&amp;#x662F;&amp;#x96F6;&amp;#x5219;&amp;#x4E0D;&amp;#x8003;&amp;#x8651;&amp;#x5DEE;&amp;#x5206;&amp;#x9650;&amp;#x5236;&amp;#xFF09;&amp;#xFF0C;&amp;#x662F;&amp;#x5426;&amp;#x8FBE;&amp;#x5230;&amp;#x4E0A;&amp;#x754C;&amp;#xFF0C;&amp;#x7684;&amp;#x603B;&amp;#x6570;&amp;#x91CF;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;PS&amp;#xFF1A;&amp;#x4E0D;&amp;#x5141;&amp;#x8BB8;&amp;#x6709;&amp;#x524D;&amp;#x5BFC;&amp;#x96F6;&amp;#x7684;&amp;#x5B9E;&amp;#x73B0;&amp;#x65B9;&amp;#x5F0F;&amp;#x662F;&amp;#xFF0C;&amp;#x5141;&amp;#x8BB8;&amp;#x524D;&amp;#x5BFC;&amp;#x96F6;&amp;#xFF0C;&amp;#x4F46;&amp;#x4E0D;&amp;#x5BF9;&amp;#x524D;&amp;#x5BFC;&amp;#x96F6;&amp;#x8BBE;&amp;#x7F6E;&amp;#x9650;&amp;#x5236;&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x4EE3;&amp;#x7801;&quot;&gt;&amp;#x4EE3;&amp;#x7801;&lt;/h3&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cmath&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstring&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;algorithm&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXX = &lt;span class=&quot;number&quot;&gt;2000000000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXN = &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MINGAP = &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; CHARSET_SIZE = &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; FLAG = &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; a[MAXN], n;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; mem[MAXN][CHARSET_SIZE][FLAG][FLAG];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; calced[MAXN][CHARSET_SIZE][FLAG][FLAG];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;dp&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; last, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; notZero, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; limited)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &amp;amp;ans = mem[n][last][notZero][limited];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (calced[n][last][notZero][limited]) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; ans;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    calced[n][last][notZero][limited] = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (n == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ans = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    } &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; limit;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (limited) limit = a[::n - n];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; limit = CHARSET_SIZE - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt;= limit; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;function&quot;&gt;notZero &amp;amp;&amp;amp; &lt;span class=&quot;title&quot;&gt;abs&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(i - last)&lt;/span&gt; &amp;lt; MINGAP) &lt;span class=&quot;keyword&quot;&gt;continue&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            ans += dp(n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, i, notZero || i != &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, limited &amp;amp;&amp;amp; i == limit);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; ans;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;solve&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt; *s)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::fill(a, a + n, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; len = &lt;span class=&quot;built_in&quot;&gt;strlen&lt;/span&gt;(s);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; len; i++) a[i] = s[len - i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;] - &lt;span class=&quot;string&quot;&gt;&amp;apos;0&amp;apos;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::reverse(a, a + n);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// for (int i = 0; i &amp;lt; n; i++) putchar(&amp;apos;0&amp;apos; + a[i]);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// putchar(&amp;apos;\n&amp;apos;);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;memset&lt;/span&gt;(mem, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;sizeof&lt;/span&gt;(mem));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;memset&lt;/span&gt;(calced, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;sizeof&lt;/span&gt;(calced));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; ans = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt;= a[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;]; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ans += dp(n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, i, i != &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, i == a[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; ans;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; l, r;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d&amp;quot;&lt;/span&gt;, &amp;amp;l, &amp;amp;r);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt; s1[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;], s2[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;sprintf&lt;/span&gt;(s1, &lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, l - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;sprintf&lt;/span&gt;(s2, &lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, r);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    n = &lt;span class=&quot;built_in&quot;&gt;strlen&lt;/span&gt;(s2);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d\n&amp;quot;&lt;/span&gt;, solve(s2) - solve(s1));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;windy &amp;#x5B9A;&amp;#x4E49;&amp;#x4E86;&amp;#x4E00;&amp;#x79CD; windy &amp;#x6570;&amp;#x3002;&amp;#x4E0D;&amp;#x542B;&amp;#x524D;&amp;#x5BFC;&amp;#x96F6;&amp;#x4E14;&amp;#x76F8;&amp;#x90BB;&amp;#x4E24;&amp;#x4E2A;&amp;#x6570;&amp;#x5B57;&amp;#x4E4B;&amp;#x5DEE;&amp;#x81F3;&amp;#x5C11;&amp;#x4E3A; $ 2 $ &amp;#x7684;&amp;#x6B63;&amp;#x6574;&amp;#x6570;&amp;#x88AB;&amp;#x79F0;&amp;#x4E3A; windy &amp;#x6570;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;windy &amp;#x60F3;&amp;#x77E5;&amp;#x9053;&amp;#xFF0C;&amp;#x5728; $ A $ &amp;#x548C; $ B $ &amp;#x4E4B;&amp;#x95F4;&amp;#xFF0C;&amp;#x5305;&amp;#x62EC; $ A $ &amp;#x548C; $ B $&amp;#xFF0C;&amp;#x603B;&amp;#x5171;&amp;#x6709;&amp;#x591A;&amp;#x5C11;&amp;#x4E2A; windy &amp;#x6570;&amp;#xFF1F;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="BZOJ" scheme="https://blog.menci.moe/tag/bzoj/"/>
    
      <category term="DP" scheme="https://blog.menci.moe/tag/dp/"/>
    
      <category term="SCOI" scheme="https://blog.menci.moe/tag/scoi/"/>
    
      <category term="数位DP" scheme="https://blog.menci.moe/tag/%E6%95%B0%E4%BD%8Ddp/"/>
    
  </entry>
  
  <entry>
    <title>「Codeforces 628D」Magic Numbers - 数位DP</title>
    <link href="https://blog.menci.moe/cf-628d/"/>
    <id>https://blog.menci.moe/cf-628d/</id>
    <published>2016-05-12T07:47:00.000Z</published>
    <updated>2016-05-13T11:12:50.000Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x6211;&amp;#x4EEC;&amp;#x8BA4;&amp;#x4E3A;&amp;#x4E00;&amp;#x4E2A;&amp;#x6570;&amp;#x662F; &lt;code&gt;d-magic&lt;/code&gt; &amp;#x7684;&amp;#xFF0C;&amp;#x5F53;&amp;#x4E14;&amp;#x4EC5;&amp;#x5F53;&amp;#x6570;&amp;#x5B57; $ d $ &amp;#x51FA;&amp;#x73B0;&amp;#x5728;&amp;#x8FD9;&amp;#x4E2A;&amp;#x6570;&amp;#x5B57;&amp;#x7684;&amp;#x5341;&amp;#x8FDB;&amp;#x5236;&amp;#x8868;&amp;#x793A;&amp;#x7684;&amp;#x6240;&amp;#x6709;&amp;#x5076;&amp;#x6570;&amp;#x4F4D;&amp;#x4E0A;&amp;#xFF0C;&amp;#x800C;&amp;#x4E0D;&amp;#x4F1A;&amp;#x51FA;&amp;#x73B0;&amp;#x5728;&amp;#x5176;&amp;#x5B83;&amp;#x4F4D;&amp;#x4E0A;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x4F8B;&amp;#x5982;&amp;#xFF0C;$ 1727374,\ 17,\ 1 $ &amp;#x662F; &lt;code&gt;7-magic&lt;/code&gt; &amp;#x7684;&amp;#xFF0C;&amp;#x4F46; $ 77,\ 7,\ 123,\ 34,\ 71 $ &amp;#x4E0D;&amp;#x662F; &lt;code&gt;7-magic&lt;/code&gt; &amp;#x7684;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x627E;&amp;#x51FA;&amp;#x80FD;&amp;#x88AB; &lt;code&gt;m&lt;/code&gt; &amp;#x6574;&amp;#x9664;&amp;#x7684; &lt;code&gt;d-magic&lt;/code&gt; &amp;#x7684;&amp;#x6570;&amp;#x5B57;&amp;#x5728;&amp;#x533A;&amp;#x95F4; $ [a, b] $ &amp;#x5185;&amp;#x7684;&amp;#x6570;&amp;#x91CF;&amp;#x3002;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;&amp;#x94FE;&amp;#x63A5;&quot;&gt;&amp;#x94FE;&amp;#x63A5;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://codeforces.com/contest/628/problem/D&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Codeforces 628D&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x9898;&amp;#x89E3;&quot;&gt;&amp;#x9898;&amp;#x89E3;&lt;/h3&gt;
&lt;p&gt;&amp;#x6570;&amp;#x4F4D; DP&amp;#xFF0C;&amp;#x8BBE;&lt;/p&gt;
&lt;p&gt;$$ f[n][limit][r] $$&lt;/p&gt;
&lt;p&gt;&amp;#x8868;&amp;#x793A;&amp;#x6570;&amp;#x5B57;&amp;#x7684;&amp;#x6700;&amp;#x540E; $ n $ &amp;#x4F4D;&amp;#xFF0C;&amp;#x6700;&amp;#x9AD8;&amp;#x4F4D;&amp;#x6700;&amp;#x5927;&amp;#x4E3A; $ limit $&amp;#xFF0C;&amp;#x6A21; $ m $ &amp;#x7684;&amp;#x4F59;&amp;#x6570;&amp;#x4E3A; $ r $ &amp;#x7684;&amp;#x6570;&amp;#x91CF;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x5BF9;&amp;#x4E8E; $ [a, b] $ &amp;#x7684;&amp;#x9650;&amp;#x5236;&amp;#xFF0C;&amp;#x6211;&amp;#x4EEC;&amp;#x901A;&amp;#x5E38;&amp;#x5B9A;&amp;#x4E49;&amp;#x51FD;&amp;#x6570; $ g(x) $ &amp;#x8868;&amp;#x793A; $ [0, x] $ &amp;#x4E2D;&amp;#x7684;&amp;#x6570;&amp;#x91CF;&amp;#xFF0C;&amp;#x6C42;&amp;#x51FA; $ g(b) - g(a - 1) $&amp;#xFF0C;&amp;#x4F46;&amp;#x8FD9;&amp;#x9053;&amp;#x9898;&amp;#x76EE;&amp;#x4E2D; $ a $ &amp;#x662F;&amp;#x9AD8;&amp;#x7CBE;&amp;#x5EA6;&amp;#x6570;&amp;#xFF0C;&amp;#x4E0D;&amp;#x65B9;&amp;#x4FBF;&amp;#x505A;&amp;#x51CF;&amp;#x6CD5;&amp;#xFF0C;&amp;#x53EF;&amp;#x4EE5;&amp;#x5148;&amp;#x6C42;&amp;#x51FA; $ g(b) - g(a) $&amp;#xFF0C;&amp;#x7136;&amp;#x540E;&amp;#x7279;&amp;#x5224; $ a $ &amp;#x662F;&amp;#x5426;&amp;#x6709;&amp;#x6548;&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x4EE3;&amp;#x7801;&quot;&gt;&amp;#x4EE3;&amp;#x7801;&lt;/h3&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;93&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;94&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;95&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;96&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;97&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;98&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;99&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;100&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;101&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;102&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;103&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;104&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;105&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;106&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;107&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;108&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;109&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;110&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;111&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;112&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;113&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;114&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;115&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;116&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;117&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;118&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;119&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;120&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;121&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;122&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;123&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;124&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;125&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;126&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;127&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;128&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;129&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;130&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;131&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;132&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;133&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;134&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;135&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;136&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;137&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;138&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;139&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;140&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;141&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;142&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;143&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;144&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;145&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// #pragma comment(linker, &amp;quot;/STACK:102400000,102400000&amp;quot;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstring&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;algorithm&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXN = &lt;span class=&quot;number&quot;&gt;2000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXM = &lt;span class=&quot;number&quot;&gt;2000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXD = &lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MOD = &lt;span class=&quot;number&quot;&gt;1e9&lt;/span&gt; + &lt;span class=&quot;number&quot;&gt;7&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; LIMIT_UNLIMITED = &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; a[MAXN];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; mem[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;][&lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;][MAXM + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; calced[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;][&lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;][MAXM + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; pow10[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, d, m;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; isEven[MAXN];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;prepare&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    pow10[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;] = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= MAXN; i++)  {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        pow10[i] = &lt;span class=&quot;keyword&quot;&gt;static_cast&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt;&amp;gt;(pow10[i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]) * &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt; % m;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;modm&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; r)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; ((r % m) + m) % m;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;mul&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; x, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static_cast&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt;&amp;gt;(pow10[n]) * x % m;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;dec&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; r, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; x)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; modm(r - x);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// int A[MAXN];&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;dp&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; limit, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; r)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &amp;amp;ans = mem[n][limit][r];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (calced[n][limit][r]) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; ans;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    calced[n][limit][r] = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (n == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (r == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) ans = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; ans = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// if (ans == 1) {&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;//     for (int i = 0; i &amp;lt; ::n; i++) putchar(&amp;apos;0&amp;apos; + A[i]);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;//     putchar(&amp;apos;\n&amp;apos;);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// }&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    } &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; next;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (n != &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) next = a[::n - n + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; next = LIMIT_UNLIMITED;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; _l, _r;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (isEven[n]) _l = d, _r = &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::min(limit, d);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; _l = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, _r = &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::min(limit, &lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = _l; i &amp;lt;= _r; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;// A[::n - n] = i;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!isEven[n] &amp;amp;&amp;amp; i == d) &lt;span class=&quot;keyword&quot;&gt;continue&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;// if (isEven[n] &amp;amp;&amp;amp; i != d) continue;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; t;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (i &amp;lt; limit || limit == LIMIT_UNLIMITED) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                t = LIMIT_UNLIMITED;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            } &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                t = next;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            ans = (ans + dp(&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    t,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    dec(r, mul(i, n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            )) % MOD;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// if (r == 178) printf(&amp;quot;f[%d][%d][%s][%d] = %d\n&amp;quot;, n, limit, isEven ? &amp;quot;true&amp;quot; : &amp;quot;false&amp;quot;, r, ans);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; ans;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;solve&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt; *s)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;memset&lt;/span&gt;(mem, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;sizeof&lt;/span&gt;(mem));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;memset&lt;/span&gt;(calced, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;sizeof&lt;/span&gt;(calced));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) a[i] = s[i] - &lt;span class=&quot;string&quot;&gt;&amp;apos;0&amp;apos;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; ans = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &amp;amp;limit = a[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::min(limit, &lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;); i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (i == d) &lt;span class=&quot;keyword&quot;&gt;continue&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; t;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (i &amp;lt; limit || n == &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            t = LIMIT_UNLIMITED;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        } &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            t = a[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// A[0] = i;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ans = (ans + dp(n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, t, dec(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, mul(i, n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)))) % MOD;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// printf(&amp;quot;solve(%s) = %d\n&amp;quot;, s, ans);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; ans;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;judge&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt; *s)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; r = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; isEven = &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!isEven &amp;amp;&amp;amp; s[i] - &lt;span class=&quot;string&quot;&gt;&amp;apos;0&amp;apos;&lt;/span&gt; == d) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (isEven &amp;amp;&amp;amp; s[i] - &lt;span class=&quot;string&quot;&gt;&amp;apos;0&amp;apos;&lt;/span&gt; != d) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        r = modm(r - mul(s[i] - &lt;span class=&quot;string&quot;&gt;&amp;apos;0&amp;apos;&lt;/span&gt;, n - i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        isEven ^= &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; r == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; ? &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; : &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// int size = 16 &amp;lt;&amp;lt; 20;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// char *p = (char *)malloc(size) + size;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// __asm__(&amp;quot;movq %0, %%rsp\n&amp;quot; :: &amp;quot;r&amp;quot;(p));&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// __asm__(&amp;quot;movl %0, %%esp\n&amp;quot; :: &amp;quot;r&amp;quot;(p));&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt; s1[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;], s2[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d\n%s\n%s&amp;quot;&lt;/span&gt;, &amp;amp;m, &amp;amp;d, s1, s2);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    prepare();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    n = &lt;span class=&quot;built_in&quot;&gt;strlen&lt;/span&gt;(s1);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    isEven[n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;] = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = n - &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;; i &amp;gt;= &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i--) isEven[i] = !isEven[i + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; ans = (solve(s2) - solve(s1) + judge(s1)) % MOD;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d\n&amp;quot;&lt;/span&gt;, (ans + MOD) % MOD);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// exit(0);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x6211;&amp;#x4EEC;&amp;#x8BA4;&amp;#x4E3A;&amp;#x4E00;&amp;#x4E2A;&amp;#x6570;&amp;#x662F; &lt;code&gt;d-magic&lt;/code&gt; &amp;#x7684;&amp;#xFF0C;&amp;#x5F53;&amp;#x4E14;&amp;#x4EC5;&amp;#x5F53;&amp;#x6570;&amp;#x5B57; $ d $ &amp;#x51FA;&amp;#x73B0;&amp;#x5728;&amp;#x8FD9;&amp;#x4E2A;&amp;#x6570;&amp;#x5B57;&amp;#x7684;&amp;#x5341;&amp;#x8FDB;&amp;#x5236;&amp;#x8868;&amp;#x793A;&amp;#x7684;&amp;#x6240;&amp;#x6709;&amp;#x5076;&amp;#x6570;&amp;#x4F4D;&amp;#x4E0A;&amp;#xFF0C;&amp;#x800C;&amp;#x4E0D;&amp;#x4F1A;&amp;#x51FA;&amp;#x73B0;&amp;#x5728;&amp;#x5176;&amp;#x5B83;&amp;#x4F4D;&amp;#x4E0A;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x4F8B;&amp;#x5982;&amp;#xFF0C;$ 1727374,\ 17,\ 1 $ &amp;#x662F; &lt;code&gt;7-magic&lt;/code&gt; &amp;#x7684;&amp;#xFF0C;&amp;#x4F46; $ 77,\ 7,\ 123,\ 34,\ 71 $ &amp;#x4E0D;&amp;#x662F; &lt;code&gt;7-magic&lt;/code&gt; &amp;#x7684;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x627E;&amp;#x51FA;&amp;#x80FD;&amp;#x88AB; &lt;code&gt;m&lt;/code&gt; &amp;#x6574;&amp;#x9664;&amp;#x7684; &lt;code&gt;d-magic&lt;/code&gt; &amp;#x7684;&amp;#x6570;&amp;#x5B57;&amp;#x5728;&amp;#x533A;&amp;#x95F4; $ [a, b] $ &amp;#x5185;&amp;#x7684;&amp;#x6570;&amp;#x91CF;&amp;#x3002;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="Codeforces" scheme="https://blog.menci.moe/tag/codeforces/"/>
    
      <category term="DP" scheme="https://blog.menci.moe/tag/dp/"/>
    
      <category term="数位DP" scheme="https://blog.menci.moe/tag/%E6%95%B0%E4%BD%8Ddp/"/>
    
  </entry>
  
  <entry>
    <title>「HDU 2089」不要 62 - 数位DP</title>
    <link href="https://blog.menci.moe/hdu-2089/"/>
    <id>https://blog.menci.moe/hdu-2089/</id>
    <published>2016-05-12T03:56:00.000Z</published>
    <updated>2016-05-13T11:12:50.000Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x4E0D;&amp;#x5409;&amp;#x5229;&amp;#x7684;&amp;#x6570;&amp;#x5B57;&amp;#x4E3A;&amp;#x6240;&amp;#x6709;&amp;#x542B;&amp;#x6709; $ 4 $ &amp;#x6216; $ 62 $ &amp;#x7684;&amp;#x53F7;&amp;#x7801;&amp;#x3002;&amp;#x4F8B;&amp;#x5982;&amp;#xFF1A;$ 62315,\ 73418,\ 88914 $ &amp;#x90FD;&amp;#x5C5E;&amp;#x4E8E;&amp;#x4E0D;&amp;#x5409;&amp;#x5229;&amp;#x53F7;&amp;#x7801;&amp;#x3002;&amp;#x4F46;&amp;#x662F;&amp;#xFF0C;$ 61152 $ &amp;#x867D;&amp;#x7136;&amp;#x542B;&amp;#x6709; $ 6 $ &amp;#x548C; $ 2 $&amp;#xFF0C;&amp;#x4F46;&amp;#x4E0D;&amp;#x662F; $ 62 $ &amp;#x8FDE;&amp;#x53F7;&amp;#xFF0C;&amp;#x6240;&amp;#x4EE5;&amp;#x4E0D;&amp;#x5C5E;&amp;#x4E8E;&amp;#x4E0D;&amp;#x5409;&amp;#x5229;&amp;#x6570;&amp;#x5B57;&amp;#x4E4B;&amp;#x5217;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x4F60;&amp;#x7684;&amp;#x4EFB;&amp;#x52A1;&amp;#x662F;&amp;#xFF0C;&amp;#x5BF9;&amp;#x4E8E;&amp;#x6BCF;&amp;#x6B21;&amp;#x7ED9;&amp;#x51FA;&amp;#x7684;&amp;#x4E00;&amp;#x4E2A;&amp;#x724C;&amp;#x7167;&amp;#x533A;&amp;#x95F4;&amp;#x53F7;&amp;#xFF0C;&amp;#x63A8;&amp;#x65AD;&amp;#x51FA;&amp;#x4EA4;&amp;#x7BA1;&amp;#x5C40;&amp;#x4ECA;&amp;#x6B21;&amp;#x53C8;&amp;#x8981;&amp;#x5B9E;&amp;#x9645;&amp;#x4E0A;&amp;#x7ED9;&amp;#x591A;&amp;#x5C11;&amp;#x8F86;&amp;#x65B0;&amp;#x7684;&amp;#x58EB;&amp;#x8F66;&amp;#x4E0A;&amp;#x724C;&amp;#x7167;&amp;#x4E86;&amp;#x3002;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;&amp;#x94FE;&amp;#x63A5;&quot;&gt;&amp;#x94FE;&amp;#x63A5;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://acm.hdu.edu.cn/showproblem.php?pid=2089&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;HDU 2089&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x9898;&amp;#x89E3;&quot;&gt;&amp;#x9898;&amp;#x89E3;&lt;/h3&gt;
&lt;p&gt;&amp;#x6570;&amp;#x4F4D; DP&amp;#xFF0C;&amp;#x8BBE;&lt;/p&gt;
&lt;p&gt;$$ f[n][last][flag] $$&lt;/p&gt;
&lt;p&gt;&amp;#x8868;&amp;#x793A;&amp;#x53F7;&amp;#x7801;&amp;#x7684;&amp;#x6700;&amp;#x540E; $ n $ &amp;#x4F4D;&amp;#xFF0C;&amp;#x8FD9; $ n $ &amp;#x4F4D;&amp;#x7684;&amp;#x4E0A;&amp;#x4E00;&amp;#x4E2A;&amp;#x5B57;&amp;#x7B26;&amp;#x662F; $ last $&amp;#xFF0C;&amp;#x4E4B;&amp;#x524D;&amp;#x7684;&amp;#x5B57;&amp;#x7B26;&amp;#x662F;&amp;#x5426;&amp;#x5168;&amp;#x90E8;&amp;#x7D27;&amp;#x8D34;&amp;#x4E0A;&amp;#x754C;&amp;#xFF0C;&amp;#x7684;&amp;#x603B;&amp;#x6570;&amp;#x91CF;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x6BCF;&amp;#x6B21;&amp;#x679A;&amp;#x4E3E;&amp;#x8FD9; $ n $ &amp;#x4F4D;&amp;#x7684;&amp;#x6700;&amp;#x9AD8;&amp;#x4F4D;&amp;#xFF0C;&amp;#x7279;&amp;#x5224; $ 4 $&amp;#xFF0C;&amp;#x7279;&amp;#x5224;&amp;#x8FDE;&amp;#x7EED;&amp;#x7684; $ 62 $ &amp;#x5373;&amp;#x53EF;&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x4EE3;&amp;#x7801;&quot;&gt;&amp;#x4EE3;&amp;#x7801;&lt;/h3&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstring&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXX = &lt;span class=&quot;number&quot;&gt;1000000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXN = &lt;span class=&quot;number&quot;&gt;7&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; CHARSET_SIZE = &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; FLAG = &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; a[MAXN], n;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; mem[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;][CHARSET_SIZE][FLAG];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; calced[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;][CHARSET_SIZE][FLAG];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;dp&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; last, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; flag)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &amp;amp;ans = mem[n][last][flag];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (calced[n][last][flag]) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; ans;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    calced[n][last][flag] = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (n == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ans = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    } &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; limit;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (flag) limit = a[::n - n];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; limit = CHARSET_SIZE - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt;= limit; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (last == &lt;span class=&quot;number&quot;&gt;6&lt;/span&gt; &amp;amp;&amp;amp; i == &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; || i == &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;) &lt;span class=&quot;keyword&quot;&gt;continue&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            ans += dp(n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, i, flag &amp;amp;&amp;amp; i == limit);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// printf(&amp;quot;dp(%d, %d) = %d\n&amp;quot;, n, last, ans);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; ans;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;solve&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; x)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt; s[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;sprintf&lt;/span&gt;(s, &lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, x);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    n = &lt;span class=&quot;built_in&quot;&gt;strlen&lt;/span&gt;(s);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) a[i] = s[i] - &lt;span class=&quot;string&quot;&gt;&amp;apos;0&amp;apos;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;memset&lt;/span&gt;(mem, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;sizeof&lt;/span&gt;(mem));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;memset&lt;/span&gt;(calced, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;sizeof&lt;/span&gt;(calced));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; ans = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt;= a[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;]; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (i == &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;) &lt;span class=&quot;keyword&quot;&gt;continue&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ans += dp(n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, i, i == a[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// printf(&amp;quot;[%d, %d] -&amp;gt; %d\n&amp;quot;, n - 1, i, dp(n - 1, i, i == a[0]));&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; ans;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; l, r;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (&lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d&amp;quot;&lt;/span&gt;, &amp;amp;l, &amp;amp;r), !(l == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &amp;amp;&amp;amp; r == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;)) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d\n&amp;quot;&lt;/span&gt;, solve(r) - solve(l - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x4E0D;&amp;#x5409;&amp;#x5229;&amp;#x7684;&amp;#x6570;&amp;#x5B57;&amp;#x4E3A;&amp;#x6240;&amp;#x6709;&amp;#x542B;&amp;#x6709; $ 4 $ &amp;#x6216; $ 62 $ &amp;#x7684;&amp;#x53F7;&amp;#x7801;&amp;#x3002;&amp;#x4F8B;&amp;#x5982;&amp;#xFF1A;$ 62315,\ 73418,\ 88914 $ &amp;#x90FD;&amp;#x5C5E;&amp;#x4E8E;&amp;#x4E0D;&amp;#x5409;&amp;#x5229;&amp;#x53F7;&amp;#x7801;&amp;#x3002;&amp;#x4F46;&amp;#x662F;&amp;#xFF0C;$ 61152 $ &amp;#x867D;&amp;#x7136;&amp;#x542B;&amp;#x6709; $ 6 $ &amp;#x548C; $ 2 $&amp;#xFF0C;&amp;#x4F46;&amp;#x4E0D;&amp;#x662F; $ 62 $ &amp;#x8FDE;&amp;#x53F7;&amp;#xFF0C;&amp;#x6240;&amp;#x4EE5;&amp;#x4E0D;&amp;#x5C5E;&amp;#x4E8E;&amp;#x4E0D;&amp;#x5409;&amp;#x5229;&amp;#x6570;&amp;#x5B57;&amp;#x4E4B;&amp;#x5217;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x4F60;&amp;#x7684;&amp;#x4EFB;&amp;#x52A1;&amp;#x662F;&amp;#xFF0C;&amp;#x5BF9;&amp;#x4E8E;&amp;#x6BCF;&amp;#x6B21;&amp;#x7ED9;&amp;#x51FA;&amp;#x7684;&amp;#x4E00;&amp;#x4E2A;&amp;#x724C;&amp;#x7167;&amp;#x533A;&amp;#x95F4;&amp;#x53F7;&amp;#xFF0C;&amp;#x63A8;&amp;#x65AD;&amp;#x51FA;&amp;#x4EA4;&amp;#x7BA1;&amp;#x5C40;&amp;#x4ECA;&amp;#x6B21;&amp;#x53C8;&amp;#x8981;&amp;#x5B9E;&amp;#x9645;&amp;#x4E0A;&amp;#x7ED9;&amp;#x591A;&amp;#x5C11;&amp;#x8F86;&amp;#x65B0;&amp;#x7684;&amp;#x58EB;&amp;#x8F66;&amp;#x4E0A;&amp;#x724C;&amp;#x7167;&amp;#x4E86;&amp;#x3002;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="DP" scheme="https://blog.menci.moe/tag/dp/"/>
    
      <category term="HDU" scheme="https://blog.menci.moe/tag/hdu/"/>
    
      <category term="数位DP" scheme="https://blog.menci.moe/tag/%E6%95%B0%E4%BD%8Ddp/"/>
    
  </entry>
  
  <entry>
    <title>「HDU 5462」King&#39;s Order - 数位DP</title>
    <link href="https://blog.menci.moe/hdu-5642/"/>
    <id>https://blog.menci.moe/hdu-5642/</id>
    <published>2016-05-11T23:47:00.000Z</published>
    <updated>2016-05-13T11:12:50.000Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x7531;&amp;#x4E8E;&amp;#x56FD;&amp;#x738B;&amp;#x7684;&amp;#x53E3;&amp;#x5403;&amp;#x5E76;&amp;#x6CA1;&amp;#x6709;&amp;#x6CBB;&amp;#x6108;&amp;#xFF0C;&amp;#x6240;&amp;#x4EE5;&amp;#x4F20;&amp;#x4EE4;&amp;#x4E2D;&amp;#x53EF;&amp;#x80FD;&amp;#x51FA;&amp;#x73B0;&amp;#xFF1A;&amp;#x201C;&amp;#x8BA9;&amp;#x7B2C;&amp;#x4E09;&amp;#x519B;-&amp;#x519B;-&amp;#x519B;&amp;#xFF0C;&amp;#x5230;&amp;#x524D;&amp;#x7EBF;&amp;#x53BB;&amp;#x201D;&amp;#x8FD9;&amp;#x6837;&amp;#x7684;&amp;#x547D;&amp;#x4EE4;&amp;#x3002;&amp;#x7531;&amp;#x4E8E;&amp;#x5927;&amp;#x6D0B;&amp;#x56FD;&amp;#x5728;&amp;#x519B;&amp;#x961F;&amp;#x4E2D;&amp;#x5B89;&amp;#x63D2;&amp;#x4E86;&amp;#x95F4;&amp;#x8C0D;&amp;#xFF0C;&amp;#x6218;&amp;#x4E8B;&amp;#x7D27;&amp;#x6025;&amp;#xFF0C;&amp;#x5F88;&amp;#x591A;&amp;#x65F6;&amp;#x5019;&amp;#x524D;&amp;#x7EBF;&amp;#x7684;&amp;#x6307;&amp;#x6325;&amp;#x5B98;&amp;#x4E0D;&amp;#x80FD;&amp;#x5206;&amp;#x6E05;&amp;#x54EA;&amp;#x4E9B;&amp;#x547D;&amp;#x4EE4;&amp;#x771F;&amp;#x6B63;&amp;#x6765;&amp;#x81EA;&amp;#x56FD;&amp;#x738B;&amp;#x3002;&amp;#x4F46;&amp;#x56FD;&amp;#x738B;&amp;#x7684;&amp;#x547D;&amp;#x4EE4;&amp;#x6709;&amp;#x4E00;&amp;#x4E2A;&amp;#x7279;&amp;#x70B9;&amp;#xFF0C;&amp;#x4ED6;&amp;#x6BCF;&amp;#x6B21;&amp;#x8FDE;&amp;#x7EED;&amp;#x91CD;&amp;#x590D;&amp;#x7684;&amp;#x5B57;&amp;#x7B26;&amp;#x6700;&amp;#x591A; $ 3 $ &amp;#x6B21;. &amp;#x6240;&amp;#x4EE5;&amp;#x8BF4;&amp;#x4ED6;&amp;#x7684;&amp;#x547D;&amp;#x4EE4;&amp;#x4E2D;&amp;#x6CA1;&amp;#x6709;&amp;#xFF1A;&amp;#x201C;&amp;#x8BA9;&amp;#x7B2C;&amp;#x4E09;&amp;#x519B;-&amp;#x519B;-&amp;#x519B;-&amp;#x519B;&amp;#xFF0C;&amp;#x5230;&amp;#x524D;&amp;#x7EBF;&amp;#x53BB;&amp;#x201D;&amp;#xFF0C;&amp;#x4F46;&amp;#x662F;&amp;#x53EF;&amp;#x4EE5;&amp;#x6709;&amp;#xFF1A;&amp;#x201C;&amp;#x8BA9;&amp;#x7B2C;&amp;#x4E09;&amp;#x519B;-&amp;#x519B; &amp;#xFF0C;&amp;#x5230;&amp;#x524D;&amp;#x7EBF;&amp;#x53BB;&amp;#x201D;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x6B64;&amp;#x65F6;&amp;#x5C06;&amp;#x519B;&amp;#x627E;&amp;#x5230;&amp;#x4E86;&amp;#x4F60;&amp;#xFF0C;&amp;#x4F60;&amp;#x9700;&amp;#x8981;&amp;#x544A;&amp;#x8BC9;&amp;#x4ED6;&amp;#xFF0C;&amp;#x7ED9;&amp;#x5B9A;&amp;#x547D;&amp;#x4EE4;&amp;#x7684;&amp;#x957F;&amp;#x5EA6;&amp;#x957F;&amp;#x5EA6;&amp;#x4E3A; $ n $&amp;#xFF0C;&amp;#x6709;&amp;#x591A;&amp;#x5C11;&amp;#x79CD;&amp;#x4E0D;&amp;#x540C;&amp;#x7684;&amp;#x547D;&amp;#x4EE4;&amp;#x53EF;&amp;#x4EE5;&amp;#x662F;&amp;#x56FD;&amp;#x738B;&amp;#x53D1;&amp;#x51FA;&amp;#x7684;&amp;#x3002;&amp;#xFF08;&amp;#x4E5F;&amp;#x5C31;&amp;#x662F;&amp;#x6C42;&amp;#x957F;&amp;#x5EA6;&amp;#x4E3A; $ n $ &amp;#x7684;&amp;#x5408;&amp;#x683C;&amp;#x5B57;&amp;#x7B26;&amp;#x4E32;&amp;#x7684;&amp;#x4E2A;&amp;#x6570;&amp;#xFF09;&amp;#x5F53;&amp;#x7136;&amp;#xFF0C;&amp;#x56FD;&amp;#x738B;&amp;#x53EF;&amp;#x80FD;&amp;#x8BF4;&amp;#x51FA;&amp;#x4E00;&amp;#x53E5;&amp;#x8BDD;&amp;#x6CA1;&amp;#x6709;&amp;#x72AF;&amp;#x4EFB;&amp;#x4F55;&amp;#x53E3;&amp;#x5403;&amp;#xFF0C;&amp;#x5C31;&amp;#x50CF;&amp;#x4ED6;&amp;#x90A3;&amp;#x6B21;&amp;#x6F14;&amp;#x8BB2;&amp;#x4E00;&amp;#x6837;&amp;#x3002;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;&amp;#x94FE;&amp;#x63A5;&quot;&gt;&amp;#x94FE;&amp;#x63A5;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://acm.hdu.edu.cn/showproblem.php?pid=5642&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;HDU 5642&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x9898;&amp;#x89E3;&quot;&gt;&amp;#x9898;&amp;#x89E3;&lt;/h3&gt;
&lt;p&gt;&amp;#x6570;&amp;#x4F4D; DP&amp;#xFF0C;&amp;#x8BBE;&lt;/p&gt;
&lt;p&gt;$$ f[n][f1][f2][f3][lastChar] $$&lt;/p&gt;
&lt;p&gt;&amp;#x8868;&amp;#x793A;&amp;#x957F;&amp;#x5EA6;&amp;#x4E3A; $ n $ &amp;#x7684;&amp;#x5B57;&amp;#x7B26;&amp;#x4E32;&amp;#xFF0C;&amp;#x6700;&amp;#x540E;&amp;#x56DB;&amp;#x4E2A;&amp;#x5B57;&amp;#x7B26;&amp;#x4E2D;&amp;#x4E24;&amp;#x4E24;&amp;#x662F;&amp;#x5426;&amp;#x76F8;&amp;#x7B49;&amp;#xFF0C;&amp;#x6700;&amp;#x540E;&amp;#x4E00;&amp;#x4E2A;&amp;#x5B57;&amp;#x7B26;&amp;#x662F; $ lastChar $&amp;#xFF0C;&amp;#x72B6;&amp;#x6001;&amp;#x8F6C;&amp;#x79FB;&amp;#x65F6;&amp;#xFF0C;&amp;#x679A;&amp;#x4E3E;&amp;#x6700;&amp;#x540E;&amp;#x4E00;&amp;#x4E2A;&amp;#x5B57;&amp;#x7B26;&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x4E09;&amp;#x4E2A;&amp;#x6807;&amp;#x5FD7;&amp;#x4F4D;&amp;#x5747;&amp;#x4E3A;&amp;#x771F;&amp;#xFF0C;&amp;#x5219;&amp;#x72B6;&amp;#x6001;&amp;#x975E;&amp;#x6CD5;&amp;#xFF0C;&amp;#x7B54;&amp;#x6848;&amp;#x4E3A;&amp;#x96F6;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x6BCF;&amp;#x6B21;&amp;#x4E0D;&amp;#x9700;&amp;#x8981;&amp;#x91CD;&amp;#x65B0;&amp;#x8BA1;&amp;#x7B97;&amp;#xFF0C;&amp;#x5229;&amp;#x7528;&amp;#x4E4B;&amp;#x524D;&amp;#x8BA1;&amp;#x7B97;&amp;#x8FC7;&amp;#x7684;&amp;#x503C;&amp;#x5373;&amp;#x53EF;&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x4EE3;&amp;#x7801;&quot;&gt;&amp;#x4EE3;&amp;#x7801;&lt;/h3&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstring&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXT = &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXN = &lt;span class=&quot;number&quot;&gt;2000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MOD = &lt;span class=&quot;number&quot;&gt;1000000007&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; CHARSET_SIZE = &lt;span class=&quot;number&quot;&gt;26&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; mem[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;][&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;][&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;][&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;][CHARSET_SIZE + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; calced[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;][&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;][&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;][&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;][CHARSET_SIZE + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;dp&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; c2EqualToC1, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; c3EqualToC2, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; c4EqualToC3, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; c4)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &amp;amp;ans = mem[n][c2EqualToC1][c3EqualToC2][c4EqualToC3][c4];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (calced[n][c2EqualToC1][c3EqualToC2][c4EqualToC3][c4]) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; ans;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    calced[n][c2EqualToC1][c3EqualToC2][c4EqualToC3][c4] = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (c2EqualToC1 &amp;amp;&amp;amp; c3EqualToC2 &amp;amp;&amp;amp; c4EqualToC3) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ans = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    } &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (n == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ans = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    } &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ans = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; CHARSET_SIZE; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            ans += dp(n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, c3EqualToC2, c4EqualToC3, i == c4, i);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            ans %= MOD;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; ans;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// inline void cleanUp() {&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//     memset(mem, 0, sizeof(mem));&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//     memset(calced, 0, sizeof(calced));&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// }&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; t;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;t);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (t--) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;n);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d\n&amp;quot;&lt;/span&gt;, dp(n, &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;, &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;, &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;, CHARSET_SIZE));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// cleanUp();&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x7531;&amp;#x4E8E;&amp;#x56FD;&amp;#x738B;&amp;#x7684;&amp;#x53E3;&amp;#x5403;&amp;#x5E76;&amp;#x6CA1;&amp;#x6709;&amp;#x6CBB;&amp;#x6108;&amp;#xFF0C;&amp;#x6240;&amp;#x4EE5;&amp;#x4F20;&amp;#x4EE4;&amp;#x4E2D;&amp;#x53EF;&amp;#x80FD;&amp;#x51FA;&amp;#x73B0;&amp;#xFF1A;&amp;#x201C;&amp;#x8BA9;&amp;#x7B2C;&amp;#x4E09;&amp;#x519B;-&amp;#x519B;-&amp;#x519B;&amp;#xFF0C;&amp;#x5230;&amp;#x524D;&amp;#x7EBF;&amp;#x53BB;&amp;#x201D;&amp;#x8FD9;&amp;#x6837;&amp;#x7684;&amp;#x547D;&amp;#x4EE4;&amp;#x3002;&amp;#x7531;&amp;#x4E8E;&amp;#x5927;&amp;#x6D0B;&amp;#x56FD;&amp;#x5728;&amp;#x519B;&amp;#x961F;&amp;#x4E2D;&amp;#x5B89;&amp;#x63D2;&amp;#x4E86;&amp;#x95F4;&amp;#x8C0D;&amp;#xFF0C;&amp;#x6218;&amp;#x4E8B;&amp;#x7D27;&amp;#x6025;&amp;#xFF0C;&amp;#x5F88;&amp;#x591A;&amp;#x65F6;&amp;#x5019;&amp;#x524D;&amp;#x7EBF;&amp;#x7684;&amp;#x6307;&amp;#x6325;&amp;#x5B98;&amp;#x4E0D;&amp;#x80FD;&amp;#x5206;&amp;#x6E05;&amp;#x54EA;&amp;#x4E9B;&amp;#x547D;&amp;#x4EE4;&amp;#x771F;&amp;#x6B63;&amp;#x6765;&amp;#x81EA;&amp;#x56FD;&amp;#x738B;&amp;#x3002;&amp;#x4F46;&amp;#x56FD;&amp;#x738B;&amp;#x7684;&amp;#x547D;&amp;#x4EE4;&amp;#x6709;&amp;#x4E00;&amp;#x4E2A;&amp;#x7279;&amp;#x70B9;&amp;#xFF0C;&amp;#x4ED6;&amp;#x6BCF;&amp;#x6B21;&amp;#x8FDE;&amp;#x7EED;&amp;#x91CD;&amp;#x590D;&amp;#x7684;&amp;#x5B57;&amp;#x7B26;&amp;#x6700;&amp;#x591A; $ 3 $ &amp;#x6B21;. &amp;#x6240;&amp;#x4EE5;&amp;#x8BF4;&amp;#x4ED6;&amp;#x7684;&amp;#x547D;&amp;#x4EE4;&amp;#x4E2D;&amp;#x6CA1;&amp;#x6709;&amp;#xFF1A;&amp;#x201C;&amp;#x8BA9;&amp;#x7B2C;&amp;#x4E09;&amp;#x519B;-&amp;#x519B;-&amp;#x519B;-&amp;#x519B;&amp;#xFF0C;&amp;#x5230;&amp;#x524D;&amp;#x7EBF;&amp;#x53BB;&amp;#x201D;&amp;#xFF0C;&amp;#x4F46;&amp;#x662F;&amp;#x53EF;&amp;#x4EE5;&amp;#x6709;&amp;#xFF1A;&amp;#x201C;&amp;#x8BA9;&amp;#x7B2C;&amp;#x4E09;&amp;#x519B;-&amp;#x519B; &amp;#xFF0C;&amp;#x5230;&amp;#x524D;&amp;#x7EBF;&amp;#x53BB;&amp;#x201D;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x6B64;&amp;#x65F6;&amp;#x5C06;&amp;#x519B;&amp;#x627E;&amp;#x5230;&amp;#x4E86;&amp;#x4F60;&amp;#xFF0C;&amp;#x4F60;&amp;#x9700;&amp;#x8981;&amp;#x544A;&amp;#x8BC9;&amp;#x4ED6;&amp;#xFF0C;&amp;#x7ED9;&amp;#x5B9A;&amp;#x547D;&amp;#x4EE4;&amp;#x7684;&amp;#x957F;&amp;#x5EA6;&amp;#x957F;&amp;#x5EA6;&amp;#x4E3A; $ n $&amp;#xFF0C;&amp;#x6709;&amp;#x591A;&amp;#x5C11;&amp;#x79CD;&amp;#x4E0D;&amp;#x540C;&amp;#x7684;&amp;#x547D;&amp;#x4EE4;&amp;#x53EF;&amp;#x4EE5;&amp;#x662F;&amp;#x56FD;&amp;#x738B;&amp;#x53D1;&amp;#x51FA;&amp;#x7684;&amp;#x3002;&amp;#xFF08;&amp;#x4E5F;&amp;#x5C31;&amp;#x662F;&amp;#x6C42;&amp;#x957F;&amp;#x5EA6;&amp;#x4E3A; $ n $ &amp;#x7684;&amp;#x5408;&amp;#x683C;&amp;#x5B57;&amp;#x7B26;&amp;#x4E32;&amp;#x7684;&amp;#x4E2A;&amp;#x6570;&amp;#xFF09;&amp;#x5F53;&amp;#x7136;&amp;#xFF0C;&amp;#x56FD;&amp;#x738B;&amp;#x53EF;&amp;#x80FD;&amp;#x8BF4;&amp;#x51FA;&amp;#x4E00;&amp;#x53E5;&amp;#x8BDD;&amp;#x6CA1;&amp;#x6709;&amp;#x72AF;&amp;#x4EFB;&amp;#x4F55;&amp;#x53E3;&amp;#x5403;&amp;#xFF0C;&amp;#x5C31;&amp;#x50CF;&amp;#x4ED6;&amp;#x90A3;&amp;#x6B21;&amp;#x6F14;&amp;#x8BB2;&amp;#x4E00;&amp;#x6837;&amp;#x3002;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="BestCoder" scheme="https://blog.menci.moe/tag/bestcoder/"/>
    
      <category term="DP" scheme="https://blog.menci.moe/tag/dp/"/>
    
      <category term="HDU" scheme="https://blog.menci.moe/tag/hdu/"/>
    
      <category term="数位DP" scheme="https://blog.menci.moe/tag/%E6%95%B0%E4%BD%8Ddp/"/>
    
  </entry>
  
  <entry>
    <title>主席树学习笔记</title>
    <link href="https://blog.menci.moe/chairman-tree-notes/"/>
    <id>https://blog.menci.moe/chairman-tree-notes/</id>
    <published>2016-05-11T13:06:00.000Z</published>
    <updated>2016-05-13T11:12:50.000Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x4E3B;&amp;#x5E2D;&amp;#x6811;&amp;#x662F;&amp;#x4E00;&amp;#x79CD;&amp;#x6570;&amp;#x636E;&amp;#x7ED3;&amp;#x6784;&amp;#xFF0C;&amp;#x5176;&amp;#x4E3B;&amp;#x8981;&amp;#x5E94;&amp;#x7528;&amp;#x662F;&amp;#x533A;&amp;#x95F4;&amp;#x7B2C; $ k $ &amp;#x5927;&amp;#x95EE;&amp;#x9898;&amp;#x3002;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;&amp;#x6743;&amp;#x503C;&amp;#x7EBF;&amp;#x6BB5;&amp;#x6811;&quot;&gt;&amp;#x6743;&amp;#x503C;&amp;#x7EBF;&amp;#x6BB5;&amp;#x6811;&lt;/h3&gt;
&lt;p&gt;&amp;#x4F20;&amp;#x7EDF;&amp;#x7684;&amp;#x7EBF;&amp;#x6BB5;&amp;#x6811;&amp;#x7528;&amp;#x4E8E;&amp;#x7EF4;&amp;#x62A4;&amp;#x4E00;&amp;#x6761;&amp;#x7EBF;&amp;#x6BB5;&amp;#x4E0A;&amp;#x7684;&amp;#x533A;&amp;#x95F4;&amp;#xFF0C;&amp;#x53EF;&amp;#x4EE5;&amp;#x65B9;&amp;#x4FBF;&amp;#x5730;&amp;#x67E5;&amp;#x8BE2;&amp;#x533A;&amp;#x95F4;&amp;#x4FE1;&amp;#x606F;&amp;#x3002;&amp;#x800C;&amp;#x5982;&amp;#x679C;&amp;#x5C06;&amp;#x7EBF;&amp;#x6BB5;&amp;#x6811;&amp;#x8F6C;&amp;#x5316;&amp;#x4E3A;&amp;#x300E;&amp;#x6743;&amp;#x503C;&amp;#x7EBF;&amp;#x6BB5;&amp;#x6811;&amp;#x300F;&amp;#xFF0C;&amp;#x6BCF;&amp;#x4E2A;&amp;#x53F6;&amp;#x5B50;&amp;#x8282;&amp;#x70B9;&amp;#x5B58;&amp;#x50A8;&amp;#x67D0;&amp;#x4E2A;&amp;#x5143;&amp;#x7D20;&amp;#x51FA;&amp;#x73B0;&amp;#x6B21;&amp;#x6570;&amp;#xFF0C;&amp;#x4E00;&amp;#x6761;&amp;#x7EBF;&amp;#x6BB5;&amp;#x7684;&amp;#x603B;&amp;#x548C;&amp;#x8868;&amp;#x793A;&amp;#x533A;&amp;#x95F4;&amp;#x5185;&amp;#x6240;&amp;#x6709;&amp;#x6570;&amp;#x51FA;&amp;#x73B0;&amp;#x6B21;&amp;#x6570;&amp;#x7684;&amp;#x603B;&amp;#x548C;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x5229;&amp;#x7528;&amp;#x6743;&amp;#x503C;&amp;#x7EBF;&amp;#x6BB5;&amp;#x6811;&amp;#x53EF;&amp;#x4EE5;&amp;#x65B9;&amp;#x4FBF;&amp;#x5730;&amp;#x6C42;&amp;#x51FA;&amp;#x6574;&amp;#x4F53;&amp;#x7B2C; $ k $ &amp;#x5927; &amp;#x2014;&amp;#x2014; &amp;#x4ECE;&amp;#x6839;&amp;#x8282;&amp;#x70B9;&amp;#x5411;&amp;#x4E0B;&amp;#x8D70;&amp;#xFF0C;&amp;#x5982;&amp;#x679C; $ k $ &amp;#x5C0F;&amp;#x4E8E;&amp;#x7B49;&amp;#x4E8E;&amp;#x5DE6;&amp;#x5B50;&amp;#x6811;&amp;#x5927;&amp;#x5C0F;&amp;#xFF0C;&amp;#x8BF4;&amp;#x660E;&amp;#x7B2C; $ k $ &amp;#x5927;&amp;#x5728;&amp;#x5DE6;&amp;#x5B50;&amp;#x6811;&amp;#x7684;&amp;#x533A;&amp;#x95F4;&amp;#x4E2D;&amp;#xFF0C;&amp;#x5728;&amp;#x5DE6;&amp;#x5B50;&amp;#x6811;&amp;#x4E2D;&amp;#x7EE7;&amp;#x7EED;&amp;#x67E5;&amp;#x627E;&amp;#x5373;&amp;#x53EF;&amp;#xFF1B;&amp;#x5426;&amp;#x5219;&amp;#xFF0C;&amp;#x8BF4;&amp;#x660E;&amp;#x7B2C; $ k $ &amp;#x5927;&amp;#x5728;&amp;#x53F3;&amp;#x5B50;&amp;#x6811;&amp;#x7684;&amp;#x533A;&amp;#x95F4;&amp;#x4E2D;&amp;#xFF0C;&amp;#x6B64;&amp;#x65F6;&amp;#x5C06; $ k $ &amp;#x51CF;&amp;#x53BB;&amp;#x5DE6;&amp;#x5B50;&amp;#x6811;&amp;#x5927;&amp;#x5C0F;&amp;#xFF0C;&amp;#x5E76;&amp;#x5728;&amp;#x53F3;&amp;#x5B50;&amp;#x6811;&amp;#x4E2D;&amp;#x7EE7;&amp;#x7EED;&amp;#x67E5;&amp;#x627E;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x67E5;&amp;#x627E;&amp;#x8FC7;&amp;#x7A0B;&amp;#x7C7B;&amp;#x4F3C;&amp;#x5E73;&amp;#x8861;&amp;#x6811;&amp;#xFF0C;&amp;#x65F6;&amp;#x95F4;&amp;#x590D;&amp;#x6742;&amp;#x5EA6;&amp;#x4E3A; $ O(\log n) $&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x524D;&amp;#x7F00;&amp;#x548C;&quot;&gt;&amp;#x524D;&amp;#x7F00;&amp;#x548C;&lt;/h3&gt;
&lt;p&gt;&amp;#x4E0A;&amp;#x8FF0;&amp;#x7B97;&amp;#x6CD5;&amp;#x53EF;&amp;#x4EE5;&amp;#x7528;&amp;#x6765;&amp;#x5904;&amp;#x7406;&amp;#x6574;&amp;#x4E2A;&amp;#x5E8F;&amp;#x5217;&amp;#x4E0A;&amp;#x7684;&amp;#x7B2C; $ k $ &amp;#x5927;&amp;#xFF0C;&amp;#x800C;&amp;#x6211;&amp;#x4EEC;&amp;#x53EF;&amp;#x4EE5;&amp;#x5BF9;&amp;#x4E8E;&amp;#x4E00;&amp;#x4E2A;&amp;#x957F;&amp;#x5EA6;&amp;#x4E3A; $ n $ &amp;#x7684;&amp;#x5E8F;&amp;#x5217; $ a $ &amp;#x5EFA;&amp;#x7ACB; $ n $ &amp;#x68F5;&amp;#x4E0A;&amp;#x8FF0;&amp;#x7684;&amp;#x6743;&amp;#x503C;&amp;#x7EBF;&amp;#x6BB5;&amp;#x6811;&amp;#xFF0C;&amp;#x7B2C; $ i $ &amp;#x68F5;&amp;#x8868;&amp;#x793A;&amp;#x300E;$ a_1 $ ~ $ a_i $ &amp;#x7684;&amp;#x6240;&amp;#x6709;&amp;#x6570;&amp;#x300F;&amp;#x7EC4;&amp;#x6210;&amp;#x7684;&amp;#x6743;&amp;#x503C;&amp;#x7EBF;&amp;#x6BB5;&amp;#x6811;&amp;#x3002;&amp;#x5982;&amp;#x679C;&amp;#x8981;&amp;#x67E5;&amp;#x8BE2; $ [l, r] $ &amp;#x4E2D;&amp;#x7684;&amp;#x7B2C; $ k $ &amp;#x5927;&amp;#xFF0C;&amp;#x53EF;&amp;#x4EE5;&amp;#x4F7F;&amp;#x7528;&amp;#x7B2C; $ r $ &amp;#x68F5;&amp;#x7EBF;&amp;#x6BB5;&amp;#x6811;&amp;#x51CF;&amp;#x53BB;&amp;#x7B2C; $ l - 1 $ &amp;#x68F5;&amp;#x7EBF;&amp;#x6BB5;&amp;#x6811;&amp;#xFF0C;&amp;#x5F97;&amp;#x5230;&amp;#x6574;&amp;#x4E2A;&amp;#x533A;&amp;#x95F4;&amp;#x7EC4;&amp;#x6210;&amp;#x7684;&amp;#x6743;&amp;#x503C;&amp;#x7EBF;&amp;#x6BB5;&amp;#x6811;&amp;#xFF0C;&amp;#x5E76;&amp;#x8FDB;&amp;#x884C;&amp;#x4E0A;&amp;#x8FF0;&amp;#x7B97;&amp;#x6CD5;&amp;#x5F97;&amp;#x5230;&amp;#x533A;&amp;#x95F4;&amp;#x4E2D;&amp;#x7684;&amp;#x7B2C; $ k $ &amp;#x5927;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x8FD9;&amp;#x4E2A;&amp;#x7B97;&amp;#x6CD5;&amp;#x5B58;&amp;#x5728;&amp;#x4E24;&amp;#x4E2A;&amp;#x95EE;&amp;#x9898;&amp;#xFF1A;&lt;/p&gt;
&lt;ol style=&quot;list-style-type: decimal&quot;&gt;
&lt;li&gt;&amp;#x6BCF;&amp;#x4E2A;&amp;#x7EBF;&amp;#x6BB5;&amp;#x6811;&amp;#x8981;&amp;#x5360;&amp;#x7528; $ O(n \log n) $ &amp;#x7684;&amp;#x7A7A;&amp;#x95F4;&amp;#xFF0C;&amp;#x7B97;&amp;#x6CD5;&amp;#x7684;&amp;#x7A7A;&amp;#x95F4;&amp;#x590D;&amp;#x6742;&amp;#x5EA6;&amp;#x4E3A; $ O(n ^ 2 \log n) $&amp;#xFF0C;&amp;#x5360;&amp;#x7528;&amp;#x7A7A;&amp;#x95F4;&amp;#x8FC7;&amp;#x591A;&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x5EFA;&amp;#x7ACB;&amp;#x6BCF;&amp;#x68F5;&amp;#x7EBF;&amp;#x6BB5;&amp;#x6811;&amp;#x81F3;&amp;#x5C11;&amp;#x8981;&amp;#x7528; $ O(n \log n) $ &amp;#x7684;&amp;#x65F6;&amp;#x95F4;&amp;#xFF0C;&amp;#x6BCF;&amp;#x6B21;&amp;#x67E5;&amp;#x8BE2;&amp;#x53C8;&amp;#x8981;&amp;#x7528; $ O(n \log n) $ &amp;#x7684;&amp;#x65F6;&amp;#x95F4;&amp;#x6784;&amp;#x5EFA;&amp;#x533A;&amp;#x95F4;&amp;#x7684;&amp;#x6743;&amp;#x503C;&amp;#x7EBF;&amp;#x6BB5;&amp;#x6811;&amp;#xFF0C;&amp;#x603B;&amp;#x65F6;&amp;#x95F4;&amp;#x590D;&amp;#x6742;&amp;#x5EA6; $ O((n + m) n \log n) $&amp;#x3002;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&amp;#x770B;&amp;#x4E0A;&amp;#x53BB;&amp;#x8FD8;&amp;#x4E0D;&amp;#x5982;&lt;strong&gt;&amp;#x6BCF;&amp;#x6B21;&amp;#x76F4;&amp;#x63A5;&amp;#x63D0;&amp;#x53D6;&amp;#x51FA;&amp;#x533A;&amp;#x95F4;&amp;#xFF0C;&amp;#x5E76;&amp;#x4F7F;&amp;#x7528;&amp;#x540E;&amp;#x7EBF;&amp;#x6027;&amp;#x9009;&amp;#x62E9;&amp;#x5F97;&amp;#x5230;&amp;#x7B54;&amp;#x6848;&lt;/strong&gt;&amp;#x7684; $ O(n ^ 2) $ &amp;#x7684;&amp;#x6734;&amp;#x7D20;&amp;#x7B97;&amp;#x6CD5;&amp;#x4F18;&amp;#x79C0;&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x4E3B;&amp;#x5E2D;&amp;#x6811;&quot;&gt;&amp;#x4E3B;&amp;#x5E2D;&amp;#x6811;&lt;/h3&gt;
&lt;p&gt;&amp;#x4ED4;&amp;#x7EC6;&amp;#x601D;&amp;#x8003;&amp;#xFF0C;&amp;#x53D1;&amp;#x73B0;&amp;#x4E0A;&amp;#x8FF0;&amp;#x7B97;&amp;#x6CD5;&amp;#x7684; $ n $ &amp;#x68F5;&amp;#x7EBF;&amp;#x6BB5;&amp;#x6811;&amp;#x4E2D;&amp;#xFF0C;&amp;#x76F8;&amp;#x90BB;&amp;#x7684;&amp;#x4E24;&amp;#x68F5;&amp;#x7EBF;&amp;#x6BB5;&amp;#x6811;&amp;#x4EC5;&amp;#x6709; $ O(\log n) $ &amp;#x4E2A;&amp;#x8282;&amp;#x70B9;&amp;#x4E0D;&amp;#x540C;&amp;#xFF0C;&amp;#x56E0;&amp;#x6B64;&amp;#x672C;&amp;#x8D28;&amp;#x4E0D;&amp;#x540C;&amp;#x7684;&amp;#x8282;&amp;#x70B9;&amp;#x53EA;&amp;#x6709; $ O(n \log n) $ &amp;#x4E2A;&amp;#x3002;&amp;#x6211;&amp;#x4EEC;&amp;#x53EF;&amp;#x4EE5;&amp;#x5145;&amp;#x5206;&amp;#x5229;&amp;#x7528;&amp;#x8FD9;&amp;#x4E00;&amp;#x7279;&amp;#x70B9;&amp;#xFF0C;&amp;#x6BCF;&amp;#x6B21;&amp;#x53EA;&amp;#x91CD;&amp;#x65B0;&amp;#x521B;&amp;#x5EFA;&amp;#x4E0E;&amp;#x4E0A;&amp;#x6B21;&amp;#x6240;&amp;#x4E0D;&amp;#x540C;&amp;#x7684;&amp;#x8282;&amp;#x70B9;&amp;#xFF0C;&amp;#x76F8;&amp;#x540C;&amp;#x7684;&amp;#x8282;&amp;#x70B9;&amp;#x76F4;&amp;#x63A5;&amp;#x4F7F;&amp;#x7528;&amp;#x524D;&amp;#x4E00;&amp;#x68F5;&amp;#x7684;&amp;#x5373;&amp;#x53EF;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x4E3A;&amp;#x4E86;&amp;#x8282;&amp;#x7701;&amp;#x7A7A;&amp;#x95F4;&amp;#xFF0C;&amp;#x53EF;&amp;#x4EE5;&amp;#x5C06;&amp;#x7B2C; $ 0 $ &amp;#x68F5;&amp;#x7EBF;&amp;#x6BB5;&amp;#x6811;&amp;#x7F6E;&amp;#x4E3A;&amp;#x7A7A;&amp;#xFF0C;&amp;#x6BCF;&amp;#x6B21;&amp;#x63D2;&amp;#x5165;&amp;#x4E00;&amp;#x4E2A;&amp;#x65B0;&amp;#x53F6;&amp;#x5B50;&amp;#x8282;&amp;#x70B9;&amp;#x65F6;&amp;#x63A5;&amp;#x5165;&amp;#x4E00;&amp;#x6761;&amp;#x957F;&amp;#x5EA6;&amp;#x4E3A; $ O(\log n) $ &amp;#x7684;&amp;#x94FE;&amp;#x3002;&amp;#x603B;&amp;#x7A7A;&amp;#x95F4;&amp;#x3001;&amp;#x65F6;&amp;#x95F4;&amp;#x590D;&amp;#x6742;&amp;#x5EA6;&amp;#x4ECD;&amp;#x4E3A; $ O(n \log n) $&lt;/p&gt;
&lt;p&gt;&amp;#x67E5;&amp;#x8BE2;&amp;#x65F6;&amp;#x6784;&amp;#x9020;&amp;#x6574;&amp;#x68F5;&amp;#x7EBF;&amp;#x6BB5;&amp;#x6811;&amp;#xFF0C;&amp;#x9700;&amp;#x8981;&amp;#x6784;&amp;#x9020; $ O(n \log n) $ &amp;#x4E2A;&amp;#x8282;&amp;#x70B9;&amp;#xFF0C;&amp;#x4F46;&amp;#x6BCF;&amp;#x6B21;&amp;#x67E5;&amp;#x8BE2;&amp;#x53EA;&amp;#x4F1A;&amp;#x7528;&amp;#x5230; $ O(\log n) $ &amp;#x4E2A;&amp;#x8282;&amp;#x70B9;&amp;#xFF0C;&amp;#x76F4;&amp;#x63A5;&amp;#x52A8;&amp;#x6001;&amp;#x6784;&amp;#x9020;&amp;#x8FD9;&amp;#x4E9B;&amp;#x8282;&amp;#x70B9;&amp;#x5373;&amp;#x53EF;&amp;#x3002;&amp;#x4E3A;&amp;#x4E86;&amp;#x65B9;&amp;#x4FBF;&amp;#xFF0C;&amp;#x53EF;&amp;#x4EE5;&amp;#x4E0D;&amp;#x663E;&amp;#x5F0F;&amp;#x6784;&amp;#x9020;&amp;#x8FD9;&amp;#x4E9B;&amp;#x8282;&amp;#x70B9;&amp;#xFF0C;&amp;#x800C;&amp;#x662F;&amp;#x76F4;&amp;#x63A5;&amp;#x7528;&amp;#x4E24;&amp;#x68F5;&amp;#x7EBF;&amp;#x6BB5;&amp;#x6811;&amp;#x4E0A;&amp;#x7684;&amp;#x503C;&amp;#x76F8;&amp;#x51CF;&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x6A21;&amp;#x677F;&quot;&gt;&amp;#x6A21;&amp;#x677F;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://poj.org/problem?id=2104&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;POJ 2104&lt;/a&gt;&lt;br&gt;
&amp;#x52A8;&amp;#x6001;&amp;#x5206;&amp;#x914D;&amp;#x5185;&amp;#x5B58;&amp;#x4F1A;&amp;#x8D85;&amp;#x65F6;&amp;#xFF0C;&amp;#x9700;&amp;#x8981;&amp;#x9759;&amp;#x6001;&amp;#x5206;&amp;#x914D;&amp;#x5185;&amp;#x5B58;&amp;#x3002;&lt;/p&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;93&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;94&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;95&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;96&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;97&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;98&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;99&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;100&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;101&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;102&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;climits&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;algorithm&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;new&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXN = &lt;span class=&quot;number&quot;&gt;100000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXM = &lt;span class=&quot;number&quot;&gt;5000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;template&lt;/span&gt; &amp;lt;&lt;span class=&quot;keyword&quot;&gt;size_t&lt;/span&gt; SIZE&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; MemoryPool {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt; buf[SIZE], *cur;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    MemoryPool() : cur(buf) {}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; *&lt;span class=&quot;title&quot;&gt;alloc&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; size)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (cur == buf + SIZE) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;malloc&lt;/span&gt;(size);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt; *p = cur;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            cur += size;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; p;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;};&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;MemoryPool&amp;lt;(&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt; + &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt; + &lt;span class=&quot;number&quot;&gt;8&lt;/span&gt; + &lt;span class=&quot;number&quot;&gt;8&lt;/span&gt; + &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;) * MAXN * &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;&amp;gt; pool;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; ChairmanTree {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Node {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; l, r;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Node *lc, *rc;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; cnt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Node(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; l, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; r, Node *lc = &lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;, Node *rc = &lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;) : l(l), r(r), lc(lc), rc(rc), cnt((lc ? lc-&amp;gt;cnt : &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) + (rc ? rc-&amp;gt;cnt : &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;)) {}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Node(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; l, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; r, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; cnt) : l(l), r(r), lc(&lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;), rc(&lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;), cnt(cnt) {}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;pushDown&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (lc &amp;amp;&amp;amp; rc) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; mid = l + ((r - l) &amp;gt;&amp;gt; &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!lc) lc = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; (pool.alloc(&lt;span class=&quot;keyword&quot;&gt;sizeof&lt;/span&gt;(Node))) Node(l, mid);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!rc) rc = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; (pool.alloc(&lt;span class=&quot;keyword&quot;&gt;sizeof&lt;/span&gt;(Node))) Node(mid + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, r);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;function&quot;&gt;Node *&lt;span class=&quot;title&quot;&gt;insert&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; num)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (num &amp;lt; l || num &amp;gt; r) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (num == l &amp;amp;&amp;amp; num == r) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; (pool.alloc(&lt;span class=&quot;keyword&quot;&gt;sizeof&lt;/span&gt;(Node))) Node(l, r, &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;cnt + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; mid = l + ((r - l) &amp;gt;&amp;gt; &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                pushDown();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (num &amp;lt;= mid) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; (pool.alloc(&lt;span class=&quot;keyword&quot;&gt;sizeof&lt;/span&gt;(Node))) Node(l, r, lc-&amp;gt;insert(num), rc);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; (pool.alloc(&lt;span class=&quot;keyword&quot;&gt;sizeof&lt;/span&gt;(Node))) Node(l, r, lc, rc-&amp;gt;insert(num));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;rank&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; lc ? lc-&amp;gt;cnt : &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    } *root[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; a[], &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;n = n;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        root[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;] = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; (pool.alloc(&lt;span class=&quot;keyword&quot;&gt;sizeof&lt;/span&gt;(Node))) Node(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            root[i] = root[i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]-&amp;gt;insert(a[i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; l, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; r, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; k)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Node *L = root[l - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;], *R = root[r];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; min = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, max = n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (min != max) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            L-&amp;gt;pushDown(), R-&amp;gt;pushDown();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; mid = min + ((max - min) &amp;gt;&amp;gt; &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;), t = R-&amp;gt;rank() - L-&amp;gt;rank();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (k &amp;lt;= t) L = L-&amp;gt;lc, R = R-&amp;gt;lc, max = mid;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; k -= t, L = L-&amp;gt;rc, R = R-&amp;gt;rc, min = mid + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; min;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} t;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, m, a[MAXN];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d&amp;quot;&lt;/span&gt;, &amp;amp;n, &amp;amp;m);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;a[i]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt;[MAXN];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::copy(a, a + n, &lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::sort(&lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt; + n);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; *end = &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::unique(&lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt; + n);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) a[i] = &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::lower_bound(&lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt;, end, a[i]) - &lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    t.build(a, n);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; m; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; l, r, k;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d %d&amp;quot;&lt;/span&gt;, &amp;amp;l, &amp;amp;r, &amp;amp;k);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; ans = t.query(l, r, k);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d\n&amp;quot;&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt;[ans]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x4E3B;&amp;#x5E2D;&amp;#x6811;&amp;#x662F;&amp;#x4E00;&amp;#x79CD;&amp;#x6570;&amp;#x636E;&amp;#x7ED3;&amp;#x6784;&amp;#xFF0C;&amp;#x5176;&amp;#x4E3B;&amp;#x8981;&amp;#x5E94;&amp;#x7528;&amp;#x662F;&amp;#x533A;&amp;#x95F4;&amp;#x7B2C; $ k $ &amp;#x5927;&amp;#x95EE;&amp;#x9898;&amp;#x3002;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="主席树" scheme="https://blog.menci.moe/tag/%E4%B8%BB%E5%B8%AD%E6%A0%91/"/>
    
      <category term="学习笔记" scheme="https://blog.menci.moe/tag/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
      <category term="数据结构" scheme="https://blog.menci.moe/tag/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
      <category term="算法模板" scheme="https://blog.menci.moe/tag/%E7%AE%97%E6%B3%95%E6%A8%A1%E6%9D%BF/"/>
    
  </entry>
  
  <entry>
    <title>「HNOI2016」树 - 最近公共祖先 + 主席树</title>
    <link href="https://blog.menci.moe/hnoi2016-tree/"/>
    <id>https://blog.menci.moe/hnoi2016-tree/</id>
    <published>2016-05-11T09:28:00.000Z</published>
    <updated>2016-05-13T11:12:50.000Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x5C0F; A &amp;#x60F3;&amp;#x505A;&amp;#x4E00;&amp;#x68F5;&amp;#x5F88;&amp;#x5927;&amp;#x7684;&amp;#x6811;&amp;#xFF0C;&amp;#x4F46;&amp;#x662F;&amp;#x4ED6;&amp;#x624B;&amp;#x4E0A;&amp;#x7684;&amp;#x6750;&amp;#x6599;&amp;#x6709;&amp;#x9650;&amp;#xFF0C;&amp;#x53EA;&amp;#x597D;&amp;#x7528;&amp;#x70B9;&amp;#x5C0F;&amp;#x6280;&amp;#x5DE7;&amp;#x4E86;&amp;#x3002;&amp;#x5F00;&amp;#x59CB;&amp;#xFF0C;&amp;#x5C0F; A &amp;#x53EA;&amp;#x6709;&amp;#x4E00;&amp;#x68F5;&amp;#x7ED3;&amp;#x70B9;&amp;#x6570;&amp;#x4E3A; $ N $ &amp;#x7684;&amp;#x6811;&amp;#xFF0C;&amp;#x7ED3;&amp;#x70B9;&amp;#x7684;&amp;#x7F16;&amp;#x53F7;&amp;#x4E3A; $ 1,\ 2,\ \dots,\ N $&amp;#xFF0C;&amp;#x5176;&amp;#x4E2D;&amp;#x7ED3;&amp;#x70B9; $ 1 $ &amp;#x4E3A;&amp;#x6839;&amp;#xFF1B;&amp;#x6211;&amp;#x4EEC;&amp;#x79F0;&amp;#x8FD9;&amp;#x9897;&amp;#x6811;&amp;#x4E3A;&amp;#x6A21;&amp;#x677F;&amp;#x6811;&amp;#x3002;&amp;#x5C0F; A &amp;#x51B3;&amp;#x5B9A;&amp;#x901A;&amp;#x8FC7;&amp;#x8FD9;&amp;#x68F5;&amp;#x6A21;&amp;#x677F;&amp;#x6811;&amp;#x6765;&amp;#x6784;&amp;#x5EFA;&amp;#x4E00;&amp;#x9897;&amp;#x5927;&amp;#x6811;&amp;#x3002;&amp;#x6784;&amp;#x5EFA;&amp;#x8FC7;&amp;#x7A0B;&amp;#x5982;&amp;#x4E0B;&amp;#xFF1A;&lt;/p&gt;
&lt;ol style=&quot;list-style-type: decimal&quot;&gt;
&lt;li&gt;&amp;#x5C06;&amp;#x6A21;&amp;#x677F;&amp;#x6811;&amp;#x590D;&amp;#x5236;&amp;#x4E3A;&amp;#x521D;&amp;#x59CB;&amp;#x7684;&amp;#x5927;&amp;#x6811;&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x4EE5;&amp;#x4E0B; 3&amp;#xFF0C;4&amp;#xFF0C;5 &amp;#x6B65;&amp;#x5FAA;&amp;#x73AF;&amp;#x6267;&amp;#x884C; $ M $ &amp;#x6B21;&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x9009;&amp;#x62E9;&amp;#x4E24;&amp;#x4E2A;&amp;#x6570;&amp;#x5B57; $ a,\ b $&amp;#xFF0C;&amp;#x5176;&amp;#x4E2D; $ 1 \leq a \leq N $&amp;#xFF0C;$ 1 \leq b \leq &amp;#x5F53;&amp;#x524D;&amp;#x5927;&amp;#x6811;&amp;#x7684;&amp;#x7ED3;&amp;#x70B9;&amp;#x6570; $&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x5C06;&amp;#x6A21;&amp;#x677F;&amp;#x6811;&amp;#x4E2D;&amp;#x4EE5;&amp;#x7ED3;&amp;#x70B9; $ a $ &amp;#x4E3A;&amp;#x6839;&amp;#x7684;&amp;#x5B50;&amp;#x6811;&amp;#x590D;&amp;#x5236;&amp;#x4E00;&amp;#x904D;&amp;#xFF0C;&amp;#x6302;&amp;#x5230;&amp;#x5927;&amp;#x6811;&amp;#x4E2D;&amp;#x7ED3;&amp;#x70B9; $ b $ &amp;#x7684;&amp;#x4E0B;&amp;#x65B9;&amp;#xFF08;&amp;#x4E5F;&amp;#x5C31;&amp;#x662F;&amp;#x8BF4;&amp;#xFF0C;&amp;#x6A21;&amp;#x677F;&amp;#x6811;&amp;#x4E2D;&amp;#x7684;&amp;#x7ED3;&amp;#x70B9; $ a $ &amp;#x4E3A;&amp;#x6839;&amp;#x7684;&amp;#x5B50;&amp;#x6811;&amp;#x590D;&amp;#x5236;&amp;#x5230;&amp;#x5927;&amp;#x6811;&amp;#x4E2D;&amp;#x540E;&amp;#xFF0C;&amp;#x5C06;&amp;#x6210;&amp;#x4E3A;&amp;#x5927;&amp;#x6811;&amp;#x4E2D;&amp;#x7ED3;&amp;#x70B9; $ b $ &amp;#x7684;&amp;#x5B50;&amp;#x6811;)&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x5C06;&amp;#x65B0;&amp;#x52A0;&amp;#x5165;&amp;#x5927;&amp;#x6811;&amp;#x7684;&amp;#x7ED3;&amp;#x70B9;&amp;#x6309;&amp;#x7167;&amp;#x5728;&amp;#x6A21;&amp;#x677F;&amp;#x6811;&amp;#x4E2D;&amp;#x7F16;&amp;#x53F7;&amp;#x7684;&amp;#x987A;&amp;#x5E8F;&amp;#x91CD;&amp;#x65B0;&amp;#x7F16;&amp;#x53F7;&amp;#x3002;&amp;#x4F8B;&amp;#x5982;&amp;#xFF0C;&amp;#x5047;&amp;#x8BBE;&amp;#x5728;&amp;#x8FDB;&amp;#x884C; 4 &amp;#x6B65;&amp;#x4E4B;&amp;#x524D;&amp;#x5927;&amp;#x6811;&amp;#x6709; $ L $ &amp;#x4E2A;&amp;#x7ED3;&amp;#x70B9;&amp;#xFF0C;&amp;#x6A21;&amp;#x677F;&amp;#x6811;&amp;#x4E2D;&amp;#x4EE5; $ a $ &amp;#x4E3A;&amp;#x6839;&amp;#x7684;&amp;#x5B50;&amp;#x6811;&amp;#x5171;&amp;#x6709; $ C $ &amp;#x4E2A;&amp;#x7ED3;&amp;#x70B9;&amp;#xFF0C;&amp;#x90A3;&amp;#x4E48;&amp;#x65B0;&amp;#x52A0;&amp;#x5165;&amp;#x6A21;&amp;#x677F;&amp;#x6811;&amp;#x7684; $ C $ &amp;#x4E2A;&amp;#x7ED3;&amp;#x70B9;&amp;#x5728;&amp;#x5927;&amp;#x6811;&amp;#x4E2D;&amp;#x7684;&amp;#x7F16;&amp;#x53F7;&amp;#x5C06;&amp;#x662F; $ L + 1,\ L + 2,\ \dots,\ L + C $&amp;#xFF1B;&amp;#x5927;&amp;#x6811;&amp;#x4E2D;&amp;#x8FD9; $ C $ &amp;#x4E2A;&amp;#x7ED3;&amp;#x70B9;&amp;#x7F16;&amp;#x53F7;&amp;#x7684;&amp;#x5927;&amp;#x5C0F;&amp;#x987A;&amp;#x5E8F;&amp;#x548C;&amp;#x6A21;&amp;#x677F;&amp;#x6811;&amp;#x4E2D;&amp;#x5BF9;&amp;#x5E94;&amp;#x7684; $ C $ &amp;#x4E2A;&amp;#x7ED3;&amp;#x70B9;&amp;#x7684;&amp;#x5927;&amp;#x5C0F;&amp;#x987A;&amp;#x5E8F;&amp;#x662F;&amp;#x4E00;&amp;#x81F4;&amp;#x7684;&amp;#x3002;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&amp;#x73B0;&amp;#x5728;&amp;#x4ED6;&amp;#x60F3;&amp;#x95EE;&amp;#x4F60;&amp;#xFF0C;&amp;#x6811;&amp;#x4E2D;&amp;#x4E00;&amp;#x4E9B;&amp;#x7ED3;&amp;#x70B9;&amp;#x5BF9;&amp;#x7684;&amp;#x8DDD;&amp;#x79BB;&amp;#x662F;&amp;#x591A;&amp;#x5C11;&amp;#x3002;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;&amp;#x94FE;&amp;#x63A5;&quot;&gt;&amp;#x94FE;&amp;#x63A5;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://www.lydsy.com/JudgeOnline/problem.php?id=4539&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;BZOJ 4539&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://cogs.top/cogs/problem/problem.php?pid=2052&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;COGS 2052&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x9898;&amp;#x89E3;&quot;&gt;&amp;#x9898;&amp;#x89E3;&lt;/h3&gt;
&lt;p&gt;&amp;#x5728;&amp;#x65B0;&amp;#x6811;&amp;#x4E2D;&amp;#x7528;&amp;#x4E00;&amp;#x4E2A;&amp;#x8282;&amp;#x70B9;&amp;#x4EE3;&amp;#x8868;&amp;#x6A21;&amp;#x677F;&amp;#x6811;&amp;#x4E2D;&amp;#x7684;&amp;#x4E00;&amp;#x68F5;&amp;#x5B50;&amp;#x6811;&amp;#xFF0C;&amp;#x5B58;&amp;#x50A8;&amp;#x6BCF;&amp;#x4E2A;&amp;#x8282;&amp;#x70B9;&amp;#x5728;&amp;#x6A21;&amp;#x677F;&amp;#x6811;&amp;#x4E2D;&amp;#x7684;&amp;#x6839;&amp;#xFF0C;&amp;#x5176;&amp;#x771F;&amp;#x5B9E;&amp;#x7236;&amp;#x8282;&amp;#x70B9;&amp;#x5728;&amp;#x6A21;&amp;#x677F;&amp;#x6811;&amp;#x4E2D;&amp;#x7684;&amp;#x8282;&amp;#x70B9;&amp;#xFF0C;&amp;#x8FB9;&amp;#x8BBE;&amp;#x7F6E;&amp;#x4E3A;&amp;#x65B0;&amp;#x8282;&amp;#x70B9;&amp;#x5230;&amp;#x5176;&amp;#x65B0;&amp;#x6811;&amp;#x4E2D;&amp;#x7236;&amp;#x8282;&amp;#x70B9;&amp;#x7684;&amp;#x6839;&amp;#x8282;&amp;#x70B9;&amp;#x7684;&amp;#x8DDD;&amp;#x79BB;&amp;#x3002;&amp;#x5BF9;&amp;#x65B0;&amp;#x6811;&amp;#x548C;&amp;#x6A21;&amp;#x677F;&amp;#x6811;&amp;#x5206;&amp;#x522B;&amp;#x8FDB;&amp;#x884C;&amp;#x6811;&amp;#x94FE;&amp;#x5256;&amp;#x5206;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x9700;&amp;#x8981;&amp;#x4ECE;&amp;#x7F16;&amp;#x53F7;&amp;#x6C42;&amp;#x51FA;&amp;#x5728;&amp;#x65B0;&amp;#x6811;&amp;#x4E2D;&amp;#x7684;&amp;#x8282;&amp;#x70B9;&amp;#x65F6;&amp;#xFF0C;&amp;#x8BB0;&amp;#x5F55;&amp;#x65B0;&amp;#x6811;&amp;#x4E2D;&amp;#x6BCF;&amp;#x4E2A;&amp;#x8282;&amp;#x70B9;&amp;#x4EE3;&amp;#x8868;&amp;#x7684;&amp;#x533A;&amp;#x95F4;&amp;#xFF0C;&amp;#x8FDB;&amp;#x884C;&amp;#x4E8C;&amp;#x5206;&amp;#x67E5;&amp;#x627E;&amp;#x3002;&amp;#x9700;&amp;#x8981;&amp;#x6C42;&amp;#x51FA;&amp;#x6A21;&amp;#x677F;&amp;#x6811;&amp;#x4E2D;&amp;#x7684;&amp;#x8282;&amp;#x70B9;&amp;#x65F6;&amp;#xFF0C;&amp;#x5148;&amp;#x6C42;&amp;#x51FA;&amp;#x5728;&amp;#x533A;&amp;#x95F4;&amp;#x5185;&amp;#x7684;&amp;#x7F16;&amp;#x53F7;&amp;#xFF0C;&amp;#x518D;&amp;#x505A;&amp;#x533A;&amp;#x95F4;&amp;#x7B2C; $ k $ &amp;#x5927;&amp;#x67E5;&amp;#x8BE2;&amp;#xFF0C;&amp;#x4F7F;&amp;#x7528;&amp;#x4E3B;&amp;#x5E2D;&amp;#x6811;&amp;#x5373;&amp;#x53EF;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x6C42;&amp;#x8DDD;&amp;#x79BB;&amp;#x65F6;&amp;#xFF0C;&amp;#x5206;&amp;#x4E09;&amp;#x79CD;&amp;#x60C5;&amp;#x51B5;&amp;#x8BA8;&amp;#x8BBA;&amp;#xFF1A;&lt;/p&gt;
&lt;ol style=&quot;list-style-type: decimal&quot;&gt;
&lt;li&gt;&amp;#x4E24;&amp;#x4E2A;&amp;#x70B9;&amp;#x5728;&amp;#x65B0;&amp;#x6811;&amp;#x4E2D;&amp;#x7684;&amp;#x7EDF;&amp;#x4E00;&amp;#x8282;&amp;#x70B9;&amp;#x5185;&amp;#xFF0C;&amp;#x76F4;&amp;#x63A5;&amp;#x5728;&amp;#x6A21;&amp;#x677F;&amp;#x6811;&amp;#x4E2D;&amp;#x627E;&amp;#x6700;&amp;#x8FD1;&amp;#x516C;&amp;#x5171;&amp;#x79DF;&amp;#x5148;&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x4E24;&amp;#x4E2A;&amp;#x70B9;&amp;#x5728;&amp;#x65B0;&amp;#x6811;&amp;#x4E2D;&amp;#x7684;&amp;#x8282;&amp;#x70B9;&amp;#x7684;&amp;#x7684;&amp;#x6700;&amp;#x8FD1;&amp;#x516C;&amp;#x5171;&amp;#x79DF;&amp;#x5148;&amp;#x4E3A;&amp;#x5176;&amp;#x4E2D;&amp;#x4E00;&amp;#x4E2A;&amp;#x8282;&amp;#x70B9;&amp;#xFF0C;&amp;#x5206;&amp;#x522B;&amp;#x6C42;&amp;#x51FA;&amp;#x591A;&amp;#x6BB5;&amp;#x8DDD;&amp;#x79BB;&amp;#x76F8;&amp;#x52A0;&amp;#x51CF;&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x5176;&amp;#x4ED6;&amp;#x60C5;&amp;#x51B5;&amp;#xFF0C;&amp;#x6BD4;&amp;#x60C5;&amp;#x51B5; 2 &amp;#x590D;&amp;#x6742;&amp;#x4E00;&amp;#x4E9B;&amp;#xFF0C;&amp;#x65B9;&amp;#x6CD5;&amp;#x7C7B;&amp;#x4F3C;&amp;#x3002;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&amp;#x603B;&amp;#x65F6;&amp;#x95F4;&amp;#x590D;&amp;#x6742;&amp;#x5EA6;&amp;#x4E3A; $ O((m + q) \log n) $&amp;#xFF0C;&amp;#x5177;&amp;#x4F53;&amp;#x5B9E;&amp;#x73B0;&amp;#x7EC6;&amp;#x8282;&amp;#x89C1;&amp;#x4EE3;&amp;#x7801;&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x4EE3;&amp;#x7801;&quot;&gt;&amp;#x4EE3;&amp;#x7801;&lt;/h3&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;93&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;94&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;95&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;96&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;97&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;98&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;99&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;100&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;101&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;102&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;103&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;104&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;105&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;106&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;107&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;108&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;109&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;110&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;111&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;112&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;113&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;114&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;115&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;116&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;117&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;118&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;119&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;120&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;121&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;122&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;123&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;124&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;125&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;126&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;127&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;128&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;129&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;130&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;131&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;132&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;133&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;134&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;135&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;136&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;137&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;138&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;139&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;140&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;141&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;142&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;143&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;144&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;145&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;146&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;147&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;148&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;149&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;150&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;151&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;152&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;153&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;154&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;155&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;156&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;157&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;158&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;159&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;160&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;161&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;162&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;163&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;164&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;165&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;166&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;167&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;168&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;169&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;170&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;171&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;172&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;173&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;174&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;175&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;176&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;177&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;178&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;179&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;180&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;181&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;182&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;183&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;184&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;185&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;186&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;187&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;188&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;189&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;190&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;191&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;192&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;193&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;194&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;195&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;196&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;197&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;198&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;199&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;200&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;201&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;202&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;203&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;204&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;205&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;206&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;207&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;208&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;209&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;210&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;211&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;212&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;213&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;214&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;215&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;216&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;217&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;218&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;219&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;220&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;221&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;222&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;223&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;224&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;225&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;226&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;227&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;228&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;229&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;230&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;231&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;232&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;233&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;234&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;235&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;236&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;237&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;238&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;239&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;240&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;241&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;242&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;243&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;244&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;245&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;246&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;247&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;248&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;249&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;250&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;251&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;252&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;253&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;254&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;255&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;256&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;257&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;258&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;259&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;260&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;261&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;262&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;263&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;264&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;265&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;266&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;267&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;268&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;269&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;270&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;271&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;272&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;273&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;274&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;275&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;276&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;277&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;278&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;279&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;280&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;281&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;282&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;283&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;284&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;285&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;286&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;287&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;288&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;289&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;290&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;291&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;292&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;293&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;294&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;295&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;296&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;297&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;298&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;299&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;300&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;301&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;302&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;303&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;304&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;305&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;306&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;307&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;308&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;309&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;310&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;311&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;312&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;313&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;314&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;315&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;316&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;317&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;318&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;319&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;320&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;321&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;322&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;323&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;climits&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;stack&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;algorithm&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXN = &lt;span class=&quot;number&quot;&gt;100000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXM = &lt;span class=&quot;number&quot;&gt;100000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXQ = &lt;span class=&quot;number&quot;&gt;100000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Range {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; l, r;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Range(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; l = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; r = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) : l(l), r(r) {}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;};&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Node;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; TemplateTreeNode;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; TargetTreeNode;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Node {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; id, depth, size, pos, posEnd;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; dist;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Node *parent, *child, *top;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; visited;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;};&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;template&lt;/span&gt; &amp;lt;&lt;span class=&quot;keyword&quot;&gt;typename&lt;/span&gt; T&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Edge {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    T *s, *t;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; w;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Edge&amp;lt;T&amp;gt; *next;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Edge(T *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; s, T *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; t, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; w) : s(s), t(t), w(w), next(s-&amp;gt;e) {}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;};&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; TemplateTreeNode : &lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; Node {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Edge&amp;lt;TemplateTreeNode&amp;gt; *e;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} templateTree[MAXN];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; TargetTreeNode : &lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; Node {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Edge&amp;lt;TargetTreeNode&amp;gt; *e;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    TemplateTreeNode *rootInTemplateTree, *parentInTemplateTree;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Range idRange;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;friend&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;operator&lt;/span&gt;&amp;lt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; TargetTreeNode &amp;amp;v, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; x) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; v.idRange.r &amp;lt; x;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} targetTree[MAXM + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; ChairmanTree {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; SegmentTree {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; l, r, mid;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        SegmentTree *lc, *rc;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; cnt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        SegmentTree(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; l, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; r, SegmentTree *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; lc = &lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;, SegmentTree *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; rc = &lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;) : l(l), r(r), mid(l + ((r - l) &amp;gt;&amp;gt; &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)), lc(lc), rc(rc), cnt((lc ? lc-&amp;gt;cnt : &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) + (rc ? rc-&amp;gt;cnt : &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;)) {}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        SegmentTree(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; l, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; r, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; cnt) : l(l), r(r), lc(&lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;), rc(&lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;), cnt(cnt) {}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;pushDown&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!lc) lc = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; SegmentTree(l, mid);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!rc) rc = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; SegmentTree(mid + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, r);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;function&quot;&gt;SegmentTree *&lt;span class=&quot;title&quot;&gt;insert&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; num)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (num &amp;lt; l || num &amp;gt; r) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (num == l &amp;amp;&amp;amp; num == r) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; SegmentTree(l, r, cnt + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                pushDown();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (num &amp;lt;= mid) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; SegmentTree(l, r, lc-&amp;gt;insert(num), rc);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; SegmentTree(l, r, lc, rc-&amp;gt;insert(num));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;rank&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; lc ? lc-&amp;gt;cnt : &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    } *root[MAXN + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; *a, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;n = n;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        root[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;] = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; SegmentTree(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= n; i++) root[i] = root[i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]-&amp;gt;insert(a[i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; l, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; r, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; k)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        SegmentTree *L = root[l - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;], *R = root[r];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; min = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, max = n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (min != max) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            L-&amp;gt;pushDown(), R-&amp;gt;pushDown();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; mid = min + ((max - min) &amp;gt;&amp;gt; &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;), t = R-&amp;gt;rank() - L-&amp;gt;rank();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (k &amp;lt;= t) L = L-&amp;gt;lc, R = R-&amp;gt;lc, max = mid;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; k -= t, L = L-&amp;gt;rc, R = R-&amp;gt;rc, min = mid + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; min;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} chairmanTree;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, m, q, dfsSequence[MAXN];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; cnt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;template&lt;/span&gt; &amp;lt;&lt;span class=&quot;keyword&quot;&gt;typename&lt;/span&gt; T&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;addEdge&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(T *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; N, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; u, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; v, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; w)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    N[u].e = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Edge&amp;lt;T&amp;gt;(&amp;amp;N[u], &amp;amp;N[v], w);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    N[v].e = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Edge&amp;lt;T&amp;gt;(&amp;amp;N[v], &amp;amp;N[u], w);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;template&lt;/span&gt; &amp;lt;&lt;span class=&quot;keyword&quot;&gt;typename&lt;/span&gt; T&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;cut&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(T *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; N, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;stack&lt;/span&gt;&amp;lt;T *&amp;gt; s;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    s.push(&amp;amp;N[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    N[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;].depth = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    N[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;].dist = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (!s.empty()) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        T *v = s.top();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!v-&amp;gt;visited) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            v-&amp;gt;visited = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (Edge&amp;lt;T&amp;gt; *e = v-&amp;gt;e; e; e = e-&amp;gt;next) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!e-&amp;gt;t-&amp;gt;depth) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    e-&amp;gt;t-&amp;gt;depth = v-&amp;gt;depth + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    e-&amp;gt;t-&amp;gt;dist = v-&amp;gt;dist + e-&amp;gt;w;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    e-&amp;gt;t-&amp;gt;parent = v;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    s.push(e-&amp;gt;t);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        } &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            v-&amp;gt;size = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (Edge&amp;lt;T&amp;gt; *e = v-&amp;gt;e; e; e = e-&amp;gt;next) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;static_cast&lt;/span&gt;&amp;lt;T *&amp;gt;(e-&amp;gt;t-&amp;gt;parent) == v) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    v-&amp;gt;size += e-&amp;gt;t-&amp;gt;size;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!v-&amp;gt;child || v-&amp;gt;child-&amp;gt;size &amp;lt; e-&amp;gt;t-&amp;gt;size) v-&amp;gt;child = e-&amp;gt;t;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            s.pop();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) N[i].visited = &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; time = -&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    s.push(&amp;amp;N[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    N[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;].depth = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (!s.empty()) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        T *v = s.top();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!v-&amp;gt;visited) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            v-&amp;gt;visited = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (v-&amp;gt;parent == &lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt; || v != &lt;span class=&quot;keyword&quot;&gt;static_cast&lt;/span&gt;&amp;lt;T *&amp;gt;(v-&amp;gt;parent-&amp;gt;child)) v-&amp;gt;top = v;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; v-&amp;gt;top = v-&amp;gt;parent-&amp;gt;top;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            v-&amp;gt;pos = ++time;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (Edge&amp;lt;T&amp;gt; *e = v-&amp;gt;e; e; e = e-&amp;gt;next) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;static_cast&lt;/span&gt;&amp;lt;T *&amp;gt;(e-&amp;gt;t-&amp;gt;parent) == v) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (e-&amp;gt;t != v-&amp;gt;child) s.push(e-&amp;gt;t);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (v-&amp;gt;child) s.push(&lt;span class=&quot;keyword&quot;&gt;static_cast&lt;/span&gt;&amp;lt;T *&amp;gt;(v-&amp;gt;child));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        } &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            v-&amp;gt;posEnd = time;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            s.pop();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;template&lt;/span&gt; &amp;lt;&lt;span class=&quot;keyword&quot;&gt;typename&lt;/span&gt; T&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; T *&lt;span class=&quot;title&quot;&gt;lca&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(T *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; u, T *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; v)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Node *a = u, *b = v;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (a-&amp;gt;top != b-&amp;gt;top) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (a-&amp;gt;top-&amp;gt;depth &amp;lt; b-&amp;gt;top-&amp;gt;depth) &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::swap(a, b);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        a = a-&amp;gt;top-&amp;gt;parent;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (a-&amp;gt;depth &amp;gt; b-&amp;gt;depth) &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::swap(a, b);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static_cast&lt;/span&gt;&amp;lt;T *&amp;gt;(a);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;template&lt;/span&gt; &amp;lt;&lt;span class=&quot;keyword&quot;&gt;typename&lt;/span&gt; T&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; T *&lt;span class=&quot;title&quot;&gt;lcaDown&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(T *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; u, T *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; v, T *&amp;amp;uDown, T *&amp;amp;vDown)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    T *p = lca(u, v);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;function&quot;&gt;T *&lt;span class=&quot;title&quot;&gt;operator&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Node *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; p, Node *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; v)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Node *tmp = v;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (tmp-&amp;gt;top-&amp;gt;parent != p) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (p-&amp;gt;top == tmp-&amp;gt;top) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static_cast&lt;/span&gt;&amp;lt;T *&amp;gt;(p-&amp;gt;child);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                tmp = tmp-&amp;gt;top-&amp;gt;parent;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static_cast&lt;/span&gt;&amp;lt;T *&amp;gt;(tmp-&amp;gt;top);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    } down;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    uDown = down(p, u), vDown = down(p, v);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; p;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;template&lt;/span&gt; &amp;lt;&lt;span class=&quot;keyword&quot;&gt;typename&lt;/span&gt; T&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;calcDist&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(T *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; u, T *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; v)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; T *p = lca(u, v);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; (u-&amp;gt;dist - p-&amp;gt;dist) + (v-&amp;gt;dist - p-&amp;gt;dist);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;template&lt;/span&gt; &amp;lt;&lt;span class=&quot;keyword&quot;&gt;typename&lt;/span&gt; T&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;getDist&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(T *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; u, T *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; v)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; llabs(u-&amp;gt;dist - v-&amp;gt;dist);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;getNode&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; id, TargetTreeNode *&amp;amp;targetTreeNode, TemplateTreeNode *&amp;amp;templateTreeNode)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    targetTreeNode = &lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    templateTreeNode = &lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    targetTreeNode = &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::lower_bound(targetTree, targetTree + cnt, id);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;/*for (int i = 0; i &amp;lt;= cnt; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        if (id &amp;gt;= targetTree[i].idRange.l &amp;amp;&amp;amp; id &amp;lt;= targetTree[i].idRange.r) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            targetTreeNode = &amp;amp;targetTree[i];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            break;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }*/&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// printf(&amp;quot;%ld\n&amp;quot;, targetTreeNode - targetTree);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (targetTreeNode == &lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;) &lt;span class=&quot;keyword&quot;&gt;throw&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (targetTreeNode == &amp;amp;targetTree[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;]) templateTreeNode = &amp;amp;templateTree[id];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; k = id - targetTreeNode-&amp;gt;idRange.l;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        TemplateTreeNode *root = targetTreeNode-&amp;gt;rootInTemplateTree;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; x = chairmanTree.query(root-&amp;gt;pos + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, root-&amp;gt;posEnd + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, k + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        templateTreeNode = &amp;amp;templateTree[x];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// static int tmp[MAXN];&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// std::copy(dfsSequence + root-&amp;gt;pos, dfsSequence + root-&amp;gt;pos + root-&amp;gt;size, tmp);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// // std::nth_element(tmp, tmp + root-&amp;gt;size, tmp + k);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// std::sort(tmp, tmp + root-&amp;gt;size);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// templateTreeNode = &amp;amp;templateTree[tmp[k]];&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; u, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; v)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    TargetTreeNode *aTarget, *bTarget;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    TemplateTreeNode *aTemplate, *bTemplate;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    getNode(u, aTarget, aTemplate), getNode(v, bTarget, bTemplate);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (aTarget == bTarget) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; calcDist(aTemplate, bTemplate);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    } &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        TargetTreeNode *aDown, *bDown;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        TemplateTreeNode *aUp, *bUp;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        TargetTreeNode *pTarget = lcaDown(aTarget, bTarget, aDown, bDown);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (aTarget-&amp;gt;depth &amp;gt; bTarget-&amp;gt;depth) &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::swap(aTarget, bTarget), &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::swap(aTemplate, bTemplate), &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::swap(aDown, bDown);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        aUp = &lt;span class=&quot;keyword&quot;&gt;static_cast&lt;/span&gt;&amp;lt;TemplateTreeNode *&amp;gt;(aDown-&amp;gt;parentInTemplateTree);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        bUp = &lt;span class=&quot;keyword&quot;&gt;static_cast&lt;/span&gt;&amp;lt;TemplateTreeNode *&amp;gt;(bDown-&amp;gt;parentInTemplateTree);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; d = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (aTarget == pTarget) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            d += getDist(bTarget, pTarget);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            d -= getDist(bUp, pTarget-&amp;gt;rootInTemplateTree);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            d += calcDist(bUp, aTemplate);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            d += getDist(bTemplate, bTarget-&amp;gt;rootInTemplateTree);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        } &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            d += getDist(aTarget, pTarget) + getDist(bTarget, pTarget);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            d -= getDist(bUp, pTarget-&amp;gt;rootInTemplateTree);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            d -= getDist(aUp, pTarget-&amp;gt;rootInTemplateTree);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            d += calcDist(aUp, bUp);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            d += getDist(bTemplate, bTarget-&amp;gt;rootInTemplateTree);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            d += getDist(aTemplate, aTarget-&amp;gt;rootInTemplateTree);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; d;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// freopen(&amp;quot;tree_tenderRun.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// freopen(&amp;quot;tree_tenderRun.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d %d&amp;quot;&lt;/span&gt;, &amp;amp;n, &amp;amp;m, &amp;amp;q);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        templateTree[i].id = i;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; u, v;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d&amp;quot;&lt;/span&gt;, &amp;amp;u, &amp;amp;v), u--, v--;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        addEdge(templateTree, u, v, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    cut&amp;lt;TemplateTreeNode&amp;gt;(templateTree, n);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) dfsSequence[templateTree[i].pos] = i;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    chairmanTree.build(dfsSequence, n);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    targetTree[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;].id = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    targetTree[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;].rootInTemplateTree = &amp;amp;templateTree[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    targetTree[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;].idRange = Range(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; lastEnd = n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= m; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        cnt = i;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        targetTree[i].id = i;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; a, b;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%lld %lld&amp;quot;&lt;/span&gt;, &amp;amp;a, &amp;amp;b), a--, b--;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        targetTree[i].idRange = Range(lastEnd + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, lastEnd + templateTree[a].size);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        lastEnd = targetTree[i].idRange.r;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        TargetTreeNode *V;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        TemplateTreeNode *v;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        getNode(b, V, v);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        addEdge(targetTree, V-&amp;gt;id, i, getDist(v, V-&amp;gt;rootInTemplateTree) + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        targetTree[i].rootInTemplateTree = &amp;amp;templateTree[a];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        targetTree[i].parentInTemplateTree = v;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    cut&amp;lt;TargetTreeNode&amp;gt;(targetTree, m + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; q; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; u, v;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%lld %lld&amp;quot;&lt;/span&gt;, &amp;amp;u, &amp;amp;v), u--, v--;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%lld\n&amp;quot;&lt;/span&gt;, query(u, v));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// fclose(stdin);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// fclose(stdout);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x5C0F; A &amp;#x60F3;&amp;#x505A;&amp;#x4E00;&amp;#x68F5;&amp;#x5F88;&amp;#x5927;&amp;#x7684;&amp;#x6811;&amp;#xFF0C;&amp;#x4F46;&amp;#x662F;&amp;#x4ED6;&amp;#x624B;&amp;#x4E0A;&amp;#x7684;&amp;#x6750;&amp;#x6599;&amp;#x6709;&amp;#x9650;&amp;#xFF0C;&amp;#x53EA;&amp;#x597D;&amp;#x7528;&amp;#x70B9;&amp;#x5C0F;&amp;#x6280;&amp;#x5DE7;&amp;#x4E86;&amp;#x3002;&amp;#x5F00;&amp;#x59CB;&amp;#xFF0C;&amp;#x5C0F; A &amp;#x53EA;&amp;#x6709;&amp;#x4E00;&amp;#x68F5;&amp;#x7ED3;&amp;#x70B9;&amp;#x6570;&amp;#x4E3A; $ N $ &amp;#x7684;&amp;#x6811;&amp;#xFF0C;&amp;#x7ED3;&amp;#x70B9;&amp;#x7684;&amp;#x7F16;&amp;#x53F7;&amp;#x4E3A; $ 1,\ 2,\ \dots,\ N $&amp;#xFF0C;&amp;#x5176;&amp;#x4E2D;&amp;#x7ED3;&amp;#x70B9; $ 1 $ &amp;#x4E3A;&amp;#x6839;&amp;#xFF1B;&amp;#x6211;&amp;#x4EEC;&amp;#x79F0;&amp;#x8FD9;&amp;#x9897;&amp;#x6811;&amp;#x4E3A;&amp;#x6A21;&amp;#x677F;&amp;#x6811;&amp;#x3002;&amp;#x5C0F; A &amp;#x51B3;&amp;#x5B9A;&amp;#x901A;&amp;#x8FC7;&amp;#x8FD9;&amp;#x68F5;&amp;#x6A21;&amp;#x677F;&amp;#x6811;&amp;#x6765;&amp;#x6784;&amp;#x5EFA;&amp;#x4E00;&amp;#x9897;&amp;#x5927;&amp;#x6811;&amp;#x3002;&amp;#x6784;&amp;#x5EFA;&amp;#x8FC7;&amp;#x7A0B;&amp;#x5982;&amp;#x4E0B;&amp;#xFF1A;&lt;/p&gt;
&lt;ol style=&quot;list-style-type: decimal&quot;&gt;
&lt;li&gt;&amp;#x5C06;&amp;#x6A21;&amp;#x677F;&amp;#x6811;&amp;#x590D;&amp;#x5236;&amp;#x4E3A;&amp;#x521D;&amp;#x59CB;&amp;#x7684;&amp;#x5927;&amp;#x6811;&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x4EE5;&amp;#x4E0B; 3&amp;#xFF0C;4&amp;#xFF0C;5 &amp;#x6B65;&amp;#x5FAA;&amp;#x73AF;&amp;#x6267;&amp;#x884C; $ M $ &amp;#x6B21;&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x9009;&amp;#x62E9;&amp;#x4E24;&amp;#x4E2A;&amp;#x6570;&amp;#x5B57; $ a,\ b $&amp;#xFF0C;&amp;#x5176;&amp;#x4E2D; $ 1 \leq a \leq N $&amp;#xFF0C;$ 1 \leq b \leq &amp;#x5F53;&amp;#x524D;&amp;#x5927;&amp;#x6811;&amp;#x7684;&amp;#x7ED3;&amp;#x70B9;&amp;#x6570; $&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x5C06;&amp;#x6A21;&amp;#x677F;&amp;#x6811;&amp;#x4E2D;&amp;#x4EE5;&amp;#x7ED3;&amp;#x70B9; $ a $ &amp;#x4E3A;&amp;#x6839;&amp;#x7684;&amp;#x5B50;&amp;#x6811;&amp;#x590D;&amp;#x5236;&amp;#x4E00;&amp;#x904D;&amp;#xFF0C;&amp;#x6302;&amp;#x5230;&amp;#x5927;&amp;#x6811;&amp;#x4E2D;&amp;#x7ED3;&amp;#x70B9; $ b $ &amp;#x7684;&amp;#x4E0B;&amp;#x65B9;&amp;#xFF08;&amp;#x4E5F;&amp;#x5C31;&amp;#x662F;&amp;#x8BF4;&amp;#xFF0C;&amp;#x6A21;&amp;#x677F;&amp;#x6811;&amp;#x4E2D;&amp;#x7684;&amp;#x7ED3;&amp;#x70B9; $ a $ &amp;#x4E3A;&amp;#x6839;&amp;#x7684;&amp;#x5B50;&amp;#x6811;&amp;#x590D;&amp;#x5236;&amp;#x5230;&amp;#x5927;&amp;#x6811;&amp;#x4E2D;&amp;#x540E;&amp;#xFF0C;&amp;#x5C06;&amp;#x6210;&amp;#x4E3A;&amp;#x5927;&amp;#x6811;&amp;#x4E2D;&amp;#x7ED3;&amp;#x70B9; $ b $ &amp;#x7684;&amp;#x5B50;&amp;#x6811;)&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x5C06;&amp;#x65B0;&amp;#x52A0;&amp;#x5165;&amp;#x5927;&amp;#x6811;&amp;#x7684;&amp;#x7ED3;&amp;#x70B9;&amp;#x6309;&amp;#x7167;&amp;#x5728;&amp;#x6A21;&amp;#x677F;&amp;#x6811;&amp;#x4E2D;&amp;#x7F16;&amp;#x53F7;&amp;#x7684;&amp;#x987A;&amp;#x5E8F;&amp;#x91CD;&amp;#x65B0;&amp;#x7F16;&amp;#x53F7;&amp;#x3002;&amp;#x4F8B;&amp;#x5982;&amp;#xFF0C;&amp;#x5047;&amp;#x8BBE;&amp;#x5728;&amp;#x8FDB;&amp;#x884C; 4 &amp;#x6B65;&amp;#x4E4B;&amp;#x524D;&amp;#x5927;&amp;#x6811;&amp;#x6709; $ L $ &amp;#x4E2A;&amp;#x7ED3;&amp;#x70B9;&amp;#xFF0C;&amp;#x6A21;&amp;#x677F;&amp;#x6811;&amp;#x4E2D;&amp;#x4EE5; $ a $ &amp;#x4E3A;&amp;#x6839;&amp;#x7684;&amp;#x5B50;&amp;#x6811;&amp;#x5171;&amp;#x6709; $ C $ &amp;#x4E2A;&amp;#x7ED3;&amp;#x70B9;&amp;#xFF0C;&amp;#x90A3;&amp;#x4E48;&amp;#x65B0;&amp;#x52A0;&amp;#x5165;&amp;#x6A21;&amp;#x677F;&amp;#x6811;&amp;#x7684; $ C $ &amp;#x4E2A;&amp;#x7ED3;&amp;#x70B9;&amp;#x5728;&amp;#x5927;&amp;#x6811;&amp;#x4E2D;&amp;#x7684;&amp;#x7F16;&amp;#x53F7;&amp;#x5C06;&amp;#x662F; $ L + 1,\ L + 2,\ \dots,\ L + C $&amp;#xFF1B;&amp;#x5927;&amp;#x6811;&amp;#x4E2D;&amp;#x8FD9; $ C $ &amp;#x4E2A;&amp;#x7ED3;&amp;#x70B9;&amp;#x7F16;&amp;#x53F7;&amp;#x7684;&amp;#x5927;&amp;#x5C0F;&amp;#x987A;&amp;#x5E8F;&amp;#x548C;&amp;#x6A21;&amp;#x677F;&amp;#x6811;&amp;#x4E2D;&amp;#x5BF9;&amp;#x5E94;&amp;#x7684; $ C $ &amp;#x4E2A;&amp;#x7ED3;&amp;#x70B9;&amp;#x7684;&amp;#x5927;&amp;#x5C0F;&amp;#x987A;&amp;#x5E8F;&amp;#x662F;&amp;#x4E00;&amp;#x81F4;&amp;#x7684;&amp;#x3002;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&amp;#x73B0;&amp;#x5728;&amp;#x4ED6;&amp;#x60F3;&amp;#x95EE;&amp;#x4F60;&amp;#xFF0C;&amp;#x6811;&amp;#x4E2D;&amp;#x4E00;&amp;#x4E9B;&amp;#x7ED3;&amp;#x70B9;&amp;#x5BF9;&amp;#x7684;&amp;#x8DDD;&amp;#x79BB;&amp;#x662F;&amp;#x591A;&amp;#x5C11;&amp;#x3002;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="BZOJ" scheme="https://blog.menci.moe/tag/bzoj/"/>
    
      <category term="COGS" scheme="https://blog.menci.moe/tag/cogs/"/>
    
      <category term="HNOI" scheme="https://blog.menci.moe/tag/hnoi/"/>
    
      <category term="主席树" scheme="https://blog.menci.moe/tag/%E4%B8%BB%E5%B8%AD%E6%A0%91/"/>
    
      <category term="最近公共祖先" scheme="https://blog.menci.moe/tag/%E6%9C%80%E8%BF%91%E5%85%AC%E5%85%B1%E7%A5%96%E5%85%88/"/>
    
      <category term="树链剖分" scheme="https://blog.menci.moe/tag/%E6%A0%91%E9%93%BE%E5%89%96%E5%88%86/"/>
    
  </entry>
  
  <entry>
    <title>「HNOI2016」网络 - 树链剖分 + DFS 序</title>
    <link href="https://blog.menci.moe/hnoi2016-network/"/>
    <id>https://blog.menci.moe/hnoi2016-network/</id>
    <published>2016-05-11T09:08:00.000Z</published>
    <updated>2016-05-13T11:12:50.000Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x4E00;&amp;#x4E2A;&amp;#x7B80;&amp;#x5355;&amp;#x7684;&amp;#x7F51;&amp;#x7EDC;&amp;#x7CFB;&amp;#x7EDF;&amp;#x53EF;&amp;#x4EE5;&amp;#x88AB;&amp;#x63CF;&amp;#x8FF0;&amp;#x6210;&amp;#x4E00;&amp;#x68F5;&amp;#x65E0;&amp;#x6839;&amp;#x6811;&amp;#x3002;&amp;#x4E24;&amp;#x4E2A;&amp;#x670D;&amp;#x52A1;&amp;#x5668;&amp;#x8FDB;&amp;#x884C;&amp;#x6570;&amp;#x636E;&amp;#x7684;&amp;#x4EA4;&amp;#x4E92;&amp;#x65F6;&amp;#xFF0C;&amp;#x6570;&amp;#x636E;&amp;#x4F1A;&amp;#x7ECF;&amp;#x8FC7;&amp;#x8FDE;&amp;#x63A5;&amp;#x8FD9;&amp;#x4E24;&amp;#x4E2A;&amp;#x670D;&amp;#x52A1;&amp;#x5668;&amp;#x7684;&amp;#x8DEF;&amp;#x5F84;&amp;#x4E0A;&amp;#x7684;&amp;#x6240;&amp;#x6709;&amp;#x670D;&amp;#x52A1;&amp;#x5668;&amp;#xFF08;&amp;#x5305;&amp;#x62EC;&amp;#x8FD9;&amp;#x4E24;&amp;#x4E2A;&amp;#x670D;&amp;#x52A1;&amp;#x5668;&amp;#x81EA;&amp;#x8EAB;&amp;#xFF09;&amp;#x3002;&amp;#x5F53;&amp;#x8DEF;&amp;#x5F84;&amp;#x4E0A;&amp;#x7684;&amp;#x67D0;&amp;#x4E2A;&amp;#x670D;&amp;#x52A1;&amp;#x5668;&amp;#x51FA;&amp;#x73B0;&amp;#x6545;&amp;#x969C;&amp;#xFF0C;&amp;#x65E0;&amp;#x6CD5;&amp;#x6B63;&amp;#x5E38;&amp;#x8FD0;&amp;#x884C;&amp;#x65F6;&amp;#xFF0C;&amp;#x6570;&amp;#x636E;&amp;#x4FBF;&amp;#x65E0;&amp;#x6CD5;&amp;#x4EA4;&amp;#x4E92;&amp;#x3002;&amp;#x6B64;&amp;#x5916;&amp;#xFF0C;&amp;#x6BCF;&amp;#x4E2A;&amp;#x6570;&amp;#x636E;&amp;#x4EA4;&amp;#x4E92;&amp;#x8BF7;&amp;#x6C42;&amp;#x90FD;&amp;#x6709;&amp;#x4E00;&amp;#x4E2A;&amp;#x91CD;&amp;#x8981;&amp;#x5EA6;&amp;#x3002;&amp;#x5728;&amp;#x6BCF;&amp;#x4E00;&amp;#x4E2A;&amp;#x65F6;&amp;#x523B;&amp;#xFF0C;&amp;#x53EA;&amp;#x6709;&amp;#x53EF;&amp;#x80FD;&amp;#x51FA;&amp;#x73B0;&amp;#x4E0B;&amp;#x5217;&amp;#x4E09;&amp;#x79CD;&amp;#x4E8B;&amp;#x4EF6;&amp;#x4E2D;&amp;#x7684;&amp;#x4E00;&amp;#x79CD;&amp;#xFF1A;&lt;/p&gt;
&lt;ol style=&quot;list-style-type: decimal&quot;&gt;
&lt;li&gt;&amp;#x5728;&amp;#x67D0;&amp;#x4E24;&amp;#x4E2A;&amp;#x670D;&amp;#x52A1;&amp;#x5668;&amp;#x4E4B;&amp;#x95F4;&amp;#x51FA;&amp;#x73B0;&amp;#x4E00;&amp;#x6761;&amp;#x65B0;&amp;#x7684;&amp;#x6570;&amp;#x636E;&amp;#x4EA4;&amp;#x4E92;&amp;#x8BF7;&amp;#x6C42;&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x67D0;&amp;#x4E2A;&amp;#x6570;&amp;#x636E;&amp;#x4EA4;&amp;#x4E92;&amp;#x7ED3;&amp;#x675F;&amp;#x8BF7;&amp;#x6C42;&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x67D0;&amp;#x4E2A;&amp;#x670D;&amp;#x52A1;&amp;#x5668;&amp;#x51FA;&amp;#x73B0;&amp;#x6545;&amp;#x969C;&amp;#x3002;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&amp;#x7CFB;&amp;#x7EDF;&amp;#x4F1A;&amp;#x5728;&amp;#x4EFB;&amp;#x4F55;&amp;#x6545;&amp;#x969C;&amp;#x53D1;&amp;#x751F;&amp;#x540E;&amp;#x7ACB;&amp;#x5373;&amp;#x4FEE;&amp;#x590D;&amp;#x3002;&amp;#x4E5F;&amp;#x5C31;&amp;#x662F;&amp;#x5728;&amp;#x51FA;&amp;#x73B0;&amp;#x6545;&amp;#x969C;&amp;#x7684;&amp;#x65F6;&amp;#x523B;&amp;#x4E4B;&amp;#x540E;&amp;#xFF0C;&amp;#x8FD9;&amp;#x4E2A;&amp;#x670D;&amp;#x52A1;&amp;#x5668;&amp;#x4F9D;&amp;#x7136;&amp;#x662F;&amp;#x6B63;&amp;#x5E38;&amp;#x7684;&amp;#x3002;&amp;#x4F46;&amp;#x5728;&amp;#x670D;&amp;#x52A1;&amp;#x5668;&amp;#x4EA7;&amp;#x751F;&amp;#x6545;&amp;#x969C;&amp;#x65F6;&amp;#x4F9D;&amp;#x7136;&amp;#x4F1A;&amp;#x5BF9;&amp;#x9700;&amp;#x8981;&amp;#x7ECF;&amp;#x8FC7;&amp;#x8BE5;&amp;#x670D;&amp;#x52A1;&amp;#x5668;&amp;#x7684;&amp;#x6570;&amp;#x636E;&amp;#x4EA4;&amp;#x4E92;&amp;#x8BF7;&amp;#x6C42;&amp;#x9020;&amp;#x6210;&amp;#x5F71;&amp;#x54CD;&amp;#x3002;&amp;#x4F60;&amp;#x7684;&amp;#x4EFB;&amp;#x52A1;&amp;#x662F;&amp;#x5728;&amp;#x6BCF;&amp;#x6B21;&amp;#x51FA;&amp;#x73B0;&amp;#x6545;&amp;#x969C;&amp;#x65F6;&amp;#xFF0C;&amp;#x7EF4;&amp;#x62A4;&amp;#x672A;&amp;#x88AB;&amp;#x5F71;&amp;#x54CD;&amp;#x7684;&amp;#x8BF7;&amp;#x6C42;&amp;#x4E2D;&amp;#x91CD;&amp;#x8981;&amp;#x5EA6;&amp;#x7684;&amp;#x6700;&amp;#x5927;&amp;#x503C;&amp;#x3002;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;&amp;#x94FE;&amp;#x63A5;&quot;&gt;&amp;#x94FE;&amp;#x63A5;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://www.lydsy.com/JudgeOnline/problem.php?id=4538&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;BZOJ 4538&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://cogs.top/cogs/problem/problem.php?pid=2215&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;COGS 2215&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x9898;&amp;#x89E3;&quot;&gt;&amp;#x9898;&amp;#x89E3;&lt;/h3&gt;
&lt;p&gt;&amp;#x5BF9;&amp;#x6811;&amp;#x8FDB;&amp;#x884C;&amp;#x6811;&amp;#x94FE;&amp;#x5256;&amp;#x5206;&amp;#xFF0C;&amp;#x5E76;&amp;#x5F97;&amp;#x5230;&amp;#x5176; DFS &amp;#x5E8F;&amp;#x3002;&amp;#x6811;&amp;#x4E0A;&amp;#x7684;&amp;#x4E00;&amp;#x6761;&amp;#x8DEF;&amp;#x7ECF;&amp;#x8F6C;&amp;#x5316;&amp;#x4E3A; DFS &amp;#x5E8F;&amp;#x4E0A;&amp;#x7684; $ O(\log n) $ &amp;#x4E2A;&amp;#x533A;&amp;#x95F4;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x8003;&amp;#x8651;&amp;#x4E00;&amp;#x6761;&amp;#x672A;&amp;#x5B8C;&amp;#x6210;&amp;#x7684;&amp;#x4EA4;&amp;#x4E92;&amp;#x8BF7;&amp;#x6C42;&lt;strong&gt;&amp;#x4E0D;&lt;/strong&gt;&amp;#x4F1A;&amp;#x53D7;&amp;#x5230;&amp;#x67D0;&amp;#x670D;&amp;#x52A1;&amp;#x5668;&amp;#x6545;&amp;#x969C;&amp;#x7684;&amp;#x5F71;&amp;#x54CD;&amp;#xFF0C;&amp;#x5F53;&amp;#x4E14;&amp;#x4EC5;&amp;#x5F53;&amp;#x8FD9;&amp;#x6761;&amp;#x4EA4;&amp;#x4E92;&amp;#x8BF7;&amp;#x6C42;&lt;strong&gt;&amp;#x4E0D;&lt;/strong&gt;&amp;#x7ECF;&amp;#x8FC7;&amp;#x8FD9;&amp;#x53F0;&amp;#x670D;&amp;#x52A1;&amp;#x5668;&amp;#x3002;&amp;#x6240;&amp;#x4EE5;&amp;#x53EA;&amp;#x9700;&amp;#x8981;&amp;#x7EF4;&amp;#x62A4;&amp;#x4E0D;&amp;#x7ECF;&amp;#x8FC7;&amp;#x67D0;&amp;#x53F0;&amp;#x670D;&amp;#x52A1;&amp;#x5668;&amp;#x7684;&amp;#x8BF7;&amp;#x6C42;&amp;#x5373;&amp;#x53EF;&amp;#x3002;&amp;#x4E00;&amp;#x6761;&amp;#x8BF7;&amp;#x6C42;&amp;#x4F1A;&amp;#x5F71;&amp;#x54CD;&amp;#x6811;&amp;#x7684; DFS &amp;#x5E8F;&amp;#x4E0A; $ O(\log n) $ &amp;#x4E2A;&amp;#x533A;&amp;#x95F4;&amp;#xFF0C;&amp;#x5176;&amp;#x8865;&amp;#x96C6;&amp;#x5373;&amp;#x4E3A;&amp;#x4E0D;&amp;#x7ECF;&amp;#x8FC7;&amp;#x7684;&amp;#x670D;&amp;#x52A1;&amp;#x5668;&amp;#xFF0C;&amp;#x4ECD;&amp;#x7136;&amp;#x662F; $ O(\log n) $ &amp;#x4E2A;&amp;#x533A;&amp;#x95F4;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x518D;&amp;#x5C31;&amp;#x662F;&amp;#x7EF4;&amp;#x62A4;&amp;#x91CD;&amp;#x8981;&amp;#x5EA6;&amp;#x6700;&amp;#x5927;&amp;#x7684;&amp;#x8BF7;&amp;#x6C42;&amp;#xFF0C;&amp;#x53EF;&amp;#x4EE5;&amp;#x5728;&amp;#x7EBF;&amp;#x6BB5;&amp;#x6811;&amp;#x7684;&amp;#x6BCF;&amp;#x4E2A;&amp;#x8282;&amp;#x70B9;&amp;#x4E0A;&amp;#x7EF4;&amp;#x62A4;&amp;#x4E00;&amp;#x4E2A;&amp;#x5806;&amp;#xFF0C;&amp;#x5E76;&amp;#x5C06;&amp;#x6807;&amp;#x8BB0;&amp;#x6C38;&amp;#x4E45;&amp;#x5316;&amp;#xFF08;&amp;#x4E0D;&amp;#x4E0B;&amp;#x4F20;&amp;#x6807;&amp;#x8BB0;&amp;#xFF0C;&amp;#x7528;&amp;#x4ECE;&amp;#x6839;&amp;#x5230;&amp;#x53F6;&amp;#x5B50;&amp;#x7684;&amp;#x4E00;&amp;#x6761;&amp;#x94FE;&amp;#x4E0A;&amp;#x7684;&amp;#x503C;&amp;#x66F4;&amp;#x65B0;&amp;#x7B54;&amp;#x6848;&amp;#xFF09;&amp;#xFF0C;&amp;#x540C;&amp;#x65F6;&amp;#x5B58;&amp;#x50A8;&amp;#x6BCF;&amp;#x6761;&amp;#x8BF7;&amp;#x6C42;&amp;#x662F;&amp;#x5426;&amp;#x5DF2;&amp;#x7ED3;&amp;#x675F;&amp;#xFF0C;&amp;#x5E76;&amp;#x53CA;&amp;#x65F6;&amp;#x5C06;&amp;#x5806;&amp;#x9876;&amp;#x5DF2;&amp;#x7ED3;&amp;#x675F;&amp;#x7684;&amp;#x8BF7;&amp;#x6C42;&amp;#x5220;&amp;#x9664;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x603B;&amp;#x65F6;&amp;#x95F4;&amp;#x590D;&amp;#x6742;&amp;#x5EA6;&amp;#x4E3A; $ O(n \log ^ 3 n) $&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x4EE3;&amp;#x7801;&quot;&gt;&amp;#x4EE3;&amp;#x7801;&lt;/h3&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;93&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;94&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;95&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;96&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;97&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;98&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;99&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;100&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;101&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;102&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;103&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;104&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;105&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;106&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;107&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;108&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;109&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;110&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;111&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;112&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;113&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;114&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;115&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;116&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;117&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;118&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;119&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;120&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;121&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;122&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;123&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;124&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;125&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;126&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;127&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;128&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;129&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;130&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;131&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;132&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;133&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;134&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;135&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;136&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;137&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;138&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;139&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;140&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;141&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;142&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;143&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;144&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;145&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;146&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;147&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;148&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;149&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;150&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;151&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;152&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;153&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;154&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;155&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;156&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;157&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;158&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;159&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;160&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;161&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;162&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;163&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;164&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;165&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;166&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;167&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;168&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;169&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;170&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;171&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;172&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;173&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;174&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;175&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;176&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;177&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;178&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;179&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;180&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;181&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;182&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;183&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;stack&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;queue&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;algorithm&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;utility&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXN = &lt;span class=&quot;number&quot;&gt;100000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXM = &lt;span class=&quot;number&quot;&gt;200000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Node;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Edge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Node {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Edge *e;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Node *p, *c, *t;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; d, i, s;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; v;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} N[MAXN];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Edge {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Node *s, *t;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Edge *next;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Edge(Node *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; s, Node *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; t) : s(s), t(t), next(s-&amp;gt;e) {}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;};&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; SegmentTree {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; l, r;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    SegmentTree *lc, *rc;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::priority_queue&amp;lt; &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::pair&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; *&amp;gt; &amp;gt; q;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    SegmentTree(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; l, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; r, SegmentTree *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; lc, SegmentTree *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; rc) : l(l), r(r), lc(lc), rc(rc) {}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    ~SegmentTree() {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (lc) &lt;span class=&quot;keyword&quot;&gt;delete&lt;/span&gt; lc;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (rc) &lt;span class=&quot;keyword&quot;&gt;delete&lt;/span&gt; rc;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; l, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; r, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::pair&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; *&amp;gt; &amp;amp;p)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (l &amp;gt; &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;r || r &amp;lt; &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;l) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (l &amp;lt;= &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;l &amp;amp;&amp;amp; r &amp;gt;= &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;r) &lt;span class=&quot;comment&quot;&gt;/* printf(&amp;quot;&amp;gt; [%d, %d]\n&amp;quot;, this-&amp;gt;l, this-&amp;gt;r), */&lt;/span&gt; q.push(p);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; lc-&amp;gt;update(l, r, p), rc-&amp;gt;update(l, r, p);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (i &amp;lt; &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;l || i &amp;gt; &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;r) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; -&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; ans = -&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (i &amp;gt;= &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;l &amp;amp;&amp;amp; i &amp;lt;= &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;r) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (!q.empty() &amp;amp;&amp;amp; *q.top().second) q.pop();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!q.empty()) ans = &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::max(ans, q.top().first);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (lc) ans = &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::max(ans, lc-&amp;gt;query(i));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (rc) ans = &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::max(ans, rc-&amp;gt;query(i));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; ans;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} *seg;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;addEdge&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; u, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; v)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    N[u].e = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Edge(&amp;amp;N[u], &amp;amp;N[v]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    N[v].e = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Edge(&amp;amp;N[v], &amp;amp;N[u]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, m;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; del[MAXM];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; SegmentTree *&lt;span class=&quot;title&quot;&gt;buildSegment&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; l, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; r)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (l &amp;gt; r) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (l == r) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; SegmentTree(l, r, &lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;, &lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; SegmentTree(l, r, buildSegment(l, l + ((r - l) &amp;gt;&amp;gt; &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)), buildSegment(l + ((r - l) &amp;gt;&amp;gt; &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, r));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;cut&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;stack&lt;/span&gt;&amp;lt;Node *&amp;gt; s;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    s.push(&amp;amp;N[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    N[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;].d = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (!s.empty()) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Node *v = s.top();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!v-&amp;gt;v) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            v-&amp;gt;v = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (Edge *e = v-&amp;gt;e; e; e = e-&amp;gt;next) &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!e-&amp;gt;t-&amp;gt;d) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                e-&amp;gt;t-&amp;gt;d = v-&amp;gt;d + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                e-&amp;gt;t-&amp;gt;p = v;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                s.push(e-&amp;gt;t);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        } &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            v-&amp;gt;s = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (Edge *e = v-&amp;gt;e; e; e = e-&amp;gt;next) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                v-&amp;gt;s += e-&amp;gt;t-&amp;gt;s;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!v-&amp;gt;c || v-&amp;gt;c-&amp;gt;s &amp;lt; e-&amp;gt;t-&amp;gt;s) v-&amp;gt;c = e-&amp;gt;t;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            s.pop();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) N[i].v = &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    s.push(&amp;amp;N[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; time = -&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (!s.empty()) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Node *v = s.top();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!v-&amp;gt;v) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            v-&amp;gt;v = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!v-&amp;gt;p || v != v-&amp;gt;p-&amp;gt;c) v-&amp;gt;t = v;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; v-&amp;gt;t = v-&amp;gt;p-&amp;gt;t;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            v-&amp;gt;i = ++time;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (Edge *e = v-&amp;gt;e; e; e = e-&amp;gt;next) &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (e-&amp;gt;t-&amp;gt;p == v &amp;amp;&amp;amp; e-&amp;gt;t != v-&amp;gt;c) s.push(e-&amp;gt;t);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (v-&amp;gt;c) s.push(v-&amp;gt;c);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        } &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; s.pop();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    seg = buildSegment(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; u, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; v, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::pair&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; *&amp;gt; &amp;amp;p)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Node *a = &amp;amp;N[u], *b = &amp;amp;N[v];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;vector&lt;/span&gt;&amp;lt; &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::pair&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;&amp;gt; &amp;gt; vec;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (a-&amp;gt;t != b-&amp;gt;t) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (a-&amp;gt;t-&amp;gt;d &amp;lt; b-&amp;gt;t-&amp;gt;d) &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::swap(a, b);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        vec.push_back(&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::make_pair(a-&amp;gt;t-&amp;gt;i, a-&amp;gt;i));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        a = a-&amp;gt;t-&amp;gt;p;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (a-&amp;gt;i &amp;gt; b-&amp;gt;i) &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::swap(a, b);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    vec.push_back(&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::make_pair(a-&amp;gt;i, b-&amp;gt;i));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (vec.empty()) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::sort(vec.begin(), vec.end());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::pair&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;&amp;gt; last = &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::make_pair(-&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, -&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;vector&lt;/span&gt;&amp;lt; &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::pair&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;&amp;gt; &amp;gt;::const_iterator it = vec.begin(); it != vec.end(); it++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        seg-&amp;gt;update(last.second + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, it-&amp;gt;first - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, p);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// printf(&amp;quot;[%d, %d]\n&amp;quot;, last.second + 1, it-&amp;gt;first - 1);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        last = *it;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    seg-&amp;gt;update(last.second + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, p);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// printf(&amp;quot;[%d, %d]\n&amp;quot;, last.second + 1, n - 1);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; x)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// printf(&amp;quot;query(%d)\n&amp;quot;, x);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; seg-&amp;gt;query(N[x].i);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    freopen(&lt;span class=&quot;string&quot;&gt;&amp;quot;network_tenderRun.in&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;r&amp;quot;&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;stdin&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    freopen(&lt;span class=&quot;string&quot;&gt;&amp;quot;network_tenderRun.out&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;w&amp;quot;&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;stdout&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d&amp;quot;&lt;/span&gt;, &amp;amp;n, &amp;amp;m);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; u, v;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d&amp;quot;&lt;/span&gt;, &amp;amp;u, &amp;amp;v), u--, v--;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        addEdge(u, v);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    cut();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// for (int i = 0; i &amp;lt; n; i++) printf(&amp;quot;#%d: i = %d\n&amp;quot;, i + 1, N[i].i);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; m; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; c;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;c);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (c == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; u, v, w;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d %d&amp;quot;&lt;/span&gt;, &amp;amp;u, &amp;amp;v, &amp;amp;w), u--, v--;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            update(u, v, &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::make_pair(w, &amp;amp;del[i]));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        } &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (c == &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; t;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;t), t--;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            del[t] = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        } &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (c == &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; x;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;x), x--;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d\n&amp;quot;&lt;/span&gt;, query(x));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    fclose(&lt;span class=&quot;built_in&quot;&gt;stdin&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    fclose(&lt;span class=&quot;built_in&quot;&gt;stdout&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x4E00;&amp;#x4E2A;&amp;#x7B80;&amp;#x5355;&amp;#x7684;&amp;#x7F51;&amp;#x7EDC;&amp;#x7CFB;&amp;#x7EDF;&amp;#x53EF;&amp;#x4EE5;&amp;#x88AB;&amp;#x63CF;&amp;#x8FF0;&amp;#x6210;&amp;#x4E00;&amp;#x68F5;&amp;#x65E0;&amp;#x6839;&amp;#x6811;&amp;#x3002;&amp;#x4E24;&amp;#x4E2A;&amp;#x670D;&amp;#x52A1;&amp;#x5668;&amp;#x8FDB;&amp;#x884C;&amp;#x6570;&amp;#x636E;&amp;#x7684;&amp;#x4EA4;&amp;#x4E92;&amp;#x65F6;&amp;#xFF0C;&amp;#x6570;&amp;#x636E;&amp;#x4F1A;&amp;#x7ECF;&amp;#x8FC7;&amp;#x8FDE;&amp;#x63A5;&amp;#x8FD9;&amp;#x4E24;&amp;#x4E2A;&amp;#x670D;&amp;#x52A1;&amp;#x5668;&amp;#x7684;&amp;#x8DEF;&amp;#x5F84;&amp;#x4E0A;&amp;#x7684;&amp;#x6240;&amp;#x6709;&amp;#x670D;&amp;#x52A1;&amp;#x5668;&amp;#xFF08;&amp;#x5305;&amp;#x62EC;&amp;#x8FD9;&amp;#x4E24;&amp;#x4E2A;&amp;#x670D;&amp;#x52A1;&amp;#x5668;&amp;#x81EA;&amp;#x8EAB;&amp;#xFF09;&amp;#x3002;&amp;#x5F53;&amp;#x8DEF;&amp;#x5F84;&amp;#x4E0A;&amp;#x7684;&amp;#x67D0;&amp;#x4E2A;&amp;#x670D;&amp;#x52A1;&amp;#x5668;&amp;#x51FA;&amp;#x73B0;&amp;#x6545;&amp;#x969C;&amp;#xFF0C;&amp;#x65E0;&amp;#x6CD5;&amp;#x6B63;&amp;#x5E38;&amp;#x8FD0;&amp;#x884C;&amp;#x65F6;&amp;#xFF0C;&amp;#x6570;&amp;#x636E;&amp;#x4FBF;&amp;#x65E0;&amp;#x6CD5;&amp;#x4EA4;&amp;#x4E92;&amp;#x3002;&amp;#x6B64;&amp;#x5916;&amp;#xFF0C;&amp;#x6BCF;&amp;#x4E2A;&amp;#x6570;&amp;#x636E;&amp;#x4EA4;&amp;#x4E92;&amp;#x8BF7;&amp;#x6C42;&amp;#x90FD;&amp;#x6709;&amp;#x4E00;&amp;#x4E2A;&amp;#x91CD;&amp;#x8981;&amp;#x5EA6;&amp;#x3002;&amp;#x5728;&amp;#x6BCF;&amp;#x4E00;&amp;#x4E2A;&amp;#x65F6;&amp;#x523B;&amp;#xFF0C;&amp;#x53EA;&amp;#x6709;&amp;#x53EF;&amp;#x80FD;&amp;#x51FA;&amp;#x73B0;&amp;#x4E0B;&amp;#x5217;&amp;#x4E09;&amp;#x79CD;&amp;#x4E8B;&amp;#x4EF6;&amp;#x4E2D;&amp;#x7684;&amp;#x4E00;&amp;#x79CD;&amp;#xFF1A;&lt;/p&gt;
&lt;ol style=&quot;list-style-type: decimal&quot;&gt;
&lt;li&gt;&amp;#x5728;&amp;#x67D0;&amp;#x4E24;&amp;#x4E2A;&amp;#x670D;&amp;#x52A1;&amp;#x5668;&amp;#x4E4B;&amp;#x95F4;&amp;#x51FA;&amp;#x73B0;&amp;#x4E00;&amp;#x6761;&amp;#x65B0;&amp;#x7684;&amp;#x6570;&amp;#x636E;&amp;#x4EA4;&amp;#x4E92;&amp;#x8BF7;&amp;#x6C42;&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x67D0;&amp;#x4E2A;&amp;#x6570;&amp;#x636E;&amp;#x4EA4;&amp;#x4E92;&amp;#x7ED3;&amp;#x675F;&amp;#x8BF7;&amp;#x6C42;&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x67D0;&amp;#x4E2A;&amp;#x670D;&amp;#x52A1;&amp;#x5668;&amp;#x51FA;&amp;#x73B0;&amp;#x6545;&amp;#x969C;&amp;#x3002;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&amp;#x7CFB;&amp;#x7EDF;&amp;#x4F1A;&amp;#x5728;&amp;#x4EFB;&amp;#x4F55;&amp;#x6545;&amp;#x969C;&amp;#x53D1;&amp;#x751F;&amp;#x540E;&amp;#x7ACB;&amp;#x5373;&amp;#x4FEE;&amp;#x590D;&amp;#x3002;&amp;#x4E5F;&amp;#x5C31;&amp;#x662F;&amp;#x5728;&amp;#x51FA;&amp;#x73B0;&amp;#x6545;&amp;#x969C;&amp;#x7684;&amp;#x65F6;&amp;#x523B;&amp;#x4E4B;&amp;#x540E;&amp;#xFF0C;&amp;#x8FD9;&amp;#x4E2A;&amp;#x670D;&amp;#x52A1;&amp;#x5668;&amp;#x4F9D;&amp;#x7136;&amp;#x662F;&amp;#x6B63;&amp;#x5E38;&amp;#x7684;&amp;#x3002;&amp;#x4F46;&amp;#x5728;&amp;#x670D;&amp;#x52A1;&amp;#x5668;&amp;#x4EA7;&amp;#x751F;&amp;#x6545;&amp;#x969C;&amp;#x65F6;&amp;#x4F9D;&amp;#x7136;&amp;#x4F1A;&amp;#x5BF9;&amp;#x9700;&amp;#x8981;&amp;#x7ECF;&amp;#x8FC7;&amp;#x8BE5;&amp;#x670D;&amp;#x52A1;&amp;#x5668;&amp;#x7684;&amp;#x6570;&amp;#x636E;&amp;#x4EA4;&amp;#x4E92;&amp;#x8BF7;&amp;#x6C42;&amp;#x9020;&amp;#x6210;&amp;#x5F71;&amp;#x54CD;&amp;#x3002;&amp;#x4F60;&amp;#x7684;&amp;#x4EFB;&amp;#x52A1;&amp;#x662F;&amp;#x5728;&amp;#x6BCF;&amp;#x6B21;&amp;#x51FA;&amp;#x73B0;&amp;#x6545;&amp;#x969C;&amp;#x65F6;&amp;#xFF0C;&amp;#x7EF4;&amp;#x62A4;&amp;#x672A;&amp;#x88AB;&amp;#x5F71;&amp;#x54CD;&amp;#x7684;&amp;#x8BF7;&amp;#x6C42;&amp;#x4E2D;&amp;#x91CD;&amp;#x8981;&amp;#x5EA6;&amp;#x7684;&amp;#x6700;&amp;#x5927;&amp;#x503C;&amp;#x3002;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="BZOJ" scheme="https://blog.menci.moe/tag/bzoj/"/>
    
      <category term="COGS" scheme="https://blog.menci.moe/tag/cogs/"/>
    
      <category term="DFS 序" scheme="https://blog.menci.moe/tag/dfs-%E5%BA%8F/"/>
    
      <category term="HNOI" scheme="https://blog.menci.moe/tag/hnoi/"/>
    
      <category term="树链剖分" scheme="https://blog.menci.moe/tag/%E6%A0%91%E9%93%BE%E5%89%96%E5%88%86/"/>
    
  </entry>
  
</feed>
