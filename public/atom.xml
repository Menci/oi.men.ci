<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Menci</title>
  <subtitle>眉眼如初，岁月如故</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://blog.menci.moe/"/>
  <updated>2016-03-07T01:44:01.000Z</updated>
  <id>https://blog.menci.moe/</id>
  
  <author>
    <name>Menci</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>「SCOI2010」游戏 - 二分图匹配</title>
    <link href="https://blog.menci.moe/scoi2010-game/"/>
    <id>https://blog.menci.moe/scoi2010-game/</id>
    <published>2016-03-07T01:43:18.000Z</published>
    <updated>2016-03-07T01:44:01.000Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x5728;&amp;#x6E38;&amp;#x620F;&amp;#x91CC;&amp;#xFF0C;&amp;#x4ED6;&amp;#x62E5;&amp;#x6709;&amp;#x5F88;&amp;#x591A;&amp;#x7684;&amp;#x88C5;&amp;#x5907;&amp;#xFF0C;&amp;#x6BCF;&amp;#x79CD;&amp;#x88C5;&amp;#x5907;&amp;#x90FD;&amp;#x6709;&amp;#x4E24;&amp;#x4E2A;&amp;#x5C5E;&amp;#x6027;&amp;#xFF0C;&amp;#x8FD9;&amp;#x4E9B;&amp;#x5C5E;&amp;#x6027;&amp;#x7684;&amp;#x503C;&amp;#x7528; $ [1, 10000] $ &amp;#x4E4B;&amp;#x95F4;&amp;#x7684;&amp;#x6570;&amp;#x8868;&amp;#x793A;&amp;#x3002;&amp;#x5F53;&amp;#x4ED6;&amp;#x4F7F;&amp;#x7528;&amp;#x67D0;&amp;#x79CD;&amp;#x88C5;&amp;#x5907;&amp;#x65F6;&amp;#xFF0C;&amp;#x4ED6;&amp;#x53EA;&amp;#x80FD;&amp;#x4F7F;&amp;#x7528;&amp;#x8BE5;&amp;#x88C5;&amp;#x5907;&amp;#x7684;&amp;#x67D0;&amp;#x4E00;&amp;#x4E2A;&amp;#x5C5E;&amp;#x6027;&amp;#x3002;&amp;#x5E76;&amp;#x4E14;&amp;#x6BCF;&amp;#x79CD;&amp;#x88C5;&amp;#x5907;&amp;#x6700;&amp;#x591A;&amp;#x53EA;&amp;#x80FD;&amp;#x4F7F;&amp;#x7528;&amp;#x4E00;&amp;#x6B21;&amp;#x3002; &amp;#x7EC8;&amp;#x6781; BOSS &amp;#x5F88;&amp;#x5947;&amp;#x602A;&amp;#xFF0C;&amp;#x653B;&amp;#x51FB;&amp;#x4ED6;&amp;#x7684;&amp;#x88C5;&amp;#x5907;&amp;#x6240;&amp;#x4F7F;&amp;#x7528;&amp;#x7684;&amp;#x5C5E;&amp;#x6027;&amp;#x503C;&amp;#x5FC5;&amp;#x987B;&amp;#x4ECE; $ 1 $ &amp;#x5F00;&amp;#x59CB;&amp;#x8FDE;&amp;#x7EED;&amp;#x9012;&amp;#x589E;&amp;#x5730;&amp;#x653B;&amp;#x51FB;&amp;#xFF0C;&amp;#x624D;&amp;#x80FD;&amp;#x5BF9; BOSS &amp;#x4EA7;&amp;#x751F;&amp;#x4F24;&amp;#x5BB3;&amp;#x3002;&amp;#x4E5F;&amp;#x5C31;&amp;#x662F;&amp;#x8BF4;&amp;#x4E00;&amp;#x5F00;&amp;#x59CB;&amp;#x7684;&amp;#x65F6;&amp;#x5019;&amp;#xFF0C;&amp;#x53EA;&amp;#x80FD;&amp;#x4F7F;&amp;#x7528;&amp;#x67D0;&amp;#x4E2A;&amp;#x5C5E;&amp;#x6027;&amp;#x503C;&amp;#x4E3A; $ 1 $ &amp;#x7684;&amp;#x88C5;&amp;#x5907;&amp;#x653B;&amp;#x51FB; BOSS&amp;#xFF0C;&amp;#x7136;&amp;#x540E;&amp;#x53EA;&amp;#x80FD;&amp;#x4F7F;&amp;#x7528;&amp;#x67D0;&amp;#x4E2A;&amp;#x5C5E;&amp;#x6027;&amp;#x503C;&amp;#x4E3A; $ 2 $ &amp;#x7684;&amp;#x88C5;&amp;#x5907;&amp;#x653B;&amp;#x51FB; BOSS&amp;#xFF0C;&amp;#x7136;&amp;#x540E;&amp;#x53EA;&amp;#x80FD;&amp;#x4F7F;&amp;#x7528;&amp;#x67D0;&amp;#x4E2A;&amp;#x5C5E;&amp;#x6027;&amp;#x503C;&amp;#x4E3A; $ 3 $ &amp;#x7684;&amp;#x88C5;&amp;#x5907;&amp;#x653B;&amp;#x51FB; BOSS &amp;#x2026;&amp;#x2026; &amp;#x4EE5;&amp;#x6B64;&amp;#x7C7B;&amp;#x63A8;&amp;#x3002;&amp;#x4ED6;&amp;#x6700;&amp;#x591A;&amp;#x80FD;&amp;#x8FDE;&amp;#x7EED;&amp;#x653B;&amp;#x51FB; BOSS &amp;#x591A;&amp;#x5C11;&amp;#x6B21;&amp;#xFF1F;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;&amp;#x9898;&amp;#x76EE;&amp;#x94FE;&amp;#x63A5;&quot;&gt;&amp;#x9898;&amp;#x76EE;&amp;#x94FE;&amp;#x63A5;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://www.lydsy.com/JudgeOnline/problem.php?id=1854&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;BZOJ 1854&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x89E3;&amp;#x9898;&amp;#x601D;&amp;#x8DEF;&quot;&gt;&amp;#x89E3;&amp;#x9898;&amp;#x601D;&amp;#x8DEF;&lt;/h3&gt;
&lt;p&gt;&amp;#x770B;&amp;#x4E00;&amp;#x4E0B;&amp;#x6570;&amp;#x636E;&amp;#x8303;&amp;#x56F4; $ N &amp;#x2264; 1000000 $&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x679A;&amp;#x4E3E;&amp;#x6BCF;&amp;#x4EF6;&amp;#x6B66;&amp;#x5668;&amp;#xFF0C;&amp;#x80AF;&amp;#x5B9A;&amp;#x8981; $ O(n) $ &amp;#x7684;&amp;#x7B97;&amp;#x6CD5;&amp;#x624D;&amp;#x80FD;&amp;#x8FC7;&amp;#xFF0C;&amp;#x4F46;&amp;#x53C8;&amp;#x60F3;&amp;#x4E0D;&amp;#x51FA; $ O(n) $ &amp;#x7684;&amp;#x7B97;&amp;#x6CD5;&amp;#x6765; &amp;#x2026;&amp;#x2026;&lt;/p&gt;
&lt;p&gt;&amp;#x6211;&amp;#x4EEC;&amp;#x6362;&amp;#x4E00;&amp;#x79CD;&amp;#x601D;&amp;#x8DEF;&amp;#xFF0C;&amp;#x4ECE;&amp;#x5C5E;&amp;#x6027;&amp;#x503C;&amp;#x5C0F;&amp;#x5230;&amp;#x5927;&amp;#xFF0C;&amp;#x4E4B;&amp;#x95F4;&amp;#x5982;&amp;#x679C;&amp;#x6709;&amp;#x4E00;&amp;#x4E2A;&amp;#x6570;&amp;#x4E0D;&amp;#x80FD;&amp;#x6CA1;&amp;#x6709;&amp;#x53EF;&amp;#x7528;&amp;#x7684;&amp;#x6B66;&amp;#x5668;&amp;#xFF0C;&amp;#x5219;&amp;#x4E0D;&amp;#x53EF;&amp;#x80FD;&amp;#x7EE7;&amp;#x7EED;&amp;#x6253;&amp;#x51FA;&amp;#x6BD4;&amp;#x8FD9;&amp;#x4E2A;&amp;#x6570;&amp;#x66F4;&amp;#x5927;&amp;#x7684;&amp;#x5C5E;&amp;#x6027;&amp;#x503C;&amp;#x4E86;&amp;#x3002;&amp;#x4E5F;&amp;#x5C31;&amp;#x662F;&amp;#x8BF4;&amp;#x7B54;&amp;#x6848;&amp;#x5177;&amp;#x6709;&amp;#x5355;&amp;#x8C03;&amp;#x6027;&amp;#xFF0C;&amp;#x53EF;&amp;#x4EE5;&amp;#x91C7;&amp;#x7528;&amp;#x679A;&amp;#x4E3E;&amp;#x7B54;&amp;#x6848;&amp;#x5E76;&amp;#x68C0;&amp;#x9A8C;&amp;#x7684;&amp;#x65B9;&amp;#x6CD5;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x9898;&amp;#x76EE;&amp;#x4E2D;&amp;#x5E76;&amp;#x6CA1;&amp;#x6709;&amp;#x8981;&amp;#x6C42;&amp;#x67D0;&amp;#x4E2A;&amp;#x5C5E;&amp;#x6027;&amp;#x503C;&amp;#x8981;&amp;#x7531;&amp;#x7279;&amp;#x5B9A;&amp;#x7684;&amp;#x6B66;&amp;#x5668;&amp;#x6253;&amp;#x51FA;&amp;#xFF0C;&amp;#x6240;&amp;#x4EE5;&amp;#x8BF4;&amp;#x53EF;&amp;#x4EE5;&amp;#x4EFB;&amp;#x610F;&amp;#x9009;&amp;#x62E9;&amp;#x67D0;&amp;#x4E2A;&amp;#x53EF;&amp;#x7528;&amp;#x7684;&amp;#x6B66;&amp;#x5668;&amp;#x6765;&amp;#x6253;&amp;#x51FA;&amp;#x6307;&amp;#x5B9A;&amp;#x7684;&amp;#x5C5E;&amp;#x6027;&amp;#x503C;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x4ECE; $ 1 $ &amp;#x5F00;&amp;#x59CB;&amp;#xFF0C;&amp;#x4EFB;&amp;#x9009;&amp;#x4E00;&amp;#x4E2A;&amp;#x53EF;&amp;#x6253;&amp;#x51FA; $ 1 $ &amp;#x7684;&amp;#x6B66;&amp;#x5668;&amp;#x5E76;&amp;#x6807;&amp;#x8BB0;&amp;#x4E3A;&amp;#x4F7F;&amp;#x7528;&amp;#x8FC7;&amp;#xFF0C;&amp;#x679A;&amp;#x4E3E;&amp;#x65F6;&amp;#x5982;&amp;#x679C;&amp;#x53D1;&amp;#x73B0;&amp;#x80FD;&amp;#x6253;&amp;#x51FA; $ X $ &amp;#x7684;&amp;#x6B66;&amp;#x5668;&amp;#x5168;&amp;#x90E8;&amp;#x88AB;&amp;#x7528;&amp;#x8FC7;&amp;#x4E86;&amp;#xFF0C;&amp;#x5C31;&amp;#x5C1D;&amp;#x8BD5;&amp;#x5C06;&amp;#x67D0;&amp;#x4E00;&amp;#x4EF6;&amp;#x5C5E;&amp;#x6027;&amp;#x503C;&amp;#x4E3A; $ \{X, Y\} $ &amp;#x6B66;&amp;#x5668;&amp;#x6807;&amp;#x8BB0;&amp;#x4E3A; $ X $&amp;#xFF0C;&amp;#x5E76;&amp;#x5BFB;&amp;#x627E; $ Y $ &amp;#x7684;&amp;#x66FF;&amp;#x4EE3;&amp;#xFF08;$ Y &amp;lt; X $&amp;#xFF09;&amp;#xFF0C;&amp;#x8FD9;&amp;#x6837;&amp;#x9012;&amp;#x5F52;&amp;#x4E0B;&amp;#x53BB;&amp;#xFF0C;&amp;#x76F4;&amp;#x5230;&amp;#x67D0;&amp;#x4E2A;&amp;#x5C5E;&amp;#x6027;&amp;#x503C;&amp;#x4F7F;&amp;#x7528;&amp;#x4E86;&amp;#x4E00;&amp;#x4EF6;&amp;#x6CA1;&amp;#x6709;&amp;#x88AB;&amp;#x4F7F;&amp;#x7528;&amp;#x6B66;&amp;#x5668;&amp;#xFF0C;&amp;#x5219;&amp;#x6210;&amp;#x529F;&amp;#xFF0C;&amp;#x5426;&amp;#x5219;&amp;#x5931;&amp;#x8D25;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x7B97;&amp;#x6CD5;&amp;#x601D;&amp;#x60F3;&amp;#x4E0E;&amp;#x300E;&amp;#x4E8C;&amp;#x5206;&amp;#x56FE;&amp;#x5339;&amp;#x914D;&amp;#x300F;&amp;#x4E2D;&amp;#x7684;&amp;#x5308;&amp;#x7259;&amp;#x5229;&amp;#x7B97;&amp;#x6CD5;&amp;#x6BD4;&amp;#x8F83;&amp;#x76F8;&amp;#x4F3C;&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;ac&amp;#x4EE3;&amp;#x7801;&quot;&gt;AC&amp;#x4EE3;&amp;#x7801;&lt;/h3&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;vector&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXN = &lt;span class=&quot;number&quot;&gt;1000000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXX = &lt;span class=&quot;number&quot;&gt;10000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Gun {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; x[&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; selected;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Gun() : selected(-&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) {}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;select&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; x)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;x[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;] == x) selected = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; selected = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} guns[MAXN];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;vector&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;&amp;gt; gunID[MAXX];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;check&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; x, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; ignore = -&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;vector&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;&amp;gt;::const_iterator p = gunID[x].begin(); p != gunID[x].end(); p++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		Gun &amp;amp;g = guns[*p];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (g.selected == -&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			g.select(x);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;vector&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;&amp;gt;::const_iterator p = gunID[x].begin(); p != gunID[x].end(); p++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (*p == ignore) &lt;span class=&quot;keyword&quot;&gt;continue&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		Gun &amp;amp;g = guns[*p];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (check(g.x[g.selected ^ &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;], *p)) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			g.select(x);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;n);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		Gun &amp;amp;g = guns[i];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d&amp;quot;&lt;/span&gt;, &amp;amp;g.x[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;], &amp;amp;g.x[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]), g.x[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;]--, g.x[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]--;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		gunID[g.x[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;]].push_back(i);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		gunID[g.x[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]].push_back(i);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; MAXX; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!check(i)) &lt;span class=&quot;keyword&quot;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d\n&amp;quot;&lt;/span&gt;, i);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x5728;&amp;#x6E38;&amp;#x620F;&amp;#x91CC;&amp;#xFF0C;&amp;#x4ED6;&amp;#x62E5;&amp;#x6709;&amp;#x5F88;&amp;#x591A;&amp;#x7684;&amp;#x88C5;&amp;#x5907;&amp;#xFF0C;&amp;#x6BCF;&amp;#x79CD;&amp;#x88C5;&amp;#x5907;&amp;#x90FD;&amp;#x6709;&amp;#x4E24;&amp;#x4E2A;&amp;#x5C5E;&amp;#x6027;&amp;#xFF0C;&amp;#x8FD9;&amp;#x4E9B;&amp;#x5C5E;&amp;#x6027;&amp;#x7684;&amp;#x503C;&amp;#x7528; $ [1, 10000] $ &amp;#x4E4B;&amp;#x95F4;&amp;#x7684;&amp;#x6570;&amp;#x8868;&amp;#x793A;&amp;#x3002;&amp;#x5F53;&amp;#x4ED6;&amp;#x4F7F;&amp;#x7528;&amp;#x67D0;&amp;#x79CD;&amp;#x88C5;&amp;#x5907;&amp;#x65F6;&amp;#xFF0C;&amp;#x4ED6;&amp;#x53EA;&amp;#x80FD;&amp;#x4F7F;&amp;#x7528;&amp;#x8BE5;&amp;#x88C5;&amp;#x5907;&amp;#x7684;&amp;#x67D0;&amp;#x4E00;&amp;#x4E2A;&amp;#x5C5E;&amp;#x6027;&amp;#x3002;&amp;#x5E76;&amp;#x4E14;&amp;#x6BCF;&amp;#x79CD;&amp;#x88C5;&amp;#x5907;&amp;#x6700;&amp;#x591A;&amp;#x53EA;&amp;#x80FD;&amp;#x4F7F;&amp;#x7528;&amp;#x4E00;&amp;#x6B21;&amp;#x3002; &amp;#x7EC8;&amp;#x6781; BOSS &amp;#x5F88;&amp;#x5947;&amp;#x602A;&amp;#xFF0C;&amp;#x653B;&amp;#x51FB;&amp;#x4ED6;&amp;#x7684;&amp;#x88C5;&amp;#x5907;&amp;#x6240;&amp;#x4F7F;&amp;#x7528;&amp;#x7684;&amp;#x5C5E;&amp;#x6027;&amp;#x503C;&amp;#x5FC5;&amp;#x987B;&amp;#x4ECE; $ 1 $ &amp;#x5F00;&amp;#x59CB;&amp;#x8FDE;&amp;#x7EED;&amp;#x9012;&amp;#x589E;&amp;#x5730;&amp;#x653B;&amp;#x51FB;&amp;#xFF0C;&amp;#x624D;&amp;#x80FD;&amp;#x5BF9; BOSS &amp;#x4EA7;&amp;#x751F;&amp;#x4F24;&amp;#x5BB3;&amp;#x3002;&amp;#x4E5F;&amp;#x5C31;&amp;#x662F;&amp;#x8BF4;&amp;#x4E00;&amp;#x5F00;&amp;#x59CB;&amp;#x7684;&amp;#x65F6;&amp;#x5019;&amp;#xFF0C;&amp;#x53EA;&amp;#x80FD;&amp;#x4F7F;&amp;#x7528;&amp;#x67D0;&amp;#x4E2A;&amp;#x5C5E;&amp;#x6027;&amp;#x503C;&amp;#x4E3A; $ 1 $ &amp;#x7684;&amp;#x88C5;&amp;#x5907;&amp;#x653B;&amp;#x51FB; BOSS&amp;#xFF0C;&amp;#x7136;&amp;#x540E;&amp;#x53EA;&amp;#x80FD;&amp;#x4F7F;&amp;#x7528;&amp;#x67D0;&amp;#x4E2A;&amp;#x5C5E;&amp;#x6027;&amp;#x503C;&amp;#x4E3A; $ 2 $ &amp;#x7684;&amp;#x88C5;&amp;#x5907;&amp;#x653B;&amp;#x51FB; BOSS&amp;#xFF0C;&amp;#x7136;&amp;#x540E;&amp;#x53EA;&amp;#x80FD;&amp;#x4F7F;&amp;#x7528;&amp;#x67D0;&amp;#x4E2A;&amp;#x5C5E;&amp;#x6027;&amp;#x503C;&amp;#x4E3A; $ 3 $ &amp;#x7684;&amp;#x88C5;&amp;#x5907;&amp;#x653B;&amp;#x51FB; BOSS &amp;#x2026;&amp;#x2026; &amp;#x4EE5;&amp;#x6B64;&amp;#x7C7B;&amp;#x63A8;&amp;#x3002;&amp;#x4ED6;&amp;#x6700;&amp;#x591A;&amp;#x80FD;&amp;#x8FDE;&amp;#x7EED;&amp;#x653B;&amp;#x51FB; BOSS &amp;#x591A;&amp;#x5C11;&amp;#x6B21;&amp;#xFF1F;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="BZOJ" scheme="https://blog.menci.moe/tag/bzoj/"/>
    
      <category term="SCOI" scheme="https://blog.menci.moe/tag/scoi/"/>
    
      <category term="二分图匹配" scheme="https://blog.menci.moe/tag/%E4%BA%8C%E5%88%86%E5%9B%BE%E5%8C%B9%E9%85%8D/"/>
    
      <category term="匈牙利算法" scheme="https://blog.menci.moe/tag/%E5%8C%88%E7%89%99%E5%88%A9%E7%AE%97%E6%B3%95/"/>
    
      <category term="图论" scheme="https://blog.menci.moe/tag/%E5%9B%BE%E8%AE%BA/"/>
    
      <category term="枚举答案" scheme="https://blog.menci.moe/tag/%E6%9E%9A%E4%B8%BE%E7%AD%94%E6%A1%88/"/>
    
  </entry>
  
  <entry>
    <title>OS X 与虚拟机中 Linux 无缝整合</title>
    <link href="https://blog.menci.moe/virtualbox-archlinux/"/>
    <id>https://blog.menci.moe/virtualbox-archlinux/</id>
    <published>2016-03-07T01:04:27.000Z</published>
    <updated>2016-03-07T01:05:48.000Z</updated>
    
    <content type="html">&lt;p&gt;OS X &amp;#x4E2D;&amp;#x6709;&amp;#x5F88;&amp;#x591A;&amp;#x4E0E; GNU/Linux &amp;#x76F8;&amp;#x4F3C;&amp;#x7684;&amp;#x5730;&amp;#x65B9;&amp;#xFF0C;&amp;#x4F46;&amp;#x4E5F;&amp;#x6709;&amp;#x5F88;&amp;#x5927;&amp;#x7684;&amp;#x5DEE;&amp;#x5F02;&amp;#xFF0C;&amp;#x5F88;&amp;#x591A;&amp;#x65F6;&amp;#x5019; GNU/Linux &amp;#x7CFB;&amp;#x7EDF;&amp;#x6BD4; OS X &amp;#x597D;&amp;#x7528;&amp;#x4E00;&amp;#x4E9B;&amp;#xFF0C;&amp;#x800C; OS X &amp;#x7684;&amp;#x56FE;&amp;#x5F62;&amp;#x754C;&amp;#x9762;&amp;#x6BD4; GNU/Linux &amp;#x4E0D;&amp;#x77E5;&amp;#x8981;&amp;#x9AD8;&amp;#x5230;&amp;#x54EA;&amp;#x91CC;&amp;#x53BB;&amp;#x4E86; &amp;#x2026;&amp;#x2026; &amp;#x4E8C;&amp;#x8005;&amp;#x517C;&amp;#x5F97;&amp;#x7684;&amp;#x65B9;&amp;#x6CD5;&amp;#xFF0C;&amp;#x5C31;&amp;#x662F;&amp;#x4F7F;&amp;#x7528;&amp;#x865A;&amp;#x62DF;&amp;#x673A;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x4E0B;&amp;#x9762;&amp;#x4EE5;&amp;#x6700;&amp;#x597D;&amp;#x7528;&amp;#x7684;&amp;#x865A;&amp;#x62DF;&amp;#x673A;&amp;#x8F6F;&amp;#x4EF6; &lt;code&gt;VirtualBox&lt;/code&gt; &amp;#x4E3A;&amp;#x4F8B;&amp;#xFF0C;&amp;#x6F14;&amp;#x793A;&amp;#x914D;&amp;#x7F6E; Archlinux &amp;#x865A;&amp;#x62DF;&amp;#x673A;&amp;#x4E0E; OS X &amp;#x4E3B;&amp;#x673A;&amp;#x65E0;&amp;#x7F1D;&amp;#x6574;&amp;#x5408;&amp;#x7684;&amp;#x6B65;&amp;#x9AA4;&amp;#x3002;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h2 id=&quot;&amp;#x5B89;&amp;#x88C5;-openssh&quot;&gt;&amp;#x5B89;&amp;#x88C5; OpenSSH&lt;/h2&gt;
&lt;p&gt;&amp;#x9996;&amp;#x5148;&amp;#xFF0C;&amp;#x5728;&amp;#x865A;&amp;#x62DF;&amp;#x673A;&amp;#x4E2D;&amp;#x5B89;&amp;#x88C5;&amp;#x597D; Arch Linux &amp;#x7CFB;&amp;#x7EDF;&amp;#xFF0C;&amp;#x5E76;&amp;#x5B89;&amp;#x88C5;&amp;#x597D;&amp;#x589E;&amp;#x5F3A;&amp;#x5DE5;&amp;#x5177;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x5B89;&amp;#x88C5; OpenSSH&amp;#xFF1A;&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo pacman -S openssh&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sudo systemctl &lt;span class=&quot;built_in&quot;&gt;enable&lt;/span&gt; sshd&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sudo systemctl start sshd&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;&amp;#x914D;&amp;#x7F6E;&amp;#x7AEF;&amp;#x53E3;&amp;#x8F6C;&amp;#x53D1;&quot;&gt;&amp;#x914D;&amp;#x7F6E;&amp;#x7AEF;&amp;#x53E3;&amp;#x8F6C;&amp;#x53D1;&lt;/h2&gt;
&lt;p&gt;&amp;#x6253;&amp;#x5F00;&amp;#x300C;&amp;#x8BBE;&amp;#x7F6E;&amp;#x300D;&amp;#x2192;&amp;#x300C;&amp;#x7F51;&amp;#x7EDC;&amp;#x300D;&amp;#xFF0C;&amp;#x9009;&amp;#x62E9;&amp;#x300C;&amp;#x7F51;&amp;#x7EDC;&amp;#x5730;&amp;#x5740;&amp;#x8F6C;&amp;#x6362;&amp;#x300C;NAT&amp;#x300D;&amp;#x8FDE;&amp;#x63A5;&amp;#x65B9;&amp;#x5F0F;&amp;#x3002;&lt;/p&gt;
&lt;div class=&quot;figure&quot;&gt;
&lt;img src=&quot;//dn-menci.qbox.me/virtualbox-archlinux/network.png&quot; alt=&quot;&amp;#x7F51;&amp;#x7EDC;&amp;#x8BBE;&amp;#x7F6E;&quot;&gt;
&lt;p class=&quot;caption&quot;&gt;&amp;#x7F51;&amp;#x7EDC;&amp;#x8BBE;&amp;#x7F6E;&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;&amp;#x70B9;&amp;#x51FB;&amp;#x300C;&amp;#x7AEF;&amp;#x53E3;&amp;#x8F6C;&amp;#x53D1;&amp;#x300D;&amp;#x3002;&lt;/p&gt;
&lt;div class=&quot;figure&quot;&gt;
&lt;img src=&quot;//dn-menci.qbox.me/virtualbox-archlinux/port.png&quot; alt=&quot;&amp;#x7AEF;&amp;#x53E3;&amp;#x8F6C;&amp;#x53D1;&quot;&gt;
&lt;p class=&quot;caption&quot;&gt;&amp;#x7AEF;&amp;#x53E3;&amp;#x8F6C;&amp;#x53D1;&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;&amp;#x5B50;&amp;#x7CFB;&amp;#x7EDF;&amp;#x7AEF;&amp;#x53E3;&amp;#x586B;&amp;#x5199; &lt;code&gt;22&lt;/code&gt;&amp;#xFF0C;&amp;#x4E3B;&amp;#x673A;&amp;#x7AEF;&amp;#x53E3;&amp;#x586B;&amp;#x4E00;&amp;#x4E2A;&amp;#x5927;&amp;#x4E8E; &lt;code&gt;1000&lt;/code&gt; &amp;#x7684;&amp;#x503C;&amp;#xFF0C;&amp;#x56E0;&amp;#x4E3A;&amp;#x5728; OS X &amp;#x4E0B;&amp;#xFF0C;&amp;#x975E; &lt;code&gt;root&lt;/code&gt; &amp;#x7528;&amp;#x6237;&amp;#x7684;&amp;#x8FDB;&amp;#x7A0B;&amp;#x662F;&amp;#x65E0;&amp;#x6CD5;&amp;#x7ED1;&amp;#x5B9A; &lt;code&gt;1000&lt;/code&gt; &amp;#x4EE5;&amp;#x4E0B;&amp;#x7684;&amp;#x7AEF;&amp;#x53E3;&amp;#x7684;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x786E;&amp;#x5B9A;&amp;#x540E;&amp;#xFF0C;&amp;#x5728;&amp;#x4E3B;&amp;#x673A;&amp;#x7684; Terminal &amp;#x4E2D;&amp;#x5C1D;&amp;#x8BD5;&amp;#x8FDE;&amp;#x63A5;&amp;#x3002;&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;ssh -p5280 &lt;span class=&quot;number&quot;&gt;127.0&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;0.1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;&amp;#x5171;&amp;#x4EAB;&amp;#x6587;&amp;#x4EF6;&amp;#x5939;&quot;&gt;&amp;#x5171;&amp;#x4EAB;&amp;#x6587;&amp;#x4EF6;&amp;#x5939;&lt;/h2&gt;
&lt;p&gt;&amp;#x5728; Virtualbox &amp;#x7684;&amp;#x300C;&amp;#x8BBE;&amp;#x7F6E;&amp;#x300D;&amp;#x2192;&amp;#x300C;&amp;#x5171;&amp;#x4EAB;&amp;#x6587;&amp;#x4EF6;&amp;#x5939;&amp;#x300D;&amp;#x4E2D;&amp;#x8BBE;&amp;#x7F6E;&amp;#x5171;&amp;#x4EAB;&amp;#x6839;&amp;#x76EE;&amp;#x5F55;&amp;#x3002;&lt;/p&gt;
&lt;div class=&quot;figure&quot;&gt;
&lt;img src=&quot;//dn-menci.qbox.me/virtualbox-archlinux/share.png&quot; alt=&quot;&amp;#x5171;&amp;#x4EAB;&amp;#x6587;&amp;#x4EF6;&amp;#x5939;&quot;&gt;
&lt;p class=&quot;caption&quot;&gt;&amp;#x5171;&amp;#x4EAB;&amp;#x6587;&amp;#x4EF6;&amp;#x5939;&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;&amp;#x4E3A;&amp;#x4E86;&amp;#x89E3;&amp;#x51B3;&amp;#x6743;&amp;#x9650;&amp;#x95EE;&amp;#x9898;&amp;#xFF0C;&amp;#x4E0D;&amp;#x8981;&amp;#x9009;&amp;#x62E9;&amp;#x300C;&amp;#x81EA;&amp;#x52A8;&amp;#x6302;&amp;#x8F7D;&amp;#x300D;&amp;#xFF0C;&amp;#x800C;&amp;#x662F;&amp;#x624B;&amp;#x52A8;&amp;#x914D;&amp;#x7F6E;&amp;#x81EA;&amp;#x52A8;&amp;#x6302;&amp;#x8F7D;&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;rc.local-&amp;#x670D;&amp;#x52A1;&quot;&gt;&lt;code&gt;rc.local&lt;/code&gt; &amp;#x670D;&amp;#x52A1;&lt;/h3&gt;
&lt;p&gt;Archlinux &amp;#x7684; systemd &amp;#x539F;&amp;#x751F;&amp;#x4E0D;&amp;#x652F;&amp;#x6301;&amp;#x5F00;&amp;#x673A;&amp;#x81EA;&amp;#x52A8;&amp;#x6267;&amp;#x884C; &lt;code&gt;rc.local&lt;/code&gt; &amp;#x6587;&amp;#x4EF6;&amp;#xFF0C;&amp;#x6240;&amp;#x4EE5;&amp;#x6211;&amp;#x4EEC;&amp;#x9700;&amp;#x8981;&amp;#x5148;&amp;#x6DFB;&amp;#x52A0;&amp;#x4E00;&amp;#x4E2A;&amp;#x670D;&amp;#x52A1;&amp;#x3002;&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo nano /usr/lib/systemd/system/rc-local.service&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&amp;#x8F93;&amp;#x5165;&amp;#x4EE5;&amp;#x4E0B;&amp;#x5185;&amp;#x5BB9;&amp;#xFF1A;&lt;/p&gt;
&lt;figure class=&quot;highlight ini&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;[Unit]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;Description=&lt;span class=&quot;value&quot;&gt;&lt;span class=&quot;string&quot;&gt;&amp;quot;/etc/rc.local Compatibility&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;After=&lt;span class=&quot;value&quot;&gt;vboxadd.service vboxadd-service.service&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[Service]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;Type=&lt;span class=&quot;value&quot;&gt;forking&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;ExecStart=&lt;span class=&quot;value&quot;&gt;/etc/rc.local start&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;TimeoutSec=&lt;span class=&quot;value&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;StandardInput=&lt;span class=&quot;value&quot;&gt;tty&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;RemainAfterExit=&lt;span class=&quot;value&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;yes&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;SysVStartPriority=&lt;span class=&quot;value&quot;&gt;&lt;span class=&quot;number&quot;&gt;999&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[Install]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;WantedBy=&lt;span class=&quot;value&quot;&gt;multi-user.target&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&amp;#x4FDD;&amp;#x5B58;&amp;#x540E;&amp;#x542F;&amp;#x7528;&amp;#x670D;&amp;#x52A1;&amp;#xFF0C;&amp;#x5E76;&amp;#x521B;&amp;#x5EFA; &lt;code&gt;rc.local&lt;/code&gt; &amp;#x6587;&amp;#x4EF6;&amp;#xFF1A;&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo systemctl &lt;span class=&quot;built_in&quot;&gt;enable&lt;/span&gt; rc-local&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;&amp;#x81EA;&amp;#x52A8;&amp;#x6302;&amp;#x8F7D;&amp;#x811A;&amp;#x672C;&quot;&gt;&amp;#x81EA;&amp;#x52A8;&amp;#x6302;&amp;#x8F7D;&amp;#x811A;&amp;#x672C;&lt;/h3&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo touch /etc/rc.local&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sudo chmod +x /etc/rc.local&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sudo nano /etc/rc.local&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;shebang&quot;&gt;#!/bin/bash&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;/usr/bin/mount -t vboxsf Host /media/Host -o uid=&lt;span class=&quot;number&quot;&gt;1000&lt;/span&gt;,gid=&lt;span class=&quot;number&quot;&gt;1000&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;/usr/bin/mount --bind /media/Host/Users/Menci /home/Menci&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;exit&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&amp;#x91CD;&amp;#x542F;&amp;#x540E;&amp;#xFF0C;&amp;#x865A;&amp;#x62DF;&amp;#x673A;&amp;#x4E2D;&amp;#x7684;&amp;#x4E3B;&amp;#x76EE;&amp;#x5F55;&amp;#x5C31;&amp;#x548C;&amp;#x4E3B;&amp;#x673A;&amp;#x4E0A;&amp;#x7684;&amp;#x4E3B;&amp;#x76EE;&amp;#x5F55;&amp;#x5171;&amp;#x4EAB;&amp;#x5566;&amp;#x3002;&lt;/p&gt;
&lt;h2 id=&quot;ssh-&amp;#x514D;&amp;#x5BC6;&amp;#x7801;&amp;#x767B;&amp;#x5F55;&quot;&gt;SSH &amp;#x514D;&amp;#x5BC6;&amp;#x7801;&amp;#x767B;&amp;#x5F55;&lt;/h2&gt;
&lt;p&gt;&amp;#x8FDB;&amp;#x884C;&amp;#x5B8C;&amp;#x4EE5;&amp;#x4E0A;&amp;#x6B65;&amp;#x9AA4;&amp;#x540E;&amp;#xFF0C;&amp;#x5DF2;&amp;#x7ECF;&amp;#x53EF;&amp;#x4EE5;&amp;#x5728;&amp;#x4E3B;&amp;#x673A;&amp;#x901A;&amp;#x8FC7; SSH &amp;#x8FDE;&amp;#x63A5;&amp;#x5230;&amp;#x865A;&amp;#x62DF;&amp;#x673A;&amp;#x4E86;&amp;#xFF0C;&amp;#x4F46;&amp;#x9700;&amp;#x8981;&amp;#x8F93;&amp;#x5165;&amp;#x5BC6;&amp;#x7801;&amp;#x3002;&amp;#x6211;&amp;#x4EEC;&amp;#x53EF;&amp;#x4EE5;&amp;#x4F7F;&amp;#x7528;&amp;#x79C1;&amp;#x94A5;&amp;#x8BA4;&amp;#x8BC1;&amp;#x7684;&amp;#x65B9;&amp;#x5F0F;&amp;#x514D;&amp;#x53BB;&amp;#x8F93;&amp;#x5165;&amp;#x5BC6;&amp;#x7801;&amp;#x3002;&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;ssh-keygen -b &lt;span class=&quot;number&quot;&gt;1024&lt;/span&gt; -t rsa&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&amp;#x4E00;&amp;#x8DEF;&amp;#x56DE;&amp;#x8F66;&amp;#x540E;&amp;#xFF0C;&amp;#x4F1A;&amp;#x5728; &lt;code&gt;~/.ssh&lt;/code&gt; &amp;#x76EE;&amp;#x5F55;&amp;#x4E0B;&amp;#x751F;&amp;#x6210;&amp;#x79C1;&amp;#x94A5;&amp;#x548C;&amp;#x516C;&amp;#x94A5;&amp;#x3002;&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;cat ~/.ssh/id_rsa.pub &amp;gt;&amp;gt; ~/.ssh/authorized_keys&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&amp;#x56E0;&amp;#x4E3A;&amp;#x4E3B;&amp;#x673A;&amp;#x548C;&amp;#x865A;&amp;#x62DF;&amp;#x673A;&amp;#x7684;&amp;#x4E3B;&amp;#x76EE;&amp;#x5F55;&amp;#x662F;&amp;#x5171;&amp;#x4EAB;&amp;#x7684;&amp;#xFF0C;&amp;#x6240;&amp;#x4EE5;&amp;#x5728;&amp;#x4E3B;&amp;#x673A;&amp;#x91CC;&amp;#x8BBE;&amp;#x7F6E;&amp;#x540E;&amp;#xFF0C;&amp;#x865A;&amp;#x62DF;&amp;#x673A;&amp;#x91CC;&amp;#x4E5F;&amp;#x4F1A;&amp;#x751F;&amp;#x6548;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x73B0;&amp;#x5728;&amp;#x8BD5;&amp;#x8BD5; SSH &amp;#x8FDE;&amp;#x63A5;&amp;#x5230;&amp;#x865A;&amp;#x62DF;&amp;#x673A;&amp;#xFF0C;&amp;#x5E94;&amp;#x8BE5;&amp;#x4E0D;&amp;#x9700;&amp;#x8981;&amp;#x5BC6;&amp;#x7801;&amp;#x4E86;&amp;#x3002;&lt;/p&gt;
&lt;h2 id=&quot;&amp;#x914D;&amp;#x7F6E;-terminal-&amp;#x5FEB;&amp;#x6377;&amp;#x952E;&quot;&gt;&amp;#x914D;&amp;#x7F6E; Terminal &amp;#x5FEB;&amp;#x6377;&amp;#x952E;&lt;/h2&gt;
&lt;p&gt;&amp;#x4F17;&amp;#x6240;&amp;#x5468;&amp;#x77E5;&amp;#xFF0C;Terminal &amp;#x4E2D;&amp;#x4EE5;&amp;#x9ED8;&amp;#x8BA4;&amp;#x8BBE;&amp;#x7F6E;&amp;#x6253;&amp;#x5F00;&amp;#x65B0;&amp;#x7A97;&amp;#x53E3;&amp;#x7684;&amp;#x5FEB;&amp;#x6377;&amp;#x952E;&amp;#x662F; &lt;code&gt;Command + N&lt;/code&gt;&amp;#x3002;&amp;#x6211;&amp;#x4EEC;&amp;#x4E5F;&amp;#x53EF;&amp;#x4EE5;&amp;#x8BBE;&amp;#x7F6E;&amp;#x6253;&amp;#x5F00;&amp;#x65B0;&amp;#x7A97;&amp;#x53E3;&amp;#x5E76; SSH &amp;#x8FDE;&amp;#x63A5;&amp;#x5230;&amp;#x865A;&amp;#x62DF;&amp;#x673A;&amp;#x7684;&amp;#x5FEB;&amp;#x6377;&amp;#x952E;&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x6DFB;&amp;#x52A0;&amp;#x63CF;&amp;#x8FF0;&amp;#x6587;&amp;#x4EF6;&quot;&gt;&amp;#x6DFB;&amp;#x52A0;&amp;#x63CF;&amp;#x8FF0;&amp;#x6587;&amp;#x4EF6;&lt;/h3&gt;
&lt;p&gt;&amp;#x5728; Terminal &amp;#x7684;&amp;#x504F;&amp;#x597D;&amp;#x8BBE;&amp;#x7F6E;&amp;#x4E2D;&amp;#xFF0C;&amp;#x9009;&amp;#x62E9;&amp;#x300C;&amp;#x63CF;&amp;#x8FF0;&amp;#x6587;&amp;#x4EF6;&amp;#x300D;&amp;#xFF0C;&amp;#x628A;&amp;#x300C;Basic&amp;#x300D;&amp;#x914D;&amp;#x7F6E;&amp;#x590D;&amp;#x5236;&amp;#x4E00;&amp;#x4EFD;&amp;#xFF0C;&amp;#x547D;&amp;#x540D;&amp;#x4E3A;&amp;#x300C;Basic Linux&amp;#x300D;&amp;#xFF0C;&amp;#x5E76;&amp;#x5728; &lt;code&gt;Shell&lt;/code&gt; &amp;#x4E00;&amp;#x680F;&amp;#x4E2D;&amp;#x586B;&amp;#x5199;&amp;#x300C;&amp;#x8FD0;&amp;#x884C;&amp;#x547D;&amp;#x4EE4;&amp;#x300D;&amp;#x4E3A; SSH&amp;#xFF0C;&amp;#x4E0D;&amp;#x52FE;&amp;#x9009;&amp;#x4E0B;&amp;#x65B9;&amp;#x7684;&amp;#x300C;&amp;#x5728; Shell &amp;#x4E2D;&amp;#x8FD0;&amp;#x884C;&amp;#x300D;&amp;#x3002;&lt;/p&gt;
&lt;div class=&quot;figure&quot;&gt;
&lt;img src=&quot;//dn-menci.qbox.me/virtualbox-archlinux/terminal.png&quot; alt=&quot;&amp;#x5171;&amp;#x4EAB;&amp;#x6587;&amp;#x4EF6;&amp;#x5939;&quot;&gt;
&lt;p class=&quot;caption&quot;&gt;&amp;#x5171;&amp;#x4EAB;&amp;#x6587;&amp;#x4EF6;&amp;#x5939;&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;&amp;#x8FD9;&amp;#x6837;&amp;#x5C31;&amp;#x5DF2;&amp;#x7ECF;&amp;#x53EF;&amp;#x4EE5;&amp;#x5728;&amp;#x83DC;&amp;#x5355;&amp;#x4E2D;&amp;#x6253;&amp;#x5F00;&amp;#x8FDE;&amp;#x63A5;&amp;#x865A;&amp;#x62DF;&amp;#x673A;&amp;#x7684;&amp;#x65B0;&amp;#x7A97;&amp;#x53E3;&amp;#x4E86;&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x6DFB;&amp;#x52A0;&amp;#x5FEB;&amp;#x6377;&amp;#x952E;&quot;&gt;&amp;#x6DFB;&amp;#x52A0;&amp;#x5FEB;&amp;#x6377;&amp;#x952E;&lt;/h3&gt;
&lt;p&gt;&amp;#x5728;&amp;#x7CFB;&amp;#x7EDF;&amp;#x504F;&amp;#x597D;&amp;#x8BBE;&amp;#x7F6E;&amp;#x4E2D;&amp;#x6DFB;&amp;#x52A0;&amp;#x5FEB;&amp;#x6377;&amp;#x952E;&amp;#xFF1A;&lt;/p&gt;
&lt;p&gt;&amp;#x300C;&amp;#x7CFB;&amp;#x7EDF;&amp;#x504F;&amp;#x597D;&amp;#x8BBE;&amp;#x7F6E;&amp;#x300D;&amp;#x2192;&amp;#x300C;&amp;#x952E;&amp;#x76D8;&amp;#x300D;&amp;#x2192;&amp;#x300C;&amp;#x5FEB;&amp;#x6377;&amp;#x952E;&amp;#x300D;&amp;#x2192;&amp;#x300C;&amp;#x5E94;&amp;#x7528;&amp;#x7A0B;&amp;#x5E8F;&amp;#x5FEB;&amp;#x6377;&amp;#x952E;&amp;#x300D;&amp;#x2192;&amp;#x300C;&amp;#x6DFB;&amp;#x52A0;&amp;#x300D;&lt;/p&gt;
&lt;div class=&quot;figure&quot;&gt;
&lt;img src=&quot;//dn-menci.qbox.me/virtualbox-archlinux/hotkey.png&quot; alt=&quot;&amp;#x5171;&amp;#x4EAB;&amp;#x6587;&amp;#x4EF6;&amp;#x5939;&quot;&gt;
&lt;p class=&quot;caption&quot;&gt;&amp;#x5171;&amp;#x4EAB;&amp;#x6587;&amp;#x4EF6;&amp;#x5939;&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;&amp;#x70B9;&amp;#x51FB;&amp;#x300C;&amp;#x6DFB;&amp;#x52A0;&amp;#x300D;&amp;#x540E;&amp;#xFF0C;&amp;#x5C31;&amp;#x53EF;&amp;#x4EE5;&amp;#x4F7F;&amp;#x7528;&amp;#x5FEB;&amp;#x6377;&amp;#x952E;&amp;#x5566;&amp;#xFF01;&lt;/p&gt;
&lt;h2 id=&quot;&amp;#x6210;&amp;#x679C;&quot;&gt;&amp;#x6210;&amp;#x679C;&lt;/h2&gt;
&lt;p&gt;&amp;#x5728; Terminal &amp;#x4E2D;&amp;#xFF0C;&amp;#x6309;&amp;#x4E0B; &lt;code&gt;Command + B&lt;/code&gt;&amp;#xFF1A;&lt;/p&gt;
&lt;div class=&quot;figure&quot;&gt;
&lt;img src=&quot;//dn-menci.qbox.me/virtualbox-archlinux/screenfetch.png&quot; alt=&quot;&amp;#x5171;&amp;#x4EAB;&amp;#x6587;&amp;#x4EF6;&amp;#x5939;&quot;&gt;
&lt;p class=&quot;caption&quot;&gt;&amp;#x5171;&amp;#x4EAB;&amp;#x6587;&amp;#x4EF6;&amp;#x5939;&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;&amp;#x4E3A;&amp;#x4E86;&amp;#x6BD4;&amp;#x8F83;&amp;#x597D;&amp;#x7684;&amp;#x6548;&amp;#x679C;&amp;#xFF0C;&amp;#x53EF;&amp;#x4EE5;&amp;#x6539;&amp;#x4E00;&amp;#x4E0B; &lt;code&gt;screenfetch&lt;/code&gt;&amp;#x3002;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;OS X &amp;#x4E2D;&amp;#x6709;&amp;#x5F88;&amp;#x591A;&amp;#x4E0E; GNU/Linux &amp;#x76F8;&amp;#x4F3C;&amp;#x7684;&amp;#x5730;&amp;#x65B9;&amp;#xFF0C;&amp;#x4F46;&amp;#x4E5F;&amp;#x6709;&amp;#x5F88;&amp;#x5927;&amp;#x7684;&amp;#x5DEE;&amp;#x5F02;&amp;#xFF0C;&amp;#x5F88;&amp;#x591A;&amp;#x65F6;&amp;#x5019; GNU/Linux &amp;#x7CFB;&amp;#x7EDF;&amp;#x6BD4; OS X &amp;#x597D;&amp;#x7528;&amp;#x4E00;&amp;#x4E9B;&amp;#xFF0C;&amp;#x800C; OS X &amp;#x7684;&amp;#x56FE;&amp;#x5F62;&amp;#x754C;&amp;#x9762;&amp;#x6BD4; GNU/Linux &amp;#x4E0D;&amp;#x77E5;&amp;#x8981;&amp;#x9AD8;&amp;#x5230;&amp;#x54EA;&amp;#x91CC;&amp;#x53BB;&amp;#x4E86; &amp;#x2026;&amp;#x2026; &amp;#x4E8C;&amp;#x8005;&amp;#x517C;&amp;#x5F97;&amp;#x7684;&amp;#x65B9;&amp;#x6CD5;&amp;#xFF0C;&amp;#x5C31;&amp;#x662F;&amp;#x4F7F;&amp;#x7528;&amp;#x865A;&amp;#x62DF;&amp;#x673A;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x4E0B;&amp;#x9762;&amp;#x4EE5;&amp;#x6700;&amp;#x597D;&amp;#x7528;&amp;#x7684;&amp;#x865A;&amp;#x62DF;&amp;#x673A;&amp;#x8F6F;&amp;#x4EF6; &lt;code&gt;VirtualBox&lt;/code&gt; &amp;#x4E3A;&amp;#x4F8B;&amp;#xFF0C;&amp;#x6F14;&amp;#x793A;&amp;#x914D;&amp;#x7F6E; Archlinux &amp;#x865A;&amp;#x62DF;&amp;#x673A;&amp;#x4E0E; OS X &amp;#x4E3B;&amp;#x673A;&amp;#x65E0;&amp;#x7F1D;&amp;#x6574;&amp;#x5408;&amp;#x7684;&amp;#x6B65;&amp;#x9AA4;&amp;#x3002;&lt;/p&gt;
    
    </summary>
    
      <category term="Geek" scheme="https://blog.menci.moe/categories/geek/"/>
    
    
      <category term="Archlinux" scheme="https://blog.menci.moe/tag/archlinux/"/>
    
      <category term="Linux" scheme="https://blog.menci.moe/tag/linux/"/>
    
      <category term="OS X" scheme="https://blog.menci.moe/tag/os-x/"/>
    
      <category term="SSH" scheme="https://blog.menci.moe/tag/ssh/"/>
    
      <category term="VirtualBox" scheme="https://blog.menci.moe/tag/virtualbox/"/>
    
      <category term="虚拟机" scheme="https://blog.menci.moe/tag/%E8%99%9A%E6%8B%9F%E6%9C%BA/"/>
    
  </entry>
  
  <entry>
    <title>「NOI2003」文本编辑器 - Splay</title>
    <link href="https://blog.menci.moe/noi2003-editor/"/>
    <id>https://blog.menci.moe/noi2003-editor/</id>
    <published>2016-03-06T11:49:35.000Z</published>
    <updated>2016-03-06T11:51:21.000Z</updated>
    
    <content type="html">&lt;table style=&quot;width:68%;&quot;&gt;
&lt;colgroup&gt;
&lt;col width=&quot;34%&quot;&gt;
&lt;col width=&quot;26%&quot;&gt;
&lt;col width=&quot;6%&quot;&gt;
&lt;/colgroup&gt;
&lt;thead&gt;
&lt;tr class=&quot;header&quot;&gt;
&lt;th align=&quot;center&quot;&gt;&amp;#x64CD;&amp;#x4F5C;&amp;#x540D;&amp;#x79F0;&lt;/th&gt;
&lt;th align=&quot;center&quot;&gt;&amp;#x8F93;&amp;#x5165;&amp;#x6587;&amp;#x4EF6;&amp;#x4E2D;&amp;#x7684;&amp;#x683C;&amp;#x5F0F;&lt;/th&gt;
&lt;th align=&quot;left&quot;&gt;&amp;#x529F;&amp;#x80FD;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&quot;odd&quot;&gt;
&lt;td align=&quot;center&quot;&gt;$ {\rm MOVE}(k) $&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;&lt;code&gt;Move k&lt;/code&gt;&lt;/td&gt;
&lt;td align=&quot;left&quot;&gt;&amp;#x5C06;&amp;#x5149;&amp;#x6807;&amp;#x79FB;&amp;#x52A8;&amp;#x5230;&amp;#x7B2C; $ k $ &amp;#x4E2A;&amp;#x5B57;&amp;#x7B26;&amp;#x4E4B;&amp;#x540E;&amp;#xFF0C;&amp;#x5982;&amp;#x679C; $ k=0 $&amp;#xFF0C;&amp;#x5C06;&amp;#x5149;&amp;#x6807;&amp;#x79FB;&amp;#x5230;&amp;#x6587;&amp;#x672C;&amp;#x7B2C;&amp;#x4E00;&amp;#x4E2A;&amp;#x5B57;&amp;#x7B26;&amp;#x4E4B;&amp;#x524D;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&quot;even&quot;&gt;
&lt;td align=&quot;center&quot;&gt;$ {\rm INSERT}(n, s) $&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;&lt;code&gt;Insert n S&lt;/code&gt;&lt;/td&gt;
&lt;td align=&quot;left&quot;&gt;&amp;#x5728;&amp;#x5149;&amp;#x6807;&amp;#x540E;&amp;#x63D2;&amp;#x5165;&amp;#x957F;&amp;#x5EA6;&amp;#x4E3A; $ n $ &amp;#x7684;&amp;#x5B57;&amp;#x7B26;&amp;#x4E32; $ s $&amp;#xFF0C;&amp;#x5149;&amp;#x6807;&amp;#x4F4D;&amp;#x7F6E;&amp;#x4E0D;&amp;#x53D8;&amp;#xFF0C;$ n &amp;#x2265; 1 $&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&quot;odd&quot;&gt;
&lt;td align=&quot;center&quot;&gt;$ {\rm DELETE}(n) $&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;&lt;code&gt;Delete n&lt;/code&gt;&lt;/td&gt;
&lt;td align=&quot;left&quot;&gt;&amp;#x5220;&amp;#x9664;&amp;#x5149;&amp;#x6807;&amp;#x540E;&amp;#x7684; $ n $ &amp;#x4E2A;&amp;#x5B57;&amp;#x7B26;&amp;#xFF0C;&amp;#x5149;&amp;#x6807;&amp;#x4F4D;&amp;#x7F6E;&amp;#x4E0D;&amp;#x53D8;&amp;#xFF0C;$ n &amp;#x2265; 1 $&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&quot;even&quot;&gt;
&lt;td align=&quot;center&quot;&gt;$ {\rm GET}(n) $&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;&lt;code&gt;Get n&lt;/code&gt;&lt;/td&gt;
&lt;td align=&quot;left&quot;&gt;&amp;#x8F93;&amp;#x51FA;&amp;#x5149;&amp;#x6807;&amp;#x540E;&amp;#x7684; $ n $ &amp;#x4E2A;&amp;#x5B57;&amp;#x7B26;&amp;#xFF0C;&amp;#x5149;&amp;#x6807;&amp;#x4F4D;&amp;#x7F6E;&amp;#x4E0D;&amp;#x53D8;&amp;#xFF0C;$ n &amp;#x2265; 1 $&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&quot;odd&quot;&gt;
&lt;td align=&quot;center&quot;&gt;$ {\rm PREV}() $&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;&lt;code&gt;Prev&lt;/code&gt;&lt;/td&gt;
&lt;td align=&quot;left&quot;&gt;&amp;#x5149;&amp;#x6807;&amp;#x524D;&amp;#x79FB;&amp;#x4E00;&amp;#x4E2A;&amp;#x5B57;&amp;#x7B26;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&quot;even&quot;&gt;
&lt;td align=&quot;center&quot;&gt;$ {\rm NEXT}() $&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;&lt;code&gt;Next&lt;/code&gt;&lt;/td&gt;
&lt;td align=&quot;left&quot;&gt;&amp;#x5149;&amp;#x6807;&amp;#x540E;&amp;#x79FB;&amp;#x4E00;&amp;#x4E2A;&amp;#x5B57;&amp;#x7B26;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;&amp;#x9898;&amp;#x76EE;&amp;#x94FE;&amp;#x63A5;&quot;&gt;&amp;#x9898;&amp;#x76EE;&amp;#x94FE;&amp;#x63A5;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://www.lydsy.com/JudgeOnline/problem.php?id=1507&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;BZOJ 1507&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x89E3;&amp;#x9898;&amp;#x601D;&amp;#x8DEF;&quot;&gt;&amp;#x89E3;&amp;#x9898;&amp;#x601D;&amp;#x8DEF;&lt;/h3&gt;
&lt;p&gt;&amp;#x5757;&amp;#x72B6;&amp;#x94FE;&amp;#x8868;&amp;#x592A;&amp;#x9B3C;&amp;#x755C;&amp;#x8FA3;&amp;#xFF01;&amp;#x8FD8;&amp;#x662F; Splay &amp;#x6BD4;&amp;#x8F83;&amp;#x597D;&amp;#x5199;&amp;#x597D;&amp;#x8C03;w&lt;/p&gt;
&lt;p&gt;&amp;#x4E00;&amp;#x70B9;&amp;#x5C0F;&amp;#x6280;&amp;#x5DE7;&amp;#xFF0C;&amp;#x63D2;&amp;#x5165;&amp;#x7684;&amp;#x65F6;&amp;#x5019;&amp;#x53EF;&amp;#x4EE5;&amp;#x7167;&amp;#x7740;&amp;#x9009;&amp;#x62E9;&amp;#x533A;&amp;#x95F4;&amp;#x7684;&amp;#x65B9;&amp;#x6CD5;&amp;#x9009;&amp;#x51FA;&amp;#x4E00;&amp;#x6BB5;&amp;#x7A7A;&amp;#x767D;&amp;#x533A;&amp;#x95F4;&amp;#xFF0C;&amp;#x7136;&amp;#x540E; &lt;code&gt;build&lt;/code&gt; &amp;#x51FA;&amp;#x4E00;&amp;#x68F5;&amp;#x5B50;&amp;#x6811;&amp;#x7ED9;&amp;#x63A5;&amp;#x4E0A;&amp;#x53BB;&amp;#xFF0C;&amp;#x53EF;&amp;#x4EE5;&amp;#x5C11;&amp;#x4E00;&amp;#x4E2A; $ \log $&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;ac&amp;#x4EE3;&amp;#x7801;&quot;&gt;AC&amp;#x4EE3;&amp;#x7801;&lt;/h3&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;93&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;94&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;95&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;96&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;97&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;98&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;99&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;100&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;101&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;102&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;103&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;104&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;105&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;106&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;107&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;108&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;109&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;110&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;111&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;112&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;113&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;114&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;115&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;116&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;117&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;118&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;119&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;120&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;121&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;122&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;123&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;124&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;125&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;126&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;127&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;128&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;129&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;130&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;131&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;132&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;133&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;134&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;135&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;136&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;137&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;138&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;139&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;140&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;141&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;142&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;143&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;144&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;145&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;146&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;147&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;148&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;149&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;150&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;151&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;152&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;153&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;154&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;155&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;156&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;157&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;158&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;159&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;160&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;161&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;162&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;163&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;164&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;165&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;166&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;167&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;168&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;169&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;170&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;171&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;172&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;173&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;174&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;175&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;176&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;177&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;178&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;179&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;180&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;181&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;182&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;183&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;184&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;185&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;186&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;187&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;188&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;189&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;190&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;191&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;192&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;193&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;194&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;195&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;196&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;197&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;198&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;199&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;200&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;201&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;202&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;203&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;204&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;205&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;206&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;207&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;208&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;209&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;210&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;211&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;212&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;213&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;vector&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;algorithm&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXM = &lt;span class=&quot;number&quot;&gt;50000&lt;/span&gt; + &lt;span class=&quot;number&quot;&gt;4000&lt;/span&gt; + &lt;span class=&quot;number&quot;&gt;200000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;template&lt;/span&gt; &amp;lt;&lt;span class=&quot;keyword&quot;&gt;typename&lt;/span&gt; T&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Splay {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;enum&lt;/span&gt; Relation {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		L = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, R = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	};&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Node {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		Node *child[&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;], *parent, **root;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		T value;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; size;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; bound;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		Node(Node *parent, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; T &amp;amp;value, Node **root, &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; bound = &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;) : parent(parent), value(value), root(root), size(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;), bound(bound) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			child[L] = child[R] = &lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		~Node() {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (child[L]) &lt;span class=&quot;keyword&quot;&gt;delete&lt;/span&gt; child[L];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (child[R]) &lt;span class=&quot;keyword&quot;&gt;delete&lt;/span&gt; child[R];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;function&quot;&gt;Relation &lt;span class=&quot;title&quot;&gt;relation&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt; == parent-&amp;gt;child[L] ? L : R;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;maintain&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;comment&quot;&gt;//if (child[L]) child[L]-&amp;gt;maintain();&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;comment&quot;&gt;//if (child[R]) child[R]-&amp;gt;maintain();&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			size = (child[L] ? child[L]-&amp;gt;size : &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) + (child[R] ? child[R]-&amp;gt;size : &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;rotate&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			Relation x = relation();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			Node *oldParent = parent;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (oldParent-&amp;gt;parent) oldParent-&amp;gt;parent-&amp;gt;child[oldParent-&amp;gt;relation()] = &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			parent = oldParent-&amp;gt;parent;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			oldParent-&amp;gt;child[x] = child[x ^ &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (child[x ^ &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]) child[x ^ &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]-&amp;gt;parent = oldParent;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			child[x ^ &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;] = oldParent;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			oldParent-&amp;gt;parent = &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			oldParent-&amp;gt;maintain(), maintain();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!parent) *root = &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;splay&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Node *targetParent = &lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (parent != targetParent){&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (parent-&amp;gt;parent == targetParent) rotate();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (parent-&amp;gt;relation() == relation()) parent-&amp;gt;rotate(), rotate();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; rotate(), rotate();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;function&quot;&gt;Node *&lt;span class=&quot;title&quot;&gt;pred&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			splay();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			Node *v = child[L];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (v-&amp;gt;child[R]) v = v-&amp;gt;child[R];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; v;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;function&quot;&gt;Node *&lt;span class=&quot;title&quot;&gt;succ&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			splay();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			Node *v = child[R];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (v-&amp;gt;child[L]) v = v-&amp;gt;child[L];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; v;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;rank&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; child[L] ? child[L]-&amp;gt;size : &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	} *root;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Splay() : root(&lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		buildBound(L), buildBound(R);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	~Splay() {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (root) &lt;span class=&quot;keyword&quot;&gt;delete&lt;/span&gt; root;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;buildBound&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Relation x)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		Node **v = &amp;amp;root, *parent = &lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (*v) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			parent = *v;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			parent-&amp;gt;size++;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			v = &amp;amp;parent-&amp;gt;child[x];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		*v = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Node(parent, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &amp;amp;root, &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;function&quot;&gt;Node *&lt;span class=&quot;title&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; T *a, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; l, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; r, Node *parent = &lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (l &amp;gt; r) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; mid = l + ((r - l) &amp;gt;&amp;gt; &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		Node *v = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Node(parent, a[mid - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;], &amp;amp;root);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		v-&amp;gt;child[L] = build(a, l, mid - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, v);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		v-&amp;gt;child[R] = build(a, mid + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, r, v);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		v-&amp;gt;maintain();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; v;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;function&quot;&gt;Node *&lt;span class=&quot;title&quot;&gt;select&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; k)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		k++;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;comment&quot;&gt;//printf(&amp;quot;select(%d) in size = %d\n&amp;quot;, k, root-&amp;gt;size);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		Node *v = root;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (v-&amp;gt;maintain(), k != v-&amp;gt;rank() + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (k &amp;lt; v-&amp;gt;rank() + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) v = v-&amp;gt;child[L];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; k -= v-&amp;gt;rank() + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, v = v-&amp;gt;child[R];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; v;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;function&quot;&gt;Node *&amp;amp;&lt;span class=&quot;title&quot;&gt;select&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; l, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; r)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		Node *lbound = select(l - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		Node *rbound = select(r + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		lbound-&amp;gt;splay();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		rbound-&amp;gt;splay(lbound);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; rbound-&amp;gt;child[L];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;insert&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; T *a, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; pos)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		Node *&amp;amp;v = select(pos + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, pos);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		v = build(a, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, n, root-&amp;gt;child[R]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		root-&amp;gt;child[R]-&amp;gt;maintain(), root-&amp;gt;maintain();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;erase&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; l, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; r)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		Node *&amp;amp;v = select(l, r);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;delete&lt;/span&gt; v;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		v = &lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		root-&amp;gt;child[R]-&amp;gt;maintain(), root-&amp;gt;maintain();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;fetch&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(T *a, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; l, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; r)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		dfs(select(l, r), a, i);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;dfs&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Node *v, T *a, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &amp;amp;i)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!v) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		dfs(v-&amp;gt;child[L], a, i);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		a[i++] = v-&amp;gt;value;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		dfs(v-&amp;gt;child[R], a, i);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;};&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; t, pos;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Splay&amp;lt;&lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt;&amp;gt; splay;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;isValid&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt; ch)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; ch &amp;gt;= &lt;span class=&quot;number&quot;&gt;32&lt;/span&gt; &amp;amp;&amp;amp; ch &amp;lt;= &lt;span class=&quot;number&quot;&gt;126&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;t);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;vector&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt;&amp;gt; buffers;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; t; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt; command[&lt;span class=&quot;keyword&quot;&gt;sizeof&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;Insert&amp;quot;&lt;/span&gt;)];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%s&amp;quot;&lt;/span&gt;, command);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (command[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;] == &lt;span class=&quot;string&quot;&gt;&amp;apos;M&amp;apos;&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;pos);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		} &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (command[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;] == &lt;span class=&quot;string&quot;&gt;&amp;apos;I&amp;apos;&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;n);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			buffers.clear();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			buffers.reserve(n);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt; ch;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; ) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (isValid(ch = getchar())) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					buffers.push_back(ch);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					i++;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			splay.insert(buffers.data(), n, pos);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		} &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (command[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;] == &lt;span class=&quot;string&quot;&gt;&amp;apos;D&amp;apos;&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;n);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			splay.erase(pos + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, pos + n);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		} &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (command[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;] == &lt;span class=&quot;string&quot;&gt;&amp;apos;G&amp;apos;&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;n);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			buffers.clear();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			buffers.resize(n + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			splay.fetch(&lt;span class=&quot;keyword&quot;&gt;const_cast&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt; *&amp;gt;(buffers.data()), pos + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, pos + n);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			buffers[n] = &lt;span class=&quot;string&quot;&gt;&amp;apos;\0&amp;apos;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%s\n&amp;quot;&lt;/span&gt;, buffers.data());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		} &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (command[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;] == &lt;span class=&quot;string&quot;&gt;&amp;apos;P&amp;apos;&lt;/span&gt;) pos--;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (command[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;] == &lt;span class=&quot;string&quot;&gt;&amp;apos;N&amp;apos;&lt;/span&gt;) pos++;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;table style=&quot;width:68%;&quot;&gt;
&lt;colgroup&gt;
&lt;col width=&quot;34%&quot;&gt;
&lt;col width=&quot;26%&quot;&gt;
&lt;col width=&quot;6%&quot;&gt;
&lt;/colgroup&gt;
&lt;thead&gt;
&lt;tr class=&quot;header&quot;&gt;
&lt;th align=&quot;center&quot;&gt;&amp;#x64CD;&amp;#x4F5C;&amp;#x540D;&amp;#x79F0;&lt;/th&gt;
&lt;th align=&quot;center&quot;&gt;&amp;#x8F93;&amp;#x5165;&amp;#x6587;&amp;#x4EF6;&amp;#x4E2D;&amp;#x7684;&amp;#x683C;&amp;#x5F0F;&lt;/th&gt;
&lt;th align=&quot;left&quot;&gt;&amp;#x529F;&amp;#x80FD;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&quot;odd&quot;&gt;
&lt;td align=&quot;center&quot;&gt;$ {\rm MOVE}(k) $&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;&lt;code&gt;Move k&lt;/code&gt;&lt;/td&gt;
&lt;td align=&quot;left&quot;&gt;&amp;#x5C06;&amp;#x5149;&amp;#x6807;&amp;#x79FB;&amp;#x52A8;&amp;#x5230;&amp;#x7B2C; $ k $ &amp;#x4E2A;&amp;#x5B57;&amp;#x7B26;&amp;#x4E4B;&amp;#x540E;&amp;#xFF0C;&amp;#x5982;&amp;#x679C; $ k=0 $&amp;#xFF0C;&amp;#x5C06;&amp;#x5149;&amp;#x6807;&amp;#x79FB;&amp;#x5230;&amp;#x6587;&amp;#x672C;&amp;#x7B2C;&amp;#x4E00;&amp;#x4E2A;&amp;#x5B57;&amp;#x7B26;&amp;#x4E4B;&amp;#x524D;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&quot;even&quot;&gt;
&lt;td align=&quot;center&quot;&gt;$ {\rm INSERT}(n, s) $&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;&lt;code&gt;Insert n S&lt;/code&gt;&lt;/td&gt;
&lt;td align=&quot;left&quot;&gt;&amp;#x5728;&amp;#x5149;&amp;#x6807;&amp;#x540E;&amp;#x63D2;&amp;#x5165;&amp;#x957F;&amp;#x5EA6;&amp;#x4E3A; $ n $ &amp;#x7684;&amp;#x5B57;&amp;#x7B26;&amp;#x4E32; $ s $&amp;#xFF0C;&amp;#x5149;&amp;#x6807;&amp;#x4F4D;&amp;#x7F6E;&amp;#x4E0D;&amp;#x53D8;&amp;#xFF0C;$ n &amp;#x2265; 1 $&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&quot;odd&quot;&gt;
&lt;td align=&quot;center&quot;&gt;$ {\rm DELETE}(n) $&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;&lt;code&gt;Delete n&lt;/code&gt;&lt;/td&gt;
&lt;td align=&quot;left&quot;&gt;&amp;#x5220;&amp;#x9664;&amp;#x5149;&amp;#x6807;&amp;#x540E;&amp;#x7684; $ n $ &amp;#x4E2A;&amp;#x5B57;&amp;#x7B26;&amp;#xFF0C;&amp;#x5149;&amp;#x6807;&amp;#x4F4D;&amp;#x7F6E;&amp;#x4E0D;&amp;#x53D8;&amp;#xFF0C;$ n &amp;#x2265; 1 $&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&quot;even&quot;&gt;
&lt;td align=&quot;center&quot;&gt;$ {\rm GET}(n) $&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;&lt;code&gt;Get n&lt;/code&gt;&lt;/td&gt;
&lt;td align=&quot;left&quot;&gt;&amp;#x8F93;&amp;#x51FA;&amp;#x5149;&amp;#x6807;&amp;#x540E;&amp;#x7684; $ n $ &amp;#x4E2A;&amp;#x5B57;&amp;#x7B26;&amp;#xFF0C;&amp;#x5149;&amp;#x6807;&amp;#x4F4D;&amp;#x7F6E;&amp;#x4E0D;&amp;#x53D8;&amp;#xFF0C;$ n &amp;#x2265; 1 $&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&quot;odd&quot;&gt;
&lt;td align=&quot;center&quot;&gt;$ {\rm PREV}() $&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;&lt;code&gt;Prev&lt;/code&gt;&lt;/td&gt;
&lt;td align=&quot;left&quot;&gt;&amp;#x5149;&amp;#x6807;&amp;#x524D;&amp;#x79FB;&amp;#x4E00;&amp;#x4E2A;&amp;#x5B57;&amp;#x7B26;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&quot;even&quot;&gt;
&lt;td align=&quot;center&quot;&gt;$ {\rm NEXT}() $&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;&lt;code&gt;Next&lt;/code&gt;&lt;/td&gt;
&lt;td align=&quot;left&quot;&gt;&amp;#x5149;&amp;#x6807;&amp;#x540E;&amp;#x79FB;&amp;#x4E00;&amp;#x4E2A;&amp;#x5B57;&amp;#x7B26;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="BZOJ" scheme="https://blog.menci.moe/tag/bzoj/"/>
    
      <category term="NOI" scheme="https://blog.menci.moe/tag/noi/"/>
    
      <category term="Splay" scheme="https://blog.menci.moe/tag/splay/"/>
    
      <category term="数据结构" scheme="https://blog.menci.moe/tag/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
      <category term="高级数据结构" scheme="https://blog.menci.moe/tag/%E9%AB%98%E7%BA%A7%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
  </entry>
  
  <entry>
    <title>「SCOI2011」糖果 - 强联通分量 + 拓扑排序</title>
    <link href="https://blog.menci.moe/scoi2011-candy/"/>
    <id>https://blog.menci.moe/scoi2011-candy/</id>
    <published>2016-03-04T13:32:23.000Z</published>
    <updated>2016-03-04T13:54:25.000Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x5E7C;&amp;#x513F;&amp;#x56ED;&amp;#x91CC;&amp;#x6709; $ N $ &amp;#x4E2A;&amp;#x5C0F;&amp;#x670B;&amp;#x53CB;&amp;#xFF0C;&amp;#x8001;&amp;#x5E08;&amp;#x73B0;&amp;#x5728;&amp;#x60F3;&amp;#x8981;&amp;#x7ED9;&amp;#x8FD9;&amp;#x4E9B;&amp;#x5C0F;&amp;#x670B;&amp;#x53CB;&amp;#x4EEC;&amp;#x5206;&amp;#x914D;&amp;#x7CD6;&amp;#x679C;&amp;#xFF0C;&amp;#x8981;&amp;#x6C42;&amp;#x6BCF;&amp;#x4E2A;&amp;#x5C0F;&amp;#x670B;&amp;#x53CB;&amp;#x90FD;&amp;#x8981;&amp;#x5206;&amp;#x5230;&amp;#x7CD6;&amp;#x679C;&amp;#x3002;&amp;#x5728;&amp;#x5206;&amp;#x914D;&amp;#x7CD6;&amp;#x679C;&amp;#x7684;&amp;#x65F6;&amp;#x5019;&amp;#xFF0C;&amp;#x9700;&amp;#x8981;&amp;#x6EE1;&amp;#x8DB3;&amp;#x5C0F;&amp;#x670B;&amp;#x53CB;&amp;#x4EEC;&amp;#x7684; $ K $ &amp;#x4E2A;&amp;#x8981;&amp;#x6C42;&amp;#x3002;&amp;#x5E7C;&amp;#x513F;&amp;#x56ED;&amp;#x7684;&amp;#x7CD6;&amp;#x679C;&amp;#x603B;&amp;#x662F;&amp;#x6709;&amp;#x9650;&amp;#x7684;&amp;#xFF0C;&amp;#x60F3;&amp;#x77E5;&amp;#x9053;&amp;#x4ED6;&amp;#x81F3;&amp;#x5C11;&amp;#x9700;&amp;#x8981;&amp;#x51C6;&amp;#x5907;&amp;#x591A;&amp;#x5C11;&amp;#x4E2A;&amp;#x7CD6;&amp;#x679C;&amp;#xFF0C;&amp;#x624D;&amp;#x80FD;&amp;#x4F7F;&amp;#x5F97;&amp;#x6BCF;&amp;#x4E2A;&amp;#x5C0F;&amp;#x670B;&amp;#x53CB;&amp;#x90FD;&amp;#x80FD;&amp;#x591F;&amp;#x5206;&amp;#x5230;&amp;#x7CD6;&amp;#x679C;&amp;#xFF0C;&amp;#x5E76;&amp;#x4E14;&amp;#x6EE1;&amp;#x8DB3;&amp;#x5C0F;&amp;#x670B;&amp;#x53CB;&amp;#x4EEC;&amp;#x6240;&amp;#x6709;&amp;#x7684;&amp;#x8981;&amp;#x6C42;&amp;#x3002;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;&amp;#x9898;&amp;#x76EE;&amp;#x94FE;&amp;#x63A5;&quot;&gt;&amp;#x9898;&amp;#x76EE;&amp;#x94FE;&amp;#x63A5;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://www.lydsy.com/JudgeOnline/problem.php?id=2330&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;BZOJ 2330&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x89E3;&amp;#x9898;&amp;#x601D;&amp;#x8DEF;&quot;&gt;&amp;#x89E3;&amp;#x9898;&amp;#x601D;&amp;#x8DEF;&lt;/h3&gt;
&lt;p&gt;&amp;#x5728;&amp;#x6EE1;&amp;#x8DB3;&amp;#x9898;&amp;#x76EE;&amp;#x7684;&amp;#x8981;&amp;#x6C42;&amp;#x4E0B;&amp;#xFF0C;&amp;#x6700;&amp;#x4F18;&amp;#x89E3;&amp;#x4E00;&amp;#x5B9A;&amp;#x662F;&amp;#xFF1A;&amp;#x6700;&amp;#x5C11;&amp;#x7684;&amp;#x4E00;&amp;#x4E2A;&amp;#xFF0C;&amp;#x6BD4;&amp;#x522B;&amp;#x4EBA;&amp;#x591A;&amp;#x4E5F;&amp;#x53EA;&amp;#x591A;&amp;#x4E00;&amp;#x4E2A;&amp;#x3002;&amp;#x5F88;&amp;#x5BB9;&amp;#x6613;&amp;#x60F3;&amp;#x5230;&amp;#x7528;&amp;#x67E5;&amp;#x5206;&amp;#x7EA6;&amp;#x675F;&amp;#x7CFB;&amp;#x7EDF;&amp;#x6765;&amp;#x505A;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x7136;&amp;#x800C;&amp;#x521A;&amp;#x5B66;&amp;#x4E86; Tarjan &amp;#x5C31;&amp;#x60F3;&amp;#x4E71;&amp;#x641E;&amp;#x641E;&amp;#xFF0C;&amp;#x505A;&amp;#x6CD5;&amp;#x662F;&amp;#xFF0C;&amp;#x628A;&amp;#x6240;&amp;#x6709;&amp;#x5173;&amp;#x7CFB;&amp;#x8F6C;&amp;#x5316;&amp;#x4E3A;&amp;#x5C0F;&amp;#x4E8E;&amp;#x7B49;&amp;#x4E8E;&amp;#x548C;&amp;#x5C0F;&amp;#x4E8E;&amp;#x4E24;&amp;#x79CD;&amp;#xFF0C;&amp;#x5148;&amp;#x628A;&amp;#x5C0F;&amp;#x4E8E;&amp;#x7B49;&amp;#x4E8E;&amp;#x7684;&amp;#x8FB9;&amp;#x5168;&amp;#x90E8;&amp;#x52A0;&amp;#x8FDB;&amp;#x53BB;&amp;#xFF0C;&amp;#x8DD1;&amp;#x4E00;&amp;#x904D; Tarjan&amp;#xFF0C;&amp;#x7136;&amp;#x540E;&amp;#x7F29;&amp;#x70B9;&amp;#xFF0C;&amp;#x6B64;&amp;#x65F6;&amp;#x4E00;&amp;#x4E2A;&amp;#x5F3A;&amp;#x8054;&amp;#x901A;&amp;#x5206;&amp;#x91CF;&amp;#x4E0A;&amp;#x7684;&amp;#x5C0F;&amp;#x670B;&amp;#x53CB;&amp;#x7CD6;&amp;#x679C;&amp;#x6570;&amp;#x662F;&amp;#x76F8;&amp;#x540C;&amp;#x7684;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x628A;&amp;#x5C0F;&amp;#x4E8E;&amp;#x7684;&amp;#x8FB9;&amp;#x518D;&amp;#x52A0;&amp;#x4E0A;&amp;#xFF0C;&amp;#x8FDB;&amp;#x884C;&amp;#x62D3;&amp;#x6251;&amp;#x6392;&amp;#x5E8F;&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x6709;&amp;#x73AF;&amp;#x8BF4;&amp;#x660E;&amp;#x65E0;&amp;#x89E3;&amp;#x3002;&amp;#x628A;&amp;#x5C0F;&amp;#x4E8E;&amp;#x7B49;&amp;#x4E8E;&amp;#x7684;&amp;#x8FB9;&amp;#x6743;&amp;#x503C;&amp;#x7F6E;&amp;#x4E3A; 0&amp;#xFF0C;&amp;#x5C0F;&amp;#x4E8E;&amp;#x7684;&amp;#x8FB9;&amp;#x6743;&amp;#x503C;&amp;#x7F6E;&amp;#x4E3A; 1&amp;#xFF0C;&amp;#x5165;&amp;#x5EA6;&amp;#x4E3A;&amp;#x96F6;&amp;#x7684;&amp;#x70B9;&amp;#x8DDD;&amp;#x79BB;&amp;#x7F6E;&amp;#x4E3A; 1&amp;#x3002;&amp;#x6C42;&amp;#x51FA;&amp;#x6240;&amp;#x6709;&amp;#x6700;&amp;#x957F;&amp;#x8DEF;&amp;#xFF0C;&amp;#x6BCF;&amp;#x4E2A;&amp;#x70B9;&amp;#x8DDD;&amp;#x79BB;&amp;#x4E58;&amp;#x4EE5;&amp;#x8BE5;&amp;#x70B9;&amp;#x5C0F;&amp;#x670B;&amp;#x53CB;&amp;#x7684;&amp;#x6570;&amp;#x91CF;&amp;#x7684;&amp;#x548C;&amp;#x5373;&amp;#x4E3A;&amp;#x7B54;&amp;#x6848;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x6CE8;&amp;#x610F;&amp;#x5F00; &lt;code&gt;long long&lt;/code&gt;&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;ac&amp;#x4EE3;&amp;#x7801;&quot;&gt;AC&amp;#x4EE3;&amp;#x7801;&lt;/h3&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;93&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;94&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;95&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;96&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;97&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;98&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;99&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;100&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;101&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;102&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;103&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;104&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;105&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;106&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;107&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;108&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;109&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;110&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;111&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;112&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;113&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;114&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;115&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;116&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;117&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;118&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;119&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;120&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;121&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;122&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;123&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;124&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;125&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;126&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;127&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;128&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;129&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;130&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;131&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;132&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;133&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;134&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;135&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;136&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;137&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;138&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;139&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;140&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;141&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;142&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;143&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;144&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;145&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;146&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;147&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;148&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;149&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;150&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;151&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;152&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;153&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;154&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;155&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;156&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;157&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;158&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;159&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;160&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;161&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;162&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;163&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;164&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;165&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;166&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;167&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;168&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;169&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;170&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;171&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;172&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;173&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;174&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;175&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;176&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;177&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;178&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;algorithm&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;stack&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;queue&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXN = &lt;span class=&quot;number&quot;&gt;100000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXK = &lt;span class=&quot;number&quot;&gt;100000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Node;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Edge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Connected;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Node {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Edge *firstEdge, *currentEdge, *inEdge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; dfn, low, inDegree, dist;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; visited, pushed, inStack;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Connected *scc;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} nodes[MAXN];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Edge {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Node *from, *to;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Edge *next;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; w;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Edge(Node *from, Node *to, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; w) : from(from), to(to), next(from-&amp;gt;firstEdge), w(w) {}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;};&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Connected {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; size;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Node v;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} sccs[MAXN];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Condition {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; x, u, v;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} conditions[MAXK];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, k;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;tarjan&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; timeStamp = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, count = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (nodes[i].visited) &lt;span class=&quot;keyword&quot;&gt;continue&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;stack&lt;/span&gt;&amp;lt;Node *&amp;gt; s, t;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		s.push(&amp;amp;nodes[i]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		nodes[i].pushed = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (!s.empty()) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			Node *v = s.top();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!v-&amp;gt;visited) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				v-&amp;gt;visited = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				v-&amp;gt;currentEdge = v-&amp;gt;firstEdge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				v-&amp;gt;dfn = v-&amp;gt;low = timeStamp++;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				v-&amp;gt;inStack = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				t.push(v);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (v-&amp;gt;currentEdge) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				Edge *&amp;amp;e = v-&amp;gt;currentEdge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!e-&amp;gt;to-&amp;gt;pushed) s.push(e-&amp;gt;to), e-&amp;gt;to-&amp;gt;pushed = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;, e-&amp;gt;to-&amp;gt;inEdge = e;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (e-&amp;gt;to-&amp;gt;inStack) v-&amp;gt;low = &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::min(v-&amp;gt;low, e-&amp;gt;to-&amp;gt;dfn);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				e = e-&amp;gt;next;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			} &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				s.pop();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (v-&amp;gt;dfn == v-&amp;gt;low) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					v-&amp;gt;scc = &amp;amp;sccs[count++];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					Node *u;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;keyword&quot;&gt;do&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;						u = t.top();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;						t.pop();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;						u-&amp;gt;inStack = &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;						u-&amp;gt;scc = v-&amp;gt;scc;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;						u-&amp;gt;scc-&amp;gt;size++;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					} &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (u != v);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (v-&amp;gt;inEdge) v-&amp;gt;inEdge-&amp;gt;from-&amp;gt;low = &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::min(v-&amp;gt;inEdge-&amp;gt;from-&amp;gt;low, v-&amp;gt;low);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; count;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;contract&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (Edge *e = nodes[i].firstEdge; e; e = e-&amp;gt;next) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (e-&amp;gt;from-&amp;gt;scc != e-&amp;gt;to-&amp;gt;scc) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				e-&amp;gt;from-&amp;gt;scc-&amp;gt;v.firstEdge = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Edge(&amp;amp;e-&amp;gt;from-&amp;gt;scc-&amp;gt;v, &amp;amp;e-&amp;gt;to-&amp;gt;scc-&amp;gt;v, e-&amp;gt;w);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				e-&amp;gt;to-&amp;gt;scc-&amp;gt;v.inDegree++;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;topoSort&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; count)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;queue&lt;/span&gt;&amp;lt;Node *&amp;gt; q;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; count; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (sccs[i].v.inDegree == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			sccs[i].v.dist = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			q.push(&amp;amp;sccs[i].v);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; x = count;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (!q.empty()) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		Node *v = q.front();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		q.pop();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		x--;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (Edge *e = v-&amp;gt;firstEdge; e; e = e-&amp;gt;next) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (e-&amp;gt;to-&amp;gt;dist == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; || e-&amp;gt;to-&amp;gt;dist &amp;lt; v-&amp;gt;dist + e-&amp;gt;w) e-&amp;gt;to-&amp;gt;dist = v-&amp;gt;dist + e-&amp;gt;w;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (--e-&amp;gt;to-&amp;gt;inDegree == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				q.push(e-&amp;gt;to);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (x &amp;gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; -&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; ans = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; count; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			ans += (&lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt;)sccs[i].size * (&lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt;)sccs[i].v.dist;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; ans;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;addEdge&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; from, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; to, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; w)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	nodes[from].firstEdge = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Edge(&amp;amp;nodes[from], &amp;amp;nodes[to], w);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d&amp;quot;&lt;/span&gt;, &amp;amp;n, &amp;amp;k);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; k; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d %d&amp;quot;&lt;/span&gt;, &amp;amp;conditions[i].x, &amp;amp;conditions[i].u, &amp;amp;conditions[i].v);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		conditions[i].u--, conditions[i].v--;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (conditions[i].x == &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::swap(conditions[i].u, conditions[i].v);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			conditions[i].x = &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		} &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (conditions[i].x == &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::swap(conditions[i].u, conditions[i].v);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			conditions[i].x = &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; k; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (conditions[i].x == &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			addEdge(conditions[i].u, conditions[i].v, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			addEdge(conditions[i].v, conditions[i].u, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		} &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (conditions[i].x == &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			addEdge(conditions[i].u, conditions[i].v, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; count = tarjan();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	contract();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; k; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (conditions[i].x == &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			Node *u = &amp;amp;nodes[conditions[i].u].scc-&amp;gt;v, *v = &amp;amp;nodes[conditions[i].v].scc-&amp;gt;v;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			u-&amp;gt;firstEdge = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Edge(u, v, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			v-&amp;gt;inDegree++;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%lld\n&amp;quot;&lt;/span&gt;, topoSort(count));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x5E7C;&amp;#x513F;&amp;#x56ED;&amp;#x91CC;&amp;#x6709; $ N $ &amp;#x4E2A;&amp;#x5C0F;&amp;#x670B;&amp;#x53CB;&amp;#xFF0C;&amp;#x8001;&amp;#x5E08;&amp;#x73B0;&amp;#x5728;&amp;#x60F3;&amp;#x8981;&amp;#x7ED9;&amp;#x8FD9;&amp;#x4E9B;&amp;#x5C0F;&amp;#x670B;&amp;#x53CB;&amp;#x4EEC;&amp;#x5206;&amp;#x914D;&amp;#x7CD6;&amp;#x679C;&amp;#xFF0C;&amp;#x8981;&amp;#x6C42;&amp;#x6BCF;&amp;#x4E2A;&amp;#x5C0F;&amp;#x670B;&amp;#x53CB;&amp;#x90FD;&amp;#x8981;&amp;#x5206;&amp;#x5230;&amp;#x7CD6;&amp;#x679C;&amp;#x3002;&amp;#x5728;&amp;#x5206;&amp;#x914D;&amp;#x7CD6;&amp;#x679C;&amp;#x7684;&amp;#x65F6;&amp;#x5019;&amp;#xFF0C;&amp;#x9700;&amp;#x8981;&amp;#x6EE1;&amp;#x8DB3;&amp;#x5C0F;&amp;#x670B;&amp;#x53CB;&amp;#x4EEC;&amp;#x7684; $ K $ &amp;#x4E2A;&amp;#x8981;&amp;#x6C42;&amp;#x3002;&amp;#x5E7C;&amp;#x513F;&amp;#x56ED;&amp;#x7684;&amp;#x7CD6;&amp;#x679C;&amp;#x603B;&amp;#x662F;&amp;#x6709;&amp;#x9650;&amp;#x7684;&amp;#xFF0C;&amp;#x60F3;&amp;#x77E5;&amp;#x9053;&amp;#x4ED6;&amp;#x81F3;&amp;#x5C11;&amp;#x9700;&amp;#x8981;&amp;#x51C6;&amp;#x5907;&amp;#x591A;&amp;#x5C11;&amp;#x4E2A;&amp;#x7CD6;&amp;#x679C;&amp;#xFF0C;&amp;#x624D;&amp;#x80FD;&amp;#x4F7F;&amp;#x5F97;&amp;#x6BCF;&amp;#x4E2A;&amp;#x5C0F;&amp;#x670B;&amp;#x53CB;&amp;#x90FD;&amp;#x80FD;&amp;#x591F;&amp;#x5206;&amp;#x5230;&amp;#x7CD6;&amp;#x679C;&amp;#xFF0C;&amp;#x5E76;&amp;#x4E14;&amp;#x6EE1;&amp;#x8DB3;&amp;#x5C0F;&amp;#x670B;&amp;#x53CB;&amp;#x4EEC;&amp;#x6240;&amp;#x6709;&amp;#x7684;&amp;#x8981;&amp;#x6C42;&amp;#x3002;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="BZOJ" scheme="https://blog.menci.moe/tag/bzoj/"/>
    
      <category term="SCOI" scheme="https://blog.menci.moe/tag/scoi/"/>
    
      <category term="Tarjan" scheme="https://blog.menci.moe/tag/tarjan/"/>
    
      <category term="差分约束系统" scheme="https://blog.menci.moe/tag/%E5%B7%AE%E5%88%86%E7%BA%A6%E6%9D%9F%E7%B3%BB%E7%BB%9F/"/>
    
      <category term="强联通分量" scheme="https://blog.menci.moe/tag/%E5%BC%BA%E8%81%94%E9%80%9A%E5%88%86%E9%87%8F/"/>
    
      <category term="拓扑排序" scheme="https://blog.menci.moe/tag/%E6%8B%93%E6%89%91%E6%8E%92%E5%BA%8F/"/>
    
      <category term="缩点" scheme="https://blog.menci.moe/tag/%E7%BC%A9%E7%82%B9/"/>
    
  </entry>
  
  <entry>
    <title>「HAOI2006」受欢迎的牛 - 强联通分量</title>
    <link href="https://blog.menci.moe/haoi2006-cow/"/>
    <id>https://blog.menci.moe/haoi2006-cow/</id>
    <published>2016-03-04T13:28:17.000Z</published>
    <updated>2016-03-04T13:28:49.000Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x6BCF;&amp;#x4E00;&amp;#x5934;&amp;#x725B;&amp;#x7684;&amp;#x613F;&amp;#x671B;&amp;#x5C31;&amp;#x662F;&amp;#x53D8;&amp;#x6210;&amp;#x4E00;&amp;#x5934;&amp;#x6700;&amp;#x53D7;&amp;#x6B22;&amp;#x8FCE;&amp;#x7684;&amp;#x725B;&amp;#x3002;&amp;#x73B0;&amp;#x5728;&amp;#x6709; $ N $ &amp;#x5934;&amp;#x725B;&amp;#xFF0C;&amp;#x7ED9;&amp;#x4F60; $ M $ &amp;#x5BF9;&amp;#x6574;&amp;#x6570; $ (A,B) $&amp;#xFF0C;&amp;#x8868;&amp;#x793A;&amp;#x725B; $ A $ &amp;#x8BA4;&amp;#x4E3A;&amp;#x725B; $ B $ &amp;#x53D7;&amp;#x6B22;&amp;#x8FCE;&amp;#x3002; &amp;#x8FD9;&amp;#x79CD;&amp;#x5173;&amp;#x7CFB;&amp;#x662F;&amp;#x5177;&amp;#x6709;&amp;#x4F20;&amp;#x9012;&amp;#x6027;&amp;#x7684;&amp;#xFF0C;&amp;#x5982;&amp;#x679C; $ A $ &amp;#x8BA4;&amp;#x4E3A; $ B $ &amp;#x53D7;&amp;#x6B22;&amp;#x8FCE;&amp;#xFF0C;$ B $ &amp;#x8BA4;&amp;#x4E3A; $ C $ &amp;#x53D7;&amp;#x6B22;&amp;#x8FCE;&amp;#xFF0C;&amp;#x90A3;&amp;#x4E48;&amp;#x725B; $ A $ &amp;#x4E5F;&amp;#x8BA4;&amp;#x4E3A;&amp;#x725B; $ C $ &amp;#x53D7;&amp;#x6B22;&amp;#x8FCE;&amp;#x3002;&amp;#x4F60;&amp;#x7684;&amp;#x4EFB;&amp;#x52A1;&amp;#x662F;&amp;#x6C42;&amp;#x51FA;&amp;#x6709;&amp;#x591A;&amp;#x5C11;&amp;#x5934;&amp;#x725B;&amp;#x88AB;&amp;#x6240;&amp;#x6709;&amp;#x7684;&amp;#x725B;&amp;#x8BA4;&amp;#x4E3A;&amp;#x662F;&amp;#x53D7;&amp;#x6B22;&amp;#x8FCE;&amp;#x7684;&amp;#x3002;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;&amp;#x9898;&amp;#x76EE;&amp;#x94FE;&amp;#x63A5;&quot;&gt;&amp;#x9898;&amp;#x76EE;&amp;#x94FE;&amp;#x63A5;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://www.lydsy.com/JudgeOnline/problem.php?id=1051&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;BZOJ 1051&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x89E3;&amp;#x9898;&amp;#x601D;&amp;#x8DEF;&quot;&gt;&amp;#x89E3;&amp;#x9898;&amp;#x601D;&amp;#x8DEF;&lt;/h3&gt;
&lt;p&gt;&amp;#x6C42;&amp;#x51FA;&amp;#x5F3A;&amp;#x8054;&amp;#x901A;&amp;#x5206;&amp;#x91CF;&amp;#xFF0C;&amp;#x7F29;&amp;#x70B9;&amp;#xFF0C;&amp;#x7136;&amp;#x540E;&amp;#x5224;&amp;#x65AD;&amp;#x662F;&amp;#x4E0D;&amp;#x662F;&amp;#x53EA;&amp;#x6709;&amp;#x4E00;&amp;#x4E2A;&amp;#x51FA;&amp;#x5EA6;&amp;#x4E3A;&amp;#x96F6;&amp;#x7684;&amp;#x70B9;&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x662F;&amp;#x8F93;&amp;#x51FA;&amp;#x5B83;&amp;#x7684;&amp;#x5927;&amp;#x5C0F;&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;ac&amp;#x4EE3;&amp;#x7801;&quot;&gt;AC&amp;#x4EE3;&amp;#x7801;&lt;/h3&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;93&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;94&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;95&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;96&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;97&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;98&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;99&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;100&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;101&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;102&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;103&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;104&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;105&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;106&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;107&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;108&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;109&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;110&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;111&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;112&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;113&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;114&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;115&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;116&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;117&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;118&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;119&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;120&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;121&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;122&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;123&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;124&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;125&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;126&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;algorithm&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;stack&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXN = &lt;span class=&quot;number&quot;&gt;10000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Node;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Edge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Connected;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Node {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Edge *firstEdge, *currentEdge, *inEdge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; dfn, low, outDegree;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; visited, pushed, inStack;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Connected *connected;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} nodes[MAXN];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Edge {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Node *from, *to;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Edge *next;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Edge(Node *from, Node *to) : from(from), to(to), next(from-&amp;gt;firstEdge) {}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;};&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Connected {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; size;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Node v;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} connecteds[MAXN];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, m;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;tarjan&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; timeStamp = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, count = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (nodes[i].visited) &lt;span class=&quot;keyword&quot;&gt;continue&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;stack&lt;/span&gt;&amp;lt;Node *&amp;gt; s, t;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		s.push(&amp;amp;nodes[i]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		nodes[i].pushed = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (!s.empty()) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			Node *v = s.top();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!v-&amp;gt;visited) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				v-&amp;gt;visited = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				v-&amp;gt;currentEdge = v-&amp;gt;firstEdge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				v-&amp;gt;dfn = v-&amp;gt;low = timeStamp++;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				v-&amp;gt;inStack = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				t.push(v);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (v-&amp;gt;currentEdge) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				Edge *&amp;amp;e = v-&amp;gt;currentEdge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!e-&amp;gt;to-&amp;gt;pushed) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					s.push(e-&amp;gt;to);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					e-&amp;gt;to-&amp;gt;pushed = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					e-&amp;gt;to-&amp;gt;inEdge = e;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				} &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (e-&amp;gt;to-&amp;gt;inStack) v-&amp;gt;low = &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::min(v-&amp;gt;low, e-&amp;gt;to-&amp;gt;dfn);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				e = e-&amp;gt;next;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			} &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				s.pop();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (v-&amp;gt;dfn == v-&amp;gt;low) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					v-&amp;gt;connected = &amp;amp;connecteds[count++];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					Node *u;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;keyword&quot;&gt;do&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;						u = t.top();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;						t.pop();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;						u-&amp;gt;inStack = &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;						u-&amp;gt;connected = v-&amp;gt;connected;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;						u-&amp;gt;connected-&amp;gt;size++;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					} &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (u != v);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (v-&amp;gt;inEdge) v-&amp;gt;inEdge-&amp;gt;from-&amp;gt;low = &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::min(v-&amp;gt;inEdge-&amp;gt;from-&amp;gt;low, v-&amp;gt;low);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; count;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; Connected *&lt;span class=&quot;title&quot;&gt;contract&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; count)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; zeroCount = count;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (Edge *e = nodes[i].firstEdge; e; e = e-&amp;gt;next) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (e-&amp;gt;from-&amp;gt;connected != e-&amp;gt;to-&amp;gt;connected) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				e-&amp;gt;from-&amp;gt;connected-&amp;gt;v.firstEdge = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Edge(&amp;amp;e-&amp;gt;from-&amp;gt;connected-&amp;gt;v, &amp;amp;e-&amp;gt;to-&amp;gt;connected-&amp;gt;v);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (e-&amp;gt;from-&amp;gt;connected-&amp;gt;v.outDegree++ == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) zeroCount--;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (zeroCount != &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; count; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (connecteds[i].v.outDegree == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &amp;amp;connecteds[i];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;addEdge&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; from, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; to)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	nodes[from].firstEdge = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Edge(&amp;amp;nodes[from], &amp;amp;nodes[to]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d&amp;quot;&lt;/span&gt;, &amp;amp;n, &amp;amp;m);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; m; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; from, to;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d&amp;quot;&lt;/span&gt;, &amp;amp;from, &amp;amp;to), from--, to--;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		addEdge(from, to);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; count = tarjan();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Connected *popular = contract(count);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!popular) &lt;span class=&quot;built_in&quot;&gt;puts&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;-1&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d\n&amp;quot;&lt;/span&gt;, popular-&amp;gt;size);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x6BCF;&amp;#x4E00;&amp;#x5934;&amp;#x725B;&amp;#x7684;&amp;#x613F;&amp;#x671B;&amp;#x5C31;&amp;#x662F;&amp;#x53D8;&amp;#x6210;&amp;#x4E00;&amp;#x5934;&amp;#x6700;&amp;#x53D7;&amp;#x6B22;&amp;#x8FCE;&amp;#x7684;&amp;#x725B;&amp;#x3002;&amp;#x73B0;&amp;#x5728;&amp;#x6709; $ N $ &amp;#x5934;&amp;#x725B;&amp;#xFF0C;&amp;#x7ED9;&amp;#x4F60; $ M $ &amp;#x5BF9;&amp;#x6574;&amp;#x6570; $ (A,B) $&amp;#xFF0C;&amp;#x8868;&amp;#x793A;&amp;#x725B; $ A $ &amp;#x8BA4;&amp;#x4E3A;&amp;#x725B; $ B $ &amp;#x53D7;&amp;#x6B22;&amp;#x8FCE;&amp;#x3002; &amp;#x8FD9;&amp;#x79CD;&amp;#x5173;&amp;#x7CFB;&amp;#x662F;&amp;#x5177;&amp;#x6709;&amp;#x4F20;&amp;#x9012;&amp;#x6027;&amp;#x7684;&amp;#xFF0C;&amp;#x5982;&amp;#x679C; $ A $ &amp;#x8BA4;&amp;#x4E3A; $ B $ &amp;#x53D7;&amp;#x6B22;&amp;#x8FCE;&amp;#xFF0C;$ B $ &amp;#x8BA4;&amp;#x4E3A; $ C $ &amp;#x53D7;&amp;#x6B22;&amp;#x8FCE;&amp;#xFF0C;&amp;#x90A3;&amp;#x4E48;&amp;#x725B; $ A $ &amp;#x4E5F;&amp;#x8BA4;&amp;#x4E3A;&amp;#x725B; $ C $ &amp;#x53D7;&amp;#x6B22;&amp;#x8FCE;&amp;#x3002;&amp;#x4F60;&amp;#x7684;&amp;#x4EFB;&amp;#x52A1;&amp;#x662F;&amp;#x6C42;&amp;#x51FA;&amp;#x6709;&amp;#x591A;&amp;#x5C11;&amp;#x5934;&amp;#x725B;&amp;#x88AB;&amp;#x6240;&amp;#x6709;&amp;#x7684;&amp;#x725B;&amp;#x8BA4;&amp;#x4E3A;&amp;#x662F;&amp;#x53D7;&amp;#x6B22;&amp;#x8FCE;&amp;#x7684;&amp;#x3002;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="BZOJ" scheme="https://blog.menci.moe/tag/bzoj/"/>
    
      <category term="HAOI" scheme="https://blog.menci.moe/tag/haoi/"/>
    
      <category term="Tarjan" scheme="https://blog.menci.moe/tag/tarjan/"/>
    
      <category term="强联通分量" scheme="https://blog.menci.moe/tag/%E5%BC%BA%E8%81%94%E9%80%9A%E5%88%86%E9%87%8F/"/>
    
      <category term="缩点" scheme="https://blog.menci.moe/tag/%E7%BC%A9%E7%82%B9/"/>
    
  </entry>
  
  <entry>
    <title>「CodeVS 2822」爱在心中 - 强联通分量</title>
    <link href="https://blog.menci.moe/codevs-2822/"/>
    <id>https://blog.menci.moe/codevs-2822/</id>
    <published>2016-03-04T02:47:42.000Z</published>
    <updated>2016-03-04T02:47:59.000Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x5728;&amp;#x7231;&amp;#x7684;&amp;#x56FD;&amp;#x5EA6;&amp;#x91CC;&amp;#x6709; N &amp;#x4E2A;&amp;#x4EBA;&amp;#xFF0C;&amp;#x5728;&amp;#x4ED6;&amp;#x4EEC;&amp;#x7684;&amp;#x5FC3;&amp;#x4E2D;&amp;#x90FD;&amp;#x6709;&amp;#x7740;&amp;#x4E00;&amp;#x4E2A;&amp;#x7231;&amp;#x7684;&amp;#x540D;&amp;#x5355;&amp;#xFF0C;&amp;#x4E0A;&amp;#x9762;&amp;#x8BB0;&amp;#x8F7D;&amp;#x7740;&amp;#x4ED6;&amp;#x6240;&amp;#x7231;&amp;#x7684;&amp;#x4EBA;&amp;#xFF08;&amp;#x4E0D;&amp;#x4F1A;&amp;#x51FA;&amp;#x73B0;&amp;#x81EA;&amp;#x7231;&amp;#x7684;&amp;#x60C5;&amp;#x51B5;&amp;#xFF09;&amp;#x3002;&amp;#x7231;&amp;#x662F;&amp;#x5177;&amp;#x6709;&amp;#x4F20;&amp;#x9012;&amp;#x6027;&amp;#x7684;&amp;#xFF0C;&amp;#x5373;&amp;#x5982;&amp;#x679C; A &amp;#x7231; B&amp;#xFF0C;B &amp;#x7231; C&amp;#xFF0C;&amp;#x5219; A &amp;#x4E5F;&amp;#x7231; C&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x5982;&amp;#x679C;&amp;#x6709;&amp;#x8FD9;&amp;#x6837;&amp;#x4E00;&amp;#x90E8;&amp;#x5206;&amp;#x4EBA;&amp;#xFF0C;&amp;#x4ED6;&amp;#x4EEC;&amp;#x5F7C;&amp;#x6B64;&amp;#x90FD;&amp;#x76F8;&amp;#x7231;&amp;#xFF0C;&amp;#x5219;&amp;#x4ED6;&amp;#x4EEC;&amp;#x5C31;&amp;#x8D85;&amp;#x8D8A;&amp;#x4E86;&amp;#x4E00;&amp;#x5207;&amp;#x7684;&amp;#x9650;&amp;#x5236;&amp;#xFF0C;&amp;#x7528;&amp;#x96C6;&amp;#x4F53;&amp;#x7684;&amp;#x7231;&amp;#x5316;&amp;#x8EAB;&amp;#x6210;&amp;#x4E3A;&amp;#x4E00;&amp;#x4E2A;&amp;#x7231;&amp;#x5FC3;&amp;#x5929;&amp;#x4F7F;&amp;#x3002;&amp;#x73B0;&amp;#x5728;&amp;#xFF0C;&amp;#x6211;&amp;#x4EEC;&amp;#x60F3;&amp;#x77E5;&amp;#x9053;&amp;#x5728;&amp;#x8FD9;&amp;#x4E2A;&amp;#x7231;&amp;#x7684;&amp;#x56FD;&amp;#x5EA6;&amp;#x91CC;&amp;#x4F1A;&amp;#x51FA;&amp;#x73B0;&amp;#x591A;&amp;#x5C11;&amp;#x7231;&amp;#x5FC3;&amp;#x5929;&amp;#x4F7F;&amp;#x3002;&amp;#x800C;&amp;#x4E14;&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x67D0;&amp;#x4E2A;&amp;#x7231;&amp;#x5FC3;&amp;#x5929;&amp;#x4F7F;&amp;#x88AB;&amp;#x5176;&amp;#x4ED6;&amp;#x6240;&amp;#x6709;&amp;#x4EBA;&amp;#x6216;&amp;#x7231;&amp;#x5FC3;&amp;#x5929;&amp;#x4F7F;&amp;#x6240;&amp;#x7231;&amp;#x5219;&amp;#x8BF7;&amp;#x8F93;&amp;#x51FA;&amp;#x8FD9;&amp;#x4E2A;&amp;#x7231;&amp;#x5FC3;&amp;#x5929;&amp;#x4F7F;&amp;#x662F;&amp;#x7531;&amp;#x54EA;&amp;#x4E9B;&amp;#x4EBA;&amp;#x6784;&amp;#x6210;&amp;#x7684;&amp;#xFF0C;&amp;#x5426;&amp;#x5219;&amp;#x8F93;&amp;#x51FA; -1&amp;#x3002;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;&amp;#x9898;&amp;#x76EE;&amp;#x94FE;&amp;#x63A5;&quot;&gt;&amp;#x9898;&amp;#x76EE;&amp;#x94FE;&amp;#x63A5;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://codevs.cn/problem/2822/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;CodeVS 2822&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x89E3;&amp;#x9898;&amp;#x601D;&amp;#x8DEF;&quot;&gt;&amp;#x89E3;&amp;#x9898;&amp;#x601D;&amp;#x8DEF;&lt;/h3&gt;
&lt;p&gt;&amp;#x7B2C;&amp;#x4E00;&amp;#x95EE;&amp;#x5F88;&amp;#x660E;&amp;#x663E;&amp;#x7684;&amp;#xFF0C;&amp;#x6C42;&amp;#x51FA;&amp;#x56FE;&amp;#x4E2D;&amp;#x6709;&amp;#x591A;&amp;#x5C11;&amp;#x4E0D;&amp;#x662F;&amp;#x5355;&amp;#x70B9;&amp;#x7684;&amp;#x5F3A;&amp;#x8054;&amp;#x901A;&amp;#x5206;&amp;#x91CF;&amp;#x5C31;&amp;#x662F;&amp;#x7B54;&amp;#x6848;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x7B2C;&amp;#x4E8C;&amp;#x95EE;&amp;#xFF0C;&amp;#x628A;&amp;#x6BCF;&amp;#x4E2A;&amp;#x5F3A;&amp;#x8054;&amp;#x901A;&amp;#x5206;&amp;#x91CF;&amp;#x7F29;&amp;#x6210;&amp;#x4E00;&amp;#x4E2A;&amp;#x70B9;&amp;#xFF0C;&amp;#x91CD;&amp;#x65B0;&amp;#x6784;&amp;#x56FE;&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x65B0;&amp;#x56FE;&amp;#x4E2D;&amp;#x6709;&amp;#x51FA;&amp;#x5EA6;&amp;#x4E3A;&amp;#x96F6;&amp;#x7684;&amp;#x70B9;&amp;#xFF0C;&amp;#x5219;&amp;#x8BE5;&amp;#x70B9;&amp;#x5BF9;&amp;#x5E94;&amp;#x7684;&amp;#x539F;&amp;#x56FE;&amp;#x4E2D;&amp;#x7684;&amp;#x70B9;&amp;#x96C6;&amp;#x5373;&amp;#x4E3A;&amp;#x7B2C;&amp;#x4E8C;&amp;#x95EE;&amp;#x7B54;&amp;#x6848;&amp;#x3002;&amp;#x6CE8;&amp;#x610F;&amp;#x6392;&amp;#x9664;&amp;#x4E00;&amp;#x4E2A;&amp;#x70B9;&amp;#x60C5;&amp;#x51B5;&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;ac&amp;#x4EE3;&amp;#x7801;&quot;&gt;AC&amp;#x4EE3;&amp;#x7801;&lt;/h3&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;93&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;94&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;95&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;96&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;97&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;98&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;99&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;100&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;101&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;102&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;103&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;104&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;105&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;106&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;107&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;108&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;109&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;110&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;111&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;112&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;113&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;114&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;115&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;116&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;117&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;118&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;119&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;120&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;121&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;122&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;123&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;124&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;125&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;126&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;127&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;128&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;129&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;130&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;131&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;132&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;133&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;134&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;135&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;136&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;137&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;138&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;139&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;140&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;141&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;142&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;143&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;144&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;145&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;146&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;147&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;algorithm&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;stack&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;vector&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXN = &lt;span class=&quot;number&quot;&gt;1000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXM = &lt;span class=&quot;number&quot;&gt;1000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Node;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Edge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Connected;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Node {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Edge *firstEdge, *currentEdge, *inEdge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; id, dfn, low, outDegree;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; visited, pushed, inStack;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Connected *connected;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} nodes[MAXN];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Edge {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Node *from, *to;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Edge *next;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Edge(Node *from, Node *to) : from(from), to(to), next(from-&amp;gt;firstEdge) {}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;};&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Connected {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; size;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;vector&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;&amp;gt; vec;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Node v;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} connecteds[MAXN];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, m;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;tarjan&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; timeStamp = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, count = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (nodes[i].visited) &lt;span class=&quot;keyword&quot;&gt;continue&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;stack&lt;/span&gt;&amp;lt;Node *&amp;gt; s, t;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		s.push(&amp;amp;nodes[i]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		nodes[i].pushed = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (!s.empty()) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			Node *v = s.top();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!v-&amp;gt;visited) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				v-&amp;gt;visited = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				v-&amp;gt;currentEdge = v-&amp;gt;firstEdge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				v-&amp;gt;dfn = v-&amp;gt;low = timeStamp++;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				v-&amp;gt;inStack = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				t.push(v);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (v-&amp;gt;currentEdge) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				Edge *&amp;amp;e = v-&amp;gt;currentEdge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!e-&amp;gt;to-&amp;gt;pushed) s.push(e-&amp;gt;to), e-&amp;gt;to-&amp;gt;pushed = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;, e-&amp;gt;to-&amp;gt;inEdge = e;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (e-&amp;gt;to-&amp;gt;inStack) v-&amp;gt;low = &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::min(v-&amp;gt;low, e-&amp;gt;to-&amp;gt;dfn);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				e = e-&amp;gt;next;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			} &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (v-&amp;gt;dfn == v-&amp;gt;low) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					v-&amp;gt;connected = &amp;amp;connecteds[count++];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					Node *u;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;keyword&quot;&gt;do&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;						u = t.top();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;						t.pop();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;						u-&amp;gt;inStack = &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;						u-&amp;gt;connected = v-&amp;gt;connected;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;						u-&amp;gt;connected-&amp;gt;size++;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;						u-&amp;gt;connected-&amp;gt;vec.push_back(u-&amp;gt;id);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					} &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (u != v);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (v-&amp;gt;inEdge) v-&amp;gt;inEdge-&amp;gt;from-&amp;gt;low = &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::min(v-&amp;gt;inEdge-&amp;gt;from-&amp;gt;low, v-&amp;gt;low);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				s.pop();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; count;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; Connected *&lt;span class=&quot;title&quot;&gt;contract&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; count)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; zeroCount = count;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (Edge *e = nodes[i].firstEdge; e; e = e-&amp;gt;next) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (e-&amp;gt;from-&amp;gt;connected != e-&amp;gt;to-&amp;gt;connected) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				e-&amp;gt;from-&amp;gt;connected-&amp;gt;v.firstEdge = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Edge(&amp;amp;e-&amp;gt;from-&amp;gt;connected-&amp;gt;v, &amp;amp;e-&amp;gt;to-&amp;gt;connected-&amp;gt;v);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (e-&amp;gt;from-&amp;gt;connected-&amp;gt;v.outDegree++ == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) zeroCount--;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (zeroCount != &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; count; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (connecteds[i].size &amp;gt; &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &amp;amp;&amp;amp; connecteds[i].v.outDegree == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &amp;amp;connecteds[i];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;addEdge&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; from, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; to)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	nodes[from].firstEdge = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Edge(&amp;amp;nodes[from], &amp;amp;nodes[to]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d&amp;quot;&lt;/span&gt;, &amp;amp;n, &amp;amp;m);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) nodes[i].id = i + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; m; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; from, to;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d&amp;quot;&lt;/span&gt;, &amp;amp;from, &amp;amp;to), from--, to--;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		addEdge(from, to);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; count = tarjan();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; ans = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; count; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (connecteds[i].size &amp;gt; &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			ans++;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d\n&amp;quot;&lt;/span&gt;, ans);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Connected *loved = contract(count);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!loved) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;built_in&quot;&gt;puts&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;-1&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	} &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::sort(loved-&amp;gt;vec.begin(), loved-&amp;gt;vec.end());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;vector&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;&amp;gt;::const_iterator p = loved-&amp;gt;vec.begin(); p != loved-&amp;gt;vec.end(); p++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d &amp;quot;&lt;/span&gt;, *p);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;built_in&quot;&gt;putchar&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;apos;\n&amp;apos;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x5728;&amp;#x7231;&amp;#x7684;&amp;#x56FD;&amp;#x5EA6;&amp;#x91CC;&amp;#x6709; N &amp;#x4E2A;&amp;#x4EBA;&amp;#xFF0C;&amp;#x5728;&amp;#x4ED6;&amp;#x4EEC;&amp;#x7684;&amp;#x5FC3;&amp;#x4E2D;&amp;#x90FD;&amp;#x6709;&amp;#x7740;&amp;#x4E00;&amp;#x4E2A;&amp;#x7231;&amp;#x7684;&amp;#x540D;&amp;#x5355;&amp;#xFF0C;&amp;#x4E0A;&amp;#x9762;&amp;#x8BB0;&amp;#x8F7D;&amp;#x7740;&amp;#x4ED6;&amp;#x6240;&amp;#x7231;&amp;#x7684;&amp;#x4EBA;&amp;#xFF08;&amp;#x4E0D;&amp;#x4F1A;&amp;#x51FA;&amp;#x73B0;&amp;#x81EA;&amp;#x7231;&amp;#x7684;&amp;#x60C5;&amp;#x51B5;&amp;#xFF09;&amp;#x3002;&amp;#x7231;&amp;#x662F;&amp;#x5177;&amp;#x6709;&amp;#x4F20;&amp;#x9012;&amp;#x6027;&amp;#x7684;&amp;#xFF0C;&amp;#x5373;&amp;#x5982;&amp;#x679C; A &amp;#x7231; B&amp;#xFF0C;B &amp;#x7231; C&amp;#xFF0C;&amp;#x5219; A &amp;#x4E5F;&amp;#x7231; C&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x5982;&amp;#x679C;&amp;#x6709;&amp;#x8FD9;&amp;#x6837;&amp;#x4E00;&amp;#x90E8;&amp;#x5206;&amp;#x4EBA;&amp;#xFF0C;&amp;#x4ED6;&amp;#x4EEC;&amp;#x5F7C;&amp;#x6B64;&amp;#x90FD;&amp;#x76F8;&amp;#x7231;&amp;#xFF0C;&amp;#x5219;&amp;#x4ED6;&amp;#x4EEC;&amp;#x5C31;&amp;#x8D85;&amp;#x8D8A;&amp;#x4E86;&amp;#x4E00;&amp;#x5207;&amp;#x7684;&amp;#x9650;&amp;#x5236;&amp;#xFF0C;&amp;#x7528;&amp;#x96C6;&amp;#x4F53;&amp;#x7684;&amp;#x7231;&amp;#x5316;&amp;#x8EAB;&amp;#x6210;&amp;#x4E3A;&amp;#x4E00;&amp;#x4E2A;&amp;#x7231;&amp;#x5FC3;&amp;#x5929;&amp;#x4F7F;&amp;#x3002;&amp;#x73B0;&amp;#x5728;&amp;#xFF0C;&amp;#x6211;&amp;#x4EEC;&amp;#x60F3;&amp;#x77E5;&amp;#x9053;&amp;#x5728;&amp;#x8FD9;&amp;#x4E2A;&amp;#x7231;&amp;#x7684;&amp;#x56FD;&amp;#x5EA6;&amp;#x91CC;&amp;#x4F1A;&amp;#x51FA;&amp;#x73B0;&amp;#x591A;&amp;#x5C11;&amp;#x7231;&amp;#x5FC3;&amp;#x5929;&amp;#x4F7F;&amp;#x3002;&amp;#x800C;&amp;#x4E14;&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x67D0;&amp;#x4E2A;&amp;#x7231;&amp;#x5FC3;&amp;#x5929;&amp;#x4F7F;&amp;#x88AB;&amp;#x5176;&amp;#x4ED6;&amp;#x6240;&amp;#x6709;&amp;#x4EBA;&amp;#x6216;&amp;#x7231;&amp;#x5FC3;&amp;#x5929;&amp;#x4F7F;&amp;#x6240;&amp;#x7231;&amp;#x5219;&amp;#x8BF7;&amp;#x8F93;&amp;#x51FA;&amp;#x8FD9;&amp;#x4E2A;&amp;#x7231;&amp;#x5FC3;&amp;#x5929;&amp;#x4F7F;&amp;#x662F;&amp;#x7531;&amp;#x54EA;&amp;#x4E9B;&amp;#x4EBA;&amp;#x6784;&amp;#x6210;&amp;#x7684;&amp;#xFF0C;&amp;#x5426;&amp;#x5219;&amp;#x8F93;&amp;#x51FA; -1&amp;#x3002;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="CodeVS" scheme="https://blog.menci.moe/tag/codevs/"/>
    
      <category term="Tarjan" scheme="https://blog.menci.moe/tag/tarjan/"/>
    
      <category term="图论" scheme="https://blog.menci.moe/tag/%E5%9B%BE%E8%AE%BA/"/>
    
      <category term="强联通分量" scheme="https://blog.menci.moe/tag/%E5%BC%BA%E8%81%94%E9%80%9A%E5%88%86%E9%87%8F/"/>
    
      <category term="缩点" scheme="https://blog.menci.moe/tag/%E7%BC%A9%E7%82%B9/"/>
    
  </entry>
  
  <entry>
    <title>Tarjan 强联通分量学习笔记</title>
    <link href="https://blog.menci.moe/tarjan-scc-notes/"/>
    <id>https://blog.menci.moe/tarjan-scc-notes/</id>
    <published>2016-03-03T13:12:23.000Z</published>
    <updated>2016-03-03T13:12:43.000Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x5728;&amp;#x4E00;&amp;#x4E2A;&amp;#x6709;&amp;#x5411;&amp;#x56FE;&amp;#x4E2D;&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x67D0;&amp;#x4E24;&amp;#x70B9;&amp;#x95F4;&amp;#x90FD;&amp;#x6709;&lt;strong&gt;&amp;#x4E92;&amp;#x76F8;&lt;/strong&gt;&amp;#x5230;&amp;#x8FBE;&amp;#x7684;&amp;#x8DEF;&amp;#x5F84;&amp;#xFF0C;&amp;#x90A3;&amp;#x4E48;&amp;#x79F0;&amp;#x4E2D;&amp;#x4E24;&amp;#x4E2A;&amp;#x70B9;&lt;strong&gt;&amp;#x5F3A;&amp;#x8054;&amp;#x901A;&lt;/strong&gt;&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x4EFB;&amp;#x610F;&amp;#x4E24;&amp;#x70B9;&amp;#x90FD;&amp;#x5F3A;&amp;#x8054;&amp;#x901A;&amp;#xFF0C;&amp;#x90A3;&amp;#x4E48;&amp;#x79F0;&amp;#x8FD9;&amp;#x4E2A;&amp;#x56FE;&amp;#x4E3A;&lt;strong&gt;&amp;#x5F3A;&amp;#x8054;&amp;#x901A;&amp;#x56FE;&lt;/strong&gt;&amp;#xFF1B;&amp;#x4E00;&amp;#x4E2A;&amp;#x6709;&amp;#x5411;&amp;#x56FE;&amp;#x7684;&lt;strong&gt;&amp;#x6781;&amp;#x5927;&lt;/strong&gt;&amp;#x5F3A;&amp;#x8054;&amp;#x901A;&amp;#x5B50;&amp;#x56FE;&amp;#x79F0;&amp;#x4E3A;&lt;strong&gt;&amp;#x5F3A;&amp;#x8054;&amp;#x901A;&amp;#x5206;&amp;#x91CF;&lt;/strong&gt;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;Tarjan &amp;#x7B97;&amp;#x6CD5;&amp;#x53EF;&amp;#x4EE5;&amp;#x5728; $ O(n + m) $ &amp;#x7684;&amp;#x65F6;&amp;#x95F4;&amp;#x5185;&amp;#x6C42;&amp;#x51FA;&amp;#x4E00;&amp;#x4E2A;&amp;#x56FE;&amp;#x7684;&amp;#x6240;&amp;#x6709;&amp;#x5F3A;&amp;#x8054;&amp;#x901A;&amp;#x5206;&amp;#x91CF;&amp;#x3002;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;&amp;#x5B9A;&amp;#x4E49;&quot;&gt;&amp;#x5B9A;&amp;#x4E49;&lt;/h3&gt;
&lt;p&gt;Tarjan &amp;#x7B97;&amp;#x6CD5;&amp;#x7684;&amp;#x6838;&amp;#x5FC3;&amp;#x8FC7;&amp;#x7A0B;&amp;#x662F;&amp;#x4E00;&amp;#x6B21; DFS&amp;#xFF0C;&amp;#x5B83;&amp;#x57FA;&amp;#x4E8E;&amp;#x7684;&amp;#x4E8B;&amp;#x5B9E;&amp;#x662F;&amp;#xFF0C;&amp;#x4E00;&amp;#x4E2A;&amp;#x5F3A;&amp;#x8054;&amp;#x901A;&amp;#x5206;&amp;#x91CF;&amp;#x4E2D;&amp;#x7684;&amp;#x70B9;&amp;#x4E00;&amp;#x5B9A;&amp;#x5904;&amp;#x4E8E;&amp;#x641C;&amp;#x7D22;&amp;#x6811;&amp;#x4E2D;&amp;#x540C;&amp;#x4E00;&amp;#x68F5;&amp;#x5B50;&amp;#x6811;&amp;#x4E2D;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x6808;&amp;#xFF0C;&amp;#x641C;&amp;#x7D22;&amp;#x6811;&amp;#x4E2D;&amp;#x540C;&amp;#x4E00;&amp;#x68F5;&amp;#x5B50;&amp;#x6811;&amp;#x4E2D;&amp;#x7684;&amp;#x70B9;&amp;#x5728;&amp;#x6808;&amp;#x4E2D;&amp;#x662F;&amp;#x76F8;&amp;#x90BB;&amp;#x7684;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;$ {\rm dfn}(u) $ &amp;#x8868;&amp;#x793A;&amp;#x8FDB;&amp;#x5165;&amp;#x8282;&amp;#x70B9; $ u $ &amp;#x65F6;&amp;#x7684;&amp;#x65F6;&amp;#x95F4;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;$ {\rm low}(u) $ &amp;#x8868;&amp;#x793A;&amp;#x7531;&amp;#x8282;&amp;#x70B9; $ u $ &amp;#x5F00;&amp;#x59CB;&amp;#x641C;&amp;#x7D22;&amp;#x6240;&amp;#x80FD;&amp;#x5230;&amp;#x8FBE;&amp;#x7684;&amp;#x70B9;&amp;#x4E2D;&amp;#xFF0C;&amp;#x5728;&amp;#x641C;&amp;#x7D22;&amp;#x6811;&amp;#x4E0A;&amp;#x662F; $ u $ &amp;#x7684;&amp;#x7956;&amp;#x5148;&amp;#x4E14; $ {\rm dfn} $ &amp;#x6700;&amp;#x5C0F;&amp;#x7684;&amp;#x8282;&amp;#x70B9;&amp;#x7684; $ {\rm dfn} $&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x7B97;&amp;#x6CD5;&amp;#x63CF;&amp;#x8FF0;&quot;&gt;&amp;#x7B97;&amp;#x6CD5;&amp;#x63CF;&amp;#x8FF0;&lt;/h3&gt;
&lt;ol style=&quot;list-style-type: decimal&quot;&gt;
&lt;li&gt;&amp;#x4ECE;&amp;#x8D77;&amp;#x70B9;&amp;#x5F00;&amp;#x59CB; DFS&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x8FDB;&amp;#x5165;&amp;#x4E00;&amp;#x4E2A;&amp;#x8282;&amp;#x70B9;&amp;#x65F6;&amp;#xFF0C;&amp;#x521D;&amp;#x59CB;&amp;#x5316;&amp;#x5B83;&amp;#x7684; $ {\rm dfn} $ &amp;#x548C; $ {\rm low} $ &amp;#x5747;&amp;#x4E3A;&amp;#x5F53;&amp;#x524D;&amp;#x65F6;&amp;#x95F4;&amp;#x6233;&amp;#xFF0C;&amp;#x5E76;&amp;#x8FDB;&amp;#x6808;&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x679A;&amp;#x4E3E;&amp;#x5F53;&amp;#x524D;&amp;#x70B9; $ v $ &amp;#x7684;&amp;#x6240;&amp;#x6709;&amp;#x90BB;&amp;#x63A5;&amp;#x70B9;&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x5982;&amp;#x679C;&amp;#x67D0;&amp;#x4E2A;&amp;#x90BB;&amp;#x63A5;&amp;#x70B9; $ u $ &amp;#x5DF2;&amp;#x5728;&amp;#x6808;&amp;#x4E2D;&amp;#xFF0C;&amp;#x5219;&amp;#x66F4;&amp;#x65B0; $ {\rm low}(v) = \min({\rm low}(v), {\rm dfn}(u)) $&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x5982;&amp;#x679C;&amp;#x67D0;&amp;#x4E2A;&amp;#x90BB;&amp;#x63A5;&amp;#x70B9; $ u $ &amp;#x672A;&amp;#x88AB;&amp;#x8BBF;&amp;#x95EE;&amp;#x8FC7;&amp;#xFF0C;&amp;#x5219;&amp;#x5BF9; $ u $ &amp;#x8FDB;&amp;#x884C; DFS&amp;#xFF0C;&amp;#x5E76;&amp;#x5728;&amp;#x56DE;&amp;#x6EAF;&amp;#x540E;&amp;#x66F4;&amp;#x65B0; $ {\rm low}(v) = \min({\rm low}(v), {\rm low(u)}) $&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x6240;&amp;#x6709;&amp;#x90BB;&amp;#x63A5;&amp;#x70B9;&amp;#x56DE;&amp;#x6EAF;&amp;#x5B8C;&amp;#x6210;&amp;#x540E;&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x5F53;&amp;#x524D;&amp;#x70B9;&amp;#x4ECD;&amp;#x6EE1;&amp;#x8DB3; $ {\rm low}(v) = {\rm dfn}(v) $&amp;#xFF0C;&amp;#x5219;&amp;#x5C06;&amp;#x6808;&amp;#x4E2D;&amp;#x4ECE; $ v $ &amp;#x5230;&amp;#x6808;&amp;#x9876;&amp;#x7684;&amp;#x6240;&amp;#x6709;&amp;#x5143;&amp;#x7D20;&amp;#x51FA;&amp;#x6808;&amp;#xFF0C;&amp;#x5E76;&amp;#x6807;&amp;#x8BB0;&amp;#x4E3A;&amp;#x4E00;&amp;#x4E2A;&amp;#x5F3A;&amp;#x8054;&amp;#x901A;&amp;#x5206;&amp;#x91CF;&amp;#x3002;&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&quot;&amp;#x89E3;&amp;#x91CA;&quot;&gt;&amp;#x89E3;&amp;#x91CA;&lt;/h3&gt;
&lt;p&gt;&amp;#x679A;&amp;#x4E3E; $ v $ &amp;#x7684;&amp;#x90BB;&amp;#x63A5;&amp;#x70B9;&amp;#x65F6;&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x67D0;&amp;#x4E2A;&amp;#x90BB;&amp;#x63A5;&amp;#x70B9; $ u $ &amp;#x5DF2;&amp;#x5728;&amp;#x6808;&amp;#x4E2D;&amp;#xFF0C;&amp;#x5219;&amp;#x66F4;&amp;#x65B0;&lt;/p&gt;
&lt;p&gt;$$ {\rm low}(v) = \min({\rm low}(v), {\rm dfn}(u)) $$&lt;/p&gt;
&lt;p&gt;&amp;#x56E0;&amp;#x4E3A;&amp;#x6808;&amp;#x4E2D;&amp;#x7684;&amp;#x6240;&amp;#x6709;&amp;#x70B9;&amp;#x5747;&amp;#x4E3A;&amp;#x641C;&amp;#x7D22;&amp;#x6811;&amp;#x4E0A;&amp;#x70B9; $ v $ &amp;#x7684;&amp;#x7956;&amp;#x5148;&amp;#xFF0C;&amp;#x4ECE;&amp;#x641C;&amp;#x7D22;&amp;#x6811;&amp;#x4E0A;&amp;#x4E00;&amp;#x4E2A;&amp;#x70B9;&amp;#x641C;&amp;#x5230;&amp;#x5B83;&amp;#x7684;&amp;#x7956;&amp;#x5148;&amp;#xFF0C;&amp;#x8BF4;&amp;#x660E;&amp;#x627E;&amp;#x5230;&amp;#x4E86;&amp;#x4E00;&amp;#x4E2A;&amp;#x73AF;&amp;#x3002;&amp;#x6B64;&amp;#x65F6;&amp;#x7528; $ u $ &amp;#x53BB;&amp;#x66F4;&amp;#x65B0; $ v $ &amp;#x7684;&amp;#x6700;&amp;#x8FDC;&amp;#x7956;&amp;#x5148;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x5982;&amp;#x679C;&amp;#x67D0;&amp;#x4E2A;&amp;#x90BB;&amp;#x63A5;&amp;#x70B9; $ u $ &amp;#x672A;&amp;#x88AB;&amp;#x8BBF;&amp;#x95EE;&amp;#x8FC7;&amp;#xFF0C;&amp;#x5219;&amp;#x5BF9; $ u $ &amp;#x8FDB;&amp;#x884C; DFS&amp;#xFF0C;&amp;#x5E76;&amp;#x5728;&amp;#x56DE;&amp;#x6EAF;&amp;#x540E;&amp;#x66F4;&amp;#x65B0;&lt;/p&gt;
&lt;p&gt;$$ {\rm low}(v) = \min({\rm low}(v), {\rm low}(u)) $$&lt;/p&gt;
&lt;p&gt;&amp;#x70B9; $ u $ &amp;#x51FA;&amp;#x53D1;&amp;#x80FD;&amp;#x5230;&amp;#x8FBE;&amp;#x7684;&amp;#x70B9;&amp;#xFF0C;&amp;#x70B9; $ v $ &amp;#x5FC5;&amp;#x5B9A;&amp;#x4E5F;&amp;#x80FD;&amp;#x5230;&amp;#x8FBE;&amp;#x3002;&amp;#x5C3D;&amp;#x7BA1; $ {\rm low}(u) $ &amp;#x53EF;&amp;#x80FD;&amp;#x4E0D;&amp;#x662F; $ v $ &amp;#x7684;&amp;#x7956;&amp;#x5148;&amp;#xFF08;&amp;#x53EF;&amp;#x80FD;&amp;#x662F; $ u $ &amp;#x6216; $ v $ &amp;#x672C;&amp;#x8EAB;&amp;#xFF09;&amp;#xFF0C;&amp;#x4F46;&amp;#x8FD9;&amp;#x5E76;&amp;#x4E0D;&amp;#x5F71;&amp;#x54CD;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x6240;&amp;#x6709;&amp;#x90BB;&amp;#x63A5;&amp;#x70B9;&amp;#x56DE;&amp;#x6EAF;&amp;#x5B8C;&amp;#x6210;&amp;#x540E;&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x5F53;&amp;#x524D;&amp;#x70B9;&amp;#x4ECD;&amp;#x6EE1;&amp;#x8DB3;&lt;/p&gt;
&lt;p&gt;$$ {\rm low}(v) = {\rm dfn}(v) $$&lt;/p&gt;
&lt;p&gt;&amp;#x8BF4;&amp;#x660E;&amp;#x4ECE;&amp;#x5F53;&amp;#x524D;&amp;#x70B9;&amp;#x51FA;&amp;#x53D1;&amp;#x4E0D;&amp;#x53EF;&amp;#x80FD;&amp;#x56DE;&amp;#x5230;&amp;#x4EFB;&amp;#x610F;&amp;#x4E00;&amp;#x4E2A;&amp;#x641C;&amp;#x7D22;&amp;#x6811;&amp;#x4E0A;&amp;#x7684;&amp;#x7956;&amp;#x5148;&amp;#xFF0C;&amp;#x5373;&amp;#x5F53;&amp;#x524D;&amp;#x8282;&amp;#x70B9;&amp;#x662F;&amp;#x67D0;&amp;#x4E2A;&amp;#x5F3A;&amp;#x8054;&amp;#x901A;&amp;#x5206;&amp;#x91CF;&amp;#x6240;&amp;#x5728;&amp;#x5B50;&amp;#x6811;&amp;#x7684;&amp;#x6839;&amp;#x8282;&amp;#x70B9;&amp;#xFF0C;&amp;#x800C;&amp;#x8FD9;&amp;#x4E9B;&amp;#x8282;&amp;#x70B9;&amp;#x90FD;&amp;#x5728;&amp;#x5F53;&amp;#x524D;&amp;#x8282;&amp;#x70B9;&amp;#x4E4B;&amp;#x540E;&amp;#x88AB;&amp;#x538B;&amp;#x5728;&amp;#x4E86;&amp;#x6808;&amp;#x4E2D;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x6CE8;&amp;#x610F;&amp;#xFF0C;$ {\rm low} $ &amp;#x503C;&amp;#x76F8;&amp;#x540C;&amp;#x7684;&amp;#x4E24;&amp;#x4E2A;&amp;#x70B9;&lt;strong&gt;&amp;#x4E00;&amp;#x5B9A;&lt;/strong&gt;&amp;#x5728;&amp;#x540C;&amp;#x4E00;&amp;#x4E2A;&amp;#x5F3A;&amp;#x8054;&amp;#x901A;&amp;#x5206;&amp;#x91CF;&amp;#x4E2D;&amp;#xFF0C;&amp;#x4F46;&amp;#x53CD;&amp;#x4E4B;&amp;#x4E0D;&amp;#x6210;&amp;#x7ACB;&amp;#xFF0C;&amp;#x540C;&amp;#x4E00;&amp;#x4E2A;&amp;#x5F3A;&amp;#x8054;&amp;#x901A;&amp;#x5206;&amp;#x91CF;&amp;#x7684;&amp;#x70B9;&amp;#x53EF;&amp;#x80FD;&amp;#x6709;&amp;#x4E0D;&amp;#x540C;&amp;#x7684; $ {\rm low} $ &amp;#x503C;&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x6A21;&amp;#x677F;&quot;&gt;&amp;#x6A21;&amp;#x677F;&lt;/h3&gt;
&lt;p&gt;&amp;#x5B9E;&amp;#x9645;&amp;#x4EE3;&amp;#x7801;&amp;#x4E2D;&amp;#x8981;&amp;#x7528;&amp;#x5230;&amp;#x4E24;&amp;#x4E2A;&amp;#x6808;&amp;#xFF0C;&amp;#x4E00;&amp;#x4E2A;&amp;#x7528;&amp;#x4E8E;&amp;#x63A7;&amp;#x5236; DFS&amp;#xFF08;&amp;#x4EE3;&amp;#x7801;&amp;#x4E2D;&amp;#x7684; &lt;code&gt;s&lt;/code&gt;&amp;#xFF09;&amp;#xFF0C;&amp;#x53E6;&amp;#x4E00;&amp;#x4E2A;&amp;#x7528;&amp;#x4E8E; Tarjan &amp;#x7B97;&amp;#x6CD5;&amp;#xFF08;&amp;#x4EE3;&amp;#x7801;&amp;#x4E2D;&amp;#x7684; &lt;code&gt;t&lt;/code&gt;&amp;#xFF09;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x56E0;&amp;#x4E3A;&amp;#x56FE;&amp;#x4E0D;&amp;#x4E00;&amp;#x5B9A;&amp;#x662F;&amp;#x5F31;&amp;#x8FDE;&amp;#x901A;&amp;#x56FE;&amp;#xFF0C;&amp;#x6240;&amp;#x4EE5;&amp;#x8981;&amp;#x4EE5;&amp;#x6BCF;&amp;#x4E2A;&amp;#x70B9;&amp;#x4E3A;&amp;#x8D77;&amp;#x70B9;&amp;#x8FDB;&amp;#x884C;&amp;#x4E00;&amp;#x6B21;&amp;#x4E0A;&amp;#x8FF0;&amp;#x7B97;&amp;#x6CD5;&amp;#x3002;&lt;/p&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Node {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Edge *firstEdge, *currentEdge, *inEdge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Connected *connected;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; dfn, low;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; inStack, visited, pushed;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} nodes[MAXN];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Edge {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Node *from, *to;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Edge *next;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Edge(Node *from, Node *to) : from(from), to(to), next(from-&amp;gt;firstEdge) {}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;};&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Connected {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; size;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} connecteds[MAXN];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;tarjan&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; timeStamp = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, count = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (nodes[i].visited) &lt;span class=&quot;keyword&quot;&gt;continue&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;stack&lt;/span&gt;&amp;lt;Node *&amp;gt; s, t;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		s.push(&amp;amp;nodes[i]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		nodes[i].pushed = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (!s.empty()) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			Node *v = s.top();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!v-&amp;gt;visited) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				v-&amp;gt;visited = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				v-&amp;gt;currentEdge = v-&amp;gt;firstEdge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				v-&amp;gt;dfn = v-&amp;gt;low = timeStamp++;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				v-&amp;gt;inStack = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				t.push(v);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (v-&amp;gt;currentEdge) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				Edge *&amp;amp;e = v-&amp;gt;currentEdge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!e-&amp;gt;to-&amp;gt;pushed) s.push(e-&amp;gt;to), e-&amp;gt;to-&amp;gt;pushed = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;, e-&amp;gt;to-&amp;gt;inEdge = e;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (e-&amp;gt;to-&amp;gt;inStack) v-&amp;gt;low = &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::min(v-&amp;gt;low, e-&amp;gt;to-&amp;gt;dfn);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				e = e-&amp;gt;next;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			} &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (v-&amp;gt;dfn == v-&amp;gt;low) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					v-&amp;gt;connected = &amp;amp;connecteds[count++];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					Node *u;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;keyword&quot;&gt;do&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;						u = t.top();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;						t.pop();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;						u-&amp;gt;inStack = &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;						u-&amp;gt;connected = v-&amp;gt;connected;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;						u-&amp;gt;connected-&amp;gt;size++;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					} &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (u != v);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (v-&amp;gt;inEdge) v-&amp;gt;inEdge-&amp;gt;from-&amp;gt;low = &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::min(v-&amp;gt;inEdge-&amp;gt;from-&amp;gt;low, v-&amp;gt;low);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				s.pop();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; count;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x5728;&amp;#x4E00;&amp;#x4E2A;&amp;#x6709;&amp;#x5411;&amp;#x56FE;&amp;#x4E2D;&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x67D0;&amp;#x4E24;&amp;#x70B9;&amp;#x95F4;&amp;#x90FD;&amp;#x6709;&lt;strong&gt;&amp;#x4E92;&amp;#x76F8;&lt;/strong&gt;&amp;#x5230;&amp;#x8FBE;&amp;#x7684;&amp;#x8DEF;&amp;#x5F84;&amp;#xFF0C;&amp;#x90A3;&amp;#x4E48;&amp;#x79F0;&amp;#x4E2D;&amp;#x4E24;&amp;#x4E2A;&amp;#x70B9;&lt;strong&gt;&amp;#x5F3A;&amp;#x8054;&amp;#x901A;&lt;/strong&gt;&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x4EFB;&amp;#x610F;&amp;#x4E24;&amp;#x70B9;&amp;#x90FD;&amp;#x5F3A;&amp;#x8054;&amp;#x901A;&amp;#xFF0C;&amp;#x90A3;&amp;#x4E48;&amp;#x79F0;&amp;#x8FD9;&amp;#x4E2A;&amp;#x56FE;&amp;#x4E3A;&lt;strong&gt;&amp;#x5F3A;&amp;#x8054;&amp;#x901A;&amp;#x56FE;&lt;/strong&gt;&amp;#xFF1B;&amp;#x4E00;&amp;#x4E2A;&amp;#x6709;&amp;#x5411;&amp;#x56FE;&amp;#x7684;&lt;strong&gt;&amp;#x6781;&amp;#x5927;&lt;/strong&gt;&amp;#x5F3A;&amp;#x8054;&amp;#x901A;&amp;#x5B50;&amp;#x56FE;&amp;#x79F0;&amp;#x4E3A;&lt;strong&gt;&amp;#x5F3A;&amp;#x8054;&amp;#x901A;&amp;#x5206;&amp;#x91CF;&lt;/strong&gt;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;Tarjan &amp;#x7B97;&amp;#x6CD5;&amp;#x53EF;&amp;#x4EE5;&amp;#x5728; $ O(n + m) $ &amp;#x7684;&amp;#x65F6;&amp;#x95F4;&amp;#x5185;&amp;#x6C42;&amp;#x51FA;&amp;#x4E00;&amp;#x4E2A;&amp;#x56FE;&amp;#x7684;&amp;#x6240;&amp;#x6709;&amp;#x5F3A;&amp;#x8054;&amp;#x901A;&amp;#x5206;&amp;#x91CF;&amp;#x3002;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="Tarjan" scheme="https://blog.menci.moe/tag/tarjan/"/>
    
      <category term="图论" scheme="https://blog.menci.moe/tag/%E5%9B%BE%E8%AE%BA/"/>
    
      <category term="学习笔记" scheme="https://blog.menci.moe/tag/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
      <category term="强联通分量" scheme="https://blog.menci.moe/tag/%E5%BC%BA%E8%81%94%E9%80%9A%E5%88%86%E9%87%8F/"/>
    
  </entry>
  
  <entry>
    <title>「SDOI2010」星际竞速 - 费用流</title>
    <link href="https://blog.menci.moe/sdoi2010-starrace/"/>
    <id>https://blog.menci.moe/sdoi2010-starrace/</id>
    <published>2016-02-29T13:30:11.000Z</published>
    <updated>2016-02-29T13:32:11.000Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x5927;&amp;#x8D5B;&amp;#x8981;&amp;#x6C42;&amp;#x8F66;&amp;#x624B;&amp;#x4EEC;&amp;#x4ECE;&amp;#x4E00;&amp;#x9897;&amp;#x4E0E;&amp;#x8FD9; $ N $ &amp;#x9897;&amp;#x884C;&amp;#x661F;&amp;#x4E4B;&amp;#x95F4;&amp;#x6CA1;&amp;#x6709;&amp;#x4EFB;&amp;#x4F55;&amp;#x822A;&amp;#x8DEF;&amp;#x7684;&amp;#x5929;&amp;#x4F53;&amp;#x51FA;&amp;#x53D1;&amp;#xFF0C;&amp;#x8BBF;&amp;#x95EE;&amp;#x8FD9; $ N $ &amp;#x9897;&amp;#x884C;&amp;#x661F;&amp;#x6BCF;&amp;#x9897;&amp;#x6070;&amp;#x597D;&amp;#x4E00;&amp;#x6B21;&amp;#x3002;&amp;#x8D85;&amp;#x80FD;&amp;#x7535;&amp;#x9A74;&amp;#x6709;&amp;#x4E24;&amp;#x79CD;&amp;#x79FB;&amp;#x52A8;&amp;#x6A21;&amp;#x5F0F;&amp;#xFF1A;&amp;#x9AD8;&amp;#x901F;&amp;#x822A;&amp;#x884C;&amp;#x6A21;&amp;#x5F0F;&amp;#x548C;&amp;#x80FD;&amp;#x529B;&amp;#x7206;&amp;#x53D1;&amp;#x6A21;&amp;#x5F0F;&amp;#x3002;&amp;#x5728;&amp;#x9AD8;&amp;#x901F;&amp;#x822A;&amp;#x884C;&amp;#x6A21;&amp;#x5F0F;&amp;#x4E0B;&amp;#xFF0C;&amp;#x8D85;&amp;#x80FD;&amp;#x7535;&amp;#x9A74;&amp;#x4F1A;&amp;#x6CBF;&amp;#x661F;&amp;#x9645;&amp;#x822A;&amp;#x8DEF;&amp;#x9AD8;&amp;#x901F;&amp;#x822A;&amp;#x884C;&amp;#x3002;&amp;#x5728;&amp;#x80FD;&amp;#x529B;&amp;#x7206;&amp;#x53D1;&amp;#x6A21;&amp;#x5F0F;&amp;#x4E0B;&amp;#xFF0C;&amp;#x7ECF;&amp;#x8FC7;&amp;#x4E00;&amp;#x6BB5;&amp;#x65F6;&amp;#x95F4;&amp;#x7684;&amp;#x5B9A;&amp;#x4F4D;&amp;#x4E4B;&amp;#x540E;&amp;#xFF0C;&amp;#x5B83;&amp;#x80FD;&amp;#x77AC;&amp;#x95F4;&amp;#x79FB;&amp;#x52A8;&amp;#x5230;&amp;#x4EFB;&amp;#x610F;&amp;#x4E00;&amp;#x4E2A;&amp;#x884C;&amp;#x661F;&amp;#x3002;&amp;#x5728;&amp;#x4F7F;&amp;#x7528;&amp;#x9AD8;&amp;#x901F;&amp;#x822A;&amp;#x884C;&amp;#x6A21;&amp;#x5F0F;&amp;#x7684;&amp;#x65F6;&amp;#x5019;&amp;#xFF0C;&amp;#x53EA;&amp;#x80FD;&amp;#x7531;&amp;#x6BCF;&amp;#x4E2A;&amp;#x661F;&amp;#x7403;&amp;#x98DE;&amp;#x5F80;&amp;#x5F15;&amp;#x529B;&amp;#x6BD4;&amp;#x5B83;&amp;#x5927;&amp;#x7684;&amp;#x661F;&amp;#x7403;&amp;#xFF0C;&amp;#x5426;&amp;#x5219;&amp;#x8D5B;&amp;#x8F66;&amp;#x5C31;&amp;#x4F1A;&amp;#x53D1;&amp;#x751F;&amp;#x7206;&amp;#x70B8;&amp;#x3002;&amp;#x6C42;&amp;#x5B8C;&amp;#x6210;&amp;#x6BD4;&amp;#x8D5B;&amp;#x7684;&amp;#x6700;&amp;#x5C11;&amp;#x65F6;&amp;#x95F4;&amp;#x3002;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;&amp;#x9898;&amp;#x76EE;&amp;#x94FE;&amp;#x63A5;&quot;&gt;&amp;#x9898;&amp;#x76EE;&amp;#x94FE;&amp;#x63A5;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://www.lydsy.com/JudgeOnline/problem.php?id=1927&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;BZOJ 1927&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://codevs.cn/problem/2313/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;CodeVS 2313&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x89E3;&amp;#x9898;&amp;#x601D;&amp;#x8DEF;&quot;&gt;&amp;#x89E3;&amp;#x9898;&amp;#x601D;&amp;#x8DEF;&lt;/h3&gt;
&lt;p&gt;&amp;#x6C42;&amp;#x5B8C;&amp;#x6210;&amp;#x6BD4;&amp;#x8D5B;&amp;#x7684;&amp;#x6700;&amp;#x5C11;&amp;#x65F6;&amp;#x95F4;&amp;#xFF0C;&amp;#x5F88;&amp;#x5BB9;&amp;#x6613;&amp;#x60F3;&amp;#x5230;&amp;#x6700;&amp;#x77ED;&amp;#x8DEF;&amp;#xFF0C;&amp;#x7136;&amp;#x800C;&amp;#x4E0D;&amp;#x786E;&amp;#x5B9A;&amp;#x8D77;&amp;#x70B9;&amp;#x7EC8;&amp;#x70B9;&amp;#x800C;&amp;#x4E14;&amp;#x6070;&amp;#x597D;&amp;#x8BBF;&amp;#x95EE;&amp;#x4E00;&amp;#x6B21;&amp;#x90FD;&amp;#x4E0D;&amp;#x592A;&amp;#x9002;&amp;#x5408;&amp;#x6700;&amp;#x77ED;&amp;#x8DEF; &amp;#x2026;&amp;#x2026; &amp;#x8003;&amp;#x8651;&amp;#x7F51;&amp;#x7EDC;&amp;#x6D41;&amp;#x5EFA;&amp;#x6A21;&amp;#x5427;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x521A;&amp;#x5F00;&amp;#x59CB;&amp;#x60F3;&amp;#x5230;&amp;#x7684;&amp;#x4E00;&amp;#x4E2A;&lt;strong&gt;&amp;#x9519;&amp;#x8BEF;&lt;/strong&gt;&amp;#x7684;&amp;#x89E3;&amp;#x6CD5;&amp;#xFF1A;&lt;/p&gt;
&lt;ol style=&quot;list-style-type: decimal&quot;&gt;
&lt;li&gt;&amp;#x628A;&amp;#x6BCF;&amp;#x4E2A;&amp;#x70B9;&amp;#x62C6;&amp;#x6210;&amp;#x4E24;&amp;#x4E2A;&amp;#x70B9;&amp;#xFF0C;&amp;#x4E00;&amp;#x4E2A;&amp;#x8868;&amp;#x793A;&amp;#x5165;&amp;#x53E6;&amp;#x4E00;&amp;#x4E2A;&amp;#x8868;&amp;#x793A;&amp;#x51FA;&amp;#xFF0C;&amp;#x4E4B;&amp;#x95F4;&amp;#x8FDE;&amp;#x4E00;&amp;#x6761;&amp;#x5BB9;&amp;#x91CF;&amp;#x4E3A; 1&amp;#xFF0C;&amp;#x8D39;&amp;#x7528;&amp;#x4E3A;&amp;#x96F6;&amp;#x7684;&amp;#x8FB9;&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x4ECE;&amp;#x6E90;&amp;#x70B9;&amp;#x5230;&amp;#x6BCF;&amp;#x4E2A;&amp;#x5165;&amp;#x70B9;&amp;#x8FDE;&amp;#x4E00;&amp;#x6761;&amp;#x5BB9;&amp;#x91CF;&amp;#x4E3A; 1 &amp;#x8D39;&amp;#x7528;&amp;#x4E3A;&amp;#x96F6;&amp;#x7684;&amp;#x8FB9;&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x4ECE;&amp;#x6BCF;&amp;#x4E2A;&amp;#x51FA;&amp;#x70B9;&amp;#x5230;&amp;#x6C47;&amp;#x70B9;&amp;#x8FDE;&amp;#x4E00;&amp;#x6761;&amp;#x5BB9;&amp;#x91CF;&amp;#x4E3A; 1 &amp;#x8D39;&amp;#x7528;&amp;#x4E3A;&amp;#x96F6;&amp;#x7684;&amp;#x8FB9;&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x5BF9;&amp;#x4E8E;&amp;#x6BCF;&amp;#x4E2A;&amp;#x70B9;&amp;#xFF0C;&amp;#x4ECE;&amp;#x5B83;&amp;#x7684;&amp;#x51FA;&amp;#x70B9;&amp;#x5230;&amp;#x6240;&amp;#x6709;&amp;#x4ED6;&amp;#x6240;&amp;#x80FD;&amp;#x5230;&amp;#x8FBE;&amp;#x7684;&amp;#x70B9;&amp;#x7684;&amp;#x5165;&amp;#x70B9;&amp;#x8FDE;&amp;#x4E00;&amp;#x6761;&amp;#x5BB9;&amp;#x91CF;&amp;#x4E3A; 1 &amp;#x8D39;&amp;#x7528;&amp;#x4E3A;&amp;#x822A;&amp;#x884C;&amp;#x65F6;&amp;#x95F4;&amp;#x7684;&amp;#x8FB9;&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x5EFA;&amp;#x7ACB;&amp;#x300E;&amp;#x4E2D;&amp;#x8F6C;&amp;#x7AD9;&amp;#x300F;&amp;#xFF0C;&amp;#x4ECE;&amp;#x6BCF;&amp;#x4E2A;&amp;#x70B9;&amp;#x5230;&amp;#x4E2D;&amp;#x8F6C;&amp;#x7AD9;&amp;#x8FDE;&amp;#x4E00;&amp;#x6761;&amp;#x5BB9;&amp;#x91CF;&amp;#x4E3A; 1 &amp;#x8D39;&amp;#x7528;&amp;#x4E3A; 0 &amp;#x7684;&amp;#x8FB9;&amp;#xFF1B;&amp;#x4ECE;&amp;#x4E2D;&amp;#x8F6C;&amp;#x7AD9;&amp;#x5230;&amp;#x6BCF;&amp;#x4E2A;&amp;#x70B9;&amp;#x8FDE;&amp;#x4E00;&amp;#x6761;&amp;#x5BB9;&amp;#x91CF;&amp;#x4E3A; 1 &amp;#x8D39;&amp;#x7528;&amp;#x4E3A;&amp;#x5B9A;&amp;#x4F4D;&amp;#x65F6;&amp;#x95F4;&amp;#x7684;&amp;#x8FB9;&amp;#x3002;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&amp;#x6C42;&amp;#x51FA;&amp;#x6700;&amp;#x5C0F;&amp;#x8D39;&amp;#x7528;&amp;#x6700;&amp;#x5927;&amp;#x6D41; &amp;#x2026;&amp;#x2026; &amp;#x5443;&amp;#xFF0C;&amp;#x7B54;&amp;#x6848;&amp;#x5C31;&amp;#x662F;&amp;#x96F6; &amp;#x2026;&amp;#x2026;&lt;/p&gt;
&lt;p&gt;&amp;#x5F88;&amp;#x5BB9;&amp;#x6613;&amp;#x60F3;&amp;#x51FA;&amp;#x4E0A;&amp;#x9762;&amp;#x7684;&amp;#x6A21;&amp;#x578B;&amp;#x662F;&amp;#x9519;&amp;#x7684;&amp;#xFF0C;&amp;#x56E0;&amp;#x4E3A;&amp;#x5B83;&amp;#x4E0D;&amp;#x80FD;&amp;#x4FDD;&amp;#x8BC1;&amp;#x6BCF;&amp;#x4E2A;&amp;#x70B9;&amp;#x90FD;&amp;#x88AB;&amp;#x8BBF;&amp;#x95EE;&amp;#x8FC7; &amp;#x2014;&amp;#x2014; &amp;#x867D;&amp;#x7136;&amp;#x5B83;&amp;#x6BD4;&amp;#x8F83;&amp;#x76F4;&amp;#x89C2;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x518D;&amp;#x6765;&amp;#x5206;&amp;#x6790;&amp;#x4E00;&amp;#x4E0B;&amp;#x9898;&amp;#x610F;&amp;#xFF0C;&amp;#x6BCF;&amp;#x4E2A;&amp;#x70B9;&amp;#x90FD;&amp;#x7ECF;&amp;#x8FC7;&amp;#x4E00;&amp;#x6B21;&amp;#xFF0C;&amp;#x6709;&amp;#x70B9;&amp;#x7C7B;&amp;#x4F3C;&amp;#x8DEF;&amp;#x5F84;&amp;#x8986;&amp;#x76D6;&amp;#xFF0C;&amp;#x800C;&amp;#x8DEF;&amp;#x5F84;&amp;#x8986;&amp;#x76D6;&amp;#x4E2D;&amp;#x662F;&amp;#x6CA1;&amp;#x6709;&amp;#x8FB9;&amp;#x6743;&amp;#x7684;&amp;#xFF0C;&amp;#x8003;&amp;#x8651;&amp;#x628A;&amp;#x8FB9;&amp;#x6743;&amp;#x52A0;&amp;#x5728;&amp;#x8D39;&amp;#x7528;&amp;#x4E0A;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x4E00;&amp;#x79CD;&lt;strong&gt;&amp;#x7C7B;&amp;#x4F3C;&amp;#x4E8E;&amp;#x8DEF;&amp;#x5F84;&amp;#x8986;&amp;#x76D6;&lt;/strong&gt;&amp;#x7684;&amp;#x5EFA;&amp;#x6A21;&amp;#x65B9;&amp;#x5F0F;&amp;#xFF1A;&lt;/p&gt;
&lt;ol style=&quot;list-style-type: decimal&quot;&gt;
&lt;li&gt;&amp;#x628A;&amp;#x6BCF;&amp;#x4E2A;&amp;#x70B9;&amp;#x62C6;&amp;#x6210;&amp;#x4E24;&amp;#x4E2A;&amp;#x70B9;&amp;#xFF0C;&amp;#x4E00;&amp;#x4E2A;&amp;#x8868;&amp;#x793A;&amp;#x5165;&amp;#x53E6;&amp;#x4E00;&amp;#x4E2A;&amp;#x8868;&amp;#x793A;&amp;#x51FA;&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x4ECE;&amp;#x6E90;&amp;#x70B9;&amp;#x5411;&amp;#x6BCF;&amp;#x4E2A;&amp;#x5165;&amp;#x70B9;&amp;#x8FDE;&amp;#x4E00;&amp;#x6761;&amp;#x5BB9;&amp;#x91CF;&amp;#x4E3A; 1 &amp;#x8D39;&amp;#x7528;&amp;#x4E3A;&amp;#x96F6;&amp;#x7684;&amp;#x8FB9;&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x4ECE;&amp;#x6BCF;&amp;#x4E2A;&amp;#x51FA;&amp;#x70B9;&amp;#x5411;&amp;#x6C47;&amp;#x70B9;&amp;#x8FDE;&amp;#x4E00;&amp;#x6761;&amp;#x5BB9;&amp;#x91CF;&amp;#x4E3A; 1 &amp;#x8D39;&amp;#x7528;&amp;#x4E3A;&amp;#x96F6;&amp;#x7684;&amp;#x8FB9;&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x5BF9;&amp;#x4E8E;&amp;#x6BCF;&amp;#x4E2A;&amp;#x70B9;&amp;#xFF0C;&amp;#x4ECE;&amp;#x5B83;&amp;#x7684;&amp;#x51FA;&amp;#x70B9;&amp;#x5230;&amp;#x6240;&amp;#x6709;&amp;#x4ED6;&amp;#x6240;&amp;#x80FD;&amp;#x5230;&amp;#x8FBE;&amp;#x7684;&amp;#x70B9;&amp;#x7684;&amp;#x5165;&amp;#x70B9;&amp;#x8FDE;&amp;#x4E00;&amp;#x6761;&amp;#x5BB9;&amp;#x91CF;&amp;#x4E3A; 1 &amp;#x8D39;&amp;#x7528;&amp;#x4E3A;&amp;#x822A;&amp;#x884C;&amp;#x65F6;&amp;#x95F4;&amp;#x7684;&amp;#x8FB9;&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x4ECE;&amp;#x6E90;&amp;#x70B9;&amp;#x5411;&amp;#x6BCF;&amp;#x4E2A;&lt;strong&gt;&amp;#x51FA;&amp;#x70B9;&lt;/strong&gt;&amp;#x8FDE;&amp;#x4E00;&amp;#x6761;&amp;#x5BB9;&amp;#x91CF;&amp;#x4E3A; 1 &amp;#x8D39;&amp;#x7528;&amp;#x4E3A;&amp;#x5B9A;&amp;#x4F4D;&amp;#x65F6;&amp;#x95F4;&amp;#x7684;&amp;#x8FB9;&amp;#x3002;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&amp;#x8FD9;&amp;#x79CD;&amp;#x5EFA;&amp;#x6A21;&amp;#x601D;&amp;#x60F3;&amp;#x6293;&amp;#x4F4F;&amp;#x4E86;&amp;#x9898;&amp;#x76EE;&amp;#x4E2D;&amp;#x300E;&amp;#x6BCF;&amp;#x4E2A;&amp;#x70B9;&amp;#x7ECF;&amp;#x8FC7;&amp;#x4E00;&amp;#x6B21;&amp;#x300F;&amp;#x7684;&amp;#x6761;&amp;#x4EF6;&amp;#xFF0C;&amp;#x907F;&amp;#x5F00;&amp;#x4E86;&amp;#x8DEF;&amp;#x5F84;&amp;#x4E0A;&amp;#x7684;&amp;#x95EE;&amp;#x9898; &amp;#x2014;&amp;#x2014; &amp;#x6574;&amp;#x4E2A;&amp;#x7F51;&amp;#x7EDC;&amp;#x4FDD;&amp;#x8BC1;&amp;#x4E86;&amp;#x5230;&amp;#x6C47;&amp;#x70B9;&amp;#x8FB9;&amp;#x5168;&amp;#x90E8;&amp;#x6EE1;&amp;#x6D41;&amp;#xFF0C;&amp;#x4E5F;&amp;#x5C31;&amp;#x5BF9;&amp;#x5E94;&amp;#x4E86;&amp;#x6BCF;&amp;#x4E2A;&amp;#x70B9;&amp;#x88AB;&amp;#x7ECF;&amp;#x8FC7;&amp;#x4E00;&amp;#x6B21;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x5904;&amp;#x7406;&amp;#x300E;&amp;#x77AC;&amp;#x95F4;&amp;#x79FB;&amp;#x52A8;&amp;#x300F;&amp;#x7684;&amp;#x601D;&amp;#x8DEF;&amp;#x662F;&amp;#xFF0C;&amp;#x4E0D;&amp;#x8003;&amp;#x8651;&amp;#x662F;&amp;#x4ECE;&amp;#x54EA;&amp;#x4E2A;&amp;#x661F;&amp;#x7403;&amp;#x79FB;&amp;#x52A8;&amp;#x8FC7;&amp;#x6765;&amp;#xFF0C;&amp;#x5411;&amp;#x54EA;&amp;#x91CC;&amp;#x8D70; &amp;#x2014;&amp;#x2014; &amp;#x56E0;&amp;#x4E3A;&amp;#x4ECE;&amp;#x6BCF;&amp;#x4E2A;&amp;#x70B9;&amp;#x5411;&amp;#x54EA;&amp;#x91CC;&amp;#x8D70;&amp;#x662F;&amp;#x7531;&amp;#x9009;&amp;#x62E9;&amp;#x7684;&amp;#x8FB9;&amp;#x51B3;&amp;#x5B9A;&amp;#x7684;&amp;#xFF08;&amp;#x751A;&amp;#x81F3;&amp;#x53EF;&amp;#x80FD;&amp;#x77AC;&amp;#x79FB;&amp;#x5230;&amp;#x7684;&amp;#x70B9;&amp;#x5C31;&amp;#x662F;&amp;#x7EC8;&amp;#x70B9;&amp;#xFF09;&amp;#xFF0C;&amp;#x53EA;&amp;#x9700;&amp;#x8981;&amp;#x8003;&amp;#x8651;&amp;#xFF0C;&amp;#x77AC;&amp;#x79FB;&amp;#x7ECF;&amp;#x8FC7;&amp;#x7684;&amp;#x70B9;&amp;#x4E0D;&amp;#x9700;&amp;#x8981;&amp;#x518D;&amp;#x5728;&amp;#x5176;&amp;#x4ED6;&amp;#x8DEF;&amp;#x5F84;&amp;#x4E0A;&amp;#x88AB;&amp;#x7ECF;&amp;#x8FC7;&amp;#xFF0C;&amp;#x6240;&amp;#x4EE5;&amp;#x76F4;&amp;#x63A5;&amp;#x4ECE;&amp;#x6E90;&amp;#x70B9;&amp;#x8FDE;&amp;#x5230;&amp;#x67D0;&amp;#x4E2A;&amp;#x70B9;&amp;#x7684;&amp;#x51FA;&amp;#x70B9;&amp;#x5C31;&amp;#x597D;&amp;#x5566;&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;ac&amp;#x4EE3;&amp;#x7801;&quot;&gt;AC&amp;#x4EE3;&amp;#x7801;&lt;/h3&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;93&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;94&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;95&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;96&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;97&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;98&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;99&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;100&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;101&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;102&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;103&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;104&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;105&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;106&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;107&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;108&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;109&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;110&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;111&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;112&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;113&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;114&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;115&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;116&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;117&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;climits&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;algorithm&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;queue&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXN = &lt;span class=&quot;number&quot;&gt;800&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXM = &lt;span class=&quot;number&quot;&gt;15000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Node;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Edge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Node {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Edge *firstEdge, *inEdge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; flow, dist;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; inQueue;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} nodes[MAXN * &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; + &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Edge {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Node *from, *to;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; capacity, flow, cost;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Edge *next, *reversedEdge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Edge(Node *from, Node *to, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; capacity, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; cost) : from(from), to(to), capacity(capacity), flow(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;), cost(cost), next(from-&amp;gt;firstEdge) {}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;};&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; EdmondsKarp {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;bellmanford&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Node *s, Node *t, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &amp;amp;flow, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &amp;amp;cost)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			nodes[i].inEdge = &lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			nodes[i].flow = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			nodes[i].dist = INT_MAX;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			nodes[i].inQueue = &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;queue&lt;/span&gt;&amp;lt;Node *&amp;gt; q;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		q.push(s);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		s-&amp;gt;flow = INT_MAX;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		s-&amp;gt;dist = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (!q.empty()) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			Node *v = q.front();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			q.pop();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			v-&amp;gt;inQueue = &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (Edge *e = v-&amp;gt;firstEdge; e; e = e-&amp;gt;next) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (e-&amp;gt;flow &amp;lt; e-&amp;gt;capacity &amp;amp;&amp;amp; e-&amp;gt;to-&amp;gt;dist &amp;gt; v-&amp;gt;dist + e-&amp;gt;cost) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					e-&amp;gt;to-&amp;gt;dist = v-&amp;gt;dist + e-&amp;gt;cost;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					e-&amp;gt;to-&amp;gt;inEdge = e;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					e-&amp;gt;to-&amp;gt;flow = &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::min(v-&amp;gt;flow, e-&amp;gt;capacity - e-&amp;gt;flow);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!e-&amp;gt;to-&amp;gt;inQueue) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;						q.push(e-&amp;gt;to);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;						e-&amp;gt;to-&amp;gt;inQueue = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (t-&amp;gt;dist == INT_MAX) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (Edge *e = t-&amp;gt;inEdge; e; e = e-&amp;gt;from-&amp;gt;inEdge) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			e-&amp;gt;flow += t-&amp;gt;flow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			e-&amp;gt;reversedEdge-&amp;gt;flow -= t-&amp;gt;flow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		flow += t-&amp;gt;flow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		cost += t-&amp;gt;flow * t-&amp;gt;dist;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;operator&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; s, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; t, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &amp;amp;flow, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &amp;amp;cost)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		flow = cost = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (bellmanford(&amp;amp;nodes[s], &amp;amp;nodes[t], n, flow, cost));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} edmondskarp;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;addEdge&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; from, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; to, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; capacity, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; cost)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	nodes[from].firstEdge = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Edge(&amp;amp;nodes[from], &amp;amp;nodes[to], capacity, cost);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	nodes[to].firstEdge = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Edge(&amp;amp;nodes[to], &amp;amp;nodes[from], &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, -cost);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	nodes[from].firstEdge-&amp;gt;reversedEdge = nodes[to].firstEdge, nodes[to].firstEdge-&amp;gt;reversedEdge = nodes[from].firstEdge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, m;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d&amp;quot;&lt;/span&gt;, &amp;amp;n, &amp;amp;m);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; s = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, t = n * &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; x;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;x);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		addEdge(s, i + n, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, x);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		addEdge(s, i, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		addEdge(i + n, t, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; m; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; u, v, w;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d %d&amp;quot;&lt;/span&gt;, &amp;amp;u, &amp;amp;v, &amp;amp;w);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (u &amp;gt; v) &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::swap(u, v);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		addEdge(u, v + n, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, w);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; flow, cost;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	edmondskarp(s, t, n * &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; + &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, flow, cost);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d\n&amp;quot;&lt;/span&gt;, cost);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x5927;&amp;#x8D5B;&amp;#x8981;&amp;#x6C42;&amp;#x8F66;&amp;#x624B;&amp;#x4EEC;&amp;#x4ECE;&amp;#x4E00;&amp;#x9897;&amp;#x4E0E;&amp;#x8FD9; $ N $ &amp;#x9897;&amp;#x884C;&amp;#x661F;&amp;#x4E4B;&amp;#x95F4;&amp;#x6CA1;&amp;#x6709;&amp;#x4EFB;&amp;#x4F55;&amp;#x822A;&amp;#x8DEF;&amp;#x7684;&amp;#x5929;&amp;#x4F53;&amp;#x51FA;&amp;#x53D1;&amp;#xFF0C;&amp;#x8BBF;&amp;#x95EE;&amp;#x8FD9; $ N $ &amp;#x9897;&amp;#x884C;&amp;#x661F;&amp;#x6BCF;&amp;#x9897;&amp;#x6070;&amp;#x597D;&amp;#x4E00;&amp;#x6B21;&amp;#x3002;&amp;#x8D85;&amp;#x80FD;&amp;#x7535;&amp;#x9A74;&amp;#x6709;&amp;#x4E24;&amp;#x79CD;&amp;#x79FB;&amp;#x52A8;&amp;#x6A21;&amp;#x5F0F;&amp;#xFF1A;&amp;#x9AD8;&amp;#x901F;&amp;#x822A;&amp;#x884C;&amp;#x6A21;&amp;#x5F0F;&amp;#x548C;&amp;#x80FD;&amp;#x529B;&amp;#x7206;&amp;#x53D1;&amp;#x6A21;&amp;#x5F0F;&amp;#x3002;&amp;#x5728;&amp;#x9AD8;&amp;#x901F;&amp;#x822A;&amp;#x884C;&amp;#x6A21;&amp;#x5F0F;&amp;#x4E0B;&amp;#xFF0C;&amp;#x8D85;&amp;#x80FD;&amp;#x7535;&amp;#x9A74;&amp;#x4F1A;&amp;#x6CBF;&amp;#x661F;&amp;#x9645;&amp;#x822A;&amp;#x8DEF;&amp;#x9AD8;&amp;#x901F;&amp;#x822A;&amp;#x884C;&amp;#x3002;&amp;#x5728;&amp;#x80FD;&amp;#x529B;&amp;#x7206;&amp;#x53D1;&amp;#x6A21;&amp;#x5F0F;&amp;#x4E0B;&amp;#xFF0C;&amp;#x7ECF;&amp;#x8FC7;&amp;#x4E00;&amp;#x6BB5;&amp;#x65F6;&amp;#x95F4;&amp;#x7684;&amp;#x5B9A;&amp;#x4F4D;&amp;#x4E4B;&amp;#x540E;&amp;#xFF0C;&amp;#x5B83;&amp;#x80FD;&amp;#x77AC;&amp;#x95F4;&amp;#x79FB;&amp;#x52A8;&amp;#x5230;&amp;#x4EFB;&amp;#x610F;&amp;#x4E00;&amp;#x4E2A;&amp;#x884C;&amp;#x661F;&amp;#x3002;&amp;#x5728;&amp;#x4F7F;&amp;#x7528;&amp;#x9AD8;&amp;#x901F;&amp;#x822A;&amp;#x884C;&amp;#x6A21;&amp;#x5F0F;&amp;#x7684;&amp;#x65F6;&amp;#x5019;&amp;#xFF0C;&amp;#x53EA;&amp;#x80FD;&amp;#x7531;&amp;#x6BCF;&amp;#x4E2A;&amp;#x661F;&amp;#x7403;&amp;#x98DE;&amp;#x5F80;&amp;#x5F15;&amp;#x529B;&amp;#x6BD4;&amp;#x5B83;&amp;#x5927;&amp;#x7684;&amp;#x661F;&amp;#x7403;&amp;#xFF0C;&amp;#x5426;&amp;#x5219;&amp;#x8D5B;&amp;#x8F66;&amp;#x5C31;&amp;#x4F1A;&amp;#x53D1;&amp;#x751F;&amp;#x7206;&amp;#x70B8;&amp;#x3002;&amp;#x6C42;&amp;#x5B8C;&amp;#x6210;&amp;#x6BD4;&amp;#x8D5B;&amp;#x7684;&amp;#x6700;&amp;#x5C11;&amp;#x65F6;&amp;#x95F4;&amp;#x3002;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="BZOJ" scheme="https://blog.menci.moe/tag/bzoj/"/>
    
      <category term="Edmonds-Karp" scheme="https://blog.menci.moe/tag/edmonds-karp/"/>
    
      <category term="SDOI" scheme="https://blog.menci.moe/tag/sdoi/"/>
    
      <category term="图论" scheme="https://blog.menci.moe/tag/%E5%9B%BE%E8%AE%BA/"/>
    
      <category term="网络流" scheme="https://blog.menci.moe/tag/%E7%BD%91%E7%BB%9C%E6%B5%81/"/>
    
      <category term="费用流" scheme="https://blog.menci.moe/tag/%E8%B4%B9%E7%94%A8%E6%B5%81/"/>
    
  </entry>
  
  <entry>
    <title>「SDOI2015」星际战争 - 网络流</title>
    <link href="https://blog.menci.moe/sdoi2015-war/"/>
    <id>https://blog.menci.moe/sdoi2015-war/</id>
    <published>2016-02-29T07:42:11.000Z</published>
    <updated>2016-02-29T07:46:18.000Z</updated>
    
    <content type="html">&lt;p&gt;Y &amp;#x519B;&amp;#x56E2;&amp;#x4E00;&amp;#x5171;&amp;#x6D3E;&amp;#x9063;&amp;#x4E86; $ N $ &amp;#x4E2A;&amp;#x5DE8;&amp;#x578B;&amp;#x673A;&amp;#x5668;&amp;#x4EBA;&amp;#x8FDB;&amp;#x653B; X &amp;#x519B;&amp;#x56E2;&amp;#x7684;&amp;#x9635;&amp;#x5730;&amp;#xFF0C;&amp;#x5176;&amp;#x4E2D;&amp;#x7B2C; $ i $ &amp;#x4E2A;&amp;#x5DE8;&amp;#x578B;&amp;#x673A;&amp;#x5668;&amp;#x4EBA;&amp;#x7684;&amp;#x88C5;&amp;#x7532;&amp;#x503C;&amp;#x4E3A; $ A_i $&amp;#x3002;&amp;#x5F53;&amp;#x4E00;&amp;#x4E2A;&amp;#x5DE8;&amp;#x578B;&amp;#x673A;&amp;#x5668;&amp;#x4EBA;&amp;#x7684;&amp;#x88C5;&amp;#x7532;&amp;#x503C;&amp;#x51CF;&amp;#x5C11;&amp;#x5230; 0 &amp;#x6216;&amp;#x8005;&amp;#x4EE5;&amp;#x4E0B;&amp;#x65F6;&amp;#xFF0C;&amp;#x8FD9;&amp;#x4E2A;&amp;#x5DE8;&amp;#x578B;&amp;#x673A;&amp;#x5668;&amp;#x4EBA;&amp;#x5C31;&amp;#x88AB;&amp;#x6467;&amp;#x6BC1;&amp;#x4E86;&amp;#x3002;X &amp;#x519B;&amp;#x56E2;&amp;#x6709; $ M $ &amp;#x4E2A;&amp;#x6FC0;&amp;#x5149;&amp;#x6B66;&amp;#x5668;&amp;#xFF0C;&amp;#x5176;&amp;#x4E2D;&amp;#x7B2C; $ i $ &amp;#x4E2A;&amp;#x6FC0;&amp;#x5149;&amp;#x6B66;&amp;#x5668;&amp;#x6BCF;&amp;#x79D2;&amp;#x53EF;&amp;#x4EE5;&amp;#x524A;&amp;#x51CF;&amp;#x4E00;&amp;#x4E2A;&amp;#x5DE8;&amp;#x578B;&amp;#x673A;&amp;#x5668;&amp;#x4EBA; $ B_i $ &amp;#x7684;&amp;#x88C5;&amp;#x7532;&amp;#x503C;&amp;#x3002;&amp;#x6FC0;&amp;#x5149;&amp;#x6B66;&amp;#x5668;&amp;#x7684;&amp;#x653B;&amp;#x51FB;&amp;#x662F;&amp;#x8FDE;&amp;#x7EED;&amp;#x7684;&amp;#x3002;&amp;#x8FD9;&amp;#x79CD;&amp;#x6FC0;&amp;#x5149;&amp;#x6B66;&amp;#x5668;&amp;#x975E;&amp;#x5E38;&amp;#x5947;&amp;#x602A;&amp;#xFF0C;&amp;#x4E00;&amp;#x4E2A;&amp;#x6FC0;&amp;#x5149;&amp;#x6B66;&amp;#x5668;&amp;#x53EA;&amp;#x80FD;&amp;#x653B;&amp;#x51FB;&amp;#x4E00;&amp;#x4E9B;&amp;#x7279;&amp;#x5B9A;&amp;#x7684;&amp;#x654C;&amp;#x4EBA;&amp;#x3002;Y &amp;#x519B;&amp;#x56E2;&amp;#x9700;&amp;#x8981;&amp;#x77E5;&amp;#x9053; X &amp;#x519B;&amp;#x56E2;&amp;#x6700;&amp;#x5C11;&amp;#x9700;&amp;#x8981;&amp;#x7528;&amp;#x591A;&amp;#x957F;&amp;#x65F6;&amp;#x95F4;&amp;#x624D;&amp;#x80FD;&amp;#x5C06; Y &amp;#x519B;&amp;#x56E2;&amp;#x7684;&amp;#x6240;&amp;#x6709;&amp;#x5DE8;&amp;#x578B;&amp;#x673A;&amp;#x5668;&amp;#x4EBA;&amp;#x6467;&amp;#x6BC1;&amp;#x3002;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;&amp;#x9898;&amp;#x76EE;&amp;#x94FE;&amp;#x63A5;&quot;&gt;&amp;#x9898;&amp;#x76EE;&amp;#x94FE;&amp;#x63A5;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://www.lydsy.com/JudgeOnline/problem.php?id=3993&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;BZOJ 3993&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x89E3;&amp;#x9898;&amp;#x601D;&amp;#x8DEF;&quot;&gt;&amp;#x89E3;&amp;#x9898;&amp;#x601D;&amp;#x8DEF;&lt;/h3&gt;
&lt;p&gt;&amp;#x5148;&amp;#x4E8C;&amp;#x5206;&amp;#x4E00;&amp;#x4E2A;&amp;#x65F6;&amp;#x95F4;&amp;#xFF0C;&amp;#x7136;&amp;#x540E;&amp;#x7528;&amp;#x7F51;&amp;#x7EDC;&amp;#x6D41;&amp;#x5224;&amp;#x5B9A;&amp;#x662F;&amp;#x5426;&amp;#x80FD;&amp;#x5728;&amp;#x8FD9;&amp;#x6BB5;&amp;#x65F6;&amp;#x95F4;&amp;#x5185;&amp;#x6253;&amp;#x5B8C;&amp;#x3002;&lt;/p&gt;
&lt;ol style=&quot;list-style-type: decimal&quot;&gt;
&lt;li&gt;&amp;#x4ECE;&amp;#x6E90;&amp;#x70B9;&amp;#x5230;&amp;#x6BCF;&amp;#x4E00;&amp;#x4E2A;&amp;#x6B66;&amp;#x5668;&amp;#x8FDE;&amp;#x4E00;&amp;#x6761;&amp;#x8FB9;&amp;#xFF0C;&amp;#x5BB9;&amp;#x91CF;&amp;#x4E3A;&amp;#x6B66;&amp;#x5668;&amp;#x7684;&amp;#x5A01;&amp;#x529B; &amp;#xD7; &amp;#x65F6;&amp;#x95F4;&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x4ECE;&amp;#x6BCF;&amp;#x4E00;&amp;#x4E2A;&amp;#x673A;&amp;#x5668;&amp;#x4EBA;&amp;#x5411;&amp;#x6C47;&amp;#x70B9;&amp;#x8FDE;&amp;#x4E00;&amp;#x6761;&amp;#x8FB9;&amp;#xFF0C;&amp;#x5BB9;&amp;#x91CF;&amp;#x4E3A;&amp;#x8BE5;&amp;#x673A;&amp;#x5668;&amp;#x4EBA;&amp;#x7684;&amp;#x88C5;&amp;#x7532;&amp;#x503C;&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x4ECE;&amp;#x6BCF;&amp;#x4E2A;&amp;#x6B66;&amp;#x5668;&amp;#x5411;&amp;#x6240;&amp;#x6709;&amp;#x4ECE;&amp;#x8BE5;&amp;#x6B66;&amp;#x5668;&amp;#x80FD;&amp;#x653B;&amp;#x51FB;&amp;#x7684;&amp;#x673A;&amp;#x5668;&amp;#x4EBA;&amp;#x8FDE;&amp;#x4E00;&amp;#x6761;&amp;#x8FB9;&amp;#xFF0C;&amp;#x5BB9;&amp;#x91CF;&amp;#x4E3A;&amp;#x6B63;&amp;#x65E0;&amp;#x7A77;&amp;#x3002;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&amp;#x55EF;&amp;#xFF0C;&amp;#x8BF4;&amp;#x8D77;&amp;#x6765;&amp;#x5F88;&amp;#x5BB9;&amp;#x6613;&amp;#x5BF9;&amp;#x5427;w &amp;#x2026;&amp;#x2026;&lt;/p&gt;
&lt;p&gt;&amp;#x7136;&amp;#x800C;&amp;#x7B54;&amp;#x6848;&amp;#x662F;&amp;#x5B9E;&amp;#x6570;&amp;#xFF0C;&amp;#x5B9E;&amp;#x6570;&amp;#x4E8C;&amp;#x5206;&amp;#x5012;&amp;#x6CA1;&amp;#x4EC0;&amp;#x4E48;&amp;#x95EE;&amp;#x9898;&amp;#xFF0C;&amp;#x8981;&amp;#x6CE8;&amp;#x610F;&amp;#x7684;&amp;#x662F; Dinic &amp;#x6A21;&amp;#x677F;&amp;#x4E5F;&amp;#x8981;&amp;#x6539;&amp;#x6210;&amp;#x5B9E;&amp;#x6570;&amp;#x7684;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x4E8C;&amp;#x5206;&amp;#x7684;&amp;#x8303;&amp;#x56F4;&amp;#x4E0D;&amp;#x592A;&amp;#x597D;&amp;#x786E;&amp;#x5B9A;&amp;#xFF0C;&amp;#x65E2;&amp;#x7136;&amp;#x9898;&amp;#x76EE;&amp;#x660E;&amp;#x786E;&amp;#x6709;&amp;#x89E3;&amp;#xFF0C;&amp;#x90A3;&amp;#x5C31;&amp;#x5B9A;&amp;#x4E0A;&amp;#x754C;&amp;#x4E3A;&lt;strong&gt;&amp;#x7528;&amp;#x4E00;&amp;#x4E2A;&amp;#x5A01;&amp;#x529B;&amp;#x6700;&amp;#x5C0F;&amp;#x7684;&amp;#x6B66;&amp;#x5668;&amp;#x6253;&amp;#x6240;&amp;#x6709;&amp;#x673A;&amp;#x5668;&amp;#x4EBA;&amp;#x6240;&amp;#x7528;&amp;#x65F6;&amp;#x95F4;&lt;/strong&gt;&amp;#xFF0C;&amp;#x53CD;&amp;#x6B63;&amp;#x4E0D;&amp;#x4F1A;&amp;#x9519;&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;ac&amp;#x4EE3;&amp;#x7801;&quot;&gt;AC&amp;#x4EE3;&amp;#x7801;&lt;/h3&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;93&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;94&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;95&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;96&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;97&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;98&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;99&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;100&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;101&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;102&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;103&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;104&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;105&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;106&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;107&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;108&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;109&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;110&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;111&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;112&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;113&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;114&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;115&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;116&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;117&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;118&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;119&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;120&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;121&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;122&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;123&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;124&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;125&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;126&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;127&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;128&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;129&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;130&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;131&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;132&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;133&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;134&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;135&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;136&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;137&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;138&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;139&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;140&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;141&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;142&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;143&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;144&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;145&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;146&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;147&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;148&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;149&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;150&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;151&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;climits&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cmath&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cfloat&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;algorithm&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;queue&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#xA0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXN = &lt;span class=&quot;number&quot;&gt;50&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXM = &lt;span class=&quot;number&quot;&gt;50&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt; EPS = &lt;span class=&quot;number&quot;&gt;1e-4&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#xA0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Node;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Edge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#xA0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Node {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Edge *firstEdge, *currentEdge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; level;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} nodes[MAXN + MAXM + &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#xA0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Edge {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Node *from, *to;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt; capacity, flow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Edge *next, *reversedEdge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#xA0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Edge(Node *from, Node *to, &lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt; capacity) : from(from), to(to), capacity(capacity), flow(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;), next(from-&amp;gt;firstEdge) {}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;};&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#xA0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, m, robot[MAXN], sumRobot, gun[MAXM], minGun = INT_MAX, attack[MAXM][MAXN];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#xA0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;equal&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt; a, &lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt; b)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;fabs&lt;/span&gt;(a - b) &amp;lt; EPS;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#xA0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Dinic {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;makeLevelGraph&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Node *s, Node *t, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) nodes[i].level = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#xA0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;queue&lt;/span&gt;&amp;lt;Node *&amp;gt; q;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		q.push(s);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#xA0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		s-&amp;gt;level = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&amp;#xA0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (!q.empty()) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			Node *v = q.front();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			q.pop();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#xA0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (Edge *e = v-&amp;gt;firstEdge; e; e = e-&amp;gt;next) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!equal(e-&amp;gt;capacity - e-&amp;gt;flow, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) &amp;amp;&amp;amp; e-&amp;gt;to-&amp;gt;level == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					e-&amp;gt;to-&amp;gt;level = v-&amp;gt;level + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (e-&amp;gt;to == t) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; q.push(e-&amp;gt;to);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#xA0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#xA0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;findPath&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Node *s, Node *t, &lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt; limit = DBL_MAX)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (s == t) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; limit;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#xA0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (Edge *&amp;amp;e = s-&amp;gt;currentEdge; e; e = e-&amp;gt;next) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (e-&amp;gt;to-&amp;gt;level == s-&amp;gt;level + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &amp;amp;&amp;amp; !equal(e-&amp;gt;capacity - e-&amp;gt;flow, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;)) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt; flow = findPath(e-&amp;gt;to, t, &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::min(limit, e-&amp;gt;capacity - e-&amp;gt;flow));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (flow &amp;gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					e-&amp;gt;flow += flow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					e-&amp;gt;reversedEdge-&amp;gt;flow -= flow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; flow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#xA0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#xA0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;operator&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; s, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; t, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt; ans = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (makeLevelGraph(&amp;amp;nodes[s], &amp;amp;nodes[t], n)) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) nodes[i].currentEdge = nodes[i].firstEdge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt; flow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; ((flow = findPath(&amp;amp;nodes[s], &amp;amp;nodes[t])) &amp;gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) ans += flow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#xA0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; ans;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} dinic;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#xA0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;addEdge&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; from, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; to, &lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt; capacity)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	nodes[from].firstEdge = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Edge(&amp;amp;nodes[from], &amp;amp;nodes[to], capacity);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	nodes[to].firstEdge = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Edge(&amp;amp;nodes[to], &amp;amp;nodes[from], &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#xA0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	nodes[from].firstEdge-&amp;gt;reversedEdge = nodes[to].firstEdge, nodes[to].firstEdge-&amp;gt;reversedEdge = nodes[from].firstEdge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#xA0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;cleanUp&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		Edge *next;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (Edge *&amp;amp;e = nodes[i].firstEdge; e; next = e-&amp;gt;next, &lt;span class=&quot;keyword&quot;&gt;delete&lt;/span&gt; e, e = next);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#xA0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;check&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt; time)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; s = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, t = n + m + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#xA0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= m; i++) addEdge(s, i, gun[i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;] * time);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= n; i++) addEdge(i + m, t, robot[i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#xA0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= m; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; j = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; j &amp;lt;= n; j++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (attack[i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;][j - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;] == &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				addEdge(i, j + m, DBL_MAX);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#xA0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt; flow = dinic(s, t, n + m + &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#xA0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	cleanUp(n + m + &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#xA0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;comment&quot;&gt;//printf(&amp;quot;%.3lf %d\n&amp;quot;, flow, sumRobot);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; equal(flow, sumRobot);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#xA0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;dichotomy&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt; l = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, r = ((&lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt;)sumRobot) / ((&lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt;)minGun);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (r - l &amp;gt; EPS) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt; mid = l + (r - l) / &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;comment&quot;&gt;//printf(&amp;quot;mid = %.6lf\n&amp;quot;, mid);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (check(mid)) r = mid;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; l = mid;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#xA0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; l + (r - l) / &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#xA0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d&amp;quot;&lt;/span&gt;, &amp;amp;n, &amp;amp;m);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#xA0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;robot[i]), sumRobot += robot[i];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; m; i++) &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;gun[i]), minGun = &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::min(minGun, gun[i]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#xA0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; m; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; j = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; j &amp;lt; n; j++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;attack[i][j]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#xA0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%.6lf\n&amp;quot;&lt;/span&gt;, dichotomy());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#xA0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;Y &amp;#x519B;&amp;#x56E2;&amp;#x4E00;&amp;#x5171;&amp;#x6D3E;&amp;#x9063;&amp;#x4E86; $ N $ &amp;#x4E2A;&amp;#x5DE8;&amp;#x578B;&amp;#x673A;&amp;#x5668;&amp;#x4EBA;&amp;#x8FDB;&amp;#x653B; X &amp;#x519B;&amp;#x56E2;&amp;#x7684;&amp;#x9635;&amp;#x5730;&amp;#xFF0C;&amp;#x5176;&amp;#x4E2D;&amp;#x7B2C; $ i $ &amp;#x4E2A;&amp;#x5DE8;&amp;#x578B;&amp;#x673A;&amp;#x5668;&amp;#x4EBA;&amp;#x7684;&amp;#x88C5;&amp;#x7532;&amp;#x503C;&amp;#x4E3A; $ A_i $&amp;#x3002;&amp;#x5F53;&amp;#x4E00;&amp;#x4E2A;&amp;#x5DE8;&amp;#x578B;&amp;#x673A;&amp;#x5668;&amp;#x4EBA;&amp;#x7684;&amp;#x88C5;&amp;#x7532;&amp;#x503C;&amp;#x51CF;&amp;#x5C11;&amp;#x5230; 0 &amp;#x6216;&amp;#x8005;&amp;#x4EE5;&amp;#x4E0B;&amp;#x65F6;&amp;#xFF0C;&amp;#x8FD9;&amp;#x4E2A;&amp;#x5DE8;&amp;#x578B;&amp;#x673A;&amp;#x5668;&amp;#x4EBA;&amp;#x5C31;&amp;#x88AB;&amp;#x6467;&amp;#x6BC1;&amp;#x4E86;&amp;#x3002;X &amp;#x519B;&amp;#x56E2;&amp;#x6709; $ M $ &amp;#x4E2A;&amp;#x6FC0;&amp;#x5149;&amp;#x6B66;&amp;#x5668;&amp;#xFF0C;&amp;#x5176;&amp;#x4E2D;&amp;#x7B2C; $ i $ &amp;#x4E2A;&amp;#x6FC0;&amp;#x5149;&amp;#x6B66;&amp;#x5668;&amp;#x6BCF;&amp;#x79D2;&amp;#x53EF;&amp;#x4EE5;&amp;#x524A;&amp;#x51CF;&amp;#x4E00;&amp;#x4E2A;&amp;#x5DE8;&amp;#x578B;&amp;#x673A;&amp;#x5668;&amp;#x4EBA; $ B_i $ &amp;#x7684;&amp;#x88C5;&amp;#x7532;&amp;#x503C;&amp;#x3002;&amp;#x6FC0;&amp;#x5149;&amp;#x6B66;&amp;#x5668;&amp;#x7684;&amp;#x653B;&amp;#x51FB;&amp;#x662F;&amp;#x8FDE;&amp;#x7EED;&amp;#x7684;&amp;#x3002;&amp;#x8FD9;&amp;#x79CD;&amp;#x6FC0;&amp;#x5149;&amp;#x6B66;&amp;#x5668;&amp;#x975E;&amp;#x5E38;&amp;#x5947;&amp;#x602A;&amp;#xFF0C;&amp;#x4E00;&amp;#x4E2A;&amp;#x6FC0;&amp;#x5149;&amp;#x6B66;&amp;#x5668;&amp;#x53EA;&amp;#x80FD;&amp;#x653B;&amp;#x51FB;&amp;#x4E00;&amp;#x4E9B;&amp;#x7279;&amp;#x5B9A;&amp;#x7684;&amp;#x654C;&amp;#x4EBA;&amp;#x3002;Y &amp;#x519B;&amp;#x56E2;&amp;#x9700;&amp;#x8981;&amp;#x77E5;&amp;#x9053; X &amp;#x519B;&amp;#x56E2;&amp;#x6700;&amp;#x5C11;&amp;#x9700;&amp;#x8981;&amp;#x7528;&amp;#x591A;&amp;#x957F;&amp;#x65F6;&amp;#x95F4;&amp;#x624D;&amp;#x80FD;&amp;#x5C06; Y &amp;#x519B;&amp;#x56E2;&amp;#x7684;&amp;#x6240;&amp;#x6709;&amp;#x5DE8;&amp;#x578B;&amp;#x673A;&amp;#x5668;&amp;#x4EBA;&amp;#x6467;&amp;#x6BC1;&amp;#x3002;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="BZOJ" scheme="https://blog.menci.moe/tag/bzoj/"/>
    
      <category term="Dinic" scheme="https://blog.menci.moe/tag/dinic/"/>
    
      <category term="SDOI" scheme="https://blog.menci.moe/tag/sdoi/"/>
    
      <category term="二分答案" scheme="https://blog.menci.moe/tag/%E4%BA%8C%E5%88%86%E7%AD%94%E6%A1%88/"/>
    
      <category term="图论" scheme="https://blog.menci.moe/tag/%E5%9B%BE%E8%AE%BA/"/>
    
      <category term="实数二分" scheme="https://blog.menci.moe/tag/%E5%AE%9E%E6%95%B0%E4%BA%8C%E5%88%86/"/>
    
      <category term="网络流" scheme="https://blog.menci.moe/tag/%E7%BD%91%E7%BB%9C%E6%B5%81/"/>
    
  </entry>
  
  <entry>
    <title>「COGS 741」负载平衡 - 费用流</title>
    <link href="https://blog.menci.moe/cogs-741/"/>
    <id>https://blog.menci.moe/cogs-741/</id>
    <published>2016-02-25T07:37:15.000Z</published>
    <updated>2016-02-25T07:38:10.000Z</updated>
    
    <content type="html">&lt;p&gt;G &amp;#x516C;&amp;#x53F8;&amp;#x6709; &lt;code&gt;n&lt;/code&gt; &amp;#x4E2A;&amp;#x6CBF;&amp;#x94C1;&amp;#x8DEF;&amp;#x8FD0;&amp;#x8F93;&amp;#x7EBF;&amp;#x73AF;&amp;#x5F62;&amp;#x6392;&amp;#x5217;&amp;#x7684;&amp;#x4ED3;&amp;#x5E93;&amp;#xFF0C;&amp;#x6BCF;&amp;#x4E2A;&amp;#x4ED3;&amp;#x5E93;&amp;#x5B58;&amp;#x50A8;&amp;#x7684;&amp;#x8D27;&amp;#x7269;&amp;#x6570;&amp;#x91CF;&amp;#x4E0D;&amp;#x7B49;&amp;#x3002;&amp;#x5982;&amp;#x4F55;&amp;#x7528;&amp;#x6700;&amp;#x5C11;&amp;#x642C;&amp;#x8FD0;&amp;#x91CF;&amp;#x53EF;&amp;#x4EE5;&amp;#x4F7F; &lt;code&gt;n&lt;/code&gt; &amp;#x4E2A;&amp;#x4ED3;&amp;#x5E93;&amp;#x7684;&amp;#x5E93;&amp;#x5B58;&amp;#x6570;&amp;#x91CF;&amp;#x76F8;&amp;#x540C;&amp;#x3002;&amp;#x642C;&amp;#x8FD0;&amp;#x8D27;&amp;#x7269;&amp;#x65F6;&amp;#xFF0C;&amp;#x53EA;&amp;#x80FD;&amp;#x5728;&amp;#x76F8;&amp;#x90BB;&amp;#x7684;&amp;#x4ED3;&amp;#x5E93;&amp;#x4E4B;&amp;#x95F4;&amp;#x642C;&amp;#x8FD0;&amp;#x3002;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;&amp;#x9898;&amp;#x76EE;&amp;#x94FE;&amp;#x63A5;&quot;&gt;&amp;#x9898;&amp;#x76EE;&amp;#x94FE;&amp;#x63A5;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://cogs.top/cogs/problem/problem.php?pid=741&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;COGS 741&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x89E3;&amp;#x9898;&amp;#x601D;&amp;#x8DEF;&quot;&gt;&amp;#x89E3;&amp;#x9898;&amp;#x601D;&amp;#x8DEF;&lt;/h3&gt;
&lt;p&gt;&amp;#x8FD9;&amp;#x9053;&amp;#x9898;&amp;#x731B;&amp;#x5730;&amp;#x770B;&amp;#x4E0A;&amp;#x53BB;&amp;#x6709;&amp;#x70B9;&amp;#x50CF;&amp;#x4E4B;&amp;#x524D;&amp;#x5199;&amp;#x8FC7;&amp;#x7684;&amp;#x4E00;&amp;#x9053;&amp;#x8D2A;&amp;#x5FC3; &amp;#x2014;&amp;#x2014; &amp;#x5747;&amp;#x5206;&amp;#x7EB8;&amp;#x724C;&amp;#xFF0C;&amp;#x90A3;&amp;#x9053;&amp;#x9898;&amp;#x53EA;&amp;#x8981;&amp;#x628A;&amp;#x6BCF;&amp;#x4E00;&amp;#x4E2A;&amp;#x6570;&amp;#x51CF;&amp;#x53BB;&amp;#x5E73;&amp;#x5747;&amp;#x6570;&amp;#xFF0C;&amp;#x7136;&amp;#x540E;&amp;#x4ECE;&amp;#x5DE6;&amp;#x5230;&amp;#x53F3;&amp;#x7D2F;&amp;#x52A0;&amp;#xFF0C;&amp;#x7279;&amp;#x5224;&amp;#x4E00;&amp;#x4E0B;&amp;#x96F6;&amp;#x5C31;&amp;#x597D;&amp;#x3002;&amp;#x4F46;&amp;#x8FD9;&amp;#x9898;&amp;#x96BE;&amp;#x70B9;&amp;#x5728;&amp;#x4E8E;&amp;#x662F;&amp;#x73AF;&amp;#x5F62;&amp;#x7684;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x9996;&amp;#x5148;&amp;#xFF0C;&amp;#x8FD8;&amp;#x662F;&amp;#x8981;&amp;#x5C06;&amp;#x6BCF;&amp;#x4E2A;&amp;#x4ED3;&amp;#x5E93;&amp;#x4E2D;&amp;#x7684;&amp;#x5E93;&amp;#x5B58;&amp;#x6570;&amp;#x91CF;&amp;#x51CF;&amp;#x53BB;&amp;#x5E73;&amp;#x5747;&amp;#x6570;&amp;#xFF0C;&amp;#x76EE;&amp;#x6807;&amp;#x4FBF;&amp;#x8F6C;&amp;#x5316;&amp;#x4E3A;&amp;#x628A;&amp;#x6B63;&amp;#x6570;&amp;#x5168;&amp;#x90E8;&amp;#x52A0;&amp;#x5230;&amp;#x8D1F;&amp;#x6570;&amp;#x4E2D;&amp;#x3002;&amp;#x300E;&amp;#x53EA;&amp;#x80FD;&amp;#x5728;&amp;#x76F8;&amp;#x90BB;&amp;#x7684;&amp;#x4ED3;&amp;#x5E93;&amp;#x4E4B;&amp;#x95F4;&amp;#x642C;&amp;#x8FD0;&amp;#x300F;&amp;#x8FD9;&amp;#x4E00;&amp;#x6761;&amp;#x4EF6;&amp;#xFF0C;&amp;#x8BA9;&amp;#x4EBA;&amp;#x5F88;&amp;#x5BB9;&amp;#x6613;&amp;#x60F3;&amp;#x5230;&amp;#x5728;&amp;#x76F8;&amp;#x90BB;&amp;#x4ED3;&amp;#x5E93;&amp;#x4E4B;&amp;#x95F4;&amp;#x8FDE;&amp;#x8FB9;&amp;#xFF0C;&amp;#x4F46;&amp;#x7A0D;&amp;#x5FAE;&amp;#x601D;&amp;#x8003;&amp;#x4E00;&amp;#x4E0B;&amp;#x5C31;&amp;#x4F1A;&amp;#x53D1;&amp;#x73B0;&amp;#x8FD9;&amp;#x6837;&amp;#x662F;&amp;#x4E0D;&amp;#x884C;&amp;#x7684;&amp;#xFF0C;&amp;#x56E0;&amp;#x4E3A;&amp;#x6709;&amp;#x65F6;&amp;#x5019;&amp;#x9700;&amp;#x8981;&amp;#x5C06;&amp;#x8D27;&amp;#x7269;&amp;#x91CD;&amp;#x590D;&amp;#x79FB;&amp;#x52A8;&amp;#x591A;&amp;#x6B21;&amp;#x624D;&amp;#x80FD;&amp;#x5230;&amp;#x8FBE;&amp;#x76EE;&amp;#x7684;&amp;#x4ED3;&amp;#x5E93;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x4E0D;&amp;#x59A8;&amp;#x53EA;&amp;#x8003;&amp;#x8651;&amp;#x6700;&amp;#x7EC8;&amp;#x7684;&amp;#x7ED3;&amp;#x679C; &amp;#x2014;&amp;#x2014; &amp;#x6B63;&amp;#x6570;&amp;#x6700;&amp;#x540E;&amp;#x90FD;&amp;#x8981;&amp;#x88AB;&amp;#x79FB;&amp;#x52A8;&amp;#x5230;&amp;#x8D1F;&amp;#x6570;&amp;#x91CC;&amp;#x9762;&amp;#x3002;&amp;#x5728;&amp;#x76F8;&amp;#x90BB;&amp;#x7684;&amp;#x4ED3;&amp;#x5E93;&amp;#x4E4B;&amp;#x95F4;&amp;#x8F6C;&amp;#x79FB;&amp;#xFF0C;&amp;#x5355;&amp;#x4F4D;&amp;#x4EE3;&amp;#x4EF7;&amp;#x662F; 1&amp;#xFF0C;&amp;#x5219;&amp;#x9694;&amp;#x7740;&amp;#x591A;&amp;#x4E2A;&amp;#x4F4D;&amp;#x7F6E;&amp;#x7684;&amp;#x4ED3;&amp;#x5E93;&amp;#x4E4B;&amp;#x95F4;&amp;#x8F6C;&amp;#x79FB;&amp;#x7684;&amp;#x4EE3;&amp;#x4EF7;&amp;#x5C31;&amp;#x662F;&lt;strong&gt;&amp;#x4E24;&amp;#x95F4;&amp;#x4ED3;&amp;#x5E93;&amp;#x7684;&amp;#x6700;&amp;#x77ED;&amp;#x8DDD;&amp;#x79BB;&lt;/strong&gt;&amp;#xFF0C;&amp;#x73AF;&amp;#x4E2D;&amp;#x4E24;&amp;#x70B9;&amp;#x7684;&amp;#x6700;&amp;#x77ED;&amp;#x8DEF;&amp;#x53EA;&amp;#x6709;&amp;#x4E24;&amp;#x79CD;&amp;#x60C5;&amp;#x51B5;&amp;#xFF0C;&amp;#x987A;&amp;#x65F6;&amp;#x9488;&amp;#x8D70;&amp;#x6216;&amp;#x8005;&amp;#x9006;&amp;#x65F6;&amp;#x9488;&amp;#x8D70;&amp;#xFF0C;&amp;#x9884;&amp;#x5904;&amp;#x7406;&amp;#x51FA;&amp;#x6765;&amp;#x5C31;&amp;#x597D;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x4ECE;&amp;#x6E90;&amp;#x70B9;&amp;#x5411;&amp;#x6BCF;&amp;#x4E2A;&amp;#x5E93;&amp;#x5B58;&amp;#x91CF;&amp;#x4E3A;&amp;#x6B63;&amp;#x6570;&amp;#x7684;&amp;#x70B9;&amp;#x8FDE;&amp;#x4E00;&amp;#x6761;&amp;#x8FB9;&amp;#xFF0C;&amp;#x5BB9;&amp;#x91CF;&amp;#x4E3A;&amp;#x5E93;&amp;#x5B58;&amp;#x91CF;&amp;#xFF0C;&amp;#x8D39;&amp;#x7528;&amp;#x4E3A; 0&amp;#xFF1B;&amp;#x4ECE;&amp;#x6BCF;&amp;#x4E2A;&amp;#x5E93;&amp;#x5B58;&amp;#x91CF;&amp;#x4E3A;&amp;#x8D1F;&amp;#x6570;&amp;#x7684;&amp;#x70B9;&amp;#x5411;&amp;#x6C47;&amp;#x70B9;&amp;#x8FDE;&amp;#x4E00;&amp;#x6761;&amp;#x8FB9;&amp;#xFF0C;&amp;#x5BB9;&amp;#x91CF;&amp;#x4E3A;&amp;#x5E93;&amp;#x5B58;&amp;#x91CF;&amp;#x7684;&amp;#x76F8;&amp;#x53CD;&amp;#x6570;&amp;#xFF0C;&amp;#x8D39;&amp;#x7528;&amp;#x4E3A; 0&amp;#xFF1B;&amp;#x4ECE;&amp;#x6BCF;&amp;#x4E2A;&amp;#x5E93;&amp;#x5B58;&amp;#x91CF;&amp;#x4E3A;&amp;#x6B63;&amp;#x6570;&amp;#x7684;&amp;#x70B9;&amp;#x5411;&amp;#x6BCF;&amp;#x4E2A;&amp;#x5E93;&amp;#x5B58;&amp;#x91CF;&amp;#x4E3A;&amp;#x8D1F;&amp;#x6570;&amp;#x7684;&amp;#x70B9;&amp;#x8FDE;&amp;#x4E00;&amp;#x6761;&amp;#x8FB9;&amp;#xFF0C;&amp;#x5BB9;&amp;#x91CF;&amp;#x4E3A;&amp;#x6B63;&amp;#x65E0;&amp;#x7A77;&amp;#xFF0C;&amp;#x8D39;&amp;#x7528;&amp;#x4E3A;&lt;strong&gt;&amp;#x4E24;&amp;#x95F4;&amp;#x4ED3;&amp;#x5E93;&amp;#x7684;&amp;#x6700;&amp;#x77ED;&amp;#x8DDD;&amp;#x79BB;&lt;/strong&gt;&amp;#xFF0C;&amp;#x6C42;&amp;#x51FA;&amp;#x6700;&amp;#x5C0F;&amp;#x8D39;&amp;#x7528;&amp;#x6700;&amp;#x5927;&amp;#x6D41;&amp;#xFF0C;&amp;#x5219;&amp;#x8D39;&amp;#x7528;&amp;#x5373;&amp;#x4E3A;&amp;#x7B54;&amp;#x6848;&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;ac&amp;#x4EE3;&amp;#x7801;&quot;&gt;AC&amp;#x4EE3;&amp;#x7801;&lt;/h3&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;93&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;94&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;95&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;96&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;97&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;98&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;99&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;100&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;101&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;102&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;103&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;104&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;105&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;106&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;107&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;108&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;109&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;110&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;111&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;112&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;113&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;114&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;115&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;116&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;117&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;118&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;119&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;120&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;121&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;122&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;123&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;124&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;125&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;126&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;127&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;128&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;129&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;130&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;131&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;132&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;133&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;134&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;135&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;136&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;137&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstdlib&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;climits&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;algorithm&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;queue&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXN = &lt;span class=&quot;number&quot;&gt;100&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Node;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Edge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Node {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Edge *firstEdge, *inEdge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; flow, dist;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; inQueue;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} nodes[MAXN + &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Edge {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Node *from, *to;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; flow, capacity, cost;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Edge *next, *reversedEdge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Edge(Node *from, Node *to, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; capacity, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; cost) : from(from), to(to), capacity(capacity), flow(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;), cost(cost), next(from-&amp;gt;firstEdge) {}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;};&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, a[MAXN], dist[MAXN][MAXN];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; EdmondsKarp {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;bellmanford&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Node *s, Node *t, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &amp;amp;flow, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &amp;amp;cost)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			nodes[i].inEdge = &lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			nodes[i].flow = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			nodes[i].dist = INT_MAX;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			nodes[i].inQueue = &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;queue&lt;/span&gt;&amp;lt;Node *&amp;gt; q;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		q.push(s);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		s-&amp;gt;flow = INT_MAX;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		s-&amp;gt;dist = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (!q.empty()) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			Node *v = q.front();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			q.pop();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			v-&amp;gt;inQueue = &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (Edge *e = v-&amp;gt;firstEdge; e; e = e-&amp;gt;next) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (e-&amp;gt;flow &amp;lt; e-&amp;gt;capacity &amp;amp;&amp;amp; e-&amp;gt;to-&amp;gt;dist &amp;gt; v-&amp;gt;dist + e-&amp;gt;cost) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					e-&amp;gt;to-&amp;gt;dist = v-&amp;gt;dist + e-&amp;gt;cost;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					e-&amp;gt;to-&amp;gt;inEdge = e;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					e-&amp;gt;to-&amp;gt;flow = &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::min(v-&amp;gt;flow, e-&amp;gt;capacity - e-&amp;gt;flow);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!e-&amp;gt;to-&amp;gt;inQueue) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;						q.push(e-&amp;gt;to);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;						e-&amp;gt;to-&amp;gt;inQueue = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (t-&amp;gt;dist == INT_MAX) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (Edge *e = t-&amp;gt;inEdge; e; e = e-&amp;gt;from-&amp;gt;inEdge) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			e-&amp;gt;flow += t-&amp;gt;flow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			e-&amp;gt;reversedEdge-&amp;gt;flow -= t-&amp;gt;flow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		flow += t-&amp;gt;flow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		cost += t-&amp;gt;flow * t-&amp;gt;dist;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;operator&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; s, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; t, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &amp;amp;flow, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &amp;amp;cost)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		flow = cost = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (bellmanford(&amp;amp;nodes[s], &amp;amp;nodes[t], n, flow, cost));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} edmondskarp;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;addEdge&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; from, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; to, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; capacity, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; cost)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	nodes[from].firstEdge = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Edge(&amp;amp;nodes[from], &amp;amp;nodes[to], capacity, cost);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	nodes[to].firstEdge = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Edge(&amp;amp;nodes[to], &amp;amp;nodes[from], &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, -cost);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	nodes[from].firstEdge-&amp;gt;reversedEdge = nodes[to].firstEdge, nodes[to].firstEdge-&amp;gt;reversedEdge = nodes[from].firstEdge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;getDistances&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; j = i + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; j &amp;lt; n; j++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			dist[i][j] = dist[j][i] = &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::min(&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;abs&lt;/span&gt;(j - i), (n - j) + i);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	freopen(&lt;span class=&quot;string&quot;&gt;&amp;quot;overload.in&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;r&amp;quot;&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;stdin&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	freopen(&lt;span class=&quot;string&quot;&gt;&amp;quot;overload.out&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;w&amp;quot;&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;stdout&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;n);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; sum = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;a[i]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		sum += a[i];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; average = sum / n;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) a[i] -= average;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	getDistances();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; s = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, t = n + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (a[i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;] &amp;gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) addEdge(s, i, a[i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;], &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (a[i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;] &amp;lt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) addEdge(i, t, -a[i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;], &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (a[i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;] &amp;gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; j = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; j &amp;lt;= n; j++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (a[j - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;] &amp;lt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) addEdge(i, j, INT_MAX, dist[i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;][j - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; flow, cost;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	edmondskarp(s, t, n + &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, flow, cost);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d\n&amp;quot;&lt;/span&gt;, cost);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	fclose(&lt;span class=&quot;built_in&quot;&gt;stdin&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	fclose(&lt;span class=&quot;built_in&quot;&gt;stdout&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;G &amp;#x516C;&amp;#x53F8;&amp;#x6709; &lt;code&gt;n&lt;/code&gt; &amp;#x4E2A;&amp;#x6CBF;&amp;#x94C1;&amp;#x8DEF;&amp;#x8FD0;&amp;#x8F93;&amp;#x7EBF;&amp;#x73AF;&amp;#x5F62;&amp;#x6392;&amp;#x5217;&amp;#x7684;&amp;#x4ED3;&amp;#x5E93;&amp;#xFF0C;&amp;#x6BCF;&amp;#x4E2A;&amp;#x4ED3;&amp;#x5E93;&amp;#x5B58;&amp;#x50A8;&amp;#x7684;&amp;#x8D27;&amp;#x7269;&amp;#x6570;&amp;#x91CF;&amp;#x4E0D;&amp;#x7B49;&amp;#x3002;&amp;#x5982;&amp;#x4F55;&amp;#x7528;&amp;#x6700;&amp;#x5C11;&amp;#x642C;&amp;#x8FD0;&amp;#x91CF;&amp;#x53EF;&amp;#x4EE5;&amp;#x4F7F; &lt;code&gt;n&lt;/code&gt; &amp;#x4E2A;&amp;#x4ED3;&amp;#x5E93;&amp;#x7684;&amp;#x5E93;&amp;#x5B58;&amp;#x6570;&amp;#x91CF;&amp;#x76F8;&amp;#x540C;&amp;#x3002;&amp;#x642C;&amp;#x8FD0;&amp;#x8D27;&amp;#x7269;&amp;#x65F6;&amp;#xFF0C;&amp;#x53EA;&amp;#x80FD;&amp;#x5728;&amp;#x76F8;&amp;#x90BB;&amp;#x7684;&amp;#x4ED3;&amp;#x5E93;&amp;#x4E4B;&amp;#x95F4;&amp;#x642C;&amp;#x8FD0;&amp;#x3002;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="COGS" scheme="https://blog.menci.moe/tag/cogs/"/>
    
      <category term="Edmonds-Karp" scheme="https://blog.menci.moe/tag/edmonds-karp/"/>
    
      <category term="图论" scheme="https://blog.menci.moe/tag/%E5%9B%BE%E8%AE%BA/"/>
    
      <category term="网络流" scheme="https://blog.menci.moe/tag/%E7%BD%91%E7%BB%9C%E6%B5%81/"/>
    
      <category term="网络流24题" scheme="https://blog.menci.moe/tag/%E7%BD%91%E7%BB%9C%E6%B5%8124%E9%A2%98/"/>
    
      <category term="费用流" scheme="https://blog.menci.moe/tag/%E8%B4%B9%E7%94%A8%E6%B5%81/"/>
    
  </entry>
  
  <entry>
    <title>「COGS 740」分配问题 - 二分图最大权匹配</title>
    <link href="https://blog.menci.moe/cogs-740/"/>
    <id>https://blog.menci.moe/cogs-740/</id>
    <published>2016-02-25T00:08:29.000Z</published>
    <updated>2016-02-25T00:10:00.000Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x6709; &lt;code&gt;n&lt;/code&gt; &amp;#x4EF6;&amp;#x5DE5;&amp;#x4F5C;&amp;#x8981;&amp;#x5206;&amp;#x914D;&amp;#x7ED9; &lt;code&gt;n&lt;/code&gt; &amp;#x4E2A;&amp;#x4EBA;&amp;#x505A;&amp;#x3002;&amp;#x7B2C; &lt;code&gt;i&lt;/code&gt; &amp;#x4E2A;&amp;#x4EBA;&amp;#x505A;&amp;#x7B2C; &lt;code&gt;j&lt;/code&gt; &amp;#x4EF6;&amp;#x5DE5;&amp;#x4F5C;&amp;#x4EA7;&amp;#x751F;&amp;#x7684;&amp;#x6548;&amp;#x76CA;&amp;#x4E3A; &lt;code&gt;c[i][j]&lt;/code&gt;&amp;#x3002;&amp;#x8BD5;&amp;#x8BBE;&amp;#x8BA1;&amp;#x4E00;&amp;#x4E2A;&amp;#x5C06; &lt;code&gt;n&lt;/code&gt; &amp;#x4EF6;&amp;#x5DE5;&amp;#x4F5C;&amp;#x5206;&amp;#x914D;&amp;#x7ED9; &lt;code&gt;n&lt;/code&gt; &amp;#x4E2A;&amp;#x4EBA;&amp;#x505A;&amp;#x7684;&amp;#x5206;&amp;#x914D;&amp;#x65B9;&amp;#x6848;&amp;#xFF0C;&amp;#x4F7F;&amp;#x4EA7;&amp;#x751F;&amp;#x7684;&amp;#x603B;&amp;#x6548;&amp;#x76CA;&amp;#x6700;&amp;#x5927;&amp;#x3002;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;&amp;#x9898;&amp;#x76EE;&amp;#x94FE;&amp;#x63A5;&quot;&gt;&amp;#x9898;&amp;#x76EE;&amp;#x94FE;&amp;#x63A5;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://cogs.top/cogs/problem/problem.php?pid=740&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;COGS 740&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x89E3;&amp;#x9898;&amp;#x601D;&amp;#x8DEF;&quot;&gt;&amp;#x89E3;&amp;#x9898;&amp;#x601D;&amp;#x8DEF;&lt;/h3&gt;
&lt;p&gt;&amp;#x628A;&amp;#x5DE5;&amp;#x4F5C;&amp;#x548C;&amp;#x4EBA;&amp;#x653E;&amp;#x5728;&amp;#x7F51;&amp;#x7EDC;&amp;#x6D41;&amp;#x6A21;&amp;#x578B;&amp;#x4E2D;&amp;#xFF0C;&amp;#x53EF;&amp;#x4EE5;&amp;#x53D1;&amp;#x73B0;&amp;#x8FD9;&amp;#x662F;&amp;#x4E00;&amp;#x5F20;&amp;#x4E8C;&amp;#x5206;&amp;#x56FE;&amp;#xFF0C;&amp;#x95EE;&amp;#x9898;&amp;#x8F6C;&amp;#x5316;&amp;#x4E3A;&amp;#x4ECE;&amp;#x56FE;&amp;#x4E2D;&amp;#x9009;&amp;#x53D6;&amp;#x4E00;&amp;#x4E9B;&amp;#x8FB9;&amp;#xFF0C;&amp;#x4F7F;&amp;#x8FD9;&amp;#x4E9B;&amp;#x8FB9;&amp;#x6CA1;&amp;#x6709;&amp;#x4EA4;&amp;#x70B9;&amp;#xFF08;&amp;#x6CA1;&amp;#x6709;&amp;#x4EBA;&amp;#x505A;&amp;#x91CD;&amp;#x590D;&amp;#x7684;&amp;#x5DE5;&amp;#x4F5C;&amp;#xFF0C;&amp;#x6CA1;&amp;#x6709;&amp;#x5DE5;&amp;#x4F5C;&amp;#x88AB;&amp;#x91CD;&amp;#x590D;&amp;#x505A;&amp;#xFF09;&amp;#xFF0C;&amp;#x5E76;&amp;#x4E14;&amp;#x8FB9;&amp;#x6743;&amp;#x603B;&amp;#x548C;&amp;#x6700;&amp;#x5927;&amp;#x3002;&amp;#x5373;&lt;strong&gt;&amp;#x4E8C;&amp;#x5206;&amp;#x56FE;&amp;#x6700;&amp;#x5927;&amp;#x6743;&amp;#x5339;&amp;#x914D;&lt;/strong&gt;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x5EFA;&amp;#x7ACB;&amp;#x6E90;&amp;#x70B9;&amp;#x4E0E;&amp;#x6C47;&amp;#x70B9;&amp;#xFF0C;&amp;#x4ECE;&amp;#x6E90;&amp;#x70B9;&amp;#x5411;&amp;#x6BCF;&amp;#x4E2A;&amp;#x4EBA;&amp;#x8FDE;&amp;#x4E00;&amp;#x6761;&amp;#x8FB9;&amp;#xFF0C;&amp;#x5BB9;&amp;#x91CF;&amp;#x4E3A; 1&amp;#xFF08;&amp;#x6BCF;&amp;#x4E2A;&amp;#x4EBA;&amp;#x53EA;&amp;#x80FD;&amp;#x5339;&amp;#x914D;&amp;#x4E00;&amp;#x6B21;&amp;#xFF09;&amp;#xFF0C;&amp;#x8D39;&amp;#x7528;&amp;#x4E3A; 0&amp;#xFF1B;&amp;#x4ECE;&amp;#x6BCF;&amp;#x4E2A;&amp;#x5DE5;&amp;#x4F5C;&amp;#x5230;&amp;#x6C47;&amp;#x70B9;&amp;#x8FDE;&amp;#x4E00;&amp;#x6761;&amp;#x8FB9;&amp;#xFF0C;&amp;#x5BB9;&amp;#x91CF;&amp;#x4E3A; 1&amp;#xFF08;&amp;#x6BCF;&amp;#x4E2A;&amp;#x5DE5;&amp;#x4F5C;&amp;#x53EA;&amp;#x80FD;&amp;#x5339;&amp;#x914D;&amp;#x4E00;&amp;#x6B21;&amp;#xFF09;&amp;#xFF0C;&amp;#x8D39;&amp;#x7528;&amp;#x4E3A; 0&amp;#xFF1B;&amp;#x4ECE;&amp;#x6BCF;&amp;#x4E2A;&amp;#x4EBA;&amp;#x5411;&amp;#x6BCF;&amp;#x4E2A;&amp;#x5DE5;&amp;#x4F5C;&amp;#x8FDE;&amp;#x4E00;&amp;#x6761;&amp;#x8FB9;&amp;#xFF0C;&amp;#x5BB9;&amp;#x91CF;&amp;#x4E3A; 0&amp;#xFF0C;&amp;#x8D39;&amp;#x7528;&amp;#x4E3A;&amp;#x6548;&amp;#x76CA;&amp;#x7684;&amp;#x76F8;&amp;#x53CD;&amp;#x6570;&amp;#x3002;&amp;#x6C42;&amp;#x51FA;&amp;#x7F51;&amp;#x7EDC;&amp;#x7684;&amp;#x6700;&amp;#x5C0F;&amp;#x8D39;&amp;#x7528;&amp;#x6700;&amp;#x5927;&amp;#x6D41;&amp;#xFF0C;&amp;#x6240;&amp;#x5F97;&amp;#x8D39;&amp;#x7528;&amp;#x7684;&amp;#x76F8;&amp;#x53CD;&amp;#x6570;&amp;#x5373;&amp;#x4E3A;&amp;#x6700;&amp;#x5927;&amp;#x6743;&amp;#x5339;&amp;#x914D;&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;ac&amp;#x4EE3;&amp;#x7801;&quot;&gt;AC&amp;#x4EE3;&amp;#x7801;&lt;/h3&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;93&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;94&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;95&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;96&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;97&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;98&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;99&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;100&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;101&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;102&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;103&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;104&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;105&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;106&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;107&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;108&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;109&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;110&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;111&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;112&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;113&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;114&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;115&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;116&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;117&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;118&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;119&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;120&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;121&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;122&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;123&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;124&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;125&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;126&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;127&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;128&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;129&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;130&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;climits&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;algorithm&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;queue&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXN = &lt;span class=&quot;number&quot;&gt;100&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Node;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Edge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Node {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Edge *firstEdge, *inEdge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; dist, flow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; inQueue;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} nodes[MAXN + MAXN + &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Edge {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Node *from, *to;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; capacity, flow, cost;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Edge *next, *reversedEdge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Edge(Node *from, Node *to, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; capacity, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; cost) : from(from), to(to), next(from-&amp;gt;firstEdge), capacity(capacity), flow(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;), cost(cost) {}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;};&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, a[MAXN][MAXN];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; EdmondsKarp {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;bellmanford&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Node *s, Node *t, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &amp;amp;flow, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &amp;amp;cost)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			nodes[i].dist = INT_MAX;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			nodes[i].inEdge = &lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			nodes[i].flow = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			nodes[i].inQueue = &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;queue&lt;/span&gt;&amp;lt;Node *&amp;gt; q;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		q.push(s);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		s-&amp;gt;dist = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		s-&amp;gt;flow = INT_MAX;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (!q.empty()) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			Node *v = q.front();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			q.pop();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			v-&amp;gt;inQueue = &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (Edge *e = v-&amp;gt;firstEdge; e; e = e-&amp;gt;next) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (e-&amp;gt;flow &amp;lt; e-&amp;gt;capacity &amp;amp;&amp;amp; e-&amp;gt;to-&amp;gt;dist &amp;gt; v-&amp;gt;dist + e-&amp;gt;cost) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					e-&amp;gt;to-&amp;gt;dist = v-&amp;gt;dist + e-&amp;gt;cost;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					e-&amp;gt;to-&amp;gt;inEdge = e;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					e-&amp;gt;to-&amp;gt;flow = &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::min(v-&amp;gt;flow, e-&amp;gt;capacity - e-&amp;gt;flow);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!e-&amp;gt;to-&amp;gt;inQueue) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;						e-&amp;gt;to-&amp;gt;inQueue = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;						q.push(e-&amp;gt;to);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (t-&amp;gt;dist == INT_MAX) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (Edge *e = t-&amp;gt;inEdge; e; e = e-&amp;gt;from-&amp;gt;inEdge) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			e-&amp;gt;flow += t-&amp;gt;flow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			e-&amp;gt;reversedEdge-&amp;gt;flow -= t-&amp;gt;flow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		flow += t-&amp;gt;flow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		cost += t-&amp;gt;dist * t-&amp;gt;flow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;operator&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; s, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; t, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &amp;amp;flow, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &amp;amp;cost)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		flow = cost = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (bellmanford(&amp;amp;nodes[s], &amp;amp;nodes[t], n, flow, cost));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} edmondskarp;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;addEdge&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; from, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; to, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; capacity, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; cost)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	nodes[from].firstEdge = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Edge(&amp;amp;nodes[from], &amp;amp;nodes[to], capacity, cost);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	nodes[to].firstEdge = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Edge(&amp;amp;nodes[to], &amp;amp;nodes[from], &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, -cost);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	nodes[from].firstEdge-&amp;gt;reversedEdge = nodes[to].firstEdge, nodes[to].firstEdge-&amp;gt;reversedEdge = nodes[from].firstEdge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;solve&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; d)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n + n + &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		Edge *next;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (Edge *&amp;amp;e = nodes[i].firstEdge; e; next = e-&amp;gt;next, &lt;span class=&quot;keyword&quot;&gt;delete&lt;/span&gt; e, e = next);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; s = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, t = n + n + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		addEdge(s, i, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		addEdge(n + i, t, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; j = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; j &amp;lt;= n; j++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			addEdge(i, n + j, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, a[i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;][j - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;] * d);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; flow, cost;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	edmondskarp(s, t, n + n + &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, flow, cost);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; cost * d;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	freopen(&lt;span class=&quot;string&quot;&gt;&amp;quot;job.in&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;r&amp;quot;&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;stdin&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	freopen(&lt;span class=&quot;string&quot;&gt;&amp;quot;job.out&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;w&amp;quot;&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;stdout&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;n);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; j = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; j &amp;lt; n; j++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;a[i][j]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d\n&amp;quot;&lt;/span&gt;, solve(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d\n&amp;quot;&lt;/span&gt;, solve(-&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	fclose(&lt;span class=&quot;built_in&quot;&gt;stdin&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	fclose(&lt;span class=&quot;built_in&quot;&gt;stdout&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x6709; &lt;code&gt;n&lt;/code&gt; &amp;#x4EF6;&amp;#x5DE5;&amp;#x4F5C;&amp;#x8981;&amp;#x5206;&amp;#x914D;&amp;#x7ED9; &lt;code&gt;n&lt;/code&gt; &amp;#x4E2A;&amp;#x4EBA;&amp;#x505A;&amp;#x3002;&amp;#x7B2C; &lt;code&gt;i&lt;/code&gt; &amp;#x4E2A;&amp;#x4EBA;&amp;#x505A;&amp;#x7B2C; &lt;code&gt;j&lt;/code&gt; &amp;#x4EF6;&amp;#x5DE5;&amp;#x4F5C;&amp;#x4EA7;&amp;#x751F;&amp;#x7684;&amp;#x6548;&amp;#x76CA;&amp;#x4E3A; &lt;code&gt;c[i][j]&lt;/code&gt;&amp;#x3002;&amp;#x8BD5;&amp;#x8BBE;&amp;#x8BA1;&amp;#x4E00;&amp;#x4E2A;&amp;#x5C06; &lt;code&gt;n&lt;/code&gt; &amp;#x4EF6;&amp;#x5DE5;&amp;#x4F5C;&amp;#x5206;&amp;#x914D;&amp;#x7ED9; &lt;code&gt;n&lt;/code&gt; &amp;#x4E2A;&amp;#x4EBA;&amp;#x505A;&amp;#x7684;&amp;#x5206;&amp;#x914D;&amp;#x65B9;&amp;#x6848;&amp;#xFF0C;&amp;#x4F7F;&amp;#x4EA7;&amp;#x751F;&amp;#x7684;&amp;#x603B;&amp;#x6548;&amp;#x76CA;&amp;#x6700;&amp;#x5927;&amp;#x3002;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="COGS" scheme="https://blog.menci.moe/tag/cogs/"/>
    
      <category term="Edmonds-Karp" scheme="https://blog.menci.moe/tag/edmonds-karp/"/>
    
      <category term="二分图匹配" scheme="https://blog.menci.moe/tag/%E4%BA%8C%E5%88%86%E5%9B%BE%E5%8C%B9%E9%85%8D/"/>
    
      <category term="图论" scheme="https://blog.menci.moe/tag/%E5%9B%BE%E8%AE%BA/"/>
    
      <category term="网络流" scheme="https://blog.menci.moe/tag/%E7%BD%91%E7%BB%9C%E6%B5%81/"/>
    
      <category term="网络流24题" scheme="https://blog.menci.moe/tag/%E7%BD%91%E7%BB%9C%E6%B5%8124%E9%A2%98/"/>
    
      <category term="费用流" scheme="https://blog.menci.moe/tag/%E8%B4%B9%E7%94%A8%E6%B5%81/"/>
    
  </entry>
  
  <entry>
    <title>「CTSC1999」星际转移 - 网络流</title>
    <link href="https://blog.menci.moe/ctsc1999-home/"/>
    <id>https://blog.menci.moe/ctsc1999-home/</id>
    <published>2016-02-24T13:41:36.000Z</published>
    <updated>2016-02-24T13:42:46.000Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x73B0;&amp;#x6709; &lt;code&gt;n&lt;/code&gt; &amp;#x4E2A;&amp;#x592A;&amp;#x7A7A;&amp;#x7AD9;&amp;#x4F4D;&amp;#x4E8E;&amp;#x5730;&amp;#x7403;&amp;#x4E0E;&amp;#x6708;&amp;#x7403;&amp;#x4E4B;&amp;#x95F4;&amp;#xFF0C;&amp;#x4E14;&amp;#x6709; &lt;code&gt;m&lt;/code&gt; &amp;#x8258;&amp;#x592A;&amp;#x7A7A;&amp;#x8239;&amp;#x5728;&amp;#x5176;&amp;#x95F4;&amp;#x6765;&amp;#x56DE;&amp;#x7A7F;&amp;#x68AD;&amp;#x3002;&amp;#x6BCF;&amp;#x4E2A;&amp;#x592A;&amp;#x7A7A;&amp;#x7AD9;&amp;#x53EF;&amp;#x5BB9;&amp;#x7EB3;&amp;#x65E0;&amp;#x9650;&amp;#x591A;&amp;#x7684;&amp;#x4EBA;&amp;#xFF0C;&amp;#x7B2C; &lt;code&gt;i&lt;/code&gt; &amp;#x4E2A;&amp;#x592A;&amp;#x7A7A;&amp;#x8239;&amp;#x53EA;&amp;#x53EF;&amp;#x5BB9;&amp;#x7EB3; &lt;code&gt;H[i]&lt;/code&gt; &amp;#x4E2A;&amp;#x4EBA;&amp;#x3002;&amp;#x6BCF;&amp;#x8258;&amp;#x592A;&amp;#x7A7A;&amp;#x8239;&amp;#x5C06;&amp;#x5468;&amp;#x671F;&amp;#x6027;&amp;#x5730;&amp;#x505C;&amp;#x9760;&amp;#x4E00;&amp;#x7CFB;&amp;#x5217;&amp;#x7684;&amp;#x592A;&amp;#x7A7A;&amp;#x7AD9;&amp;#x3002;&amp;#x6BCF;&amp;#x4E00;&amp;#x8258;&amp;#x592A;&amp;#x7A7A;&amp;#x8239;&amp;#x4ECE;&amp;#x4E00;&amp;#x4E2A;&amp;#x592A;&amp;#x7A7A;&amp;#x7AD9;&amp;#x9A76;&amp;#x5F80;&amp;#x4EFB;&amp;#x4E00;&amp;#x592A;&amp;#x7A7A;&amp;#x7AD9;&amp;#x8017;&amp;#x65F6;&amp;#x5747;&amp;#x4E3A; 1&amp;#x3002;&amp;#x4EBA;&amp;#x4EEC;&amp;#x53EA;&amp;#x80FD;&amp;#x5728;&amp;#x592A;&amp;#x7A7A;&amp;#x8239;&amp;#x505C;&amp;#x9760;&amp;#x592A;&amp;#x7A7A;&amp;#x7AD9;&amp;#xFF08;&amp;#x6216;&amp;#x6708;&amp;#x7403;&amp;#x3001;&amp;#x5730;&amp;#x7403;&amp;#xFF09;&amp;#x65F6;&amp;#x4E0A;&amp;#x3001;&amp;#x4E0B;&amp;#x8239;&amp;#x3002;&amp;#x521D;&amp;#x59CB;&amp;#x65F6;&amp;#x6240;&amp;#x6709;&amp;#x4EBA;&amp;#x5168;&amp;#x5728;&amp;#x5730;&amp;#x7403;&amp;#x4E0A;&amp;#xFF0C;&amp;#x592A;&amp;#x7A7A;&amp;#x8239;&amp;#x5168;&amp;#x5728;&amp;#x521D;&amp;#x59CB;&amp;#x7AD9;&amp;#x3002;&amp;#x6C42;&amp;#x8BA9;&amp;#x6240;&amp;#x6709;&amp;#x4EBA;&amp;#x5C3D;&amp;#x5FEB;&amp;#x5730;&amp;#x5168;&amp;#x90E8;&amp;#x8F6C;&amp;#x79FB;&amp;#x5230;&amp;#x6708;&amp;#x7403;&amp;#x4E0A;&amp;#x7684;&amp;#x6700;&amp;#x77ED;&amp;#x65F6;&amp;#x95F4;&amp;#x3002;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;&amp;#x9898;&amp;#x76EE;&amp;#x94FE;&amp;#x63A5;&quot;&gt;&amp;#x9898;&amp;#x76EE;&amp;#x94FE;&amp;#x63A5;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://cogs.top/cogs/problem/problem.php?pid=736&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;COGS 736&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x89E3;&amp;#x9898;&amp;#x601D;&amp;#x8DEF;&quot;&gt;&amp;#x89E3;&amp;#x9898;&amp;#x601D;&amp;#x8DEF;&lt;/h3&gt;
&lt;p&gt;&amp;#x8BDD;&amp;#x8BF4;&amp;#x8FD9;&amp;#x9898;&amp;#x771F;&amp;#x662F;&amp;#x96BE;&amp;#x8C03; &amp;#x2026;&amp;#x2026; qwq&lt;/p&gt;
&lt;p&gt;&amp;#x8003;&amp;#x8651;&amp;#x5230;&amp;#x300E;&amp;#x4E00;&amp;#x4E2A;&amp;#x592A;&amp;#x7A7A;&amp;#x7AD9;&amp;#x548C;&amp;#x4E00;&amp;#x4E2A;&amp;#x65F6;&amp;#x95F4;&amp;#x70B9;&amp;#x300F;&amp;#x786E;&amp;#x5B9A;&amp;#x4E86;&amp;#x4E00;&amp;#x4E2A;&amp;#x72B6;&amp;#x6001;&amp;#xFF0C;&amp;#x679A;&amp;#x4E3E;&amp;#x7B54;&amp;#x6848; &lt;code&gt;t&lt;/code&gt;&amp;#xFF0C;&amp;#x5C06;&amp;#x6BCF;&amp;#x4E2A;&amp;#x592A;&amp;#x7A7A;&amp;#x7AD9;&amp;#x62C6;&amp;#x6210; &lt;code&gt;t + 1&lt;/code&gt; &amp;#x4E2A;&amp;#x70B9;&amp;#xFF08;&amp;#x56E0;&amp;#x4E3A;&amp;#x521D;&amp;#x59CB;&amp;#x72B6;&amp;#x6001;&amp;#x662F;&amp;#x5728; 0 &amp;#x65F6;&amp;#x523B;&amp;#xFF09;&amp;#x3002;&amp;#x5BF9;&amp;#x4E8E;&amp;#x6BCF;&amp;#x4E00;&amp;#x4E2A;&amp;#x65F6;&amp;#x523B;&amp;#xFF0C;&amp;#x4ECE;&lt;strong&gt;&amp;#x4E0A;&amp;#x4E00;&amp;#x65F6;&amp;#x523B;&amp;#x6BCF;&amp;#x4E2A;&amp;#x592A;&amp;#x7A7A;&amp;#x8239;&amp;#x7684;&amp;#x505C;&amp;#x7559;&amp;#x7AD9;&lt;/strong&gt;&amp;#x5230;&lt;strong&gt;&amp;#x8FD9;&amp;#x4E00;&amp;#x65F6;&amp;#x523B;&amp;#x6BCF;&amp;#x4E2A;&amp;#x592A;&amp;#x7A7A;&amp;#x8239;&amp;#x7684;&amp;#x505C;&amp;#x7559;&amp;#x7AD9;&lt;/strong&gt;&amp;#x8FDE;&amp;#x4E00;&amp;#x6761;&amp;#x8FB9;&amp;#xFF0C;&amp;#x5BB9;&amp;#x91CF;&amp;#x4E3A;&amp;#x8BE5;&amp;#x592A;&amp;#x7A7A;&amp;#x8239;&amp;#x8F7D;&amp;#x5BA2;&amp;#x91CF;&amp;#xFF1B;&amp;#x5BF9;&amp;#x4E8E;&amp;#x4EFB;&amp;#x4F55;&amp;#x4E00;&amp;#x4E2A;&amp;#x592A;&amp;#x7A7A;&amp;#x7AD9;&amp;#xFF0C;&amp;#x4ECE;&amp;#x4E0A;&amp;#x4E00;&amp;#x65F6;&amp;#x523B;&amp;#x5230;&amp;#x8FD9;&amp;#x4E00;&amp;#x65F6;&amp;#x523B;&amp;#x8FDE;&amp;#x4E00;&amp;#x6761;&amp;#x8FB9;&amp;#xFF0C;&amp;#x5BB9;&amp;#x91CF;&amp;#x4E3A;&amp;#x6B63;&amp;#x65E0;&amp;#x7A77;&amp;#xFF08;&amp;#x8868;&amp;#x793A;&amp;#x4EBA;&amp;#x505C;&amp;#x7559;&amp;#x5728;&amp;#x592A;&amp;#x7A7A;&amp;#x7AD9;&amp;#xFF09;&amp;#xFF1B;&amp;#x5BF9;&amp;#x4E8E;&amp;#x4EFB;&amp;#x610F;&amp;#x65F6;&amp;#x523B;&amp;#x7684;&amp;#x5730;&amp;#x7403;&amp;#xFF0C;&amp;#x4ECE;&amp;#x6E90;&amp;#x70B9;&amp;#x5411;&amp;#x5176;&amp;#x8FDE;&amp;#x4E00;&amp;#x6761;&amp;#x8FB9;&amp;#xFF0C;&amp;#x5BB9;&amp;#x91CF;&amp;#x4E3A;&amp;#x6B63;&amp;#x65E0;&amp;#x7A77;&amp;#xFF1B;&amp;#x5BF9;&amp;#x4E8E;&amp;#x4EFB;&amp;#x610F;&amp;#x65F6;&amp;#x523B;&amp;#x7684;&amp;#x6708;&amp;#x7403;&amp;#xFF0C;&amp;#x4ECE;&amp;#x5176;&amp;#x5411;&amp;#x6C47;&amp;#x70B9;&amp;#x8FDE;&amp;#x4E00;&amp;#x6761;&amp;#x8FB9;&amp;#xFF0C;&amp;#x5BB9;&amp;#x91CF;&amp;#x4E3A;&amp;#x6B63;&amp;#x65E0;&amp;#x7A77;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x4ECE;&amp;#x5C0F;&amp;#x5230;&amp;#x5927;&amp;#x679A;&amp;#x4E3E;&amp;#x7B54;&amp;#x6848;&amp;#xFF0C;&amp;#x7B54;&amp;#x6848;&amp;#x6BCF;&amp;#x589E;&amp;#x5927; 1&amp;#xFF0C;&amp;#x5728;&amp;#x539F;&amp;#x56FE;&amp;#x4E2D;&amp;#x52A0;&amp;#x5165;&amp;#x65B0;&amp;#x8FB9;&amp;#x3002;&amp;#x76F4;&amp;#x5230;&amp;#x6C47;&amp;#x70B9;&amp;#x7684;&amp;#x6D41;&amp;#x91CF;&amp;#x5927;&amp;#x4E8E;&amp;#x7B49;&amp;#x4E8E;&amp;#x603B;&amp;#x4EBA;&amp;#x6570;&amp;#xFF0C;&amp;#x5219;&amp;#x7B54;&amp;#x6848;&amp;#x5408;&amp;#x6CD5;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x4E5F;&amp;#x53EF;&amp;#x4EE5;&amp;#x4E8C;&amp;#x5206;&amp;#x7B54;&amp;#x6848; &amp;#x2026;&amp;#x2026; &amp;#x4E0D;&amp;#x8FC7;&amp;#x90A3;&amp;#x6837;&amp;#x8981;&amp;#x62C6;&amp;#x6389;&amp;#x56FE;&amp;#x91CD;&amp;#x5EFA;&amp;#xFF0C;&amp;#x603B;&amp;#x611F;&amp;#x89C9;&amp;#x6570;&amp;#x636E;&amp;#x5C0F;&amp;#x7684;&amp;#x60C5;&amp;#x51B5;&amp;#x4E0B;&amp;#x6BD4;&amp;#x679A;&amp;#x4E3E;&amp;#x8FD8;&amp;#x8981;&amp;#x6162;&amp;#x3002;qwq&lt;/p&gt;
&lt;p&gt;&amp;#x6570;&amp;#x636E;&amp;#x8303;&amp;#x56F4;&amp;#x6709;&amp;#x5751;&amp;#xFF01;&amp;#x6570;&amp;#x636E;&amp;#x8303;&amp;#x56F4;&amp;#x6709;&amp;#x5751;&amp;#xFF01;&amp;#x6570;&amp;#x636E;&amp;#x8303;&amp;#x56F4;&amp;#x6709;&amp;#x5751;&amp;#xFF01;&lt;code&gt;n&lt;/code&gt; &amp;#x548C; &lt;code&gt;m&lt;/code&gt; &amp;#x7684;&amp;#x6700;&amp;#x5927;&amp;#x503C;&amp;#x98A0;&amp;#x5012;&amp;#x4E86;&amp;#xFF01;&lt;/p&gt;
&lt;h3 id=&quot;ac&amp;#x4EE3;&amp;#x7801;&quot;&gt;AC&amp;#x4EE3;&amp;#x7801;&lt;/h3&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;93&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;94&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;95&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;96&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;97&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;98&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;99&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;100&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;101&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;102&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;103&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;104&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;105&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;106&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;107&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;108&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;109&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;110&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;111&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;112&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;113&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;114&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;115&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;116&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;117&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;118&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;119&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;120&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;121&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;122&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;123&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;124&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;125&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;126&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;127&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;128&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;129&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;130&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;131&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;132&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;133&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;134&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;135&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;136&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;137&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;138&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;139&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;140&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;141&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;142&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;143&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;144&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;145&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;146&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;147&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;148&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;149&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;150&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;151&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;152&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;153&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;154&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;155&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;156&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;157&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;158&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;159&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;160&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;161&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;162&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;163&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;164&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;165&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;166&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;167&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;168&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;169&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;170&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;171&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;172&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;173&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;174&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;175&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;176&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;177&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;178&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;179&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;180&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;181&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;182&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;183&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;184&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;185&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;186&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;187&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;188&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;189&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;190&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;191&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;192&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;climits&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;algorithm&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;queue&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;vector&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXN = &lt;span class=&quot;number&quot;&gt;13&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXM = &lt;span class=&quot;number&quot;&gt;20&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXK = &lt;span class=&quot;number&quot;&gt;50&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Node;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Edge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Node {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Edge *firstEdge, *currentEdge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; level;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;comment&quot;&gt;//char info[256];&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} nodes[MAXN * (MAXN + &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;) * (MAXM + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) * MAXK * &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; + &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Edge {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Node *from, *to;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; capacity, flow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Edge *next, *reversedEdge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Edge(Node *from, Node *to, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; capacity) : from(from), to(to), capacity(capacity), flow(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;), next(from-&amp;gt;firstEdge) {}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;};&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, m, k, a[MAXM];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;vector&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;&amp;gt; v[MAXM];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;vector&lt;/span&gt;&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;&amp;gt;::const_iterator currentStation[MAXM];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Node *v)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;comment&quot;&gt;//printf(&amp;quot;%s&amp;quot;, v-&amp;gt;info);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;comment&quot;&gt;//int x = (int)(v - nodes);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;comment&quot;&gt;//if (x == 0) putchar(&amp;apos;s&amp;apos;);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;comment&quot;&gt;//else if (x == n * (n + 2) * (m + 1) * k * 2 + 1) putchar(&amp;apos;t&amp;apos;);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;comment&quot;&gt;//else {&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;comment&quot;&gt;//	printf(&amp;quot;{ day: %d, station: %d }&amp;quot;, x / (n + 2), x % (n + 2) - 2);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;comment&quot;&gt;//}&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Dinic {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;makeLevelGraph&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Node *s, Node *t, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) nodes[i].level = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;queue&lt;/span&gt;&amp;lt;Node *&amp;gt; q;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		q.push(s);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		s-&amp;gt;level = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (!q.empty()) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			Node *v = q.front();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			q.pop();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (Edge *e = v-&amp;gt;firstEdge; e; e = e-&amp;gt;next) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (e-&amp;gt;flow &amp;lt; e-&amp;gt;capacity &amp;amp;&amp;amp; e-&amp;gt;to-&amp;gt;level == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;comment&quot;&gt;//print(e-&amp;gt;from);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;comment&quot;&gt;//printf(&amp;quot; -&amp;gt; &amp;quot;);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;comment&quot;&gt;//print(e-&amp;gt;to);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;comment&quot;&gt;//putchar(&amp;apos;\n&amp;apos;);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					e-&amp;gt;to-&amp;gt;level = v-&amp;gt;level + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (e-&amp;gt;to == t) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; q.push(e-&amp;gt;to);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;findPath&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Node *s, Node *t, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; limit = INT_MAX)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (s == t) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; limit;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (Edge *&amp;amp;e = s-&amp;gt;currentEdge; e; e = e-&amp;gt;next) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (e-&amp;gt;flow &amp;lt; e-&amp;gt;capacity &amp;amp;&amp;amp; e-&amp;gt;to-&amp;gt;level == s-&amp;gt;level + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; flow = findPath(e-&amp;gt;to, t, &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::min(e-&amp;gt;capacity - e-&amp;gt;flow, limit));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (flow &amp;gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;comment&quot;&gt;//printf(&amp;quot;(%d)\n&amp;quot;, (int)(s - nodes));&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					e-&amp;gt;flow += flow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					e-&amp;gt;reversedEdge-&amp;gt;flow -= flow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; flow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;operator&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; s, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; t, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (Edge *e = nodes[i].firstEdge; e; e = e-&amp;gt;next) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				e-&amp;gt;flow = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; ans = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (makeLevelGraph(&amp;amp;nodes[s], &amp;amp;nodes[t], n)) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) nodes[i].currentEdge = nodes[i].firstEdge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; flow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; ((flow = findPath(&amp;amp;nodes[s], &amp;amp;nodes[t])) &amp;gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) ans += flow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; ans;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} dinic;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;addEdge&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; from, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; to, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; capacity)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;comment&quot;&gt;//printf(&amp;quot;\t\t%d\n&amp;quot;, capacity);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	nodes[from].firstEdge = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Edge(&amp;amp;nodes[from], &amp;amp;nodes[to], capacity);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	nodes[to].firstEdge = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Edge(&amp;amp;nodes[to], &amp;amp;nodes[from], &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	nodes[from].firstEdge-&amp;gt;reversedEdge = nodes[to].firstEdge, nodes[to].firstEdge-&amp;gt;reversedEdge = nodes[from].firstEdge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;stationID&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; station, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; day)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;comment&quot;&gt;//sprintf(nodes[day * (n + 2) + station].info, &amp;quot;{ day: %d, station: %d }&amp;quot;, day, station - 2);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; day * (n + &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;) + station;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;solve&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; s = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, t = n * (n + &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;) * (m + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) * k * &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;comment&quot;&gt;//nodes[s].info[0] = &amp;apos;s&amp;apos;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;comment&quot;&gt;//nodes[t].info[0] = &amp;apos;t&amp;apos;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;comment&quot;&gt;//puts(&amp;quot;s --&amp;gt; { day: 0, station: 0 }&amp;quot;);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	addEdge(s, stationID(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;), INT_MAX);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;comment&quot;&gt;//puts(&amp;quot;s --&amp;gt; { day: 0, station: -1 }&amp;quot;);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	addEdge(stationID(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;), t, INT_MAX);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= (n + &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;) * (m + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) * k * &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; j = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; j &amp;lt;= m; j++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; oldStation = *currentStation[j - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			currentStation[j - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]++;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (currentStation[j - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;] == v[j - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;].end()) currentStation[j - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;] = v[j - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;].begin();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; newStation = *currentStation[j - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;comment&quot;&gt;//printf(&amp;quot;{ day: %d, station: %d } --&amp;gt; { day: %d, station: %d }\n&amp;quot;, i - 1, oldStation - 2, i, newStation - 2);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			addEdge(stationID(oldStation, i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;), stationID(newStation, i), a[j - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;comment&quot;&gt;//printf(&amp;quot;s --&amp;gt; { day: %d, station: 0 }\n&amp;quot;, i);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;comment&quot;&gt;//printf(&amp;quot;{ day: %d, station: -1 } --&amp;gt; t\n&amp;quot;, i);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		addEdge(stationID(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, i), t, INT_MAX);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		addEdge(s, stationID(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, i), INT_MAX);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; j = &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;; j &amp;lt;= n + &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;; j++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;comment&quot;&gt;//printf(&amp;quot;{ day: %d, station: %d } --&amp;gt; { day: %d, station: %d }\n&amp;quot;, i - 1, j - 2, i, j - 2);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			addEdge(stationID(j, i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;), stationID(j, i), INT_MAX);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; flow = dinic(s, t, n * (n + &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;) * (m + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) * k * &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; + &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;comment&quot;&gt;//printf(&amp;quot;%d\n&amp;quot;, flow);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (flow &amp;gt;= k) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; i;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;comment&quot;&gt;//printf(&amp;quot;%d\n&amp;quot;, sizeof(nodes));&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	freopen(&lt;span class=&quot;string&quot;&gt;&amp;quot;home.in&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;r&amp;quot;&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;stdin&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	freopen(&lt;span class=&quot;string&quot;&gt;&amp;quot;home.out&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;w&amp;quot;&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;stdout&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d %d&amp;quot;&lt;/span&gt;, &amp;amp;n, &amp;amp;m, &amp;amp;k);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; m; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;a[i]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; t;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;t);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; j = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; j &amp;lt; t; j++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; x;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;x);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			v[i].push_back(x + &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		currentStation[i] = v[i].begin();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d\n&amp;quot;&lt;/span&gt;, solve());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	fclose(&lt;span class=&quot;built_in&quot;&gt;stdin&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	fclose(&lt;span class=&quot;built_in&quot;&gt;stdout&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x73B0;&amp;#x6709; &lt;code&gt;n&lt;/code&gt; &amp;#x4E2A;&amp;#x592A;&amp;#x7A7A;&amp;#x7AD9;&amp;#x4F4D;&amp;#x4E8E;&amp;#x5730;&amp;#x7403;&amp;#x4E0E;&amp;#x6708;&amp;#x7403;&amp;#x4E4B;&amp;#x95F4;&amp;#xFF0C;&amp;#x4E14;&amp;#x6709; &lt;code&gt;m&lt;/code&gt; &amp;#x8258;&amp;#x592A;&amp;#x7A7A;&amp;#x8239;&amp;#x5728;&amp;#x5176;&amp;#x95F4;&amp;#x6765;&amp;#x56DE;&amp;#x7A7F;&amp;#x68AD;&amp;#x3002;&amp;#x6BCF;&amp;#x4E2A;&amp;#x592A;&amp;#x7A7A;&amp;#x7AD9;&amp;#x53EF;&amp;#x5BB9;&amp;#x7EB3;&amp;#x65E0;&amp;#x9650;&amp;#x591A;&amp;#x7684;&amp;#x4EBA;&amp;#xFF0C;&amp;#x7B2C; &lt;code&gt;i&lt;/code&gt; &amp;#x4E2A;&amp;#x592A;&amp;#x7A7A;&amp;#x8239;&amp;#x53EA;&amp;#x53EF;&amp;#x5BB9;&amp;#x7EB3; &lt;code&gt;H[i]&lt;/code&gt; &amp;#x4E2A;&amp;#x4EBA;&amp;#x3002;&amp;#x6BCF;&amp;#x8258;&amp;#x592A;&amp;#x7A7A;&amp;#x8239;&amp;#x5C06;&amp;#x5468;&amp;#x671F;&amp;#x6027;&amp;#x5730;&amp;#x505C;&amp;#x9760;&amp;#x4E00;&amp;#x7CFB;&amp;#x5217;&amp;#x7684;&amp;#x592A;&amp;#x7A7A;&amp;#x7AD9;&amp;#x3002;&amp;#x6BCF;&amp;#x4E00;&amp;#x8258;&amp;#x592A;&amp;#x7A7A;&amp;#x8239;&amp;#x4ECE;&amp;#x4E00;&amp;#x4E2A;&amp;#x592A;&amp;#x7A7A;&amp;#x7AD9;&amp;#x9A76;&amp;#x5F80;&amp;#x4EFB;&amp;#x4E00;&amp;#x592A;&amp;#x7A7A;&amp;#x7AD9;&amp;#x8017;&amp;#x65F6;&amp;#x5747;&amp;#x4E3A; 1&amp;#x3002;&amp;#x4EBA;&amp;#x4EEC;&amp;#x53EA;&amp;#x80FD;&amp;#x5728;&amp;#x592A;&amp;#x7A7A;&amp;#x8239;&amp;#x505C;&amp;#x9760;&amp;#x592A;&amp;#x7A7A;&amp;#x7AD9;&amp;#xFF08;&amp;#x6216;&amp;#x6708;&amp;#x7403;&amp;#x3001;&amp;#x5730;&amp;#x7403;&amp;#xFF09;&amp;#x65F6;&amp;#x4E0A;&amp;#x3001;&amp;#x4E0B;&amp;#x8239;&amp;#x3002;&amp;#x521D;&amp;#x59CB;&amp;#x65F6;&amp;#x6240;&amp;#x6709;&amp;#x4EBA;&amp;#x5168;&amp;#x5728;&amp;#x5730;&amp;#x7403;&amp;#x4E0A;&amp;#xFF0C;&amp;#x592A;&amp;#x7A7A;&amp;#x8239;&amp;#x5168;&amp;#x5728;&amp;#x521D;&amp;#x59CB;&amp;#x7AD9;&amp;#x3002;&amp;#x6C42;&amp;#x8BA9;&amp;#x6240;&amp;#x6709;&amp;#x4EBA;&amp;#x5C3D;&amp;#x5FEB;&amp;#x5730;&amp;#x5168;&amp;#x90E8;&amp;#x8F6C;&amp;#x79FB;&amp;#x5230;&amp;#x6708;&amp;#x7403;&amp;#x4E0A;&amp;#x7684;&amp;#x6700;&amp;#x77ED;&amp;#x65F6;&amp;#x95F4;&amp;#x3002;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="COGS" scheme="https://blog.menci.moe/tag/cogs/"/>
    
      <category term="CTSC" scheme="https://blog.menci.moe/tag/ctsc/"/>
    
      <category term="Dinic" scheme="https://blog.menci.moe/tag/dinic/"/>
    
      <category term="图论" scheme="https://blog.menci.moe/tag/%E5%9B%BE%E8%AE%BA/"/>
    
      <category term="枚举答案" scheme="https://blog.menci.moe/tag/%E6%9E%9A%E4%B8%BE%E7%AD%94%E6%A1%88/"/>
    
      <category term="网络流" scheme="https://blog.menci.moe/tag/%E7%BD%91%E7%BB%9C%E6%B5%81/"/>
    
      <category term="网络流24题" scheme="https://blog.menci.moe/tag/%E7%BD%91%E7%BB%9C%E6%B5%8124%E9%A2%98/"/>
    
  </entry>
  
  <entry>
    <title>「COGS 742」深海机器人 - 费用流</title>
    <link href="https://blog.menci.moe/cogs-742/"/>
    <id>https://blog.menci.moe/cogs-742/</id>
    <published>2016-02-23T13:44:06.000Z</published>
    <updated>2016-02-23T13:44:58.000Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x6709;&amp;#x591A;&amp;#x4E2A;&amp;#x6DF1;&amp;#x6D77;&amp;#x673A;&amp;#x5668;&amp;#x4EBA;&amp;#x5230;&amp;#x8FBE;&amp;#x6DF1;&amp;#x6D77;&amp;#x6D77;&amp;#x5E95;&amp;#x540E;&amp;#x79BB;&amp;#x5F00;&amp;#x6F5C;&amp;#x8247;&amp;#x5411;&amp;#x9884;&amp;#x5B9A;&amp;#x76EE;&amp;#x6807;&amp;#x79FB;&amp;#x52A8;&amp;#x3002;&amp;#x6DF1;&amp;#x6D77;&amp;#x673A;&amp;#x5668;&amp;#x4EBA;&amp;#x5728;&amp;#x79FB;&amp;#x52A8;&amp;#x4E2D;&amp;#x8FD8;&amp;#x5FC5;&amp;#x987B;&amp;#x6CBF;&amp;#x9014;&amp;#x91C7;&amp;#x96C6;&amp;#x6D77;&amp;#x5E95;&amp;#x751F;&amp;#x7269;&amp;#x6807;&amp;#x672C;&amp;#x3002;&amp;#x6CBF;&amp;#x9014;&amp;#x751F;&amp;#x7269;&amp;#x6807;&amp;#x672C;&amp;#x7531;&amp;#x6700;&amp;#x5148;&amp;#x9047;&amp;#x5230;&amp;#x5B83;&amp;#x7684;&amp;#x6DF1;&amp;#x6D77;&amp;#x673A;&amp;#x5668;&amp;#x4EBA;&amp;#x5B8C;&amp;#x6210;&amp;#x91C7;&amp;#x96C6;&amp;#x3002;&amp;#x6BCF;&amp;#x6761;&amp;#x9884;&amp;#x5B9A;&amp;#x8DEF;&amp;#x5F84;&amp;#x4E0A;&amp;#x7684;&amp;#x751F;&amp;#x7269;&amp;#x6807;&amp;#x672C;&amp;#x7684;&amp;#x4EF7;&amp;#x503C;&amp;#x662F;&amp;#x5DF2;&amp;#x77E5;&amp;#x7684;&amp;#xFF0C;&amp;#x800C;&amp;#x4E14;&amp;#x751F;&amp;#x7269;&amp;#x6807;&amp;#x672C;&amp;#x53EA;&amp;#x80FD;&amp;#x88AB;&amp;#x91C7;&amp;#x96C6;&amp;#x4E00;&amp;#x6B21;&amp;#x3002;&amp;#x6DF1;&amp;#x6D77;&amp;#x673A;&amp;#x5668;&amp;#x4EBA;&amp;#x53EA;&amp;#x80FD;&amp;#x4ECE;&amp;#x5176;&amp;#x51FA;&amp;#x53D1;&amp;#x4F4D;&amp;#x7F6E;&amp;#x6CBF;&amp;#x7740;&amp;#x5411;&amp;#x5317;&amp;#x6216;&amp;#x5411;&amp;#x4E1C;&amp;#x7684;&amp;#x65B9;&amp;#x5411;&amp;#x79FB;&amp;#x52A8;&amp;#xFF0C;&amp;#x800C;&amp;#x4E14;&amp;#x591A;&amp;#x4E2A;&amp;#x6DF1;&amp;#x6D77;&amp;#x673A;&amp;#x5668;&amp;#x4EBA;&amp;#x53EF;&amp;#x4EE5;&amp;#x5728;&amp;#x540C;&amp;#x4E00;&amp;#x65F6;&amp;#x95F4;&amp;#x5360;&amp;#x636E;&amp;#x540C;&amp;#x4E00;&amp;#x4F4D;&amp;#x7F6E;&amp;#x3002;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;&amp;#x9898;&amp;#x76EE;&amp;#x94FE;&amp;#x63A5;&quot;&gt;&amp;#x9898;&amp;#x76EE;&amp;#x94FE;&amp;#x63A5;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://cogs.top/cogs/problem/problem.php?pid=742&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;COGS 742&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x89E3;&amp;#x9898;&amp;#x601D;&amp;#x8DEF;&quot;&gt;&amp;#x89E3;&amp;#x9898;&amp;#x601D;&amp;#x8DEF;&lt;/h3&gt;
&lt;p&gt;&amp;#x6700;&amp;#x5927;&amp;#x8D39;&amp;#x7528;&amp;#x6700;&amp;#x5927;&amp;#x6D41;&amp;#x5EFA;&amp;#x6A21;&amp;#xFF0C;&amp;#x4ECE;&amp;#x6E90;&amp;#x70B9;&amp;#x5411;&amp;#x6BCF;&amp;#x4E2A;&amp;#x8D77;&amp;#x70B9;&amp;#x8FDE;&amp;#x4E00;&amp;#x6761;&amp;#x8FB9;&amp;#xFF0C;&amp;#x6D41;&amp;#x91CF;&amp;#x4E3A;&amp;#x51FA;&amp;#x53D1;&amp;#x7684;&amp;#x673A;&amp;#x5668;&amp;#x4EBA;&amp;#x6570;&amp;#x91CF;&amp;#xFF0C;&amp;#x8D39;&amp;#x7528;&amp;#x4E3A;&amp;#x96F6;&amp;#xFF1B;&amp;#x4ECE;&amp;#x6BCF;&amp;#x4E2A;&amp;#x7EC8;&amp;#x70B9;&amp;#x5411;&amp;#x6C47;&amp;#x70B9;&amp;#x8FDE;&amp;#x4E00;&amp;#x6761;&amp;#x8FB9;&amp;#xFF0C;&amp;#x6D41;&amp;#x91CF;&amp;#x4E3A;&amp;#x5230;&amp;#x8FBE;&amp;#x7684;&amp;#x673A;&amp;#x5668;&amp;#x4EBA;&amp;#x6570;&amp;#x91CF;&amp;#xFF0C;&amp;#x8D39;&amp;#x7528;&amp;#x4E3A;&amp;#x96F6;&amp;#xFF1B;&amp;#x628A;&amp;#x6BCF;&amp;#x4E2A;&amp;#x683C;&amp;#x70B9;&amp;#x770B;&amp;#x505A;&amp;#x70B9;&amp;#xFF0C;&amp;#x4ECE;&amp;#x6BCF;&amp;#x4E2A;&amp;#x683C;&amp;#x70B9;&amp;#x5411;&amp;#x5176;&amp;#x4E1C;&amp;#x8FB9;&amp;#x3001;&amp;#x5317;&amp;#x8FB9;&amp;#x5404;&amp;#x8FDE;&lt;strong&gt;&amp;#x4E24;&amp;#x6761;&lt;/strong&gt;&amp;#x8FB9;&amp;#xFF0C;&amp;#x7B2C;&amp;#x4E00;&amp;#x6761;&amp;#x5BB9;&amp;#x91CF;&amp;#x4E3A; 1&amp;#xFF0C;&amp;#x8D39;&amp;#x7528;&amp;#x4E3A;&amp;#x751F;&amp;#x7269;&amp;#x6807;&amp;#x672C;&amp;#x4EF7;&amp;#x503C;&amp;#x7684;&amp;#x76F8;&amp;#x53CD;&amp;#x6570;&amp;#xFF08;&amp;#x4FDD;&amp;#x8BC1;&amp;#x7B2C;&amp;#x4E00;&amp;#x4E2A;&amp;#x901A;&amp;#x8FC7;&amp;#x7684;&amp;#x673A;&amp;#x5668;&amp;#x4EBA;&amp;#x53D6;&amp;#x8D70;&amp;#x6807;&amp;#x672C;&amp;#xFF09;&amp;#xFF0C;&amp;#x53E6;&amp;#x4E00;&amp;#x6761;&amp;#x5BB9;&amp;#x91CF;&amp;#x4E3A;&amp;#x6B63;&amp;#x65E0;&amp;#x7A77;&amp;#xFF0C;&amp;#x8D39;&amp;#x7528;&amp;#x4E3A; 0&amp;#xFF08;&amp;#x4FDD;&amp;#x8BC1;&amp;#x591A;&amp;#x4E2A;&amp;#x673A;&amp;#x5668;&amp;#x4EBA;&amp;#x53EF;&amp;#x5360;&amp;#x636E;&amp;#x540C;&amp;#x4E00;&amp;#x4F4D;&amp;#x7F6E;&amp;#xFF0C;&amp;#x5E76;&amp;#x4E14;&amp;#x8DEF;&amp;#x5F84;&amp;#x53EF;&amp;#x91CD;&amp;#x53E0;&amp;#xFF09;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x8BA1;&amp;#x7B97;&amp;#x5750;&amp;#x6807;&amp;#x662F;&amp;#x4E2A;&amp;#x5927;&amp;#x5751;&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;ac&amp;#x4EE3;&amp;#x7801;&quot;&gt;AC&amp;#x4EE3;&amp;#x7801;&lt;/h3&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;93&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;94&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;95&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;96&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;97&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;98&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;99&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;100&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;101&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;102&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;103&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;104&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;105&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;106&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;107&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;108&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;109&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;110&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;111&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;112&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;113&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;114&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;115&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;116&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;117&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;118&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;119&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;120&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;121&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;122&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;123&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;124&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;125&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;126&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;127&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;128&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;129&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;130&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;131&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;132&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;133&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;134&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;135&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;136&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;137&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;138&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;139&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;140&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;141&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;142&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;143&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;144&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;145&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;146&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;147&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;148&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;149&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;150&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;151&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;152&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;153&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;climits&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cassert&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;algorithm&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;queue&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXP = &lt;span class=&quot;number&quot;&gt;15&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXQ = &lt;span class=&quot;number&quot;&gt;15&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXA = &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXB = &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Node;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Edge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Node {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Edge *firstEdge, *inEdge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; flow, dist;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; inQueue;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} nodes[(MAXP + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) * (MAXQ + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) + &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Edge {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Node *from, *to;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; capacity, flow, cost;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Edge *next, *reversedEdge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Edge(Node *from, Node *to, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; capacity, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; cost) : from(from), to(to), capacity(capacity), flow(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;), cost(cost), next(from-&amp;gt;firstEdge) {}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;};&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; a, b, p, q;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; EdmondsKarp {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;bellmanford&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Node *s, Node *t, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &amp;amp;flow, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &amp;amp;cost)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			nodes[i].dist = INT_MAX;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			nodes[i].inQueue = &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			nodes[i].flow = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			nodes[i].inEdge = &lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;queue&lt;/span&gt;&amp;lt;Node *&amp;gt; q;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		q.push(s);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		s-&amp;gt;flow = INT_MAX;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		s-&amp;gt;dist = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (!q.empty()) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			Node *v = q.front();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			q.pop();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			v-&amp;gt;inQueue = &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (Edge *e = v-&amp;gt;firstEdge; e; e = e-&amp;gt;next) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (e-&amp;gt;flow &amp;lt; e-&amp;gt;capacity &amp;amp;&amp;amp; e-&amp;gt;to-&amp;gt;dist &amp;gt; v-&amp;gt;dist + e-&amp;gt;cost) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					e-&amp;gt;to-&amp;gt;dist = v-&amp;gt;dist + e-&amp;gt;cost;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					e-&amp;gt;to-&amp;gt;inEdge = e;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					e-&amp;gt;to-&amp;gt;flow = &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::min(v-&amp;gt;flow, e-&amp;gt;capacity - e-&amp;gt;flow);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!e-&amp;gt;to-&amp;gt;inQueue) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;						q.push(e-&amp;gt;to);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;						e-&amp;gt;to-&amp;gt;inQueue = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (t-&amp;gt;dist == INT_MAX) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (Edge *e = t-&amp;gt;inEdge; e; e = e-&amp;gt;from-&amp;gt;inEdge) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;comment&quot;&gt;//printf(&amp;quot;%d -&amp;gt; %d = %d\n&amp;quot;, (int)(e-&amp;gt;from - nodes), (int)(e-&amp;gt;to - nodes), t-&amp;gt;flow);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			e-&amp;gt;flow += t-&amp;gt;flow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			e-&amp;gt;reversedEdge-&amp;gt;flow -= t-&amp;gt;flow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		flow += t-&amp;gt;flow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		cost += t-&amp;gt;dist * t-&amp;gt;flow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;comment&quot;&gt;//printf(&amp;quot;flow += %d, cost += %d\n&amp;quot;, t-&amp;gt;flow, t-&amp;gt;dist * t-&amp;gt;flow);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;operator&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; s, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; t, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &amp;amp;flow, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &amp;amp;cost)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		flow = cost = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (bellmanford(&amp;amp;nodes[s], &amp;amp;nodes[t], n, flow, cost));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} edmondskarp;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;addEdge&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; from, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; to, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; capacity, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; cost)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	assert(from &amp;lt; (p + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) * (q + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) + &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	assert(to &amp;lt; (p + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) * (q + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) + &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	nodes[from].firstEdge = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Edge(&amp;amp;nodes[from], &amp;amp;nodes[to], capacity, cost);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	nodes[to].firstEdge = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Edge(&amp;amp;nodes[to], &amp;amp;nodes[from], &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, -cost);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	nodes[from].firstEdge-&amp;gt;reversedEdge = nodes[to].firstEdge, nodes[to].firstEdge-&amp;gt;reversedEdge = nodes[from].firstEdge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;getNodeID&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; x, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; y)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; x * (q + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) + y + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	freopen(&lt;span class=&quot;string&quot;&gt;&amp;quot;shinkai.in&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;r&amp;quot;&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;stdin&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	freopen(&lt;span class=&quot;string&quot;&gt;&amp;quot;shinkai.out&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;w&amp;quot;&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;stdout&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d\n%d %d&amp;quot;&lt;/span&gt;, &amp;amp;a, &amp;amp;b, &amp;amp;p, &amp;amp;q);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; s = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, t = (p + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) * (q + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; p + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; j = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; j &amp;lt; q; j++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; x;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;x);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;comment&quot;&gt;//printf(&amp;quot;(%d, %d) -&amp;gt; (%d, %d) = %d\n&amp;quot;, i, j, i, j + 1, x);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			addEdge(getNodeID(i, j), getNodeID(i, j + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;), &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, -x);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			addEdge(getNodeID(i, j), getNodeID(i, j + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;), INT_MAX, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; j = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; j &amp;lt; q + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; j++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; p; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; x;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;x);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;comment&quot;&gt;//printf(&amp;quot;(%d, %d) -&amp;gt; (%d, %d) = %d\n&amp;quot;, i, j, i + 1, j, x);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			addEdge(getNodeID(i, j), getNodeID(i + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, j), &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, -x);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			addEdge(getNodeID(i, j), getNodeID(i + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, j), INT_MAX, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; a; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; k, x, y;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d %d&amp;quot;&lt;/span&gt;, &amp;amp;k, &amp;amp;x, &amp;amp;y);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		addEdge(s, getNodeID(x, y), k, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; b; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; k, x, y;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d %d&amp;quot;&lt;/span&gt;, &amp;amp;k, &amp;amp;x, &amp;amp;y);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		addEdge(getNodeID(x, y), t, k, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; flow, cost;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	edmondskarp(s, t, (p + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) * (q + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) + &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, flow, cost);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d\n&amp;quot;&lt;/span&gt;, -cost);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	fclose(&lt;span class=&quot;built_in&quot;&gt;stdin&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	fclose(&lt;span class=&quot;built_in&quot;&gt;stdout&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x6709;&amp;#x591A;&amp;#x4E2A;&amp;#x6DF1;&amp;#x6D77;&amp;#x673A;&amp;#x5668;&amp;#x4EBA;&amp;#x5230;&amp;#x8FBE;&amp;#x6DF1;&amp;#x6D77;&amp;#x6D77;&amp;#x5E95;&amp;#x540E;&amp;#x79BB;&amp;#x5F00;&amp;#x6F5C;&amp;#x8247;&amp;#x5411;&amp;#x9884;&amp;#x5B9A;&amp;#x76EE;&amp;#x6807;&amp;#x79FB;&amp;#x52A8;&amp;#x3002;&amp;#x6DF1;&amp;#x6D77;&amp;#x673A;&amp;#x5668;&amp;#x4EBA;&amp;#x5728;&amp;#x79FB;&amp;#x52A8;&amp;#x4E2D;&amp;#x8FD8;&amp;#x5FC5;&amp;#x987B;&amp;#x6CBF;&amp;#x9014;&amp;#x91C7;&amp;#x96C6;&amp;#x6D77;&amp;#x5E95;&amp;#x751F;&amp;#x7269;&amp;#x6807;&amp;#x672C;&amp;#x3002;&amp;#x6CBF;&amp;#x9014;&amp;#x751F;&amp;#x7269;&amp;#x6807;&amp;#x672C;&amp;#x7531;&amp;#x6700;&amp;#x5148;&amp;#x9047;&amp;#x5230;&amp;#x5B83;&amp;#x7684;&amp;#x6DF1;&amp;#x6D77;&amp;#x673A;&amp;#x5668;&amp;#x4EBA;&amp;#x5B8C;&amp;#x6210;&amp;#x91C7;&amp;#x96C6;&amp;#x3002;&amp;#x6BCF;&amp;#x6761;&amp;#x9884;&amp;#x5B9A;&amp;#x8DEF;&amp;#x5F84;&amp;#x4E0A;&amp;#x7684;&amp;#x751F;&amp;#x7269;&amp;#x6807;&amp;#x672C;&amp;#x7684;&amp;#x4EF7;&amp;#x503C;&amp;#x662F;&amp;#x5DF2;&amp;#x77E5;&amp;#x7684;&amp;#xFF0C;&amp;#x800C;&amp;#x4E14;&amp;#x751F;&amp;#x7269;&amp;#x6807;&amp;#x672C;&amp;#x53EA;&amp;#x80FD;&amp;#x88AB;&amp;#x91C7;&amp;#x96C6;&amp;#x4E00;&amp;#x6B21;&amp;#x3002;&amp;#x6DF1;&amp;#x6D77;&amp;#x673A;&amp;#x5668;&amp;#x4EBA;&amp;#x53EA;&amp;#x80FD;&amp;#x4ECE;&amp;#x5176;&amp;#x51FA;&amp;#x53D1;&amp;#x4F4D;&amp;#x7F6E;&amp;#x6CBF;&amp;#x7740;&amp;#x5411;&amp;#x5317;&amp;#x6216;&amp;#x5411;&amp;#x4E1C;&amp;#x7684;&amp;#x65B9;&amp;#x5411;&amp;#x79FB;&amp;#x52A8;&amp;#xFF0C;&amp;#x800C;&amp;#x4E14;&amp;#x591A;&amp;#x4E2A;&amp;#x6DF1;&amp;#x6D77;&amp;#x673A;&amp;#x5668;&amp;#x4EBA;&amp;#x53EF;&amp;#x4EE5;&amp;#x5728;&amp;#x540C;&amp;#x4E00;&amp;#x65F6;&amp;#x95F4;&amp;#x5360;&amp;#x636E;&amp;#x540C;&amp;#x4E00;&amp;#x4F4D;&amp;#x7F6E;&amp;#x3002;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="COGS" scheme="https://blog.menci.moe/tag/cogs/"/>
    
      <category term="Edmonds-Karp" scheme="https://blog.menci.moe/tag/edmonds-karp/"/>
    
      <category term="图论" scheme="https://blog.menci.moe/tag/%E5%9B%BE%E8%AE%BA/"/>
    
      <category term="网络流" scheme="https://blog.menci.moe/tag/%E7%BD%91%E7%BB%9C%E6%B5%81/"/>
    
      <category term="网络流24题" scheme="https://blog.menci.moe/tag/%E7%BD%91%E7%BB%9C%E6%B5%8124%E9%A2%98/"/>
    
      <category term="费用流" scheme="https://blog.menci.moe/tag/%E8%B4%B9%E7%94%A8%E6%B5%81/"/>
    
  </entry>
  
  <entry>
    <title>「COGS 739」运输问题 - 费用流</title>
    <link href="https://blog.menci.moe/cogs-739/"/>
    <id>https://blog.menci.moe/cogs-739/</id>
    <published>2016-02-20T13:37:35.000Z</published>
    <updated>2016-02-23T12:35:48.000Z</updated>
    
    <content type="html">&lt;p&gt;W &amp;#x516C;&amp;#x53F8;&amp;#x6709; &lt;code&gt;m&lt;/code&gt; &amp;#x4E2A;&amp;#x4ED3;&amp;#x5E93;&amp;#x548C; &lt;code&gt;n&lt;/code&gt; &amp;#x4E2A;&amp;#x96F6;&amp;#x552E;&amp;#x5546;&amp;#x5E97;&amp;#x3002;&amp;#x7B2C; &lt;code&gt;i&lt;/code&gt; &amp;#x4E2A;&amp;#x4ED3;&amp;#x5E93;&amp;#x6709; $ a_i $ &amp;#x4E2A;&amp;#x8D27;&amp;#x7269;&amp;#xFF0C;&amp;#x7B2C; &lt;code&gt;j&lt;/code&gt; &amp;#x4E2A;&amp;#x5546;&amp;#x5E97;&amp;#x9700;&amp;#x8981; $ b_j $ &amp;#x4E2A;&amp;#x8D27;&amp;#x7269;&amp;#xFF0C;&amp;#x4ECE;&amp;#x7B2C; &lt;code&gt;i&lt;/code&gt; &amp;#x4E2A;&amp;#x4ED3;&amp;#x5E93;&amp;#x8FD0;&amp;#x8F93;&amp;#x5230;&amp;#x7B2C; &lt;code&gt;j&lt;/code&gt; &amp;#x4E2A;&amp;#x96F6;&amp;#x552E;&amp;#x5546;&amp;#x5E97;&amp;#x7684;&amp;#x8D39;&amp;#x7528;&amp;#x4E3A; $ c_{ij} $&amp;#xFF0C;&amp;#x8981;&amp;#x5C06;&amp;#x6240;&amp;#x6709;&amp;#x8D27;&amp;#x7269;&amp;#x8FD0;&amp;#x5230;&amp;#x5546;&amp;#x5E97;&amp;#xFF0C;&amp;#x6700;&amp;#x5C0F;&amp;#x8D39;&amp;#x7528;&amp;#x662F;&amp;#x591A;&amp;#x5C11;&amp;#xFF1F;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;&amp;#x9898;&amp;#x76EE;&amp;#x94FE;&amp;#x63A5;&quot;&gt;&amp;#x9898;&amp;#x76EE;&amp;#x94FE;&amp;#x63A5;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://cogs.top/cogs/problem/problem.php?pid=739&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;COGS 739&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x89E3;&amp;#x9898;&amp;#x601D;&amp;#x8DEF;&quot;&gt;&amp;#x89E3;&amp;#x9898;&amp;#x601D;&amp;#x8DEF;&lt;/h3&gt;
&lt;p&gt;&amp;#x88F8;&amp;#x8D39;&amp;#x7528;&amp;#x6D41;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x4ECE;&amp;#x6E90;&amp;#x70B9;&amp;#x5411;&amp;#x6BCF;&amp;#x4E2A;&amp;#x4ED3;&amp;#x5E93;&amp;#x8FDE;&amp;#x63A5;&amp;#x4E00;&amp;#x6761;&amp;#x8FB9;&amp;#xFF0C;&amp;#x5BB9;&amp;#x91CF;&amp;#x4E3A;&amp;#x4ED3;&amp;#x5E93;&amp;#x7684;&amp;#x8D27;&amp;#x7269;&amp;#x6570;&amp;#x91CF;&amp;#xFF1B;&amp;#x4ECE;&amp;#x6BCF;&amp;#x4E2A;&amp;#x5546;&amp;#x5E97;&amp;#x5411;&amp;#x6C47;&amp;#x70B9;&amp;#x8FDE;&amp;#x4E00;&amp;#x6761;&amp;#x8FB9;&amp;#xFF0C;&amp;#x5BB9;&amp;#x91CF;&amp;#x4E3A;&amp;#x5546;&amp;#x5E97;&amp;#x9700;&amp;#x8981;&amp;#x7684;&amp;#x8D27;&amp;#x7269;&amp;#x6570;&amp;#x91CF;&amp;#xFF1B;&amp;#x5728;&amp;#x6BCF;&amp;#x4E00;&amp;#x5BF9;&amp;#x4ED3;&amp;#x5E93;&amp;#x548C;&amp;#x5546;&amp;#x5E97;&amp;#x4E4B;&amp;#x95F4;&amp;#x8FDE;&amp;#x63A5;&amp;#x4E00;&amp;#x6761;&amp;#x8FB9;&amp;#xFF0C;&amp;#x5BB9;&amp;#x91CF;&amp;#x4E3A;&amp;#x65E0;&amp;#x7A77;&amp;#x5927;&amp;#xFF0C;&amp;#x8D39;&amp;#x7528;&amp;#x4E3A;&amp;#x8FD0;&amp;#x8F93;&amp;#x8D39;&amp;#x7528;&amp;#x3002;&amp;#x5206;&amp;#x522B;&amp;#x6C42;&amp;#x51FA;&amp;#x6700;&amp;#x5927;&amp;#x3001;&amp;#x6700;&amp;#x5C0F;&amp;#x8D39;&amp;#x7528;&amp;#x6700;&amp;#x5927;&amp;#x6D41;&amp;#x5C31;&amp;#x662F;&amp;#x7B54;&amp;#x6848;&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;ac&amp;#x4EE3;&amp;#x7801;&quot;&gt;AC&amp;#x4EE3;&amp;#x7801;&lt;/h3&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;93&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;94&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;95&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;96&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;97&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;98&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;99&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;100&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;101&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;102&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;103&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;104&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;105&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;106&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;107&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;108&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;109&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;110&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;111&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;112&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;113&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;114&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;115&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;116&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;117&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;118&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;119&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;120&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;121&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;122&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;123&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;124&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;125&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;126&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;127&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;128&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;129&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;130&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;131&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;132&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;133&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;climits&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;algorithm&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;queue&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXN = &lt;span class=&quot;number&quot;&gt;100&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXM = &lt;span class=&quot;number&quot;&gt;100&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Node;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Edge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Node {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Edge *firstEdge, *inEdge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; dist, flow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; inQueue;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} nodes[MAXM + MAXN + &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Edge {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Node *from, *to;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; capacity, flow, cost;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Edge *next, *reversedEdge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Edge(Node *from, Node *to, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; capacity, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; cost) : from(from), to(to), capacity(capacity), flow(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;), cost(cost), next(from-&amp;gt;firstEdge) {}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;};&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, m, a[MAXM], b[MAXN], cost[MAXM][MAXN];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; EdmondsKarp {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;bellmanford&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Node *s, Node *t, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &amp;amp;flow, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &amp;amp;cost)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			nodes[i].flow = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			nodes[i].inEdge = &lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			nodes[i].dist = INT_MAX;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			nodes[i].inQueue = &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;queue&lt;/span&gt;&amp;lt;Node *&amp;gt; q;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		q.push(s);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		s-&amp;gt;dist = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		s-&amp;gt;flow = INT_MAX;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (!q.empty()) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			Node *v = q.front();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			q.pop();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			v-&amp;gt;inQueue = &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (Edge *e = v-&amp;gt;firstEdge; e; e = e-&amp;gt;next) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (e-&amp;gt;flow &amp;lt; e-&amp;gt;capacity &amp;amp;&amp;amp; e-&amp;gt;to-&amp;gt;dist &amp;gt; v-&amp;gt;dist + e-&amp;gt;cost) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					e-&amp;gt;to-&amp;gt;dist = v-&amp;gt;dist + e-&amp;gt;cost;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					e-&amp;gt;to-&amp;gt;inEdge = e;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					e-&amp;gt;to-&amp;gt;flow = &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::min(v-&amp;gt;flow, e-&amp;gt;capacity - e-&amp;gt;flow);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!e-&amp;gt;to-&amp;gt;inQueue) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;						e-&amp;gt;to-&amp;gt;inQueue = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;						q.push(e-&amp;gt;to);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (t-&amp;gt;dist == INT_MAX) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (Edge *e = t-&amp;gt;inEdge; e; e = e-&amp;gt;from-&amp;gt;inEdge) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			e-&amp;gt;flow += t-&amp;gt;flow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			e-&amp;gt;reversedEdge-&amp;gt;flow -= t-&amp;gt;flow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		flow += t-&amp;gt;flow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		cost += t-&amp;gt;dist * t-&amp;gt;flow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;operator&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; s, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; t, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &amp;amp;flow, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &amp;amp;cost)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		flow = cost = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (bellmanford(&amp;amp;nodes[s], &amp;amp;nodes[t], n, flow, cost));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} edmondskarp;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;addEdge&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; from, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; to, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; capacity, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; cost)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	nodes[from].firstEdge = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Edge(&amp;amp;nodes[from], &amp;amp;nodes[to], capacity, cost);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	nodes[to].firstEdge = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Edge(&amp;amp;nodes[to], &amp;amp;nodes[from], &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, -cost);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	nodes[from].firstEdge-&amp;gt;reversedEdge = nodes[to].firstEdge, nodes[to].firstEdge-&amp;gt;reversedEdge = nodes[from].firstEdge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;solve&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; d)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; m + n + &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		Edge *next;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (Edge *&amp;amp;e = nodes[i].firstEdge; e; next = e-&amp;gt;next, &lt;span class=&quot;keyword&quot;&gt;delete&lt;/span&gt; e, e = next);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; s = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, t = m + n + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= m; i++) addEdge(s, i, a[i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;], &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; j = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; j &amp;lt;= n; j++) addEdge(m + j, t, b[j - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;], &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= m; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; j = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; j &amp;lt;= n; j++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			addEdge(i, m + j, INT_MAX, cost[i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;][j - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;] * d);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; flow, cost;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	edmondskarp(s, t, m + n + &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, flow, cost);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; cost * d;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	freopen(&lt;span class=&quot;string&quot;&gt;&amp;quot;tran.in&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;r&amp;quot;&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;stdin&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	freopen(&lt;span class=&quot;string&quot;&gt;&amp;quot;tran.out&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;w&amp;quot;&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;stdout&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d&amp;quot;&lt;/span&gt;, &amp;amp;m, &amp;amp;n);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; m; i++) &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;a[i]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; j = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; j &amp;lt; n; j++) &lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;b[j]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; m; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; j = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; j &amp;lt; n; j++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;cost[i][j]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d\n&amp;quot;&lt;/span&gt;, solve(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d\n&amp;quot;&lt;/span&gt;, solve(-&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	fclose(&lt;span class=&quot;built_in&quot;&gt;stdin&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	fclose(&lt;span class=&quot;built_in&quot;&gt;stdout&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;W &amp;#x516C;&amp;#x53F8;&amp;#x6709; &lt;code&gt;m&lt;/code&gt; &amp;#x4E2A;&amp;#x4ED3;&amp;#x5E93;&amp;#x548C; &lt;code&gt;n&lt;/code&gt; &amp;#x4E2A;&amp;#x96F6;&amp;#x552E;&amp;#x5546;&amp;#x5E97;&amp;#x3002;&amp;#x7B2C; &lt;code&gt;i&lt;/code&gt; &amp;#x4E2A;&amp;#x4ED3;&amp;#x5E93;&amp;#x6709; $ a_i $ &amp;#x4E2A;&amp;#x8D27;&amp;#x7269;&amp;#xFF0C;&amp;#x7B2C; &lt;code&gt;j&lt;/code&gt; &amp;#x4E2A;&amp;#x5546;&amp;#x5E97;&amp;#x9700;&amp;#x8981; $ b_j $ &amp;#x4E2A;&amp;#x8D27;&amp;#x7269;&amp;#xFF0C;&amp;#x4ECE;&amp;#x7B2C; &lt;code&gt;i&lt;/code&gt; &amp;#x4E2A;&amp;#x4ED3;&amp;#x5E93;&amp;#x8FD0;&amp;#x8F93;&amp;#x5230;&amp;#x7B2C; &lt;code&gt;j&lt;/code&gt; &amp;#x4E2A;&amp;#x96F6;&amp;#x552E;&amp;#x5546;&amp;#x5E97;&amp;#x7684;&amp;#x8D39;&amp;#x7528;&amp;#x4E3A; $ c_{ij} $&amp;#xFF0C;&amp;#x8981;&amp;#x5C06;&amp;#x6240;&amp;#x6709;&amp;#x8D27;&amp;#x7269;&amp;#x8FD0;&amp;#x5230;&amp;#x5546;&amp;#x5E97;&amp;#xFF0C;&amp;#x6700;&amp;#x5C0F;&amp;#x8D39;&amp;#x7528;&amp;#x662F;&amp;#x591A;&amp;#x5C11;&amp;#xFF1F;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="COGS" scheme="https://blog.menci.moe/tag/cogs/"/>
    
      <category term="Edmonds-Karp" scheme="https://blog.menci.moe/tag/edmonds-karp/"/>
    
      <category term="图论" scheme="https://blog.menci.moe/tag/%E5%9B%BE%E8%AE%BA/"/>
    
      <category term="网络流" scheme="https://blog.menci.moe/tag/%E7%BD%91%E7%BB%9C%E6%B5%81/"/>
    
      <category term="网络流24题" scheme="https://blog.menci.moe/tag/%E7%BD%91%E7%BB%9C%E6%B5%8124%E9%A2%98/"/>
    
      <category term="费用流" scheme="https://blog.menci.moe/tag/%E8%B4%B9%E7%94%A8%E6%B5%81/"/>
    
  </entry>
  
  <entry>
    <title>「JSOI2008」最大数 - Splay</title>
    <link href="https://blog.menci.moe/jsoi2008-maxnumber/"/>
    <id>https://blog.menci.moe/jsoi2008-maxnumber/</id>
    <published>2016-02-20T02:11:00.000Z</published>
    <updated>2016-02-20T02:13:55.000Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x73B0;&amp;#x5728;&amp;#x8BF7;&amp;#x6C42;&amp;#x4F60;&amp;#x7EF4;&amp;#x62A4;&amp;#x4E00;&amp;#x4E2A;&amp;#x6570;&amp;#x5217;&amp;#xFF0C;&amp;#x8981;&amp;#x6C42;&amp;#x63D0;&amp;#x4F9B;&amp;#x4EE5;&amp;#x4E0B;&amp;#x4E24;&amp;#x79CD;&amp;#x64CD;&amp;#x4F5C;&amp;#xFF1A;&lt;/p&gt;
&lt;ol style=&quot;list-style-type: decimal&quot;&gt;
&lt;li&gt;&amp;#x67E5;&amp;#x8BE2;&amp;#x64CD;&amp;#x4F5C;&amp;#x3002;&lt;br&gt;
&amp;#x8BED;&amp;#x6CD5;&amp;#xFF1A;&lt;code&gt;Q L&lt;/code&gt;&lt;br&gt;
&amp;#x529F;&amp;#x80FD;&amp;#xFF1A;&amp;#x67E5;&amp;#x8BE2;&amp;#x5F53;&amp;#x524D;&amp;#x6570;&amp;#x5217;&amp;#x4E2D;&amp;#x672B;&amp;#x5C3E; &lt;code&gt;L&lt;/code&gt; &amp;#x4E2A;&amp;#x6570;&amp;#x4E2D;&amp;#x7684;&amp;#x6700;&amp;#x5927;&amp;#x7684;&amp;#x6570;&amp;#xFF0C;&amp;#x5E76;&amp;#x8F93;&amp;#x51FA;&amp;#x8FD9;&amp;#x4E2A;&amp;#x6570;&amp;#x7684;&amp;#x503C;&amp;#x3002;&lt;br&gt;
&amp;#x9650;&amp;#x5236;&amp;#xFF1A;&lt;code&gt;L&lt;/code&gt; &amp;#x4E0D;&amp;#x8D85;&amp;#x8FC7;&amp;#x5F53;&amp;#x524D;&amp;#x6570;&amp;#x5217;&amp;#x7684;&amp;#x957F;&amp;#x5EA6;&amp;#x3002;&lt;/li&gt;
&lt;li&gt;&amp;#x63D2;&amp;#x5165;&amp;#x64CD;&amp;#x4F5C;&amp;#x3002; &amp;#x8BED;&amp;#x6CD5;&amp;#xFF1A;&lt;code&gt;A n&lt;/code&gt;&lt;br&gt;
&amp;#x529F;&amp;#x80FD;&amp;#xFF1A;&amp;#x5C06; &lt;code&gt;n&lt;/code&gt; &amp;#x52A0;&amp;#x4E0A; &lt;code&gt;t&lt;/code&gt;&amp;#xFF0C;&amp;#x5176;&amp;#x4E2D; &lt;code&gt;t&lt;/code&gt; &amp;#x662F;&amp;#x6700;&amp;#x8FD1;&amp;#x4E00;&amp;#x6B21;&amp;#x67E5;&amp;#x8BE2;&amp;#x64CD;&amp;#x4F5C;&amp;#x7684;&amp;#x7B54;&amp;#x6848;&amp;#xFF08;&amp;#x5982;&amp;#x679C;&amp;#x8FD8;&amp;#x672A;&amp;#x6267;&amp;#x884C;&amp;#x8FC7;&amp;#x67E5;&amp;#x8BE2;&amp;#x64CD;&amp;#x4F5C;&amp;#xFF0C;&amp;#x5219; &lt;code&gt;t = 0&lt;/code&gt;)&amp;#xFF0C;&amp;#x5E76;&amp;#x5C06;&amp;#x6240;&amp;#x5F97;&amp;#x7ED3;&amp;#x679C;&amp;#x5BF9;&amp;#x4E00;&amp;#x4E2A;&amp;#x56FA;&amp;#x5B9A;&amp;#x7684;&amp;#x5E38;&amp;#x6570; &lt;code&gt;D&lt;/code&gt; &amp;#x53D6;&amp;#x6A21;&amp;#xFF0C;&amp;#x5C06;&amp;#x6240;&amp;#x5F97;&amp;#x7B54;&amp;#x6848;&amp;#x63D2;&amp;#x5165;&amp;#x5230;&amp;#x6570;&amp;#x5217;&amp;#x7684;&amp;#x672B;&amp;#x5C3E;&amp;#x3002;&lt;br&gt;
&amp;#x9650;&amp;#x5236;&amp;#xFF1A;&lt;code&gt;n&lt;/code&gt; &amp;#x662F;&amp;#x975E;&amp;#x8D1F;&amp;#x6574;&amp;#x6570;&amp;#x5E76;&amp;#x4E14;&amp;#x5728;&amp;#x957F;&amp;#x6574;&amp;#x8303;&amp;#x56F4;&amp;#x5185;&amp;#x3002;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&amp;#x6CE8;&amp;#x610F;&amp;#xFF1A;&amp;#x521D;&amp;#x59CB;&amp;#x65F6;&amp;#x6570;&amp;#x5217;&amp;#x662F;&amp;#x7A7A;&amp;#x7684;&amp;#xFF0C;&amp;#x6CA1;&amp;#x6709;&amp;#x4E00;&amp;#x4E2A;&amp;#x6570;&amp;#x3002;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;&amp;#x9898;&amp;#x76EE;&amp;#x94FE;&amp;#x63A5;&quot;&gt;&amp;#x9898;&amp;#x76EE;&amp;#x94FE;&amp;#x63A5;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://www.lydsy.com/JudgeOnline/problem.php?id=1012&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;BZOJ 1012&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x89E3;&amp;#x9898;&amp;#x601D;&amp;#x8DEF;&quot;&gt;&amp;#x89E3;&amp;#x9898;&amp;#x601D;&amp;#x8DEF;&lt;/h3&gt;
&lt;p&gt;Splay &amp;#x88F8;&amp;#x9898;&amp;#x4E0D;&amp;#x7528;&amp;#x8BF4;&amp;#x4E86;&amp;#x5427; &amp;#x2026;&amp;#x2026;&lt;/p&gt;
&lt;p&gt;&amp;#x8BDD;&amp;#x8BF4;&amp;#x5F00;&amp;#x4E00;&amp;#x68F5;&amp;#x5927;&amp;#x7EBF;&amp;#x6BB5;&amp;#x6811;&amp;#x4E5F;&amp;#x8D44;&amp;#x78C1;&amp;#x5427;&amp;#xFF1F;&lt;/p&gt;
&lt;p&gt;&amp;#x6572;&amp;#x4E2A; Splay &amp;#x7EC3;&amp;#x7EC3;&amp;#x4EE3;&amp;#x7801;&amp;#x80FD;&amp;#x529B;&amp;#xFF0C;&amp;#x7ED3;&amp;#x679C;&amp;#x6298;&amp;#x817E;&amp;#x4E86;&amp;#x4FE9;&amp;#x5C0F;&amp;#x65F6;&amp;#xFF0C;&amp;#x8FD9;&amp;#x6BB5;&amp;#x65F6;&amp;#x95F4;&amp;#x4EE3;&amp;#x7801;&amp;#x80FD;&amp;#x529B;&amp;#x6025;&amp;#x5267;&amp;#x4E0B;&amp;#x964D;&amp;#x554A;&amp;#xFF01;qwq&lt;/p&gt;
&lt;h3 id=&quot;ac&amp;#x4EE3;&amp;#x7801;&quot;&gt;AC&amp;#x4EE3;&amp;#x7801;&lt;/h3&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;93&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;94&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;95&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;96&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;97&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;98&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;99&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;100&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;101&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;102&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;103&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;104&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;105&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;106&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;107&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;108&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;109&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;110&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;111&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;112&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;113&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;114&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;115&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;116&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;117&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;118&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;119&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;120&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;121&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;122&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;123&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;124&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;125&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;126&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;127&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;128&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;129&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;130&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;131&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;132&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;133&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;134&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;135&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;136&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;137&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;138&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;139&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;140&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;141&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;142&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;143&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;144&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;145&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;146&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;147&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;148&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;149&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;150&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;151&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;152&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;153&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;154&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;155&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;156&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;157&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;158&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;159&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;160&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;161&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;162&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;163&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;164&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;165&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;166&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;167&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;168&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;169&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;170&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;171&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;172&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;173&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;174&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;175&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;algorithm&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXM = &lt;span class=&quot;number&quot;&gt;200000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;template&lt;/span&gt; &amp;lt;&lt;span class=&quot;keyword&quot;&gt;typename&lt;/span&gt; T&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Splay {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;enum&lt;/span&gt; Relation {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		L = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, R = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	};&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Node {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		Node *parent, *child[&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;], **root;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; value, max;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; size;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; bound;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		Node(Node *parent, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; T &amp;amp;value, Node **root, &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; bound = &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;) : parent(parent), value(value), root(root), bound(bound), size(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) {}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;maintain&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			size = (child[L] ? child[L]-&amp;gt;size : &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) + (child[R] ? child[R]-&amp;gt;size : &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			max = value;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (child[L] &amp;amp;&amp;amp; !child[L]-&amp;gt;bound) max = &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::max(max, child[L]-&amp;gt;max);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (child[R] &amp;amp;&amp;amp; !child[R]-&amp;gt;bound) max = &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::max(max, child[R]-&amp;gt;max);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;function&quot;&gt;Relation &lt;span class=&quot;title&quot;&gt;relation&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt; == parent-&amp;gt;child[L] ? L : R;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;rotate&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			Relation r = relation();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			Node *oldParent = parent;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (oldParent-&amp;gt;parent) oldParent-&amp;gt;parent-&amp;gt;child[oldParent-&amp;gt;relation()] = &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			parent = oldParent-&amp;gt;parent;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			oldParent-&amp;gt;child[r] = child[r ^ &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (child[r ^ &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]) child[r ^ &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]-&amp;gt;parent = oldParent;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			child[r ^ &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;] = oldParent;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			oldParent-&amp;gt;parent = &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			oldParent-&amp;gt;maintain(), maintain();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!parent) *root = &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;splay&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Node *targetParent = &lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (parent != targetParent) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (parent-&amp;gt;parent == targetParent) rotate();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (relation() == parent-&amp;gt;relation()) parent-&amp;gt;rotate(), rotate();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; rotate(), rotate();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;rank&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; child[L] ? child[L]-&amp;gt;size : &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;function&quot;&gt;Node *&lt;span class=&quot;title&quot;&gt;pred&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			splay();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			Node *v = &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;child[L];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (v-&amp;gt;child[R]) v = v-&amp;gt;child[R];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; v;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;function&quot;&gt;Node *&lt;span class=&quot;title&quot;&gt;succ&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			splay();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			Node *v = &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;child[R];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (v-&amp;gt;child[L]) v = v-&amp;gt;child[L];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; v;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; depth = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (child[L]) child[L]-&amp;gt;print(depth + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; depth; i++) &lt;span class=&quot;built_in&quot;&gt;putchar&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;apos; &amp;apos;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;comment&quot;&gt;//printf(&amp;quot;%d\n&amp;quot;, value);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (child[R]) child[R]-&amp;gt;print(depth + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	} *root;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Splay() {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		buildBound(L), buildBound(R);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		root-&amp;gt;print();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;built_in&quot;&gt;puts&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;---------------------------&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;buildBound&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Relation r)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		Node **v = &amp;amp;root, *parent = &lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (*v) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			parent = *v;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			parent-&amp;gt;size++;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			v = &amp;amp;parent-&amp;gt;child[r];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		*v = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Node(parent, r == L ? -&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; : &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &amp;amp;root, &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; T &amp;amp;value)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		Node **v = &amp;amp;root, *parent = &lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (*v) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			parent = *v;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			parent-&amp;gt;size++;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (parent-&amp;gt;bound &amp;amp;&amp;amp; parent-&amp;gt;value == &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) v = &amp;amp;parent-&amp;gt;child[L];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; v = &amp;amp;parent-&amp;gt;child[R];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		*v = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Node(parent, value, &amp;amp;root);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;comment&quot;&gt;//print();&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		(*v)-&amp;gt;splay();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;function&quot;&gt;Node *&lt;span class=&quot;title&quot;&gt;select&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; k)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		k++;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		Node *v = root;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (k != v-&amp;gt;rank() + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;comment&quot;&gt;//printf(&amp;quot;select(k = %d) in [%d] - { size = %d, rank = %d }\n&amp;quot;, k, v-&amp;gt;value, v-&amp;gt;size, v-&amp;gt;rank());&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (k &amp;lt; v-&amp;gt;rank() + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) v = v-&amp;gt;child[L];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; k -= v-&amp;gt;rank() + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, v = v-&amp;gt;child[R];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; v;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;function&quot;&gt;Node *&lt;span class=&quot;title&quot;&gt;select&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; l, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; r)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		Node *pred = select(l)-&amp;gt;pred();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		Node *succ = select(r)-&amp;gt;succ();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		pred-&amp;gt;splay();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		succ-&amp;gt;splay(root);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; succ-&amp;gt;child[L];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; T &amp;amp;&lt;span class=&quot;title&quot;&gt;queryMax&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; l, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; r)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; select(l, r)-&amp;gt;max;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; root-&amp;gt;size - &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;};&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; m, p, lastAns;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Splay&amp;lt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;&amp;gt; splay;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;isVaild&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt; ch)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; ch == &lt;span class=&quot;string&quot;&gt;&amp;apos;A&amp;apos;&lt;/span&gt; || ch == &lt;span class=&quot;string&quot;&gt;&amp;apos;Q&amp;apos;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d&amp;quot;&lt;/span&gt;, &amp;amp;m, &amp;amp;p);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; m; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt; cmd;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (!isVaild(cmd = getchar()));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;comment&quot;&gt;//printf(&amp;quot;cmd(&amp;apos;%c&amp;apos;)\n&amp;quot;, cmd);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (cmd == &lt;span class=&quot;string&quot;&gt;&amp;apos;A&amp;apos;&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;n);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			splay.append((n + lastAns) % p);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		} &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; l;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;l);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d\n&amp;quot;&lt;/span&gt;, lastAns = splay.queryMax(splay.size() - l + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, splay.size()));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x73B0;&amp;#x5728;&amp;#x8BF7;&amp;#x6C42;&amp;#x4F60;&amp;#x7EF4;&amp;#x62A4;&amp;#x4E00;&amp;#x4E2A;&amp;#x6570;&amp;#x5217;&amp;#xFF0C;&amp;#x8981;&amp;#x6C42;&amp;#x63D0;&amp;#x4F9B;&amp;#x4EE5;&amp;#x4E0B;&amp;#x4E24;&amp;#x79CD;&amp;#x64CD;&amp;#x4F5C;&amp;#xFF1A;&lt;/p&gt;
&lt;ol style=&quot;list-style-type: decimal&quot;&gt;
&lt;li&gt;&amp;#x67E5;&amp;#x8BE2;&amp;#x64CD;&amp;#x4F5C;&amp;#x3002;&lt;br&gt;
&amp;#x8BED;&amp;#x6CD5;&amp;#xFF1A;&lt;code&gt;Q L&lt;/code&gt;&lt;br&gt;
&amp;#x529F;&amp;#x80FD;&amp;#xFF1A;&amp;#x67E5;&amp;#x8BE2;&amp;#x5F53;&amp;#x524D;&amp;#x6570;&amp;#x5217;&amp;#x4E2D;&amp;#x672B;&amp;#x5C3E; &lt;code&gt;L&lt;/code&gt; &amp;#x4E2A;&amp;#x6570;&amp;#x4E2D;&amp;#x7684;&amp;#x6700;&amp;#x5927;&amp;#x7684;&amp;#x6570;&amp;#xFF0C;&amp;#x5E76;&amp;#x8F93;&amp;#x51FA;&amp;#x8FD9;&amp;#x4E2A;&amp;#x6570;&amp;#x7684;&amp;#x503C;&amp;#x3002;&lt;br&gt;
&amp;#x9650;&amp;#x5236;&amp;#xFF1A;&lt;code&gt;L&lt;/code&gt; &amp;#x4E0D;&amp;#x8D85;&amp;#x8FC7;&amp;#x5F53;&amp;#x524D;&amp;#x6570;&amp;#x5217;&amp;#x7684;&amp;#x957F;&amp;#x5EA6;&amp;#x3002;&lt;/li&gt;
&lt;li&gt;&amp;#x63D2;&amp;#x5165;&amp;#x64CD;&amp;#x4F5C;&amp;#x3002; &amp;#x8BED;&amp;#x6CD5;&amp;#xFF1A;&lt;code&gt;A n&lt;/code&gt;&lt;br&gt;
&amp;#x529F;&amp;#x80FD;&amp;#xFF1A;&amp;#x5C06; &lt;code&gt;n&lt;/code&gt; &amp;#x52A0;&amp;#x4E0A; &lt;code&gt;t&lt;/code&gt;&amp;#xFF0C;&amp;#x5176;&amp;#x4E2D; &lt;code&gt;t&lt;/code&gt; &amp;#x662F;&amp;#x6700;&amp;#x8FD1;&amp;#x4E00;&amp;#x6B21;&amp;#x67E5;&amp;#x8BE2;&amp;#x64CD;&amp;#x4F5C;&amp;#x7684;&amp;#x7B54;&amp;#x6848;&amp;#xFF08;&amp;#x5982;&amp;#x679C;&amp;#x8FD8;&amp;#x672A;&amp;#x6267;&amp;#x884C;&amp;#x8FC7;&amp;#x67E5;&amp;#x8BE2;&amp;#x64CD;&amp;#x4F5C;&amp;#xFF0C;&amp;#x5219; &lt;code&gt;t = 0&lt;/code&gt;)&amp;#xFF0C;&amp;#x5E76;&amp;#x5C06;&amp;#x6240;&amp;#x5F97;&amp;#x7ED3;&amp;#x679C;&amp;#x5BF9;&amp;#x4E00;&amp;#x4E2A;&amp;#x56FA;&amp;#x5B9A;&amp;#x7684;&amp;#x5E38;&amp;#x6570; &lt;code&gt;D&lt;/code&gt; &amp;#x53D6;&amp;#x6A21;&amp;#xFF0C;&amp;#x5C06;&amp;#x6240;&amp;#x5F97;&amp;#x7B54;&amp;#x6848;&amp;#x63D2;&amp;#x5165;&amp;#x5230;&amp;#x6570;&amp;#x5217;&amp;#x7684;&amp;#x672B;&amp;#x5C3E;&amp;#x3002;&lt;br&gt;
&amp;#x9650;&amp;#x5236;&amp;#xFF1A;&lt;code&gt;n&lt;/code&gt; &amp;#x662F;&amp;#x975E;&amp;#x8D1F;&amp;#x6574;&amp;#x6570;&amp;#x5E76;&amp;#x4E14;&amp;#x5728;&amp;#x957F;&amp;#x6574;&amp;#x8303;&amp;#x56F4;&amp;#x5185;&amp;#x3002;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&amp;#x6CE8;&amp;#x610F;&amp;#xFF1A;&amp;#x521D;&amp;#x59CB;&amp;#x65F6;&amp;#x6570;&amp;#x5217;&amp;#x662F;&amp;#x7A7A;&amp;#x7684;&amp;#xFF0C;&amp;#x6CA1;&amp;#x6709;&amp;#x4E00;&amp;#x4E2A;&amp;#x6570;&amp;#x3002;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="BZOJ" scheme="https://blog.menci.moe/tag/bzoj/"/>
    
      <category term="JSOI" scheme="https://blog.menci.moe/tag/jsoi/"/>
    
      <category term="Splay" scheme="https://blog.menci.moe/tag/splay/"/>
    
      <category term="数据结构" scheme="https://blog.menci.moe/tag/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
      <category term="高级数据结构" scheme="https://blog.menci.moe/tag/%E9%AB%98%E7%BA%A7%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
  </entry>
  
  <entry>
    <title>Edmonds-Karp 费用流学习笔记</title>
    <link href="https://blog.menci.moe/edmonds-karp-notes/"/>
    <id>https://blog.menci.moe/edmonds-karp-notes/</id>
    <published>2016-02-19T09:04:38.000Z</published>
    <updated>2016-02-19T09:24:00.000Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x6709;&amp;#x4E00;&amp;#x7C7B;&amp;#x7F51;&amp;#x7EDC;&amp;#x6D41;&amp;#x95EE;&amp;#x9898;&amp;#xFF0C;&amp;#x6700;&amp;#x5927;&amp;#x6D41;&amp;#x5E76;&amp;#x4E0D;&amp;#x552F;&amp;#x4E00;&amp;#xFF0C;&amp;#x800C;&amp;#x6BCF;&amp;#x4E00;&amp;#x6761;&amp;#x8FB9;&amp;#x90FD;&amp;#x6709;&amp;#x4E00;&amp;#x4E2A;&amp;#x5355;&amp;#x4F4D;&amp;#x6D41;&amp;#x91CF;&amp;#x7684;&amp;#x8D39;&amp;#x7528;&amp;#xFF0C;&amp;#x6700;&amp;#x4F18;&amp;#x89E3;&amp;#x7684;&amp;#x76EE;&amp;#x6807;&amp;#x662F;&amp;#x4FDD;&amp;#x8BC1;&amp;#x6D41;&amp;#x91CF;&amp;#x6700;&amp;#x5927;&amp;#x7684;&amp;#x524D;&amp;#x63D0;&amp;#x4E0B;&amp;#x4F7F;&amp;#x603B;&amp;#x8D39;&amp;#x7528;&amp;#x6700;&amp;#x5C0F;&amp;#x3002;&amp;#x5355;&amp;#x7EAF;&amp;#x7684;&amp;#x6700;&amp;#x5927;&amp;#x6D41;&amp;#x53EF;&amp;#x4EE5;&amp;#x4F7F;&amp;#x7528; Edmonds-Karp &amp;#x7B97;&amp;#x6CD5;&amp;#x6C42;&amp;#x89E3;&amp;#xFF0C;&amp;#x4F46;&amp;#x8FD9;&amp;#x4E2A;&amp;#x7B97;&amp;#x6CD5;&amp;#x4E0D;&amp;#x591F;&amp;#x4F18;&amp;#xFF0C;&amp;#x6700;&amp;#x5E38;&amp;#x7528;&amp;#x7684;&amp;#x662F; Dinic &amp;#x7B97;&amp;#x6CD5;&amp;#x3002;&amp;#x4F46; Edmonds-Karp &amp;#x786E;&amp;#x662F;&amp;#x6700;&amp;#x5C0F;&amp;#x8D39;&amp;#x7528;&amp;#x6D41;&amp;#x95EE;&amp;#x9898;&amp;#x6700;&amp;#x5E38;&amp;#x7528;&amp;#x7684;&amp;#x7B97;&amp;#x6CD5;&amp;#x3002;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;&amp;#x5B9A;&amp;#x4E49;&quot;&gt;&amp;#x5B9A;&amp;#x4E49;&lt;/h3&gt;
&lt;p&gt;&amp;#x8D39;&amp;#x7528;&amp;#xFF08;&lt;code&gt;cost&lt;/code&gt;&amp;#xFF09;&amp;#xFF1A;&amp;#x5355;&amp;#x4F4D;&amp;#x6D41;&amp;#x91CF;&amp;#x6D41;&amp;#x8FC7;&amp;#x4E00;&amp;#x6761;&amp;#x8FB9;&amp;#x9700;&amp;#x8981;&amp;#x652F;&amp;#x4ED8;&amp;#x7684;&amp;#x8D39;&amp;#x7528;&amp;#xFF0C;&amp;#x7B97;&amp;#x6CD5;&amp;#x7684;&amp;#x76EE;&amp;#x6807;&amp;#x662F;&amp;#x4F7F;&amp;#x603B;&amp;#x6D41;&amp;#x91CF;&amp;#x6700;&amp;#x5927;&amp;#x7684;&amp;#x524D;&amp;#x63D0;&amp;#x4E0B;&amp;#x603B;&amp;#x8D39;&amp;#x7528;&amp;#x6700;&amp;#x5C0F;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x5176;&amp;#x4ED6;&amp;#x7684;&amp;#x5B9A;&amp;#x4E49;&amp;#x548C; Dinic &amp;#x4E2D;&amp;#x57FA;&amp;#x672C;&amp;#x76F8;&amp;#x540C;&amp;#xFF0C;&amp;#x4F46; Edmonds-Karp &amp;#x4E2D;&amp;#x6CA1;&amp;#x6709;&amp;#x300E;&amp;#x5C42;&amp;#x6B21;&amp;#x300F;&amp;#x548C;&amp;#x300E;&amp;#x5C42;&amp;#x6B21;&amp;#x56FE;&amp;#x300F;&amp;#x7684;&amp;#x6982;&amp;#x5FF5;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;Edmonds-Karp &amp;#x7684;&amp;#x53CD;&amp;#x5411;&amp;#x8FB9;&amp;#x7684;&amp;#x8D39;&amp;#x7528;&amp;#x662F;&amp;#x539F;&amp;#x8FB9;&amp;#x7684;&amp;#x8D39;&amp;#x7528;&amp;#x76F8;&amp;#x53CD;&amp;#x6570;&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x7B97;&amp;#x6CD5;&quot;&gt;&amp;#x7B97;&amp;#x6CD5;&lt;/h3&gt;
&lt;ol style=&quot;list-style-type: decimal&quot;&gt;
&lt;li&gt;&amp;#x5728;&amp;#x6B8B;&amp;#x91CF;&amp;#x7F51;&amp;#x7EDC;&amp;#x4E2D;&amp;#x4EE5;&amp;#x300E;&amp;#x8D39;&amp;#x7528;&amp;#x300F;&amp;#x4E3A;&amp;#x8DDD;&amp;#x79BB;&amp;#xFF0C;&amp;#x6CBF;&amp;#x7740;&amp;#x672A;&amp;#x6EE1;&amp;#x6D41;&amp;#x8FB9;&amp;#x627E;&amp;#x51FA;&amp;#x4E00;&amp;#x6761;&amp;#x4ECE;&amp;#x6E90;&amp;#x70B9;&amp;#x5230;&amp;#x6C47;&amp;#x70B9;&amp;#x7684;&amp;#x6700;&amp;#x77ED;&amp;#x8DEF;&amp;#xFF0C;&amp;#x5E76;&amp;#x8FDB;&amp;#x884C;&amp;#x589E;&amp;#x5E7F;&amp;#x3002;&lt;/li&gt;
&lt;li&gt;&amp;#x589E;&amp;#x5E7F;&amp;#x65F6;&amp;#x5C06;&amp;#x603B;&amp;#x8D39;&amp;#x7528;&amp;#x52A0;&amp;#x4E0A;&lt;strong&gt;&amp;#x6C47;&amp;#x70B9;&amp;#x7684;&amp;#x8DDD;&amp;#x79BB;&lt;/strong&gt; &amp;#xD7; &lt;strong&gt;&amp;#x589E;&amp;#x5E7F;&amp;#x6D41;&amp;#x91CF;&lt;/strong&gt;&amp;#x3002;&lt;/li&gt;
&lt;li&gt;&amp;#x65E0;&amp;#x6CD5;&amp;#x627E;&amp;#x5230;&amp;#x589E;&amp;#x5E7F;&amp;#x8DEF;&amp;#x65F6;&amp;#x7B97;&amp;#x6CD5;&amp;#x7ED3;&amp;#x675F;&amp;#xFF0C;&amp;#x6B64;&amp;#x65F6;&amp;#x5DF2;&amp;#x627E;&amp;#x51FA;&amp;#x7F51;&amp;#x7EDC;&amp;#x7684;&amp;#x6700;&amp;#x5C0F;&amp;#x8D39;&amp;#x7528;&amp;#x6700;&amp;#x5927;&amp;#x6D41;&amp;#x3002;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&amp;#x627E;&amp;#x6700;&amp;#x77ED;&amp;#x8DEF;&amp;#x65F6;&amp;#xFF0C;&amp;#x4E00;&amp;#x822C;&amp;#x4F7F;&amp;#x7528; Bellman-Ford &amp;#x7B97;&amp;#x6CD5;&amp;#xFF0C;&amp;#x56E0;&amp;#x4E3A;&amp;#x7F51;&amp;#x7EDC;&amp;#x4E2D;&amp;#x4E00;&amp;#x822C;&amp;#x90FD;&amp;#x4F1A;&amp;#x5B58;&amp;#x5728;&amp;#x8D1F;&amp;#x6743;&amp;#x8FB9;&amp;#xFF0C;&amp;#x800C;&amp;#x4E0D;&amp;#x53EF;&amp;#x80FD;&amp;#x6709;&amp;#x8D1F;&amp;#x73AF;&amp;#x2014;&amp;#x2014;&amp;#x5F53;&amp;#x6709;&amp;#x8D1F;&amp;#x73AF;&amp;#x65F6;&amp;#xFF0C;&amp;#x6700;&amp;#x5C0F;&amp;#x8D39;&amp;#x7528;&amp;#x6700;&amp;#x5927;&amp;#x6D41;&amp;#x4E0D;&amp;#x5B58;&amp;#x5728;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;Edmonds-Karp &amp;#x57FA;&amp;#x4E8E;&amp;#x4E00;&amp;#x4E2A;&amp;#x4E8B;&amp;#x5B9E;&amp;#xFF1A;&amp;#x5982;&amp;#x679C;&amp;#x5F53;&amp;#x524D;&amp;#x8D39;&amp;#x7528;&amp;#x662F;&amp;#x5728;&amp;#x5F53;&amp;#x524D;&amp;#x6D41;&amp;#x91CF;&amp;#x4E0B;&amp;#x7684;&amp;#x6700;&amp;#x5C0F;&amp;#x8D39;&amp;#x7528;&amp;#xFF0C;&amp;#x90A3;&amp;#x4E48;&amp;#x4EE5;&amp;#x6700;&amp;#x5C0F;&amp;#x8D39;&amp;#x7528;&amp;#x589E;&amp;#x5E7F;&amp;#x4E4B;&amp;#x540E;&amp;#x7684;&amp;#x8D39;&amp;#x7528;&amp;#x4E5F;&amp;#x4E3A;&amp;#x589E;&amp;#x5E7F;&amp;#x540E;&amp;#x7684;&amp;#x6D41;&amp;#x91CF;&amp;#x4E0B;&amp;#x7684;&amp;#x6700;&amp;#x5C0F;&amp;#x8D39;&amp;#x7528;&amp;#x3002;&amp;#x4E0D;&amp;#x65AD;&amp;#x589E;&amp;#x5E7F;&amp;#x627E;&amp;#x5230;&amp;#x7684;&amp;#x5C31;&amp;#x662F;&amp;#x6700;&amp;#x5C0F;&amp;#x8D39;&amp;#x7528;&amp;#x6700;&amp;#x5927;&amp;#x6D41;&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x4EE3;&amp;#x7801;&amp;#x5B9E;&amp;#x73B0;&quot;&gt;&amp;#x4EE3;&amp;#x7801;&amp;#x5B9E;&amp;#x73B0;&lt;/h3&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Node {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Edge *firstEdge, *inEdge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; flow, dist;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; inQueue;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} nodes[MAXN];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Edge {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Node *from, *to;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; capacity, flow, cost;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Edge *next, *reversedEdge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Edge(Node *from, Node *to, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; capacity, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; cost) : from(from), to(to), capacity(capacity), cost(cost), flow(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;), next(from-&amp;gt;firstEdge) {}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;};&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; EdmondsKarp {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;bellmanford&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Node *s, Node *t, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &amp;amp;flow, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &amp;amp;cost)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			nodes[i].dist = INT_MAX;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			nodes[i].inEdge = &lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			nodes[i].flow = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			nodes[i].inQueue = &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		s-&amp;gt;flow = INT_MAX;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		s-&amp;gt;dist = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;queue&lt;/span&gt;&amp;lt;Node *&amp;gt; q;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		q.push(s);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (!q.empty()) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			Node *v = q.front();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			q.pop();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			v-&amp;gt;inQueue = &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (Edge *e = v-&amp;gt;firstEdge; e; e = e-&amp;gt;next) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (e-&amp;gt;flow &amp;lt; e-&amp;gt;capacity &amp;amp;&amp;amp; e-&amp;gt;to-&amp;gt;dist &amp;gt; v-&amp;gt;dist + e-&amp;gt;cost) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					e-&amp;gt;to-&amp;gt;dist = v-&amp;gt;dist + e-&amp;gt;cost;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					e-&amp;gt;to-&amp;gt;inEdge = e;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					e-&amp;gt;to-&amp;gt;flow = &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::min(v-&amp;gt;flow, e-&amp;gt;capacity - e-&amp;gt;flow);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!e-&amp;gt;to-&amp;gt;inQueue) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;						q.push(e-&amp;gt;to);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;						e-&amp;gt;to-&amp;gt;inQueue = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (t-&amp;gt;dist == INT_MAX) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (Node *v = t; v != s; v = v-&amp;gt;inEdge-&amp;gt;from) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			v-&amp;gt;inEdge-&amp;gt;flow += t-&amp;gt;flow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			v-&amp;gt;inEdge-&amp;gt;reversedEdge-&amp;gt;flow -= t-&amp;gt;flow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		cost += t-&amp;gt;dist * t-&amp;gt;flow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		flow += t-&amp;gt;flow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;operator&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; s, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; t, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &amp;amp;flow, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &amp;amp;cost)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		flow = cost = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (bellmanford(&amp;amp;nodes[s], &amp;amp;nodes[t], n, flow, cost));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} edmondskarp;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;addEdge&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; from, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; to, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; capacity, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; cost)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	nodes[from].firstEdge = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Edge(&amp;amp;nodes[from], &amp;amp;nodes[to], capacity, cost);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	nodes[to].firstEdge = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Edge(&amp;amp;nodes[to], &amp;amp;nodes[from], &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, -cost);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	nodes[from].firstEdge-&amp;gt;reversedEdge = nodes[to].firstEdge, nodes[to].firstEdge-&amp;gt;reversedEdge = nodes[from].firstEdge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x6709;&amp;#x4E00;&amp;#x7C7B;&amp;#x7F51;&amp;#x7EDC;&amp;#x6D41;&amp;#x95EE;&amp;#x9898;&amp;#xFF0C;&amp;#x6700;&amp;#x5927;&amp;#x6D41;&amp;#x5E76;&amp;#x4E0D;&amp;#x552F;&amp;#x4E00;&amp;#xFF0C;&amp;#x800C;&amp;#x6BCF;&amp;#x4E00;&amp;#x6761;&amp;#x8FB9;&amp;#x90FD;&amp;#x6709;&amp;#x4E00;&amp;#x4E2A;&amp;#x5355;&amp;#x4F4D;&amp;#x6D41;&amp;#x91CF;&amp;#x7684;&amp;#x8D39;&amp;#x7528;&amp;#xFF0C;&amp;#x6700;&amp;#x4F18;&amp;#x89E3;&amp;#x7684;&amp;#x76EE;&amp;#x6807;&amp;#x662F;&amp;#x4FDD;&amp;#x8BC1;&amp;#x6D41;&amp;#x91CF;&amp;#x6700;&amp;#x5927;&amp;#x7684;&amp;#x524D;&amp;#x63D0;&amp;#x4E0B;&amp;#x4F7F;&amp;#x603B;&amp;#x8D39;&amp;#x7528;&amp;#x6700;&amp;#x5C0F;&amp;#x3002;&amp;#x5355;&amp;#x7EAF;&amp;#x7684;&amp;#x6700;&amp;#x5927;&amp;#x6D41;&amp;#x53EF;&amp;#x4EE5;&amp;#x4F7F;&amp;#x7528; Edmonds-Karp &amp;#x7B97;&amp;#x6CD5;&amp;#x6C42;&amp;#x89E3;&amp;#xFF0C;&amp;#x4F46;&amp;#x8FD9;&amp;#x4E2A;&amp;#x7B97;&amp;#x6CD5;&amp;#x4E0D;&amp;#x591F;&amp;#x4F18;&amp;#xFF0C;&amp;#x6700;&amp;#x5E38;&amp;#x7528;&amp;#x7684;&amp;#x662F; Dinic &amp;#x7B97;&amp;#x6CD5;&amp;#x3002;&amp;#x4F46; Edmonds-Karp &amp;#x786E;&amp;#x662F;&amp;#x6700;&amp;#x5C0F;&amp;#x8D39;&amp;#x7528;&amp;#x6D41;&amp;#x95EE;&amp;#x9898;&amp;#x6700;&amp;#x5E38;&amp;#x7528;&amp;#x7684;&amp;#x7B97;&amp;#x6CD5;&amp;#x3002;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="Edmonds-Karp" scheme="https://blog.menci.moe/tag/edmonds-karp/"/>
    
      <category term="图论" scheme="https://blog.menci.moe/tag/%E5%9B%BE%E8%AE%BA/"/>
    
      <category term="学习笔记" scheme="https://blog.menci.moe/tag/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
      <category term="网络流" scheme="https://blog.menci.moe/tag/%E7%BD%91%E7%BB%9C%E6%B5%81/"/>
    
      <category term="费用流" scheme="https://blog.menci.moe/tag/%E8%B4%B9%E7%94%A8%E6%B5%81/"/>
    
  </entry>
  
  <entry>
    <title>「NOIP2010」关押罪犯 - 二分图染色</title>
    <link href="https://blog.menci.moe/noip2010-prison/"/>
    <id>https://blog.menci.moe/noip2010-prison/</id>
    <published>2016-02-19T08:00:26.000Z</published>
    <updated>2016-02-19T08:06:06.000Z</updated>
    
    <content type="html">&lt;p&gt;S &amp;#x57CE;&amp;#x73B0;&amp;#x6709;&amp;#x4E24;&amp;#x5EA7;&amp;#x76D1;&amp;#x72F1;&amp;#xFF0C;&amp;#x4E00;&amp;#x5171;&amp;#x5173;&amp;#x62BC;&amp;#x7740; &lt;code&gt;N&lt;/code&gt; &amp;#x540D;&amp;#x7F6A;&amp;#x72AF;&amp;#xFF0C;&amp;#x7F16;&amp;#x53F7;&amp;#x5206;&amp;#x522B;&amp;#x4E3A; &lt;code&gt;1 ~ N&lt;/code&gt;&amp;#xFF0C;&amp;#x6211;&amp;#x4EEC;&amp;#x7528;&amp;#x201C;&amp;#x6028;&amp;#x6C14;&amp;#x503C;&amp;#x201D;&amp;#xFF08;&amp;#x4E00;&amp;#x4E2A;&amp;#x6B63;&amp;#x6574;&amp;#x6570;&amp;#x503C;&amp;#xFF09;&amp;#x6765;&amp;#x8868;&amp;#x793A;&amp;#x67D0;&amp;#x4E24;&amp;#x540D;&amp;#x7F6A;&amp;#x72AF;&amp;#x4E4B;&amp;#x95F4;&amp;#x7684;&amp;#x4EC7;&amp;#x6068;&amp;#x7A0B;&amp;#x5EA6;&amp;#xFF0C;&amp;#x6028;&amp;#x6C14;&amp;#x503C;&amp;#x8D8A;&amp;#x5927;&amp;#xFF0C;&amp;#x5219;&amp;#x8FD9;&amp;#x4E24;&amp;#x540D;&amp;#x7F6A;&amp;#x72AF;&amp;#x4E4B;&amp;#x95F4;&amp;#x7684;&amp;#x79EF;&amp;#x6028;&amp;#x8D8A;&amp;#x591A;&amp;#x3002;&amp;#x6BCF;&amp;#x5E74;&amp;#x6BCF;&amp;#x4E00;&amp;#x5BF9;&amp;#x6709;&amp;#x4EC7;&amp;#x6068;&amp;#x7684;&amp;#x7F6A;&amp;#x72AF;&amp;#x4F1A;&amp;#x53D1;&amp;#x751F;&amp;#x4E00;&amp;#x6B21;&amp;#x51B2;&amp;#x7A81;&amp;#x3002;&amp;#x516C;&amp;#x52A1;&amp;#x7E41;&amp;#x5FD9;&amp;#x7684; Z &amp;#x5E02;&amp;#x957F;&amp;#x53EA;&amp;#x4F1A;&amp;#x53BB;&amp;#x770B;&amp;#x5217;&amp;#x8868;&amp;#x4E2D;&amp;#x7684;&amp;#x7B2C;&amp;#x4E00;&amp;#x4E2A;&amp;#x4E8B;&amp;#x4EF6;&amp;#x7684;&amp;#x5F71;&amp;#x54CD;&amp;#x529B;&amp;#x3002;&amp;#x90A3;&amp;#x4E48;&amp;#xFF0C;&amp;#x5E94;&amp;#x5982;&amp;#x4F55;&amp;#x5206;&amp;#x914D;&amp;#x7F6A;&amp;#x72AF;&amp;#xFF0C;&amp;#x624D;&amp;#x80FD;&amp;#x4F7F; Z &amp;#x5E02;&amp;#x957F;&amp;#x770B;&amp;#x5230;&amp;#x7684;&amp;#x90A3;&amp;#x4E2A;&amp;#x51B2;&amp;#x7A81;&amp;#x4E8B;&amp;#x4EF6;&amp;#x7684;&amp;#x5F71;&amp;#x54CD;&amp;#x529B;&amp;#x6700;&amp;#x5C0F;&amp;#xFF0C;&amp;#x6C42;&amp;#x8FD9;&amp;#x4E2A;&amp;#x6700;&amp;#x5C0F;&amp;#x503C;&amp;#x662F;&amp;#x591A;&amp;#x5C11;&amp;#xFF1F;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;&amp;#x9898;&amp;#x76EE;&amp;#x94FE;&amp;#x63A5;&quot;&gt;&amp;#x9898;&amp;#x76EE;&amp;#x94FE;&amp;#x63A5;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://codevs.cn/problem/1069/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;CodeVS 1069&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://tyvj.cn/p/1403&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Tyvj 1043&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.luogu.org/problem/show?pid=1525&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;&amp;#x6D1B;&amp;#x8C37; 1525&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x89E3;&amp;#x9898;&amp;#x601D;&amp;#x8DEF;&quot;&gt;&amp;#x89E3;&amp;#x9898;&amp;#x601D;&amp;#x8DEF;&lt;/h3&gt;
&lt;p&gt;&amp;#x56E0;&amp;#x4E3A;&amp;#x8981;&amp;#x6C42;&amp;#x6700;&amp;#x5C0F;&amp;#x503C;&amp;#xFF0C;&amp;#x6240;&amp;#x4EE5;&amp;#x8003;&amp;#x8651;&amp;#x4E8C;&amp;#x5206;&amp;#x7B54;&amp;#x6848;&amp;#x3002;&amp;#x5F53;&amp;#x6211;&amp;#x4EEC;&amp;#x4E8C;&amp;#x5206;&amp;#x4E00;&amp;#x4E2A;&amp;#x7B54;&amp;#x6848; &lt;code&gt;x&lt;/code&gt; &amp;#x540E;&amp;#xFF0C;&amp;#x53EA;&amp;#x9700;&amp;#x8981;&amp;#x8003;&amp;#x8651;&amp;#x6012;&amp;#x6C14;&amp;#x503C;&amp;#x5927;&amp;#x4E8E; &lt;code&gt;x&lt;/code&gt; &amp;#x7684;&amp;#x6210;&amp;#x5BF9;&amp;#x7F6A;&amp;#x72AF;&amp;#x4E86;&amp;#xFF0C;&amp;#x8FD9;&amp;#x65F6;&amp;#x5019;&amp;#x5BF9;&amp;#x6574;&amp;#x5F20;&amp;#x56FE;&amp;#x8FDB;&amp;#x884C;&amp;#x4E8C;&amp;#x5206;&amp;#x56FE;&amp;#x67D3;&amp;#x8272;&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x80FD;&amp;#x88AB;&amp;#x67D3;&amp;#x8272;&amp;#x6210;&amp;#x4E3A;&amp;#x4E8C;&amp;#x5206;&amp;#x56FE;&amp;#xFF0C;&amp;#x5219;&amp;#x8FD9;&amp;#x4E2A;&amp;#x7B54;&amp;#x6848;&amp;#x5408;&amp;#x6CD5;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x4E8C;&amp;#x5206;&amp;#x56FE;&amp;#x67D3;&amp;#x8272;&amp;#xFF1A;&amp;#x628A;&amp;#x6BCF;&amp;#x4E2A;&amp;#x672A;&amp;#x6807;&amp;#x8BB0;&amp;#x7684;&amp;#x8282;&amp;#x70B9;&amp;#x6807;&amp;#x8BB0;&amp;#x4E3A;&amp;#x4EFB;&amp;#x610F;&amp;#x4E00;&amp;#x79CD;&amp;#x989C;&amp;#x8272;&amp;#xFF0C;&amp;#x5BF9;&amp;#x5176;&amp;#x8FDB;&amp;#x884C;&amp;#x4E00;&amp;#x6B21; BFS&amp;#xFF0C;&amp;#x6BCF;&amp;#x4E00;&amp;#x6B21;&amp;#x6269;&amp;#x5C55;&amp;#x628A;&amp;#x672A;&amp;#x88AB;&amp;#x67D3;&amp;#x8272;&amp;#x7684;&amp;#x8282;&amp;#x70B9;&amp;#x6807;&amp;#x8BB0;&amp;#x4E3A;&amp;#x4E0E;&amp;#x81EA;&amp;#x8EAB;&amp;#x76F8;&amp;#x53CD;&amp;#x7684;&amp;#x989C;&amp;#x8272;&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x53D1;&amp;#x73B0;&amp;#x6269;&amp;#x5C55;&amp;#x51FA;&amp;#x53BB;&amp;#x7684;&amp;#x8282;&amp;#x70B9;&amp;#x7684;&amp;#x989C;&amp;#x8272;&amp;#x4E0E;&amp;#x81EA;&amp;#x8EAB;&amp;#x76F8;&amp;#x540C;&amp;#xFF0C;&amp;#x5219;&amp;#x67D3;&amp;#x8272;&amp;#x5931;&amp;#x8D25;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x65F6;&amp;#x95F4;&amp;#x590D;&amp;#x6742;&amp;#x5EA6;&amp;#x4E3A; $ O(n{log}n) $&amp;#xFF0C;&amp;#x7406;&amp;#x8BBA;&amp;#x4E0A;&amp;#x6765;&amp;#x8BF4;&amp;#x53EF;&amp;#x4EE5;&amp;#x8FC7; 100% &amp;#x7684;&amp;#x6570;&amp;#x636E;&amp;#xFF0C;&amp;#x7136;&amp;#x800C; Tyvj &amp;#x7684;&amp;#x8BC4;&amp;#x6D4B;&amp;#x673A;&amp;#x592A;&amp;#x70C2;&amp;#x7ADF;&amp;#x7136; TLE &amp;#x4E86;&amp;#x4E00;&amp;#x4E2A;&amp;#x70B9;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x6709;&amp;#x795E;&amp;#x7287;&amp;#x8BF4;&amp;#x53EF;&amp;#x4EE5;&amp;#x7528;&amp;#x5E76;&amp;#x67E5;&amp;#x96C6;&amp;#xFF0C;&amp;#x7136;&amp;#x800C;&amp;#x6211;&amp;#x592A;&amp;#x5F31;&amp;#x4E0D;&amp;#x4F1A; &amp;#x2026;&amp;#x2026; qwq&lt;/p&gt;
&lt;h3 id=&quot;ac&amp;#x4EE3;&amp;#x7801;&quot;&gt;AC&amp;#x4EE3;&amp;#x7801;&lt;/h3&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;93&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;94&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;95&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;96&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;97&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;98&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;99&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;100&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;101&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;algorithm&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;queue&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXN = &lt;span class=&quot;number&quot;&gt;20000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXM = &lt;span class=&quot;number&quot;&gt;100000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;enum&lt;/span&gt; Color {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	None = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Red = &lt;span class=&quot;number&quot;&gt;2000&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Blue = &lt;span class=&quot;number&quot;&gt;5280&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;};&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Node;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Edge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Node {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Edge *firstEdge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Color color;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} nodes[MAXN];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Edge {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Node *from, *to;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; w;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Edge *next;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Edge(Node *from, Node *to, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; w) : from(from), to(to), next(from-&amp;gt;firstEdge), w(w) {}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;};&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, m, max;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;addEdge&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; u, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; v, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; w)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	nodes[u].firstEdge = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Edge(&amp;amp;nodes[u], &amp;amp;nodes[v], w);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	nodes[v].firstEdge = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Edge(&amp;amp;nodes[v], &amp;amp;nodes[u], w);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; Color &lt;span class=&quot;title&quot;&gt;getReveseColor&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Color c)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; c == Red ? Blue : Red;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;bfs&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Node *start, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; limit)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;check&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; limit)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) nodes[i].color = None;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (nodes[i].color == None) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			nodes[i].color = Red;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;queue&lt;/span&gt;&amp;lt;Node *&amp;gt; q;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			q.push(&amp;amp;nodes[i]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (!q.empty()) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				Node *v = q.front();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				q.pop();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (Edge *e = v-&amp;gt;firstEdge; e; e = e-&amp;gt;next) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (e-&amp;gt;w &amp;lt; limit) &lt;span class=&quot;keyword&quot;&gt;continue&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (e-&amp;gt;to-&amp;gt;color == None) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;						e-&amp;gt;to-&amp;gt;color = getReveseColor(v-&amp;gt;color);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;						q.push(e-&amp;gt;to);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					} &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (e-&amp;gt;to-&amp;gt;color == v-&amp;gt;color) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;solve&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; l = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, r = max;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (l &amp;lt; r) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; mid = (l &amp;amp; r) + ((l ^ r) &amp;gt;&amp;gt; &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;comment&quot;&gt;//printf(&amp;quot;[%d, %d] with `mid` = %d\n&amp;quot;, l, r, mid);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (check(mid)) r = mid;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; l = mid + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; l - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d&amp;quot;&lt;/span&gt;, &amp;amp;n, &amp;amp;m);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; m; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; u, v, w;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d %d&amp;quot;&lt;/span&gt;, &amp;amp;u, &amp;amp;v, &amp;amp;w), u--, v--;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		addEdge(u, v, w);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		max = &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::max(max, w);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d\n&amp;quot;&lt;/span&gt;, solve());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;S &amp;#x57CE;&amp;#x73B0;&amp;#x6709;&amp;#x4E24;&amp;#x5EA7;&amp;#x76D1;&amp;#x72F1;&amp;#xFF0C;&amp;#x4E00;&amp;#x5171;&amp;#x5173;&amp;#x62BC;&amp;#x7740; &lt;code&gt;N&lt;/code&gt; &amp;#x540D;&amp;#x7F6A;&amp;#x72AF;&amp;#xFF0C;&amp;#x7F16;&amp;#x53F7;&amp;#x5206;&amp;#x522B;&amp;#x4E3A; &lt;code&gt;1 ~ N&lt;/code&gt;&amp;#xFF0C;&amp;#x6211;&amp;#x4EEC;&amp;#x7528;&amp;#x201C;&amp;#x6028;&amp;#x6C14;&amp;#x503C;&amp;#x201D;&amp;#xFF08;&amp;#x4E00;&amp;#x4E2A;&amp;#x6B63;&amp;#x6574;&amp;#x6570;&amp;#x503C;&amp;#xFF09;&amp;#x6765;&amp;#x8868;&amp;#x793A;&amp;#x67D0;&amp;#x4E24;&amp;#x540D;&amp;#x7F6A;&amp;#x72AF;&amp;#x4E4B;&amp;#x95F4;&amp;#x7684;&amp;#x4EC7;&amp;#x6068;&amp;#x7A0B;&amp;#x5EA6;&amp;#xFF0C;&amp;#x6028;&amp;#x6C14;&amp;#x503C;&amp;#x8D8A;&amp;#x5927;&amp;#xFF0C;&amp;#x5219;&amp;#x8FD9;&amp;#x4E24;&amp;#x540D;&amp;#x7F6A;&amp;#x72AF;&amp;#x4E4B;&amp;#x95F4;&amp;#x7684;&amp;#x79EF;&amp;#x6028;&amp;#x8D8A;&amp;#x591A;&amp;#x3002;&amp;#x6BCF;&amp;#x5E74;&amp;#x6BCF;&amp;#x4E00;&amp;#x5BF9;&amp;#x6709;&amp;#x4EC7;&amp;#x6068;&amp;#x7684;&amp;#x7F6A;&amp;#x72AF;&amp;#x4F1A;&amp;#x53D1;&amp;#x751F;&amp;#x4E00;&amp;#x6B21;&amp;#x51B2;&amp;#x7A81;&amp;#x3002;&amp;#x516C;&amp;#x52A1;&amp;#x7E41;&amp;#x5FD9;&amp;#x7684; Z &amp;#x5E02;&amp;#x957F;&amp;#x53EA;&amp;#x4F1A;&amp;#x53BB;&amp;#x770B;&amp;#x5217;&amp;#x8868;&amp;#x4E2D;&amp;#x7684;&amp;#x7B2C;&amp;#x4E00;&amp;#x4E2A;&amp;#x4E8B;&amp;#x4EF6;&amp;#x7684;&amp;#x5F71;&amp;#x54CD;&amp;#x529B;&amp;#x3002;&amp;#x90A3;&amp;#x4E48;&amp;#xFF0C;&amp;#x5E94;&amp;#x5982;&amp;#x4F55;&amp;#x5206;&amp;#x914D;&amp;#x7F6A;&amp;#x72AF;&amp;#xFF0C;&amp;#x624D;&amp;#x80FD;&amp;#x4F7F; Z &amp;#x5E02;&amp;#x957F;&amp;#x770B;&amp;#x5230;&amp;#x7684;&amp;#x90A3;&amp;#x4E2A;&amp;#x51B2;&amp;#x7A81;&amp;#x4E8B;&amp;#x4EF6;&amp;#x7684;&amp;#x5F71;&amp;#x54CD;&amp;#x529B;&amp;#x6700;&amp;#x5C0F;&amp;#xFF0C;&amp;#x6C42;&amp;#x8FD9;&amp;#x4E2A;&amp;#x6700;&amp;#x5C0F;&amp;#x503C;&amp;#x662F;&amp;#x591A;&amp;#x5C11;&amp;#xFF1F;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="CodeVS" scheme="https://blog.menci.moe/tag/codevs/"/>
    
      <category term="NOIP" scheme="https://blog.menci.moe/tag/noip/"/>
    
      <category term="Vijos" scheme="https://blog.menci.moe/tag/vijos/"/>
    
      <category term="二分图染色" scheme="https://blog.menci.moe/tag/%E4%BA%8C%E5%88%86%E5%9B%BE%E6%9F%93%E8%89%B2/"/>
    
      <category term="二分答案" scheme="https://blog.menci.moe/tag/%E4%BA%8C%E5%88%86%E7%AD%94%E6%A1%88/"/>
    
      <category term="图论" scheme="https://blog.menci.moe/tag/%E5%9B%BE%E8%AE%BA/"/>
    
      <category term="洛谷" scheme="https://blog.menci.moe/tag/%E6%B4%9B%E8%B0%B7/"/>
    
  </entry>
  
  <entry>
    <title>「COGS 746」骑士共存 - 二分图最大独立集</title>
    <link href="https://blog.menci.moe/cogs-746/"/>
    <id>https://blog.menci.moe/cogs-746/</id>
    <published>2016-02-19T03:43:42.000Z</published>
    <updated>2016-02-19T03:44:48.000Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x5728;&amp;#x4E00;&amp;#x4E2A; $ N * N $ &amp;#x4E2A;&amp;#x65B9;&amp;#x683C;&amp;#x7684;&amp;#x56FD;&amp;#x9645;&amp;#x8C61;&amp;#x68CB;&amp;#x68CB;&amp;#x76D8;&amp;#x4E0A;&amp;#xFF0C;&amp;#x9A6C;&amp;#xFF08;&amp;#x9A91;&amp;#x58EB;&amp;#xFF09;&amp;#x53EF;&amp;#x4EE5;&amp;#x653B;&amp;#x51FB;&amp;#x7684;&amp;#x68CB;&amp;#x76D8;&amp;#x65B9;&amp;#x683C;&amp;#x5982;&amp;#x56FE;&amp;#x6240;&amp;#x793A;&amp;#x3002;&amp;#x68CB;&amp;#x76D8;&amp;#x4E0A;&amp;#x67D0;&amp;#x4E9B;&amp;#x65B9;&amp;#x683C;&amp;#x8BBE;&amp;#x7F6E;&amp;#x4E86;&amp;#x969C;&amp;#x788D;&amp;#xFF0C;&amp;#x9A91;&amp;#x58EB;&amp;#x4E0D;&amp;#x5F97;&amp;#x8FDB;&amp;#x5165;&amp;#x3002;&amp;#x95EE;&amp;#x6700;&amp;#x591A;&amp;#x53EF;&amp;#x4EE5;&amp;#x5728;&amp;#x68CB;&amp;#x76D8;&amp;#x4E0A;&amp;#x653E;&amp;#x591A;&amp;#x5C11;&amp;#x4E2A;&amp;#x5176;&amp;#x5B9E;&amp;#x3002;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;&amp;#x9898;&amp;#x76EE;&amp;#x94FE;&amp;#x63A5;&quot;&gt;&amp;#x9898;&amp;#x76EE;&amp;#x94FE;&amp;#x63A5;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://cogs.top/cogs/problem/problem.php?pid=746&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;COGS 746&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x89E3;&amp;#x9898;&amp;#x601D;&amp;#x8DEF;&quot;&gt;&amp;#x89E3;&amp;#x9898;&amp;#x601D;&amp;#x8DEF;&lt;/h3&gt;
&lt;p&gt;&amp;#x5728;&amp;#x9898;&amp;#x56FE;&amp;#x4E2D;&amp;#x53EF;&amp;#x4EE5;&amp;#x53D1;&amp;#x73B0;&amp;#xFF0C;&amp;#x6BCF;&amp;#x4E2A;&amp;#x9A6C;&amp;#x53EF;&amp;#x4EE5;&amp;#x653B;&amp;#x51FB;&amp;#x7684;&amp;#x683C;&amp;#x5B50;&amp;#x90FD;&amp;#x5728;&amp;#x4E0E;&amp;#x81EA;&amp;#x8EAB;&amp;#x989C;&amp;#x8272;&amp;#x4E0D;&amp;#x540C;&amp;#x7684;&amp;#x683C;&amp;#x5B50;&amp;#x4E0A;&amp;#xFF0C;&amp;#x5373;&amp;#x6574;&amp;#x4E2A;&amp;#x68CB;&amp;#x76D8;&amp;#x53EF;&amp;#x4EE5;&amp;#x5EFA;&amp;#x7ACB;&amp;#x4E3A;&amp;#x4E8C;&amp;#x5206;&amp;#x56FE;&amp;#xFF0C;&amp;#x5E76;&amp;#x4F7F;&amp;#x80FD;&amp;#x4E92;&amp;#x76F8;&amp;#x653B;&amp;#x51FB;&amp;#x5230;&amp;#x7684;&amp;#x683C;&amp;#x5B50;&amp;#x4F4D;&amp;#x4E8E;&amp;#x4E0D;&amp;#x540C;&amp;#x7684;&amp;#x4E24;&amp;#x5217;&amp;#x3002;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&amp;#x6839;&amp;#x636E;&amp;#x5B9A;&amp;#x7406;&amp;#xFF0C;&amp;#x4E8C;&amp;#x5206;&amp;#x56FE;&amp;#x6700;&amp;#x5927;&amp;#x72EC;&amp;#x7ACB;&amp;#x96C6;&amp;#x5373;&amp;#x4E3A;&amp;#x6700;&amp;#x5C0F;&amp;#x70B9;&amp;#x8986;&amp;#x76D6;&amp;#x96C6;&amp;#x7684;&amp;#x8865;&amp;#x96C6;&amp;#xFF0C;&amp;#x800C;&amp;#x6700;&amp;#x5C0F;&amp;#x70B9;&amp;#x8986;&amp;#x76D6;&amp;#x96C6;&amp;#x53EF;&amp;#x4EE5;&amp;#x7528;&amp;#x6700;&amp;#x5C0F;&amp;#x5272;&amp;#x6A21;&amp;#x578B;&amp;#x6765;&amp;#x6C42;&amp;#x89E3;&amp;#x3002;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;&amp;#x5EFA;&amp;#x7ACB;&amp;#x6E90;&amp;#x70B9; S &amp;#x548C;&amp;#x6C47;&amp;#x70B9; T&amp;#xFF0C;&amp;#x5BF9;&amp;#x4E8E;&amp;#x4E8C;&amp;#x5206;&amp;#x56FE;&amp;#x4E2D;&amp;#x6BCF;&amp;#x4E2A; X &amp;#x70B9;&amp;#x96C6;&amp;#x4E2D;&amp;#x7684;&amp;#x70B9;&amp;#xFF0C;&amp;#x4ECE; S &amp;#x5411;&amp;#x5176;&amp;#x8FDE;&amp;#x4E00;&amp;#x6761;&amp;#x8FB9;&amp;#xFF0C;&amp;#x5BB9;&amp;#x91CF;&amp;#x4E3A;&amp;#x70B9;&amp;#x6743;&amp;#xFF1B;&amp;#x5BF9;&amp;#x4E8E;&amp;#x6BCF;&amp;#x4E2A; Y &amp;#x70B9;&amp;#x96C6;&amp;#x4E2D;&amp;#x7684;&amp;#x70B9;&amp;#xFF0C;&amp;#x4ECE;&amp;#x8BE5;&amp;#x70B9;&amp;#x5411;&amp;#x6C47;&amp;#x70B9;&amp;#x8FDE;&amp;#x4E00;&amp;#x6761;&amp;#x8FB9;&amp;#xFF0C;&amp;#x5BB9;&amp;#x91CF;&amp;#x4E3A;&amp;#x70B9;&amp;#x6743;&amp;#xFF1B;&amp;#x5BF9;&amp;#x4E8E;&amp;#x539F;&amp;#x56FE;&amp;#x4E2D;&amp;#x7684;&amp;#x6BCF;&amp;#x6761;&amp;#x8FB9;&amp;#xFF0C;&amp;#x8F6C;&amp;#x5316;&amp;#x4E3A;&amp;#x4ECE; X &amp;#x70B9;&amp;#x96C6;&amp;#x7684;&amp;#x70B9;&amp;#x8FDE;&amp;#x63A5;&amp;#x5230; Y &amp;#x70B9;&amp;#x96C6;&amp;#x4E2D;&amp;#x7684;&amp;#x70B9;&amp;#x7684;&amp;#x8FB9;&amp;#xFF0C;&amp;#x5BB9;&amp;#x91CF;&amp;#x4E3A;&amp;#x65E0;&amp;#x7A77;&amp;#x5927;&amp;#x3002;&amp;#x6C42;&amp;#x51FA;&amp;#x6700;&amp;#x5C0F;&amp;#x5272;&amp;#xFF0C;&amp;#x5219;&amp;#x8BE5;&amp;#x6700;&amp;#x5C0F;&amp;#x5272;&amp;#x4E3A;&amp;#x7B80;&amp;#x5355;&amp;#x5272;&amp;#xFF0C;&amp;#x5373;&amp;#x4EFB;&amp;#x610F;&amp;#x4E00;&amp;#x6761;&amp;#x5272;&amp;#x8FB9;&amp;#x4E0D;&amp;#x53EF;&amp;#x80FD;&amp;#x662F;&amp;#x4E2D;&amp;#x95F4;&amp;#x90A3;&amp;#x6761;&amp;#x65E0;&amp;#x7A77;&amp;#x5927;&amp;#x7684;&amp;#x8FB9;&amp;#xFF0C;&amp;#x800C;&amp;#x8FD9;&amp;#x4E9B;&amp;#x5272;&amp;#x8FB9;&amp;#x6070;&amp;#x597D;&amp;#x4E0D;&amp;#x91CD;&amp;#x590D;&amp;#x7684;&amp;#x8986;&amp;#x76D6;&amp;#x4E86;&amp;#x6574;&amp;#x4E2A;&amp;#x4E8C;&amp;#x5206;&amp;#x56FE;&amp;#x4E2D;&amp;#x7684;&amp;#x6240;&amp;#x6709;&amp;#x70B9;&amp;#xFF0C;&amp;#x5E76;&amp;#x4E14;&amp;#x6743;&amp;#x503C;&amp;#x548C;&amp;#x6700;&amp;#x5C0F;&amp;#x3002;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;&amp;#x2014;&amp;#x2014;&amp;#x6458;&amp;#x81EA;&amp;#x300A;&amp;#x300C;COGS 734&amp;#x300D;&amp;#x65B9;&amp;#x683C;&amp;#x53D6;&amp;#x6570; - &amp;#x4E8C;&amp;#x5206;&amp;#x56FE;&amp;#x6700;&amp;#x5927;&amp;#x72EC;&amp;#x7ACB;&amp;#x96C6;&amp;#x300B;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;ac&amp;#x4EE3;&amp;#x7801;&quot;&gt;AC&amp;#x4EE3;&amp;#x7801;&lt;/h3&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;93&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;94&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;95&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;96&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;97&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;98&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;99&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;100&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;101&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;102&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;103&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;104&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;105&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;106&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;107&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;108&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;109&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;110&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;111&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;112&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;113&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;114&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;115&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;116&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;117&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;118&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;119&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;120&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;121&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;122&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;123&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;124&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;125&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;126&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;127&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;128&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;129&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;130&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;131&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;132&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;133&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;134&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;135&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;136&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;137&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;138&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;139&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;140&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;141&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;142&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;143&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;144&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;145&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;146&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;147&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;148&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;149&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;150&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;151&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;152&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;153&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;154&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;155&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;156&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;157&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;climits&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;algorithm&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;queue&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXN = &lt;span class=&quot;number&quot;&gt;200&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXM = MAXN * MAXN;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Point {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; x, y;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Point(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; x, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; y) : x(x), y(y) {}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Point &lt;span class=&quot;keyword&quot;&gt;operator&lt;/span&gt;+(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; Point &amp;amp;pt) &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; Point(x + pt.x, y + pt.y);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;};&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; Point turns[&lt;span class=&quot;number&quot;&gt;8&lt;/span&gt;] = {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Point(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;),&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Point(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;),&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Point(-&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, -&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;),&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Point(-&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, -&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;),&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Point(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, -&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;),&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Point(-&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;),&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Point(-&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;),&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Point(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, -&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;};&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Node;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Edge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Node {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Edge *firstEdge, *currentEdge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; level;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} nodes[MAXN * MAXN + &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Edge {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Node *from, *to;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; capacity, flow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Edge *next, *reversedEdge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Edge(Node *from, Node *to, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; capacity) : from(from), to(to), capacity(capacity), flow(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;), next(from-&amp;gt;firstEdge) {}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;};&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, m;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; blocked[MAXN][MAXN];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Dinic {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;makeLevelGraph&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Node *s, Node *t, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) nodes[i].level = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, nodes[i].currentEdge = nodes[i].firstEdge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;queue&lt;/span&gt;&amp;lt;Node *&amp;gt; q;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		q.push(s);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		s-&amp;gt;level = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (!q.empty()) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			Node *v = q.front();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			q.pop();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (Edge *e = v-&amp;gt;firstEdge; e; e = e-&amp;gt;next) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (e-&amp;gt;flow &amp;lt; e-&amp;gt;capacity &amp;amp;&amp;amp; e-&amp;gt;to-&amp;gt;level == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					e-&amp;gt;to-&amp;gt;level = v-&amp;gt;level + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (e-&amp;gt;to == t) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; q.push(e-&amp;gt;to);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;findPath&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Node *s, Node *t, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; limit = INT_MAX)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (s == t) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; limit;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (Edge *&amp;amp;e = s-&amp;gt;currentEdge; e; e = e-&amp;gt;next) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (e-&amp;gt;flow &amp;lt; e-&amp;gt;capacity &amp;amp;&amp;amp; e-&amp;gt;to-&amp;gt;level == s-&amp;gt;level + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; flow = findPath(e-&amp;gt;to, t, &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::min(limit, e-&amp;gt;capacity - e-&amp;gt;flow));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (flow &amp;gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					e-&amp;gt;flow += flow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					e-&amp;gt;reversedEdge-&amp;gt;flow -= flow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; flow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;operator&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; s, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; t, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; ans = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (makeLevelGraph(&amp;amp;nodes[s], &amp;amp;nodes[t], n)) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; flow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; ((flow = findPath(&amp;amp;nodes[s], &amp;amp;nodes[t])) &amp;gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) ans += flow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; ans;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} dinic;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;addEdge&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; from, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; to, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; capacity)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	nodes[from].firstEdge = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Edge(&amp;amp;nodes[from], &amp;amp;nodes[to], capacity);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	nodes[to].firstEdge = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Edge(&amp;amp;nodes[to], &amp;amp;nodes[from], &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	nodes[from].firstEdge-&amp;gt;reversedEdge = nodes[to].firstEdge, nodes[to].firstEdge-&amp;gt;reversedEdge = nodes[from].firstEdge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;getNodeID&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; x, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; y)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; y * n + x + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	freopen(&lt;span class=&quot;string&quot;&gt;&amp;quot;knight.in&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;r&amp;quot;&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;stdin&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	freopen(&lt;span class=&quot;string&quot;&gt;&amp;quot;knight.out&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;w&amp;quot;&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;stdout&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d&amp;quot;&lt;/span&gt;, &amp;amp;n, &amp;amp;m);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; m; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; x, y;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d&amp;quot;&lt;/span&gt;, &amp;amp;x, &amp;amp;y), x--, y--;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		blocked[x][y] = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; s = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, t = n * n + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; sum = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; j = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; j &amp;lt; n; j++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (blocked[i][j]) &lt;span class=&quot;keyword&quot;&gt;continue&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			sum++;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; id = getNodeID(i, j);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ((i + j) % &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;comment&quot;&gt;//printf(&amp;quot;S =&amp;gt; (%d, %d)\n&amp;quot;, i + 1, j + 1);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				addEdge(s, id, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; k = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; k &amp;lt; &lt;span class=&quot;number&quot;&gt;8&lt;/span&gt;; k++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					Point pt = Point(i, j) + turns[k];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (pt.x &amp;lt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; || pt.x &amp;gt; n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; || pt.y &amp;lt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; || pt.y &amp;gt; n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; || blocked[pt.x][pt.y]) &lt;span class=&quot;keyword&quot;&gt;continue&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;comment&quot;&gt;//printf(&amp;quot;(%d, %d) =&amp;gt; (%d, %d)\n&amp;quot;, i + 1, j + 1, pt.x + 1, pt.y + 1);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					addEdge(id, getNodeID(pt.x, pt.y), INT_MAX);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			} &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; addEdge(id, t, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;span class=&quot;comment&quot;&gt;//, printf(&amp;quot;(%d, %d) =&amp;gt; T\n&amp;quot;, i + 1, j + 1);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; maxFlow = dinic(s, t, n * n + &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d\n&amp;quot;&lt;/span&gt;, sum - maxFlow);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	fclose(&lt;span class=&quot;built_in&quot;&gt;stdin&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	fclose(&lt;span class=&quot;built_in&quot;&gt;stdout&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x5728;&amp;#x4E00;&amp;#x4E2A; $ N * N $ &amp;#x4E2A;&amp;#x65B9;&amp;#x683C;&amp;#x7684;&amp;#x56FD;&amp;#x9645;&amp;#x8C61;&amp;#x68CB;&amp;#x68CB;&amp;#x76D8;&amp;#x4E0A;&amp;#xFF0C;&amp;#x9A6C;&amp;#xFF08;&amp;#x9A91;&amp;#x58EB;&amp;#xFF09;&amp;#x53EF;&amp;#x4EE5;&amp;#x653B;&amp;#x51FB;&amp;#x7684;&amp;#x68CB;&amp;#x76D8;&amp;#x65B9;&amp;#x683C;&amp;#x5982;&amp;#x56FE;&amp;#x6240;&amp;#x793A;&amp;#x3002;&amp;#x68CB;&amp;#x76D8;&amp;#x4E0A;&amp;#x67D0;&amp;#x4E9B;&amp;#x65B9;&amp;#x683C;&amp;#x8BBE;&amp;#x7F6E;&amp;#x4E86;&amp;#x969C;&amp;#x788D;&amp;#xFF0C;&amp;#x9A91;&amp;#x58EB;&amp;#x4E0D;&amp;#x5F97;&amp;#x8FDB;&amp;#x5165;&amp;#x3002;&amp;#x95EE;&amp;#x6700;&amp;#x591A;&amp;#x53EF;&amp;#x4EE5;&amp;#x5728;&amp;#x68CB;&amp;#x76D8;&amp;#x4E0A;&amp;#x653E;&amp;#x591A;&amp;#x5C11;&amp;#x4E2A;&amp;#x5176;&amp;#x5B9E;&amp;#x3002;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="COGS" scheme="https://blog.menci.moe/tag/cogs/"/>
    
      <category term="Dinic" scheme="https://blog.menci.moe/tag/dinic/"/>
    
      <category term="图论" scheme="https://blog.menci.moe/tag/%E5%9B%BE%E8%AE%BA/"/>
    
      <category term="最大独立集" scheme="https://blog.menci.moe/tag/%E6%9C%80%E5%A4%A7%E7%8B%AC%E7%AB%8B%E9%9B%86/"/>
    
      <category term="网络流" scheme="https://blog.menci.moe/tag/%E7%BD%91%E7%BB%9C%E6%B5%81/"/>
    
      <category term="网络流24题" scheme="https://blog.menci.moe/tag/%E7%BD%91%E7%BB%9C%E6%B5%8124%E9%A2%98/"/>
    
  </entry>
  
  <entry>
    <title>「COGS 738」数字梯形 - 费用流</title>
    <link href="https://blog.menci.moe/cogs-738/"/>
    <id>https://blog.menci.moe/cogs-738/</id>
    <published>2016-02-19T03:33:27.000Z</published>
    <updated>2016-02-19T03:35:21.000Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x4E00;&amp;#x4E2A;&amp;#x6570;&amp;#x5B57;&amp;#x68AF;&amp;#x5F62;&amp;#xFF0C;&amp;#x5171;&amp;#x6709; &lt;code&gt;n&lt;/code&gt; &amp;#x884C;&amp;#xFF0C;&amp;#x7B2C;&amp;#x4E00;&amp;#x884C;&amp;#x6709; &lt;code&gt;m&lt;/code&gt; &amp;#x4E2A;&amp;#x6570;&amp;#x5B57;&amp;#xFF0C;&amp;#x6BCF;&amp;#x4E00;&amp;#x884C;&amp;#x90FD;&amp;#x6BD4;&amp;#x4E0A;&amp;#x4E00;&amp;#x884C;&amp;#x591A;&amp;#x4E00;&amp;#x4E2A;&amp;#x6570;&amp;#x5B57;&amp;#x3002;&amp;#x4ECE;&amp;#x7B2C;&amp;#x4E00;&amp;#x884C;&amp;#x7684;&amp;#x6BCF;&amp;#x4E00;&amp;#x4E2A;&amp;#x6570;&amp;#x5B57;&amp;#x5F00;&amp;#x59CB;&amp;#xFF0C;&amp;#x6BCF;&amp;#x4E00;&amp;#x6B21;&amp;#x5411;&amp;#x5DE6;&amp;#x4E0B;&amp;#x65B9;&amp;#x6216;&amp;#x5DE6;&amp;#x4E0A;&amp;#x65B9;&amp;#x8D70;&amp;#xFF0C;&amp;#x76F4;&amp;#x5230;&amp;#x6700;&amp;#x540E;&amp;#x4E00;&amp;#x884C;&amp;#xFF0C;&amp;#x6709;&amp;#x4EE5;&amp;#x4E0B;&amp;#x4E09;&amp;#x79CD;&amp;#x89C4;&amp;#x5219;&amp;#xFF1A;&lt;/p&gt;
&lt;ol style=&quot;list-style-type: decimal&quot;&gt;
&lt;li&gt;&amp;#x4EFB;&amp;#x610F;&amp;#x4E24;&amp;#x6761;&amp;#x8DEF;&amp;#x5F84;&amp;#x6CA1;&amp;#x6709;&amp;#x516C;&amp;#x5171;&amp;#x90E8;&amp;#x5206;&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x4EFB;&amp;#x610F;&amp;#x4E24;&amp;#x6761;&amp;#x8DEF;&amp;#x5F84;&amp;#x53EA;&amp;#x80FD;&amp;#x5728;&amp;#x70B9;&amp;#xFF08;&amp;#x6570;&amp;#x5B57;&amp;#xFF09;&amp;#x4E0A;&amp;#x6709;&amp;#x516C;&amp;#x5171;&amp;#x90E8;&amp;#x5206;&amp;#xFF0C;&amp;#x4E0D;&amp;#x80FD;&amp;#x5728;&amp;#x8FB9;&amp;#xFF08;&amp;#x6570;&amp;#x5B57;&amp;#x4E0E;&amp;#x6570;&amp;#x5B57;&amp;#x4E4B;&amp;#x95F4;&amp;#xFF09;&amp;#x4E0A;&amp;#x6709;&amp;#x516C;&amp;#x5171;&amp;#x90E8;&amp;#x5206;&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x4EFB;&amp;#x610F;&amp;#x4E24;&amp;#x6761;&amp;#x8DEF;&amp;#x5F84;&amp;#x53EF;&amp;#x4EE5;&amp;#x5728;&amp;#x70B9;&amp;#x4E0A;&amp;#x6216;&amp;#x8FB9;&amp;#x4E0A;&amp;#x6709;&amp;#x516C;&amp;#x5171;&amp;#x90E8;&amp;#x5206;&amp;#x3002;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&amp;#x6C42;&amp;#x5206;&amp;#x522B;&amp;#x5728;&amp;#x8FD9;&amp;#x4E09;&amp;#x79CD;&amp;#x89C4;&amp;#x5219;&amp;#x4E0B;&amp;#x7684;&amp;#x8DEF;&amp;#x5F84;&amp;#x6240;&amp;#x7ECF;&amp;#x8FC7;&amp;#x6570;&amp;#x5B57;&amp;#x603B;&amp;#x548C;&amp;#x7684;&amp;#x6700;&amp;#x5927;&amp;#x503C;&amp;#x3002;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;&amp;#x9898;&amp;#x76EE;&amp;#x94FE;&amp;#x63A5;&quot;&gt;&amp;#x9898;&amp;#x76EE;&amp;#x94FE;&amp;#x63A5;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://cogs.top/cogs/problem/problem.php?pid=738&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;COGS 738&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x89E3;&amp;#x9898;&amp;#x601D;&amp;#x8DEF;&quot;&gt;&amp;#x89E3;&amp;#x9898;&amp;#x601D;&amp;#x8DEF;&lt;/h3&gt;
&lt;p&gt;&amp;#x56E0;&amp;#x4E3A;&amp;#x662F;&amp;#x4ECE;&amp;#x7B2C;&amp;#x4E00;&amp;#x884C;&amp;#x8D70;&amp;#x5230;&amp;#x6700;&amp;#x540E;&amp;#x4E00;&amp;#x884C;&amp;#xFF0C;&amp;#x5BF9;&amp;#x4E8E;&amp;#x8DEF;&amp;#x5F84;&amp;#x6709;&amp;#x9650;&amp;#x5236;&amp;#xFF0C;&amp;#x5E76;&amp;#x4E14;&amp;#x6700;&amp;#x5927;&amp;#x5316;&amp;#x603B;&amp;#x548C;&amp;#xFF0C;&amp;#x6240;&amp;#x4EE5;&amp;#x8003;&amp;#x8651;&amp;#x8D39;&amp;#x7528;&amp;#x6D41;&amp;#x5EFA;&amp;#x6A21;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x5C06;&amp;#x6BCF;&amp;#x4E2A;&amp;#x6570;&amp;#x5B57;&amp;#x62C6;&amp;#x6210;&amp;#x4E24;&amp;#x4E2A;&amp;#x70B9;&amp;#xFF0C;&amp;#x4E2D;&amp;#x95F4;&amp;#x4E00;&amp;#x6761;&amp;#x8FB9;&amp;#x5BB9;&amp;#x91CF;&amp;#x4E3A; 1&amp;#xFF0C;&amp;#x8D39;&amp;#x7528;&amp;#x4E3A;&amp;#x8BE5;&amp;#x6570;&amp;#x5B57;&amp;#x7684;&amp;#x76F8;&amp;#x53CD;&amp;#x6570;&amp;#xFF1B;&amp;#x4ECE;&amp;#x6E90;&amp;#x70B9;&amp;#x5230;&amp;#x7B2C;&amp;#x4E00;&amp;#x884C;&amp;#x6BCF;&amp;#x4E2A;&amp;#x6570;&amp;#x5B57;&amp;#x7684;&amp;#x5165;&amp;#x70B9;&amp;#x8FDE;&amp;#x4E00;&amp;#x6761;&amp;#x8FB9;&amp;#xFF0C;&amp;#x5BB9;&amp;#x91CF;&amp;#x4E3A; 1&amp;#xFF0C;&amp;#x8D39;&amp;#x7528;&amp;#x4E3A; 0&amp;#xFF1B;&amp;#x4ECE;&amp;#x6700;&amp;#x540E;&amp;#x4E00;&amp;#x884C;&amp;#x6BCF;&amp;#x4E2A;&amp;#x6570;&amp;#x5B57;&amp;#x7684;&amp;#x51FA;&amp;#x70B9;&amp;#x5411;&amp;#x6C47;&amp;#x70B9;&amp;#x8FDE;&amp;#x4E00;&amp;#x6761;&amp;#x8FB9;&amp;#xFF0C;&amp;#x5BB9;&amp;#x91CF;&amp;#x4E3A; 1&amp;#xFF0C;&amp;#x8D39;&amp;#x7528;&amp;#x4E3A; 1&amp;#xFF1B;&amp;#x5BF9;&amp;#x4E8E;&amp;#x9664;&amp;#x6700;&amp;#x540E;&amp;#x4E00;&amp;#x884C;&amp;#x5916;&amp;#x7684;&amp;#x6BCF;&amp;#x4E2A;&amp;#x6570;&amp;#x5B57;&amp;#xFF0C;&amp;#x4ECE;&amp;#x5176;&amp;#x51FA;&amp;#x70B9;&amp;#x5411;&amp;#x5176;&amp;#x4E0B;&amp;#x65B9;&amp;#x4E24;&amp;#x4E2A;&amp;#x6570;&amp;#x5B57;&amp;#x7684;&amp;#x5165;&amp;#x70B9;&amp;#x5206;&amp;#x522B;&amp;#x8FDE;&amp;#x4E00;&amp;#x6761;&amp;#x8FB9;&amp;#xFF0C;&amp;#x5BB9;&amp;#x91CF;&amp;#x4E3A; 1&amp;#xFF0C;&amp;#x8D39;&amp;#x7528;&amp;#x4E3A; 0&amp;#x3002;&amp;#x6C42;&amp;#x51FA;&amp;#x7F51;&amp;#x7EDC;&amp;#x7684;&amp;#x6700;&amp;#x5C0F;&amp;#x8D39;&amp;#x7528;&amp;#x6700;&amp;#x5927;&amp;#x6D41;&amp;#xFF0C;&amp;#x5219;&amp;#x7ED3;&amp;#x679C;&amp;#x8D39;&amp;#x7528;&amp;#x7684;&amp;#x76F8;&amp;#x53CD;&amp;#x6570;&amp;#x5373;&amp;#x4E3A;&amp;#x7B2C;&amp;#x4E00;&amp;#x95EE;&amp;#x7B54;&amp;#x6848;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x6709;&amp;#x4E86;&amp;#x7B2C;&amp;#x4E00;&amp;#x95EE;&amp;#x7684;&amp;#x57FA;&amp;#x7840;&amp;#xFF0C;&amp;#x540E;&amp;#x9762;&amp;#x4E24;&amp;#x95EE;&amp;#x5C31;&amp;#x6BD4;&amp;#x8F83;&amp;#x5BB9;&amp;#x6613;&amp;#x4E86;&amp;#xFF0C;&amp;#x7B2C;&amp;#x4E8C;&amp;#x95EE;&amp;#x56E0;&amp;#x4E3A;&amp;#x53EF;&amp;#x4EE5;&amp;#x5728;&amp;#x6570;&amp;#x5B57;&amp;#x4E0A;&amp;#x91CD;&amp;#x590D;&amp;#xFF0C;&amp;#x5C31;&amp;#x628A;&amp;#x6BCF;&amp;#x4E2A;&amp;#x6570;&amp;#x5B57;&amp;#x7684;&amp;#x5165;&amp;#x70B9;&amp;#x548C;&amp;#x51FA;&amp;#x70B9;&amp;#x4E4B;&amp;#x95F4;&amp;#x7684;&amp;#x8FB9;&amp;#x5BB9;&amp;#x91CF;&amp;#x6539;&amp;#x4E3A;&amp;#x6B63;&amp;#x65E0;&amp;#x7A77;&amp;#xFF0C;&amp;#x628A;&amp;#x6307;&amp;#x5411;&amp;#x6C47;&amp;#x70B9;&amp;#x7684;&amp;#x8FB9;&amp;#x5BB9;&amp;#x91CF;&amp;#x4E5F;&amp;#x6539;&amp;#x4E3A;&amp;#x6B63;&amp;#x65E0;&amp;#x7A77;&amp;#xFF1B;&amp;#x7B2C;&amp;#x4E09;&amp;#x95EE;&amp;#x56E0;&amp;#x4E3A;&amp;#x53EF;&amp;#x4EE5;&amp;#x5728;&amp;#x8FB9;&amp;#x4E0A;&amp;#x91CD;&amp;#x590D;&amp;#xFF0C;&amp;#x5C31;&amp;#x5728;&amp;#x7B2C;&amp;#x4E8C;&amp;#x95EE;&amp;#x7684;&amp;#x57FA;&amp;#x7840;&amp;#x4E0A;&amp;#x628A;&amp;#x6BCF;&amp;#x4E2A;&amp;#x6570;&amp;#x5B57;&amp;#x7684;&amp;#x51FA;&amp;#x70B9;&amp;#x5411;&amp;#x4E0B;&amp;#x65B9;&amp;#x8FDE;&amp;#x63A5;&amp;#x7684;&amp;#x4E24;&amp;#x6761;&amp;#x8FB9;&amp;#x5BB9;&amp;#x91CF;&amp;#x6539;&amp;#x4E3A;&amp;#x6B63;&amp;#x65E0;&amp;#x7A77;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x4E00;&amp;#x5B9A;&amp;#x8981;&amp;#x6CE8;&amp;#x610F;&amp;#xFF0C;&amp;#x8BA1;&amp;#x7B97;&amp;#x7F51;&amp;#x7EDC;&amp;#x6D41;&amp;#x8282;&amp;#x70B9;&amp;#x7F16;&amp;#x53F7;&amp;#x8981;&amp;#x7528;&lt;strong&gt;&amp;#x68AF;&amp;#x5F62;&amp;#x9762;&amp;#x79EF;&amp;#x516C;&amp;#x5F0F;&lt;/strong&gt;&amp;#xFF0C;&amp;#x8BBE;&amp;#x6E90;&amp;#x70B9; &lt;code&gt;s&lt;/code&gt; &amp;#x7684;&amp;#x7F16;&amp;#x53F7;&amp;#x4E3A; 0&amp;#xFF0C;&amp;#x5219;&amp;#x5BF9;&amp;#x6570;&amp;#x5B57;&amp;#x8FDB;&amp;#x884C;&amp;#x62C6;&amp;#x70B9;&amp;#x540E;&amp;#x6240;&amp;#x5F97;&amp;#x7684;&amp;#x70B9;&amp;#x6570;&amp;#x91CF;&amp;#x4E3A; $ \frac{(m + (m + n - 1)) * n} {2} * 2 $&amp;#xFF0C;&amp;#x5373;&amp;#x6C47;&amp;#x70B9;&amp;#x7684;&amp;#x7F16;&amp;#x53F7;&amp;#x4E3A; $ \frac{(m + (m + n - 1)) * n} {2} * 2 + 1 $&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;ac&amp;#x4EE3;&amp;#x7801;&quot;&gt;AC&amp;#x4EE3;&amp;#x7801;&lt;/h3&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;93&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;94&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;95&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;96&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;97&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;98&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;99&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;100&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;101&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;102&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;103&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;104&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;105&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;106&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;107&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;108&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;109&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;110&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;111&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;112&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;113&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;114&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;115&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;116&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;117&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;118&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;119&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;120&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;121&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;122&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;123&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;124&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;125&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;126&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;127&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;128&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;129&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;130&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;131&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;132&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;133&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;134&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;135&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;136&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;137&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;138&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;139&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;140&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;141&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;142&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;143&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;144&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;145&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;146&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;147&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;148&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;149&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;150&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;151&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;152&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;153&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;154&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;155&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;156&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;157&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;158&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;159&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;160&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;161&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;162&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;163&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;164&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;165&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;166&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;167&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;168&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;169&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;170&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;171&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;172&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;173&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;174&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;175&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;176&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;177&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;178&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;179&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;180&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;181&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;182&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;183&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;184&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;185&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;186&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;climits&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cassert&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;algorithm&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;queue&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXM = &lt;span class=&quot;number&quot;&gt;20&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXN = &lt;span class=&quot;number&quot;&gt;20&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; L = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, R = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, IN = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, OUT = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Point {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; x, y;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Point() {}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Point(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; x, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; y) : x(x), y(y) {}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;};&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Node;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Edge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Node {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Edge *firstEdge, *inEdge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; flow, dist;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; inQueue;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} nodes[((MAXM + (MAXM + MAXN - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)) * MAXN / &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;) * &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; + &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Edge {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Node *from, *to;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; capacity, flow, cost;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Edge *next, *reversedEdge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Edge(Node *from, Node *to, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; capacity, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; cost) : from(from), to(to), capacity(capacity), cost(cost), flow(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;), next(from-&amp;gt;firstEdge) {}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;};&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, m, a[MAXN][MAXM + MAXN - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;], s, t;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; mapNode[MAXN][MAXM + MAXN - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;][&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;], mapEdge[MAXN][MAXM + MAXN - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;][&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; EdmondsKarp {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;bellmanford&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Node *s, Node *t, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &amp;amp;flow, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &amp;amp;cost)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			nodes[i].dist = INT_MAX;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			nodes[i].inEdge = &lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			nodes[i].flow = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			nodes[i].inQueue = &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		s-&amp;gt;flow = INT_MAX;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		s-&amp;gt;dist = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;queue&lt;/span&gt;&amp;lt;Node *&amp;gt; q;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		q.push(s);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (!q.empty()) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			Node *v = q.front();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			q.pop();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			v-&amp;gt;inQueue = &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (Edge *e = v-&amp;gt;firstEdge; e; e = e-&amp;gt;next) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (e-&amp;gt;flow &amp;lt; e-&amp;gt;capacity &amp;amp;&amp;amp; e-&amp;gt;to-&amp;gt;dist &amp;gt; v-&amp;gt;dist + e-&amp;gt;cost) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					e-&amp;gt;to-&amp;gt;dist = v-&amp;gt;dist + e-&amp;gt;cost;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;comment&quot;&gt;//printf(&amp;quot;dist((%d, %d), (%d, %d)) = %d\n&amp;quot;, e-&amp;gt;to-&amp;gt;pt1.x, e-&amp;gt;to-&amp;gt;pt1.y, e-&amp;gt;to-&amp;gt;pt2.x, e-&amp;gt;to-&amp;gt;pt2.y, e-&amp;gt;to-&amp;gt;dist);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					e-&amp;gt;to-&amp;gt;inEdge = e;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					e-&amp;gt;to-&amp;gt;flow = &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::min(v-&amp;gt;flow, e-&amp;gt;capacity - e-&amp;gt;flow);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!e-&amp;gt;to-&amp;gt;inQueue) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;						q.push(e-&amp;gt;to);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;						e-&amp;gt;to-&amp;gt;inQueue = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (t-&amp;gt;dist == INT_MAX) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (Node *v = t; v != s; v = v-&amp;gt;inEdge-&amp;gt;from) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			v-&amp;gt;inEdge-&amp;gt;flow += t-&amp;gt;flow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			v-&amp;gt;inEdge-&amp;gt;reversedEdge-&amp;gt;flow -= t-&amp;gt;flow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		cost += t-&amp;gt;dist * t-&amp;gt;flow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		flow += t-&amp;gt;flow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;comment&quot;&gt;//printf(&amp;quot;flow += %d\n&amp;quot;, t-&amp;gt;flow);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;operator&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; s, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; t, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &amp;amp;flow, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &amp;amp;cost)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		flow = cost = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (bellmanford(&amp;amp;nodes[s], &amp;amp;nodes[t], n, flow, cost));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} edmondskarp;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;addEdge&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; from, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; to, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; capacity, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; cost)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	nodes[from].firstEdge = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Edge(&amp;amp;nodes[from], &amp;amp;nodes[to], capacity, cost);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	nodes[to].firstEdge = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Edge(&amp;amp;nodes[to], &amp;amp;nodes[from], &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, -cost);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	nodes[from].firstEdge-&amp;gt;reversedEdge = nodes[to].firstEdge, nodes[to].firstEdge-&amp;gt;reversedEdge = nodes[from].firstEdge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;releaseMemory&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; ((m + (m + n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)) * n / &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;) * &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; + &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		Edge *next;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (Edge *e = nodes[i].firstEdge; e; next = e-&amp;gt;next, &lt;span class=&quot;keyword&quot;&gt;delete&lt;/span&gt; e, e = next);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		nodes[i].firstEdge = &lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;buildNetwork&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; limitPerNode, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; limitPerEdge)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	releaseMemory();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; m; i++) addEdge(s, mapNode[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;][i][IN], &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; j = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; j &amp;lt; m + i; j++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;comment&quot;&gt;//printf(&amp;quot;i(%d) -&amp;gt; %d, j(%d) -&amp;gt; %d\n&amp;quot;, i + 1, n, j + 1, m + i);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; (&amp;amp;v)[&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;] = mapNode[i][j];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; (&amp;amp;e)[&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;] = mapEdge[i][j];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;comment&quot;&gt;//printf(&amp;quot;a[i][j] = %d\n&amp;quot;, a[i][j]);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			addEdge(v[IN], v[OUT], limitPerNode, -a[i][j]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (i == n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;comment&quot;&gt;//printf(&amp;quot;OUT(%d, %d) = %d to t\n&amp;quot;, i + 1, j + 1, a[i][j]);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				addEdge(v[OUT], t, limitPerNode, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			} &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;comment&quot;&gt;//printf(&amp;quot;OUT(%d, %d) = %d to IN(%d, %d) = %d\n&amp;quot;, i + 1, j + 1, a[i][j], i + 1 + 1, j + 1, a[i + 1][j]);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				addEdge(v[OUT], e[L], limitPerEdge, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;comment&quot;&gt;//printf(&amp;quot;OUT(%d, %d) = %d to IN(%d, %d) = %d\n&amp;quot;, i + 1, j + 1, a[i][j], i + 1 + 1, j + 1 + 1, a[i + 1][j + 1]);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				addEdge(v[OUT], e[R], limitPerEdge, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;solve&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; flow, cost;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	edmondskarp(s, t, ((m + (m + n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)) * n / &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;) * &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; + &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, flow, cost);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; -cost;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;task1&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	buildNetwork(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; solve();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;task2&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	buildNetwork(INT_MAX, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; solve();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;task3&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	buildNetwork(INT_MAX, INT_MAX);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; solve();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	freopen(&lt;span class=&quot;string&quot;&gt;&amp;quot;digit.in&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;r&amp;quot;&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;stdin&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	freopen(&lt;span class=&quot;string&quot;&gt;&amp;quot;digit.out&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;w&amp;quot;&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;stdout&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d&amp;quot;&lt;/span&gt;, &amp;amp;m, &amp;amp;n);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	s = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, t = ((m + (m + n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)) * n / &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;) * &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;comment&quot;&gt;//printf(&amp;quot;t = %d\n&amp;quot;, t);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; k = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; j = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; j &amp;lt; m + i; j++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;a[i][j]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			mapNode[i][j][IN] = k++;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			mapNode[i][j][OUT] = k++;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			assert(k - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &amp;lt; ((m + (m + n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)) * n / &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;) * &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; j = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; j &amp;lt; m + i; j++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			mapEdge[i][j][L] = mapNode[i + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;][j][IN];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			mapEdge[i][j][R] = mapNode[i + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;][j + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;][IN];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d\n&amp;quot;&lt;/span&gt;, task1());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d\n&amp;quot;&lt;/span&gt;, task2());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d\n&amp;quot;&lt;/span&gt;, task3());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	fclose(&lt;span class=&quot;built_in&quot;&gt;stdin&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	fclose(&lt;span class=&quot;built_in&quot;&gt;stdout&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x4E00;&amp;#x4E2A;&amp;#x6570;&amp;#x5B57;&amp;#x68AF;&amp;#x5F62;&amp;#xFF0C;&amp;#x5171;&amp;#x6709; &lt;code&gt;n&lt;/code&gt; &amp;#x884C;&amp;#xFF0C;&amp;#x7B2C;&amp;#x4E00;&amp;#x884C;&amp;#x6709; &lt;code&gt;m&lt;/code&gt; &amp;#x4E2A;&amp;#x6570;&amp;#x5B57;&amp;#xFF0C;&amp;#x6BCF;&amp;#x4E00;&amp;#x884C;&amp;#x90FD;&amp;#x6BD4;&amp;#x4E0A;&amp;#x4E00;&amp;#x884C;&amp;#x591A;&amp;#x4E00;&amp;#x4E2A;&amp;#x6570;&amp;#x5B57;&amp;#x3002;&amp;#x4ECE;&amp;#x7B2C;&amp;#x4E00;&amp;#x884C;&amp;#x7684;&amp;#x6BCF;&amp;#x4E00;&amp;#x4E2A;&amp;#x6570;&amp;#x5B57;&amp;#x5F00;&amp;#x59CB;&amp;#xFF0C;&amp;#x6BCF;&amp;#x4E00;&amp;#x6B21;&amp;#x5411;&amp;#x5DE6;&amp;#x4E0B;&amp;#x65B9;&amp;#x6216;&amp;#x5DE6;&amp;#x4E0A;&amp;#x65B9;&amp;#x8D70;&amp;#xFF0C;&amp;#x76F4;&amp;#x5230;&amp;#x6700;&amp;#x540E;&amp;#x4E00;&amp;#x884C;&amp;#xFF0C;&amp;#x6709;&amp;#x4EE5;&amp;#x4E0B;&amp;#x4E09;&amp;#x79CD;&amp;#x89C4;&amp;#x5219;&amp;#xFF1A;&lt;/p&gt;
&lt;ol style=&quot;list-style-type: decimal&quot;&gt;
&lt;li&gt;&amp;#x4EFB;&amp;#x610F;&amp;#x4E24;&amp;#x6761;&amp;#x8DEF;&amp;#x5F84;&amp;#x6CA1;&amp;#x6709;&amp;#x516C;&amp;#x5171;&amp;#x90E8;&amp;#x5206;&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x4EFB;&amp;#x610F;&amp;#x4E24;&amp;#x6761;&amp;#x8DEF;&amp;#x5F84;&amp;#x53EA;&amp;#x80FD;&amp;#x5728;&amp;#x70B9;&amp;#xFF08;&amp;#x6570;&amp;#x5B57;&amp;#xFF09;&amp;#x4E0A;&amp;#x6709;&amp;#x516C;&amp;#x5171;&amp;#x90E8;&amp;#x5206;&amp;#xFF0C;&amp;#x4E0D;&amp;#x80FD;&amp;#x5728;&amp;#x8FB9;&amp;#xFF08;&amp;#x6570;&amp;#x5B57;&amp;#x4E0E;&amp;#x6570;&amp;#x5B57;&amp;#x4E4B;&amp;#x95F4;&amp;#xFF09;&amp;#x4E0A;&amp;#x6709;&amp;#x516C;&amp;#x5171;&amp;#x90E8;&amp;#x5206;&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;&amp;#x4EFB;&amp;#x610F;&amp;#x4E24;&amp;#x6761;&amp;#x8DEF;&amp;#x5F84;&amp;#x53EF;&amp;#x4EE5;&amp;#x5728;&amp;#x70B9;&amp;#x4E0A;&amp;#x6216;&amp;#x8FB9;&amp;#x4E0A;&amp;#x6709;&amp;#x516C;&amp;#x5171;&amp;#x90E8;&amp;#x5206;&amp;#x3002;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&amp;#x6C42;&amp;#x5206;&amp;#x522B;&amp;#x5728;&amp;#x8FD9;&amp;#x4E09;&amp;#x79CD;&amp;#x89C4;&amp;#x5219;&amp;#x4E0B;&amp;#x7684;&amp;#x8DEF;&amp;#x5F84;&amp;#x6240;&amp;#x7ECF;&amp;#x8FC7;&amp;#x6570;&amp;#x5B57;&amp;#x603B;&amp;#x548C;&amp;#x7684;&amp;#x6700;&amp;#x5927;&amp;#x503C;&amp;#x3002;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="COGS" scheme="https://blog.menci.moe/tag/cogs/"/>
    
      <category term="Edmonds-Karp" scheme="https://blog.menci.moe/tag/edmonds-karp/"/>
    
      <category term="图论" scheme="https://blog.menci.moe/tag/%E5%9B%BE%E8%AE%BA/"/>
    
      <category term="网络流" scheme="https://blog.menci.moe/tag/%E7%BD%91%E7%BB%9C%E6%B5%81/"/>
    
      <category term="网络流24题" scheme="https://blog.menci.moe/tag/%E7%BD%91%E7%BB%9C%E6%B5%8124%E9%A2%98/"/>
    
      <category term="费用流" scheme="https://blog.menci.moe/tag/%E8%B4%B9%E7%94%A8%E6%B5%81/"/>
    
  </entry>
  
  <entry>
    <title>「COGS 734」方格取数 - 二分图最大独立集</title>
    <link href="https://blog.menci.moe/cogs-734/"/>
    <id>https://blog.menci.moe/cogs-734/</id>
    <published>2016-02-15T09:02:01.000Z</published>
    <updated>2016-02-15T09:03:18.000Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x5728;&amp;#x4E00;&amp;#x4E2A;&amp;#x6709; $ M * N $ &amp;#x4E2A;&amp;#x65B9;&amp;#x683C;&amp;#x7684;&amp;#x68CB;&amp;#x76D8;&amp;#x4E2D;&amp;#xFF0C;&amp;#x6BCF;&amp;#x4E2A;&amp;#x65B9;&amp;#x683C;&amp;#x4E2D;&amp;#x6709;&amp;#x4E00;&amp;#x4E2A;&amp;#x6B63;&amp;#x6574;&amp;#x6570;&amp;#x3002;&amp;#x73B0;&amp;#x8981;&amp;#x4ECE;&amp;#x65B9;&amp;#x683C;&amp;#x4E2D;&amp;#x53D6;&amp;#x6570;&amp;#xFF0C;&amp;#x4F7F;&amp;#x4EFB;&amp;#x610F;&amp;#x4E24;&amp;#x4E2A;&amp;#x6570;&amp;#x6240;&amp;#x5728;&amp;#x65B9;&amp;#x683C;&amp;#x6CA1;&amp;#x6709;&amp;#x516C;&amp;#x5171;&amp;#x8FB9;&amp;#xFF0C;&amp;#x4E14;&amp;#x53D6;&amp;#x51FA;&amp;#x7684;&amp;#x6570;&amp;#x7684;&amp;#x603B;&amp;#x548C;&amp;#x6700;&amp;#x5927;&amp;#x3002;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;&amp;#x9898;&amp;#x76EE;&amp;#x94FE;&amp;#x63A5;&quot;&gt;&amp;#x9898;&amp;#x76EE;&amp;#x94FE;&amp;#x63A5;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://cogs.top/cogs/problem/problem.php?pid=734&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;COGS 734&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#x89E3;&amp;#x9898;&amp;#x601D;&amp;#x8DEF;&quot;&gt;&amp;#x89E3;&amp;#x9898;&amp;#x601D;&amp;#x8DEF;&lt;/h3&gt;
&lt;p&gt;&amp;#x4EFB;&amp;#x610F;&amp;#x4E24;&amp;#x4E2A;&amp;#x6570;&amp;#x6240;&amp;#x5728;&amp;#x7684;&amp;#x65B9;&amp;#x683C;&amp;#x6CA1;&amp;#x6709;&amp;#x516C;&amp;#x5171;&amp;#x8FB9;&amp;#xFF0C;&amp;#x8003;&amp;#x8651;&amp;#x628A;&amp;#x6240;&amp;#x6709;&amp;#x7684;&amp;#x683C;&amp;#x5B50;&amp;#x5EFA;&amp;#x6210;&amp;#x56FE;&amp;#xFF0C;&amp;#x4E0D;&amp;#x80FD;&amp;#x540C;&amp;#x65F6;&amp;#x9009;&amp;#x62E9;&amp;#x7684;&amp;#x70B9;&amp;#x4E4B;&amp;#x95F4;&amp;#x4E24;&amp;#x4E24;&amp;#x8FDE;&amp;#x8FB9;&amp;#xFF0C;&amp;#x6C42;&amp;#x51FA;&amp;#x4E00;&amp;#x4E2A;&amp;#x70B9;&amp;#x6743;&amp;#x548C;&amp;#x6700;&amp;#x5927;&amp;#x7684;&amp;#x5B50;&amp;#x56FE;&amp;#xFF08;&amp;#x6700;&amp;#x5927;&amp;#x72EC;&amp;#x7ACB;&amp;#x96C6;&amp;#xFF09;&amp;#xFF0C;&amp;#x5176;&amp;#x548C;&amp;#x5373;&amp;#x4E3A;&amp;#x7B54;&amp;#x6848;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x8FDB;&amp;#x4E00;&amp;#x6B65;&amp;#x5206;&amp;#x6790;&amp;#xFF0C;&amp;#x53D1;&amp;#x73B0;&amp;#x8FD9;&amp;#x4E2A;&amp;#x56FE;&amp;#x662F;&amp;#x4E00;&amp;#x4E2A;&amp;#x4E8C;&amp;#x5206;&amp;#x56FE; &amp;#x2014;&amp;#x2014; &amp;#x56E0;&amp;#x4E3A;&amp;#x6BCF;&amp;#x4E2A;&amp;#x70B9;&amp;#x53EA;&amp;#x4F1A;&amp;#x548C;&lt;strong&gt;&amp;#x68CB;&amp;#x76D8;&amp;#x4E2D;&amp;#x4E0E;&amp;#x5176;&amp;#x76F8;&amp;#x90BB;&amp;#x7684;&amp;#x70B9;&lt;/strong&gt;&amp;#x8FDE;&amp;#x8FB9;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x6839;&amp;#x636E;&amp;#x5B9A;&amp;#x7406;&amp;#xFF0C;&amp;#x4E8C;&amp;#x5206;&amp;#x56FE;&amp;#x6700;&amp;#x5927;&amp;#x72EC;&amp;#x7ACB;&amp;#x96C6;&amp;#x5373;&amp;#x4E3A;&amp;#x6700;&amp;#x5C0F;&amp;#x70B9;&amp;#x8986;&amp;#x76D6;&amp;#x96C6;&amp;#x7684;&amp;#x8865;&amp;#x96C6;&amp;#xFF0C;&amp;#x800C;&amp;#x6700;&amp;#x5C0F;&amp;#x70B9;&amp;#x8986;&amp;#x76D6;&amp;#x96C6;&amp;#x53EF;&amp;#x4EE5;&amp;#x7528;&amp;#x6700;&amp;#x5C0F;&amp;#x5272;&amp;#x6A21;&amp;#x578B;&amp;#x6765;&amp;#x6C42;&amp;#x89E3;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x5EFA;&amp;#x7ACB;&amp;#x6E90;&amp;#x70B9; S &amp;#x548C;&amp;#x6C47;&amp;#x70B9; T&amp;#xFF0C;&amp;#x5BF9;&amp;#x4E8E;&amp;#x4E8C;&amp;#x5206;&amp;#x56FE;&amp;#x4E2D;&amp;#x6BCF;&amp;#x4E2A; X &amp;#x70B9;&amp;#x96C6;&amp;#x4E2D;&amp;#x7684;&amp;#x70B9;&amp;#xFF0C;&amp;#x4ECE; S &amp;#x5411;&amp;#x5176;&amp;#x8FDE;&amp;#x4E00;&amp;#x6761;&amp;#x8FB9;&amp;#xFF0C;&amp;#x5BB9;&amp;#x91CF;&amp;#x4E3A;&amp;#x70B9;&amp;#x6743;&amp;#xFF1B;&amp;#x5BF9;&amp;#x4E8E;&amp;#x6BCF;&amp;#x4E2A; Y &amp;#x70B9;&amp;#x96C6;&amp;#x4E2D;&amp;#x7684;&amp;#x70B9;&amp;#xFF0C;&amp;#x4ECE;&amp;#x8BE5;&amp;#x70B9;&amp;#x5411;&amp;#x6C47;&amp;#x70B9;&amp;#x8FDE;&amp;#x4E00;&amp;#x6761;&amp;#x8FB9;&amp;#xFF0C;&amp;#x5BB9;&amp;#x91CF;&amp;#x4E3A;&amp;#x70B9;&amp;#x6743;&amp;#xFF1B;&amp;#x5BF9;&amp;#x4E8E;&amp;#x539F;&amp;#x56FE;&amp;#x4E2D;&amp;#x7684;&amp;#x6BCF;&amp;#x6761;&amp;#x8FB9;&amp;#xFF0C;&amp;#x8F6C;&amp;#x5316;&amp;#x4E3A;&amp;#x4ECE; X &amp;#x70B9;&amp;#x96C6;&amp;#x7684;&amp;#x70B9;&amp;#x8FDE;&amp;#x63A5;&amp;#x5230; Y &amp;#x70B9;&amp;#x96C6;&amp;#x4E2D;&amp;#x7684;&amp;#x70B9;&amp;#x7684;&amp;#x8FB9;&amp;#xFF0C;&amp;#x5BB9;&amp;#x91CF;&amp;#x4E3A;&amp;#x65E0;&amp;#x7A77;&amp;#x5927;&amp;#x3002;&amp;#x6C42;&amp;#x51FA;&amp;#x6700;&amp;#x5C0F;&amp;#x5272;&amp;#xFF0C;&amp;#x5219;&amp;#x8BE5;&amp;#x6700;&amp;#x5C0F;&amp;#x5272;&amp;#x4E3A;&amp;#x7B80;&amp;#x5355;&amp;#x5272;&amp;#xFF0C;&amp;#x5373;&amp;#x4EFB;&amp;#x610F;&amp;#x4E00;&amp;#x6761;&amp;#x5272;&amp;#x8FB9;&amp;#x4E0D;&amp;#x53EF;&amp;#x80FD;&amp;#x662F;&amp;#x4E2D;&amp;#x95F4;&amp;#x90A3;&amp;#x6761;&amp;#x65E0;&amp;#x7A77;&amp;#x5927;&amp;#x7684;&amp;#x8FB9;&amp;#xFF0C;&amp;#x800C;&amp;#x8FD9;&amp;#x4E9B;&amp;#x5272;&amp;#x8FB9;&amp;#x6070;&amp;#x597D;&amp;#x4E0D;&amp;#x91CD;&amp;#x590D;&amp;#x7684;&amp;#x8986;&amp;#x76D6;&amp;#x4E86;&amp;#x6574;&amp;#x4E2A;&amp;#x4E8C;&amp;#x5206;&amp;#x56FE;&amp;#x4E2D;&amp;#x7684;&amp;#x6240;&amp;#x6709;&amp;#x70B9;&amp;#xFF0C;&amp;#x5E76;&amp;#x4E14;&amp;#x6743;&amp;#x503C;&amp;#x548C;&amp;#x6700;&amp;#x5C0F;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x5EFA;&amp;#x7ACB;&amp;#x4E8C;&amp;#x5206;&amp;#x56FE;&amp;#x6A21;&amp;#x578B;&amp;#x7684;&amp;#x65F6;&amp;#x5019;&amp;#x6CE8;&amp;#x610F;&amp;#x7EC6;&amp;#x8282;&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;ac&amp;#x4EE3;&amp;#x7801;&quot;&gt;AC&amp;#x4EE3;&amp;#x7801;&lt;/h3&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;93&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;94&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;95&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;96&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;97&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;98&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;99&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;100&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;101&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;102&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;103&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;104&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;105&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;106&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;107&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;108&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;109&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;110&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;111&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;112&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;113&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;114&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;115&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;116&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;117&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;118&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;119&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;120&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;121&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;122&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;123&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;124&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;125&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;126&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;127&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;climits&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;algorithm&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;preprocessor&quot;&gt;#&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;lt;queue&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXN = &lt;span class=&quot;number&quot;&gt;30&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; MAXM = &lt;span class=&quot;number&quot;&gt;30&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Node;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Edge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Node {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Edge *firstEdge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; level;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} nodes[MAXN * MAXM + &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Edge {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Node *from, *to;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; capacity, flow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Edge *next, *reversedEdge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Edge(Node *from, Node *to, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; capacity) : from(from), to(to), next(from-&amp;gt;firstEdge), capacity(capacity), flow(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) {}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;};&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, m;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Dinic {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;makeLevelGraph&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Node *s, Node *t, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) nodes[i].level = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;queue&lt;/span&gt;&amp;lt;Node *&amp;gt; q;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		q.push(s);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		s-&amp;gt;level = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (!q.empty()) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			Node *v = q.front();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			q.pop();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (Edge *e = v-&amp;gt;firstEdge; e; e = e-&amp;gt;next) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (e-&amp;gt;flow &amp;lt; e-&amp;gt;capacity &amp;amp;&amp;amp; e-&amp;gt;to-&amp;gt;level == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					e-&amp;gt;to-&amp;gt;level = v-&amp;gt;level + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (e-&amp;gt;to == t) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; q.push(e-&amp;gt;to);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;findPath&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Node *s, Node *t, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; limit = INT_MAX)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (s == t) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; limit;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (Edge *e = s-&amp;gt;firstEdge; e; e = e-&amp;gt;next) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (e-&amp;gt;flow &amp;lt; e-&amp;gt;capacity &amp;amp;&amp;amp; e-&amp;gt;to-&amp;gt;level == s-&amp;gt;level + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; flow = findPath(e-&amp;gt;to, t, &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::min(limit, e-&amp;gt;capacity - e-&amp;gt;flow));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (flow &amp;gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					e-&amp;gt;flow += flow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					e-&amp;gt;reversedEdge-&amp;gt;flow -= flow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; flow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;operator&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; s, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; t, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; ans = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (makeLevelGraph(&amp;amp;nodes[s], &amp;amp;nodes[t], n)) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; flow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; ((flow = findPath(&amp;amp;nodes[s], &amp;amp;nodes[t])) &amp;gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) ans += flow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; ans;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;} dinic;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;addEdge&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; from, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; to, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; capacity)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	nodes[from].firstEdge = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Edge(&amp;amp;nodes[from], &amp;amp;nodes[to], capacity);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	nodes[to].firstEdge = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Edge(&amp;amp;nodes[to], &amp;amp;nodes[from], &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	nodes[from].firstEdge-&amp;gt;reversedEdge = nodes[to].firstEdge, nodes[to].firstEdge-&amp;gt;reversedEdge = nodes[from].firstEdge;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;getNodeID&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; x, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; y)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; x * n + y + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	freopen(&lt;span class=&quot;string&quot;&gt;&amp;quot;grid.in&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;r&amp;quot;&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;stdin&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	freopen(&lt;span class=&quot;string&quot;&gt;&amp;quot;grid.out&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;w&amp;quot;&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;stdout&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d %d&amp;quot;&lt;/span&gt;, &amp;amp;m, &amp;amp;n);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; s = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, t = n * m + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; sum = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; m; i++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; j = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; j &amp;lt; n; j++) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; num;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, &amp;amp;num);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			sum += num;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; id = getNodeID(i, j);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; flag = (i + j) % &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (flag) addEdge(s, id, num);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; addEdge(id, t, num);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (flag) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (i &amp;gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) addEdge(id, getNodeID(i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, j), INT_MAX);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (i &amp;lt; m - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) addEdge(id, getNodeID(i + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, j), INT_MAX);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (j &amp;gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) addEdge(id, getNodeID(i, j - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;), INT_MAX);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (j &amp;lt; n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) addEdge(id, getNodeID(i, j + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;), INT_MAX);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; maxFlow = dinic(s, t, n * m + &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d\n&amp;quot;&lt;/span&gt;, sum - maxFlow);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	fclose(&lt;span class=&quot;built_in&quot;&gt;stdin&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	fclose(&lt;span class=&quot;built_in&quot;&gt;stdout&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x5728;&amp;#x4E00;&amp;#x4E2A;&amp;#x6709; $ M * N $ &amp;#x4E2A;&amp;#x65B9;&amp;#x683C;&amp;#x7684;&amp;#x68CB;&amp;#x76D8;&amp;#x4E2D;&amp;#xFF0C;&amp;#x6BCF;&amp;#x4E2A;&amp;#x65B9;&amp;#x683C;&amp;#x4E2D;&amp;#x6709;&amp;#x4E00;&amp;#x4E2A;&amp;#x6B63;&amp;#x6574;&amp;#x6570;&amp;#x3002;&amp;#x73B0;&amp;#x8981;&amp;#x4ECE;&amp;#x65B9;&amp;#x683C;&amp;#x4E2D;&amp;#x53D6;&amp;#x6570;&amp;#xFF0C;&amp;#x4F7F;&amp;#x4EFB;&amp;#x610F;&amp;#x4E24;&amp;#x4E2A;&amp;#x6570;&amp;#x6240;&amp;#x5728;&amp;#x65B9;&amp;#x683C;&amp;#x6CA1;&amp;#x6709;&amp;#x516C;&amp;#x5171;&amp;#x8FB9;&amp;#xFF0C;&amp;#x4E14;&amp;#x53D6;&amp;#x51FA;&amp;#x7684;&amp;#x6570;&amp;#x7684;&amp;#x603B;&amp;#x548C;&amp;#x6700;&amp;#x5927;&amp;#x3002;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="https://blog.menci.moe/categories/oi/"/>
    
    
      <category term="COGS" scheme="https://blog.menci.moe/tag/cogs/"/>
    
      <category term="Dinic" scheme="https://blog.menci.moe/tag/dinic/"/>
    
      <category term="图论" scheme="https://blog.menci.moe/tag/%E5%9B%BE%E8%AE%BA/"/>
    
      <category term="最大独立集" scheme="https://blog.menci.moe/tag/%E6%9C%80%E5%A4%A7%E7%8B%AC%E7%AB%8B%E9%9B%86/"/>
    
      <category term="网络流" scheme="https://blog.menci.moe/tag/%E7%BD%91%E7%BB%9C%E6%B5%81/"/>
    
      <category term="网络流24题" scheme="https://blog.menci.moe/tag/%E7%BD%91%E7%BB%9C%E6%B5%8124%E9%A2%98/"/>
    
  </entry>
  
</feed>
